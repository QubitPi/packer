<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Google Cloud Platform | Integrations | Packer | HashiCorp Developer</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE."/><meta name="twitter:description" content="The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE."/><meta property="og:site_name" content="Google Cloud Platform | Integrations | Packer | HashiCorp Developer"/><meta property="og:title" content="Google Cloud Platform | Integrations | Packer | HashiCorp Developer"/><meta property="og:image" content="https://developer.hashicorp.com/og-image/packer.jpg"/><link rel="canonical" href="https://developer.hashicorp.com/packer/integrations/hashicorp/googlecompute"/><link rel="icon" href="/favicon.ico" sizes="any"/><link rel="icon" href="/icon.svg" type="image/svg+xml"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="google-site-verification" content="zRQZqfAsOX-ypXfU0mzAIzb5rUvj5fA4Zw2jWJRN-JI"/><meta name="zd-site-verification" content="xnvnvv1i0wl4tf0pzaymb" data-product="hcp"/><meta name="zd-site-verification" content="36fp2i1pj67d8cjtzf4fi9" data-product="terraform"/><meta name="zd-site-verification" content="nbe87kfyp1sck7b13vj1i" data-product="packer"/><meta name="zd-site-verification" content="wvsmmqa1cfb9am9zlwfj" data-product="consul"/><meta name="zd-site-verification" content="cw22oopfwr68ujj0n5pn9i" data-product="boundary"/><meta name="zd-site-verification" content="lkslvganwfgfqfwpdeicgh" data-product="vault"/><meta name="zd-site-verification" content="jl2wp2hoej9rz6c8rmqdns" data-product="nomad"/><meta name="zd-site-verification" content="2eb0cu6xceo73t0038m0tb" data-product="waypoint"/><meta name="zd-site-verification" content="n52xisxdf3higs2q9kuogd" data-product="vagrant"/><meta name="twitter:image" content="https://developer.hashicorp.com/og-image/packer.jpg"/><link rel="prefetch" href="https://www.datadoghq-browser-agent.com/datadog-rum-v4.js"/><script type="application/ld+json">[{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Developer","item":"https://developer.hashicorp.com/"},{"@type":"ListItem","position":2,"name":"Packer","item":"https://developer.hashicorp.com/packer"},{"@type":"ListItem","position":3,"name":"Integrations","item":"https://developer.hashicorp.com/packer/integrations"},{"@type":"ListItem","position":4,"name":"Google Cloud Platform","item":"https://developer.hashicorp.com/packer/integrations/hashicorp/googlecompute"}]}]</script><meta name="next-head-count" content="31"/><link rel="preload" href="/hashicorp-packer/_next/static/css/c621b75f20f9135a.css" as="style"/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/c621b75f20f9135a.css" data-n-g=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/46db8953ec6dc2da.css" as="style"/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/46db8953ec6dc2da.css" data-n-p=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/26afe300494d6bcd.css" as="style"/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/26afe300494d6bcd.css" data-n-p=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/2d34fcd0bdba49b0.css" as="style"/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/2d34fcd0bdba49b0.css" data-n-p=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/0f613fe490e205b0.css" as="style"/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/0f613fe490e205b0.css" data-n-p=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/6cccab16b153a5f4.css" as="style"/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/6cccab16b153a5f4.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/hashicorp-packer/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/hashicorp-packer/_next/static/chunks/webpack-5807112211686a12.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/framework-2fe4cb6473b20297.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/main-7335293e23c346da.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/pages/_app-fbdec872f00a6a1b.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/5110-abef9c4251241be2.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/6298-0ebb749f40214f31.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/279-2ec7649c2610ad1d.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/5182-68aa414569a67250.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/6584-5218c448d7eacc13.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/1674-7b662558aac53369.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/3890-15dedba2a79fbb17.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/161-5ffad0d39bd4c34f.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/2539-4f6f4f80fb2915bc.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/8569-8ab7a5779bc00bb2.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/7347-fa648846f25ad408.js" defer=""></script><script src="/hashicorp-packer/_next/static/chunks/pages/%5BproductSlug%5D/integrations/%5BorganizationSlug%5D/%5BintegrationSlug%5D-1c0fa2716e704e42.js" defer=""></script><script src="/hashicorp-packer/_next/static/VGXTUm1VCSgK23NSRIBql/_buildManifest.js" defer=""></script><script src="/hashicorp-packer/_next/static/VGXTUm1VCSgK23NSRIBql/_ssgManifest.js" defer=""></script></head><body><script>!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://artemis.hashicorp.com/script/"+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics._cdn="https://artemis.hashicorp.com";analytics.SNIPPET_VERSION="4.1.0";}}();</script><div id="__next"><div class="style_root__gtmO7 style_isShown__VBT3O style_hideOnMobile__8aYhN"><a href="https://hashi.co/dev-ai-signup" class="style_linkElem__N77Wq"><span class="style_textContainer__nWykx g-grid-container"><span class="style_tag__49wXK g-type-body-small-x-strong">HashiCorp Developer AI<!-- --> </span><span class="style_text__LAM7g g-type-body-small">Private beta now available<span class="style_linkText__zMT7D g-type-body-small-x-strong"> <!-- -->Sign up today</span></span></span></a><button class="style_closeButton__sM2Zq"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 5L5 15M5 5l10 10" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div><span style="position:absolute;border:0;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;word-wrap:normal">Dismiss alert</span></button></div><script type="text/javascript">
(function checkDismissAlertBanner() {
  try {
    if (document.cookie.includes('banner_private-beta-now-available=1')) {
      const element = document.querySelector('.style_root__gtmO7')
      element.classList.remove('style_isShown__VBT3O')
    }
  } catch (_) {
    // do nothing
  }
})()
</script><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="core-dev-dot-layout_root__n_H9f"><div class="base-layout_root__eEe1S" data-layout="base-new"><div class="base-layout_header__tS5Up"><header class="navigation-header_root__melJh"><div class="navigation-header_leftSide__KvYLy"><div class="product-page-content_productsDropdown__ADVi_"><div class="dropdown-menu_root__6KZmR"><div class="dropdown-menu_activatorWrapper__CcEW9"><button aria-controls="navigation-header-menu-react-aria-1" aria-expanded="false" aria-label="Main menu" class="dropdown-menu_activator__ckTuF g-focus-ring-from-box-shadow-dark product-page-content_productsDropdownButton__qQbE_" data-heap-track="navigation-header-dropdown-menu-activator"><span class="dropdown-menu_activatorLeadingIcon__eumCf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true" class="product-page-content_productsDropdownIcon__wBq3i"><g fill="currentColor"><path d="M10.336 1.5L2 6.268v11.456l3.131 1.793V8.061l5.205-2.979V1.5z"></path><path d="M13.664 1.5v9.123h-3.328V7.219L7.203 9.012V20.7l3.133 1.796V13.4h3.328v3.381l3.131-1.793V3.293L13.664 1.5z"></path><path d="M22 17.732L13.664 22.5v-3.582l5.203-2.98V4.484L22 6.276v11.456z"></path></g></svg></span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="dropdown-menu_activatorTrailingIcon__9J6dL"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button></div><div class="dropdown-menu_dropdownContainer__PHNMa product-page-content_productsDropdownPane__tPPie" id="navigation-header-menu-react-aria-1" style="display:none"><ul class="dropdown-menu_itemGroup__oGM_M"><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M7.846 2.574a.25.25 0 01.308 0l5.25 4.12a.25.25 0 01.096.196v7.36a.75.75 0 001.5 0V6.89a1.75 1.75 0 00-.67-1.377L9.08 1.394a1.75 1.75 0 00-2.16 0l-5.25 4.12A1.75 1.75 0 001 6.89v7.36a.75.75 0 001.5 0V6.89a.25.25 0 01.096-.196l5.25-4.12z"></path><path d="M6.5 14.25V10.5h3v3.75a.75.75 0 001.5 0v-4C11 9.56 10.44 9 9.75 9h-3.5C5.56 9 5 9.56 5 10.25v4a.75.75 0 001.5 0z"></path></g></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">HashiCorp Developer</span></div></div></a></li></ul><hr class="dropdown-menu_itemGroupDivider__2hzpC"/><ul class="dropdown-menu_itemGroup__oGM_M"><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/hcp"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">HashiCorp Cloud Platform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/terraform"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-terraform-brand)"><path d="M1 0v5.05l4.349 2.527V2.526L1 0zM10.175 5.344l-4.35-2.525v5.05l4.35 2.527V5.344zM10.651 10.396V5.344L15 2.819v5.05l-4.349 2.527zM10.174 16l-4.349-2.526v-5.05l4.349 2.525V16z"></path></g></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">Terraform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/packer"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">Packer</span></div></div></a></li><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/consul"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">Consul</span></div></div></a></li><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/vault"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-vault-brand)" d="M0 0l7.971 15.516L16 0H0zm6.732 6.16h-1.27V4.89h1.27v1.27zm0-1.906h-1.27V2.985h1.27v1.269zm1.904 3.81h-1.27v-1.27h1.27v1.27zm0-1.905h-1.27V4.89h1.27v1.27zm0-1.905h-1.27V2.985h1.27v1.269zm1.894 1.905H9.26V4.89h1.27v1.27zM9.26 4.254V2.985h1.27v1.269H9.26z"></path></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">Vault</span></div></div></a></li><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/boundary"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-boundary-brand)"><path d="M4.81 15v-1.085h2.25v-.67H5.968v-1.093h5.149L8.726 8l2.392-4.154H5.84v5.76H3V1h9.775l1.631 2.832L12.006 8l2.448 4.252L12.872 15H4.81z"></path><path d="M5.248 12.152h-1.09v1.092h1.09v-1.092zM3 13.907h1.09v1.092H3v-1.092z"></path></g></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">Boundary</span></div></div></a></li><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/nomad"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-nomad-brand)" d="M8 0L1 4v8l7 4 7-4V4L8 0zm3.119 8.797L9.254 9.863 7.001 8.65v2.549l-2.118 1.33v-5.33l1.68-1.018 2.332 1.216V4.794l2.23-1.322-.006 5.325z"></path></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">Nomad</span></div></div></a></li><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/waypoint"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-waypoint-brand)"><path d="M4 5.312h1.334L10 13.4l3.334-5.777L10.666 3H8l2.666 4.623L10 8.778 6.667 3H0l6 10.4 1.333-2.31L4 5.311zM14.002 6.463L16 3h-3.996l1.998 3.463z"></path></g></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">Waypoint</span></div></div></a></li><li><a class="dropdown-menu_itemLink__VpbEz g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/vagrant"><div class="dropdown-menu_itemLinkContent__DF_Kb"><div class="dropdown-menu_leftAlignedItemLinkContent__DNVQb"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__HoaSb"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="#1868F2" d="M13.08.75L9.924 2.58v1.123L8 8.245 6.076 3.703V2.58L2.92.75 1 1.864v1.293l4.276 10.514L8 15.25l2.724-1.579L15 3.157V1.864L13.08.75z"></path><path fill="#0850C5" d="M15 1.865l-3.157 1.829v1.124L9.28 10.57 8 11.312v3.939l2.724-1.579L15 3.158V1.865zM6.076 3.703V2.58l-1.92 1.113v1.125l2.564 5.751L8 9.827V8.245L6.076 3.703z"></path></svg></span><span class="text_root__WdIWm hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__rL_Fw">Vagrant</span></div></div></a></li></ul></div></div></div><div class="product-page-content_productLinkAndNav___DH4r"><a aria-label="Packer home" class="product-icon-text-link_root__8kSDs g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-product-logo-link" href="/hashicorp-packer/packer"><div class="product-icon-text-lockup_root__p7LuM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="product-icon-text-lockup_icon__i_EB4"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="product-icon-text-lockup_text__gfI6W hds-typography-body-200">Packer</span></div></a><nav class="nav-bar-list-container_nav__0Q0OL"><ul class="nav-bar-list-container_ul__sgfM9"><li><a aria-label="Packer Install" class="primary-nav-link_root__5e0jF g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/downloads"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__zsIfa">Install</span></a></li><li><a aria-label="Packer Tutorials" class="primary-nav-link_root__5e0jF g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/tutorials"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__zsIfa">Tutorials</span></a></li><li><a aria-label="Packer Documentation" class="primary-nav-link_root__5e0jF g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/docs"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__zsIfa">Documentation</span></a></li><li><a aria-label="Packer Guides" class="primary-nav-link_root__5e0jF g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/guides"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__zsIfa">Guides</span></a></li><li><a aria-label="Packer Plugins" class="primary-nav-link_root__5e0jF g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/plugins"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__zsIfa">Plugins</span></a></li><li><a aria-label="Packer Integrations" class="primary-nav-link_root__5e0jF g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/integrations"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__zsIfa">Integrations</span></a></li><li><a aria-label="Packer Try Cloud" class="primary-nav-link_root__5e0jF g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="undefinedopens-in-new-tab-label-react-aria-19" target="_blank" href="https://portal.cloud.hashicorp.com/sign-up"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__zsIfa">Try Cloud</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-19">(opens in new tab)</span></li></ul></nav></div></div><div class="navigation-header_rightSide__VIrVO"><button aria-label="Search" class="command-bar-activator_root__DsgCL g-focus-ring-from-box-shadow-dark"><span class="command-bar-activator_left__BhdH4"><span class="command-bar-activator_leadingIcon__eFqV7"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M7.25 2a5.25 5.25 0 103.144 9.455l2.326 2.325a.75.75 0 101.06-1.06l-2.325-2.326A5.25 5.25 0 007.25 2zM3.5 7.25a3.75 3.75 0 117.5 0 3.75 3.75 0 01-7.5 0z" clip-rule="evenodd"></path></svg></span><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular command-bar-activator_text__2TtkO">Search</span></span><span class="command-bar-activator_right__Uai8J"><span class="g-screen-reader-only">Command or control key</span><span aria-hidden="true" class="badge_root__LCJF3 badge_small__gwcZy badge_filled-neutral-dark-mode__mds6M command-bar-activator_keyBadge__Io5xa"><div class="cmd-ctrl-icon_root__5ZSUu"><svg width="41" height="11" viewBox="0 0 41 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.125 2.063V3h2.25v-.938a2.062 2.062 0 112.063 2.063H7.5v2.25h.938a2.062 2.062 0 11-2.063 2.063V7.5h-2.25v.938a2.062 2.062 0 11-2.063-2.063H3v-2.25h-.938a2.062 2.062 0 112.063-2.063zm-2.063-.938a.937.937 0 100 1.875H3v-.938a.937.937 0 00-.938-.937zM7.5 7.5v.938a.937.937 0 10.938-.938H7.5zM6.375 6.375v-2.25h-2.25v2.25h2.25zM2.062 7.5H3v.938a.937.937 0 11-.938-.938zM7.5 3h.938a.937.937 0 10-.938-.938V3z" fill="#fff"/><path d="M15.09 10.5L18.085 0h-1.097L14 10.5h1.09zm11.297-5.192c-.183-1.445-1.263-2.534-3.05-2.534C21.264 2.774 20 4.247 20 6.61c0 2.41 1.27 3.89 3.344 3.89 1.76 0 2.86-1.034 3.043-2.5H25.02c-.184.808-.792 1.247-1.682 1.247-1.172 0-1.898-.994-1.898-2.637 0-1.61.72-2.583 1.898-2.583.942 0 1.518.555 1.681 1.281h1.368zM28.6 1.041v1.897h-1.133v1.178H28.6v4.281c0 1.432.622 2.007 2.186 2.007.275 0 .537-.034.766-.075V9.158c-.196.02-.32.034-.537.034-.7 0-1.008-.35-1.008-1.15V4.115h1.545V2.938h-1.545V1.041H28.6zm4.607 9.315h1.407V5.911c0-1.048.752-1.767 1.819-1.767.249 0 .667.048.785.082V2.842a3.372 3.372 0 00-.628-.054c-.93 0-1.721.527-1.924 1.26h-.105v-1.13h-1.354v7.438zm5.431 0h1.407V0h-1.407v10.356z" fill="#fff"/></svg></div></span><span class="g-screen-reader-only">K key</span><span aria-hidden="true" class="badge_root__LCJF3 badge_small__gwcZy badge_filled-neutral-dark-mode__mds6M command-bar-activator_keyBadge__Io5xa"><div class="k-icon_root__ac61X"><svg width="8" height="10" viewBox="0 0 8 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.512 9.84v-3l.986-1.147L5.445 9.84h1.704L3.46 4.745 6.857.84H5.244L1.61 5.094h-.098V.84H.15v9h1.363z" fill="#fff"/></svg></div></span></span></button><div class="navigation-header_authenticationControls__wYhHm"><div class="disclosure_root__AAinH dropdown-disclosure_root__KM3_y dropdown-disclosure_list-position--right__KzHJE"><button aria-controls="disclosure-react-aria-20-content" aria-expanded="false" aria-label="User menu" class="disclosure_activator__jqkij activator_root__cU8vM dropdown-disclosure_activator__Dk5J_ navigation-header_userDropdownDisclosureActivator__9VIsG g-focus-ring-from-box-shadow-dark activator_hasIcon__qoG5l g-focus-ring-from-box-shadow"><span class="activator_childrenWrapper__KnFKW"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path fill-rule="evenodd" d="M12 3a5 5 0 100 10 5 5 0 000-10zM8.5 8a3.5 3.5 0 117 0 3.5 3.5 0 01-7 0z" clip-rule="evenodd"></path><path d="M7.75 14.5A4.75 4.75 0 003 19.25v1a.75.75 0 001.5 0v-1A3.25 3.25 0 017.75 16h8.5a3.25 3.25 0 013.25 3.25v1a.75.75 0 001.5 0v-1a4.75 4.75 0 00-4.75-4.75h-8.5z"></path></g></svg></span><span class="activator_chevronWrapper__6hV29"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></span></button><div class="disclosure_contentContainer__77KIY dropdown-disclosure_content__GVRd1 undefined" id="disclosure-react-aria-20-content"><ul class="dropdown-disclosure_list__wyx6a"><li class="list-item_root__HMbDW"><button class="list-item_button__WHsV6 g-focus-ring-from-box-shadow"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium">Sign in</span></button></li><li class="list-item_root__HMbDW"><a class="list-item_link__HfxcT g-focus-ring-from-box-shadow" href="/hashicorp-packer/sign-up"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium">Sign up</span></a></li><li class="list-item_root__HMbDW"><hr class="list-item_separator__frucY"/></li><li class="list-item_root__HMbDW user-dropdown-switcher_listItem__fwBD7 hds-font-weight-medium"><label class="theme-switcher_label__bs8JE hds-typography-body-200" for="react-aria-22">Theme</label></li></ul></div></div></div><button aria-label="Open navigation menu" class="navigation-header_mobileMenuButton__BDLU4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path d="M2 5.75A.75.75 0 012.75 5h18.5a.75.75 0 010 1.5H2.75A.75.75 0 012 5.75zM2 11.75a.75.75 0 01.75-.75h18.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2.75 17a.75.75 0 000 1.5h18.5a.75.75 0 000-1.5H2.75z"></path></g></svg></button></div></header></div><div class="base-layout_contentArea__Bvd4x"><div class="sidebar-sidecar-layout_root__8s1Nl sidebar-sidecar-layout_mainWidth-wide__3uqYb"><div class="mobile-menu-container_root__2_51o sidebar-sidecar-layout_sidebarContainer__DVNhA"><div class="sidebar-sidecar-layout_sidebarContentWrapper__Q5ntu"><div class="sidebar_sidebar__eQGRJ"><div class="sidebar_backToLinkWrapper__zbqbb"><div class="sidebar-back-to-link_root__37rRr"><a class="standalone-link_standaloneLink__BqSgp g-focus-ring-from-box-shadow standalone-link_primary__dy62o" data-heap-track="standalone-link sidebar-back-to-link" href="/hashicorp-packer/packer/integrations"><div class="standalone-link_standaloneLinkContents__ch8c6 standalone-link_medium__DU9ke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M10.795 3.235a.75.75 0 01-.03 1.06L6.842 8l3.923 3.705a.75.75 0 01-1.03 1.09l-4.5-4.25a.75.75 0 010-1.09l4.5-4.25a.75.75 0 011.06.03z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__mzzHK">Packer Integrations</span></div></a></div></div><nav aria-labelledby="sidebar-label" class="sidebar_nav__EFmKd" id="sidebar-nav"><div><h2 class="sidebar-headings_root__7EIuF" id="sidebar-label"></h2></div><a class="skip-to-main-content_root__KEA0_ g-focus-border-and-box-shadow-light" href="#main">Skip to main content</a><ul class="sidebar_navList__Je2sN"><li><a aria-current="page" class="sidebar-nav-highlight-item_root__s8AOR g-focus-ring-from-box-shadow sidebar-nav-highlight-item_theme-packer__yMAXH" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="sidebar-nav-highlight-item_icon__10CMq"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="sidebar-nav-highlight-item_text__20W05 hds-typography-body-200">Google Cloud Platform</span></a></li><li><button aria-controls="undefined-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__i1Wj0 g-focus-ring-from-box-shadow" id="undefined-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__EY1_n">Builders</span><div class="sidebar-nav-menu-item_rightIconsContainer__FBm4_"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="undefined-list"><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__i1Wj0 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/latest/components/builder/googlecompute"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__EY1_n">Google Cloud Platform</span></a></li></ul></li><li><button aria-controls="undefined-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__i1Wj0 g-focus-ring-from-box-shadow" id="undefined-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__EY1_n">Post-Processors</span><div class="sidebar-nav-menu-item_rightIconsContainer__FBm4_"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="undefined-list"><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__i1Wj0 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__EY1_n">Google Cloud Platform Image Import</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__i1Wj0 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-export"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__EY1_n">Google Cloud Platform Image Exporter</span></a></li></ul></li></ul><hr class="sidebar-horizontal-rule_root__e5nM5"/><ul class="sidebar_navList__Je2sN"><li><h3 class="sidebar-headings_root__7EIuF">Resources</h3></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__i1Wj0 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-packer/tutorials/library?product=packer"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__EY1_n">Tutorial Library</span></a></li><li><a aria-label="Community Forum. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__i1Wj0 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-29" target="_blank" href="https://discuss.hashicorp.com/c/packer/23"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__EY1_n">Community Forum</span><div class="sidebar-nav-menu-item_rightIconsContainer__FBm4_"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-29">(opens in new tab)</span></li><li><a aria-label="Support. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__i1Wj0 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-30" target="_blank" href="https://www.hashicorp.com/customer-success"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__EY1_n">Support</span><div class="sidebar-nav-menu-item_rightIconsContainer__FBm4_"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-30">(opens in new tab)</span></li><li><a aria-label="GitHub. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__i1Wj0 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-31" target="_blank" href="https://github.com/hashicorp/packer"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__EY1_n">GitHub</span><div class="sidebar-nav-menu-item_rightIconsContainer__FBm4_"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-31">(opens in new tab)</span></li></ul></nav></div></div></div><div class="sidebar-sidecar-layout_contentWrapper__FtPII"><div class="sidebar-sidecar-layout_paddedAreaWrapper__95V0T"><div class="sidebar-sidecar-layout_breadcrumbContainer__7Yczs"><div class="sidebar-sidecar-layout_breadcrumbMaxWidth__vWUZe"><nav aria-label="Breadcrumb" class="breadcrumb-bar_root__Z5aTO"><ol class="breadcrumb-bar_listRoot__U6We_"><li class="text_root__WdIWm hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__Ew2MO"><a class="breadcrumb-bar_breadcrumbText__ftu3n g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-packer">Developer</a></li><li class="text_root__WdIWm hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__Ew2MO"><a class="breadcrumb-bar_breadcrumbText__ftu3n g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-packer/packer">Packer</a></li><li class="text_root__WdIWm hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__Ew2MO"><a class="breadcrumb-bar_breadcrumbText__ftu3n g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-packer/packer/integrations">Integrations</a></li><li class="text_root__WdIWm hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__Ew2MO"><a class="breadcrumb-bar_breadcrumbText__ftu3n g-focus-ring-from-box-shadow" aria-current="page" data-heap-track="breadcrumb-bar-item" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute">Google Cloud Platform</a></li></ol></nav></div></div><div class="sidebar-sidecar-layout_mainAndSidecar__x_g3M"><main id="main" class="sidebar-sidecar-layout_main__S864v"><div class="hds-surface-base card_root__hKIbm content-header-card_contentHeaderCard__o_pj5 style_header__hC90u"><div class="content-header-card_cardTop__k1b1K"><span class="icon-tile_root__VcaKq icon-tile_size-large__pgQmk icon-tile_color-packer__7zIDY content-header-card_icon__TE3Ym"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><div class="content-header-card_content__E_UK8"><div class="content-header-card_upper__ykPCb"><div class="disclosure_root__AAinH dropdown-disclosure_root__KM3_y dropdown-disclosure_list-position--right__KzHJE content-header-card_dropdown__C3vc7 g-hide-on-desktop g-hide-on-tablet"><button aria-controls="disclosure-react-aria-36-content" aria-expanded="false" class="button_root__eSBLF hds-font-weight-medium button_medium__uIVG8 button_secondary__KpNHc disclosure_activator__jqkij activator_root__cU8vM dropdown-disclosure_activator__Dk5J_" data-heap-track="button " type="button"><span>v1.1.3 (latest)</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="activator_chevronWrapper__6hV29"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button><div class="disclosure_contentContainer__77KIY dropdown-disclosure_content__GVRd1 undefined" id="disclosure-react-aria-36-content"><ul class="dropdown-disclosure_list__wyx6a"><li class="list-item_root__HMbDW"><a class="list-item_link__HfxcT g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/v1.1.2"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium">v1.1.2</span></a></li><li class="list-item_root__HMbDW"><a class="list-item_link__HfxcT g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/v1.1.1"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium">v1.1.1</span></a></li></ul></div></div><div class="content-header-card_left__N62_5"><div class="content-header-card_titleWrap__TnJZ6"><span class="content-header-card_title__VPM8f hds-typography-display-300 from global, hds-font-weight-bold">Google Cloud Platform</span><p class="text_root__WdIWm hds-typography-body-100 hds-font-weight-medium content-header-card_attribution__xYqD_">@hashicorp</p></div><p class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular content-header-card_description__9nAXx">The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE.</p></div><div class="disclosure_root__AAinH dropdown-disclosure_root__KM3_y dropdown-disclosure_list-position--right__KzHJE content-header-card_dropdown__C3vc7 g-hide-on-mobile"><button aria-controls="disclosure-react-aria-39-content" aria-expanded="false" class="button_root__eSBLF hds-font-weight-medium button_medium__uIVG8 button_secondary__KpNHc disclosure_activator__jqkij activator_root__cU8vM dropdown-disclosure_activator__Dk5J_" data-heap-track="button " type="button"><span>v1.1.3 (latest)</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="activator_chevronWrapper__6hV29"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button><div class="disclosure_contentContainer__77KIY dropdown-disclosure_content__GVRd1 undefined" id="disclosure-react-aria-39-content"><ul class="dropdown-disclosure_list__wyx6a"><li class="list-item_root__HMbDW"><a class="list-item_link__HfxcT g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/v1.1.2"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium">v1.1.2</span></a></li><li class="list-item_root__HMbDW"><a class="list-item_link__HfxcT g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/v1.1.1"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-medium">v1.1.1</span></a></li></ul></div></div></div><div class="content-header-card_lower__eP0Xh"><ul class="badge-list_badgeList__c8eh4 content-header-card_badgeList__FpL3I"><li class="badge-list_badge__l2QZL"><span data-state="tooltip-hidden" data-reach-tooltip-trigger=""><span class="g-screen-reader-only">Official</span><span aria-hidden="true" class="badge_root__LCJF3 badge_small__gwcZy badge_filled-neutral__5Spxj"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg><span>Official</span></span></span></li></ul><p class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular content-header-card_note__6aAxf">Updated 3 months ago</p></div></div></div><div class="content-header-card_cardBottom__Y_3o3"><ul class="content-header-card_linksList__rW2Fi"><li class="content-header-card_link__yhv4Q"><a class="standalone-link_standaloneLink__BqSgp g-focus-ring-from-box-shadow standalone-link_secondary__2IA5T" data-heap-track="standalone-link " rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-42" target="_blank" href="https://github.com/hashicorp/packer-plugin-googlecompute/tree/main/docs"><div class="standalone-link_standaloneLinkContents__ch8c6 standalone-link_medium__DU9ke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M8 1C4.133 1 1 4.13 1 7.993c0 3.09 2.006 5.71 4.787 6.635.35.064.478-.152.478-.337 0-.166-.006-.606-.01-1.19-1.947.423-2.357-.937-2.357-.937-.319-.808-.778-1.023-.778-1.023-.635-.434.048-.425.048-.425.703.05 1.073.72 1.073.72.624 1.07 1.638.76 2.037.582.063-.452.244-.76.444-.935-1.554-.176-3.188-.776-3.188-3.456 0-.763.273-1.388.72-1.876-.072-.177-.312-.888.07-1.85 0 0 .586-.189 1.924.716A6.711 6.711 0 018 4.381c.595.003 1.194.08 1.753.236 1.336-.905 1.923-.717 1.923-.717.382.963.142 1.674.07 1.85.448.49.72 1.114.72 1.877 0 2.686-1.638 3.278-3.197 3.45.251.216.475.643.475 1.296 0 .934-.009 1.688-.009 1.918 0 .187.127.404.482.336A6.996 6.996 0 0015 7.993 6.997 6.997 0 008 1z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__mzzHK">GitHub</span></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-42">(opens in new tab)</span></li></ul></div></div><h1>Google Cloud Platform</h1><div class="style_readmeView___2ue2"><div class="dev-dot-content_root__PM7Rc hds-typography-body-300"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">The Google compute Packer plugin lets you create custom images for use within Google Compute Engine (GCE).</p><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h3__ST7wF" id="user-content-installation"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow mdx-heading-permalink_h3__6xxpA" aria-label="Installation permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#installation"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Installation</h3><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">To install this plugin, copy and paste this code into your Packer configuration, then run <a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://www.packer.io/docs/commands/init"><code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">packer init</code></a>.</p><div class="g-code-block style_root__rglDp language-hcl mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token keyword">packer</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token keyword">required_plugins</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token property">googlecompute</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">source</span>  <span class="token punctuation">=</span> <span class="token string">&quot;github.com/hashicorp/googlecompute&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;~&gt; 1&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Alternatively, you can use <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">packer plugins install</code> to manage installation of this plugin.</p><div class="g-code-block style_root__rglDp language-sh mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-sh mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-sh mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">$ packer plugins install github.com/hashicorp/googlecompute<!-- -->
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h3__ST7wF" id="user-content-components"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow mdx-heading-permalink_h3__6xxpA" aria-label="Components permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#components"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Components</h3><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-builders"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Builders permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#builders"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Builders</h4><ul class="mdx-lists_listRoot__zHI9u"><li class="mdx-lists_listItem__2Palk"><a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/latest/components/builder/googlecompute">googlecompute</a> - The
googlecompute builder creates images from existing ones, by launching an instance, provisioning it, then exporting
it as a reusable image.</li></ul><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-post-processors"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Post-Processors permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#post-processors"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Post-Processors</h4><ul class="mdx-lists_listRoot__zHI9u"><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import">googlecompute-import</a> -
The googlecompute-import post-processor imports an existing raw disk image, and imports it as a GCE image that can be
used for launching instances from.</p></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-export">googlecompute-export</a> -
The googlecompute-export post-processor exports the image built by the googlecompute builder as a .tar.gz archive into Google
Cloud Storage (GCS).</p></li></ul><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h3__ST7wF" id="user-content-authentication"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow mdx-heading-permalink_h3__6xxpA" aria-label="Authentication permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#authentication"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Authentication</h3><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Authenticating with Google Cloud services requires either a User Application Default Credentials,
a JSON Service Account Key or an Access Token.  These are <strong>not</strong> required if you are
running the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">googlecompute</code> Packer builder on Google Cloud with a
properly-configured <a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://cloud.google.com/compute/docs/authentication">Google Service
Account</a>.</p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-running-locally-on-your-workstation."><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Running locally on your workstation permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#running-locally-on-your-workstation."><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Running locally on your workstation.</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">If you run the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">googlecompute</code> Packer builder locally on your workstation, you will
need to install the Google Cloud SDK and authenticate using <a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://cloud.google.com/sdk/gcloud/reference/auth/application-default">User Application Default
Credentials</a>.
You don&#x27;t need to specify an <em>account file</em> if you are using this method. Your user
must have at least <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">Compute Instance Admin (v1)</code> &amp; <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">Service Account User</code> roles
to use Packer succesfully.</p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-running-on-google-cloud"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Running on Google Cloud permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#running-on-google-cloud"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Running on Google Cloud</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">If you run the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">googlecompute</code> Packer builder on GCE or GKE, you can
configure that instance or cluster to use a <a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://cloud.google.com/compute/docs/authentication">Google Service
Account</a>. This will allow
Packer to authenticate to Google Cloud without having to bake in a separate
credential/authentication file.</p><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">It is recommended that you create a custom service account for Packer and assign it
<code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">Compute Instance Admin (v1)</code> &amp; <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">Service Account User</code> roles.</p><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">For <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">gcloud</code>, you can run the following commands:</p><div class="g-code-block style_root__rglDp language-shell-session mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-shell-session mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-shell-session mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud iam service-accounts create packer <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --project YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --description<span class="token operator">=</span><span class="token string">&quot;Packer Service Account&quot;</span> <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --display-name<span class="token operator">=</span><span class="token string">&quot;Packer Service Account&quot;</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">    --member<span class="token operator">=</span>serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">    --role<span class="token operator">=</span>roles/compute.instanceAdmin.v1</span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">    --member<span class="token operator">=</span>serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">    --role<span class="token operator">=</span>roles/iam.serviceAccountUser</span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">    --member<span class="token operator">=</span>serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">    --role<span class="token operator">=</span>roles/iap.tunnelResourceAccessor</span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud compute instances create <span class="token environment constant">INSTANCE</span>-NAME <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --project YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --image-family ubuntu-2004-lts <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --image-project ubuntu-os-cloud <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --network YOUR_GCP_NETWORK <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --zone YOUR_GCP_ZONE <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --service-account<span class="token operator">=</span>packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token command"><span class="token bash language-bash">  --scopes<span class="token operator">=</span><span class="token string">&quot;https://www.googleapis.com/auth/cloud-platform&quot;</span></span></span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>The service account will be used automatically by Packer as long as there is
no <em>account file</em> specified in the Packer configuration file.</strong></p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-running-outside-of-google-cloud"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Running outside of Google Cloud permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#running-outside-of-google-cloud"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Running outside of Google Cloud</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">The <a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://console.cloud.google.com">Google Cloud Console</a> allows
you to create and download a credential file that will let you use the
<code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">googlecompute</code> Packer builder anywhere. To make the process more
straightforwarded, it is documented here.</p><ol class="mdx-lists_listRoot__zHI9u"><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Log into the <a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://console.cloud.google.com/iam-admin/serviceaccounts">Google Cloud
Console</a> and select a project.</p></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Click Select a project, choose your project, and click Open.</p></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Click Create Service Account.</p></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Enter a service account name (friendly display name), an optional description, select the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">Compute Engine Instance Admin (v1)</code> and <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">Service Account User</code> roles, and then click Save.</p></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Generate a JSON Key and save it in a secure location.</p></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Set the Environment Variable <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">GOOGLE_APPLICATION_CREDENTIALS</code> to point to the path of the service account key.</p></li></ol><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-precedence-of-authentication-methods"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Precedence of Authentication Methods permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#precedence-of-authentication-methods"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Precedence of Authentication Methods</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Packer looks for credentials in the following places, preferring the first
location found:</p><ol class="mdx-lists_listRoot__zHI9u"><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">An <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">access_token</code> option in your packer file.</p></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">An <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">account_file</code> option in your packer file.</p></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">A JSON file (Service Account) whose path is specified by the
<code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">GOOGLE_APPLICATION_CREDENTIALS</code> environment variable.</p></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">A JSON file in a location known to the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">gcloud</code> command-line tool.
(<code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">gcloud auth application-default login</code> creates it)</p><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">On Windows, this is:</p><div class="g-code-block style_root__rglDp mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">%APPDATA%/gcloud/application_default_credentials.json<!-- -->
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">On other systems:</p><div class="g-code-block style_root__rglDp mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">$HOME/.config/gcloud/application_default_credentials.json<!-- -->
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div></li><li class="mdx-lists_listItem__2Palk"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">On Google Compute Engine and Google App Engine Managed VMs, it fetches
credentials from the metadata server. (Needs a correct VM authentication
scope configuration, see above.)</p></li></ol><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h3__ST7wF" id="user-content-examples"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow mdx-heading-permalink_h3__6xxpA" aria-label="Examples permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#examples"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Examples</h3><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-basic-example"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Basic Example permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#basic-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Basic Example</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Below is a fully functioning example. It doesn&#x27;t do anything useful since no
provisioners or startup-script metadata are defined, but it will effectively
repackage an existing GCE image.</p><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>JSON</strong></p><div class="g-code-block style_root__rglDp language-json mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-json mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-json mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;source_image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;debian-9-stretch-v20200805&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;ssh_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>HCL2</strong></p><div class="g-code-block style_root__rglDp language-hcl mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;basic-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my project&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">source_image</span> <span class="token punctuation">=</span> <span class="token string">&quot;debian-9-stretch-v20200805&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.basic-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-windows-example"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Windows Example permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#windows-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Windows Example</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Before you can provision using the winrm communicator, you need to allow
traffic through google&#x27;s firewall on the winrm port (tcp:5986). You can do so
using the gcloud command.</p><div class="g-code-block style_root__rglDp mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">gcloud compute firewall-rules create allow-winrm --allow tcp:5986<!-- -->
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Or alternatively by navigating to <a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://console.cloud.google.com/networking/firewalls/list">https://console.cloud.google.com/networking/firewalls/list</a>.</p><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">Once this is set up, the following is a complete working packer config after
setting a valid <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">project_id</code>:</p><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>JSON</strong></p><div class="g-code-block style_root__rglDp language-json mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-json mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-json mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;source_image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;windows-server-2019-dc-v20200813&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;disk_size&quot;</span><span class="token operator">:</span> <span class="token string">&quot;50&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;machine_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;n1-standard-2&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;communicator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;winrm&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;winrm_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer_user&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;winrm_insecure&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;winrm_use_ssl&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">        <span class="token property">&quot;sysprep-specialize-script-cmd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;winrm quickconfig -quiet &amp; net user /add packer_user &amp; net localgroup administrators packer_user /add &amp; winrm set winrm/config/service/auth @{Basic=\&quot;true\&quot;}&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>HCL2</strong></p><div class="g-code-block style_root__rglDp language-hcl mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;windows-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;MY_PROJECT&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">source_image</span> <span class="token punctuation">=</span> <span class="token string">&quot;windows-server-2019-dc-v20200813&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">disk_size</span> <span class="token punctuation">=</span> <span class="token number">50</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">machine_type</span> <span class="token punctuation">=</span> <span class="token string">&quot;n1-standard-2&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">communicator</span> <span class="token punctuation">=</span> <span class="token string">&quot;winrm&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">winrm_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer_user&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">winrm_insecure</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">winrm_use_ssl</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">metadata</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token property">sysprep-specialize-script-cmd</span> <span class="token punctuation">=</span> <span class="token string">&quot;winrm quickconfig -quiet &amp; net user /add packer_user &amp; net localgroup administrators packer_user /add &amp; winrm set winrm/config/service/auth @{Basic=\&quot;true\&quot;}&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.windows-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><div class="alert alert-info g-type-body"><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>Warning:</strong> Please note that if you&#x27;re setting up WinRM for provisioning, you&#x27;ll probably want to turn it off or restrict its permissions as part of a shutdown script at the end of Packer&#x27;s provisioning process. For more details on the why/how, check out this useful blog post and the associated code:
<a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/">https://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/</a></p></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">This build can take up to 15 min.</p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-windows-over-winssh-example"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Windows over WinSSH Example permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#windows-over-winssh-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Windows over WinSSH Example</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">The following uses Windows SSH as backend communicator
<a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse">https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse</a></p><div class="g-code-block style_root__rglDp language-hcl mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;windows-ssh-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;MY_PROJECT&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">source_image</span> <span class="token punctuation">=</span> <span class="token string">&quot;windows-server-2019-dc-v20200813&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-east4-a&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">disk_size</span> <span class="token punctuation">=</span> <span class="token number">50</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">machine_type</span> <span class="token punctuation">=</span> <span class="token string">&quot;n1-standard-2&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">communicator</span> <span class="token punctuation">=</span> <span class="token string">&quot;ssh&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> var.packer_username<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">ssh_password</span> <span class="token punctuation">=</span> var.packer_user_password<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">ssh_timeout</span> <span class="token punctuation">=</span> <span class="token string">&quot;1h&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">metadata</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token property">sysprep-specialize-script-cmd</span> <span class="token punctuation">=</span> <span class="token string">&quot;net user <span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">packer_username</span><span class="token punctuation">}</span></span> \&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">packer_user_password</span><span class="token punctuation">}</span></span>\&quot; /add /y &amp; wmic UserAccount where Name=\&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">packer_username</span><span class="token punctuation">}</span></span>\&quot; set PasswordExpires=False &amp; net localgroup administrators <span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">packer_username</span><span class="token punctuation">}</span></span> /add &amp; powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 &amp; powershell Start-Service sshd &amp; powershell Set-Service -Name sshd -StartupType &#x27;Automatic&#x27; &amp; powershell New-NetFirewallRule -Name &#x27;OpenSSH-Server-In-TCP&#x27; -DisplayName &#x27;OpenSSH Server (sshd)&#x27; -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 &amp; powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \&quot;Set-ExecutionPolicy -ExecutionPolicy bypass -Force\&quot;&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.windows-ssh-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token keyword">provisioner<span class="token type variable"> &quot;powershell&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token property">script</span> <span class="token punctuation">=</span> <span class="token string">&quot;../scripts/install-features.ps1&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token property">elevated_user</span>     <span class="token punctuation">=</span> var.packer_username<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token property">elevated_password</span> <span class="token punctuation">=</span> var.packer_user_password<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-windows-over-winssh-ansible-provisioner"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Windows over WinSSH - Ansible Provisioner permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#windows-over-winssh-ansible-provisioner"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Windows over WinSSH - Ansible Provisioner</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">The following uses Windows SSH as backend communicator
<a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse">https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse</a>
with a private key.</p><ul class="mdx-lists_listRoot__zHI9u"><li class="mdx-lists_listItem__2Palk">The <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">sysprep-specialize-script-cmd</code> creates the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">packer_user</code> and adds it to the local administrators group and configures the ssh key, firewall rule and required permissions.</li></ul><div class="g-code-block style_root__rglDp mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">source &quot;googlecompute&quot; &quot;windows-ssh-ansible&quot; {<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  project_id              = var.project_id<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  source_image            = &quot;windows-server-2019-dc-v20200813&quot;<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  zone                    = &quot;us-east4-a&quot;<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  disk_size               = 50<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  machine_type            = &quot;n1-standard-8&quot;<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  communicator            = &quot;ssh&quot;<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  ssh_username            = var.packer_username<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  ssh_private_key_file    = var.ssh_key_file_path<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  ssh_timeout             = &quot;1h&quot;<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  metadata = {<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    sysprep-specialize-script-cmd = &quot;net user ${var.packer_username} \&quot;${var.packer_user_password}\&quot; /add /y &amp; wmic UserAccount where Name=\&quot;${var.packer_username}\&quot; set PasswordExpires=False &amp; net localgroup administrators ${var.packer_username} /add &amp; powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 &amp; echo ${var.ssh_pub_key} &gt; C:\\ProgramData\\ssh\\administrators_authorized_keys &amp; icacls.exe \&quot;C:\\ProgramData\\ssh\\administrators_authorized_keys\&quot; /inheritance:r /grant \&quot;Administrators:F\&quot; /grant \&quot;SYSTEM:F\&quot; &amp; powershell New-ItemProperty -Path \&quot;HKLM:\\SOFTWARE\\OpenSSH\&quot; -Name DefaultShell -Value \&quot;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\&quot; -PropertyType String -Force  &amp; powershell Start-Service sshd &amp; powershell Set-Service -Name sshd -StartupType &#x27;Automatic&#x27; &amp; powershell New-NetFirewallRule -Name &#x27;OpenSSH-Server-In-TCP&#x27; -DisplayName &#x27;OpenSSH Server (sshd)&#x27; -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 &amp; powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \&quot;Set-ExecutionPolicy -ExecutionPolicy bypass -Force\&quot;&quot;<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  }<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  account_file = var.account_file_path<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">}<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">build {<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  sources = [&quot;sources.googlecompute.windows-ssh-ansible&quot;]<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  provisioner &quot;ansible&quot; {<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    playbook_file           = &quot;./playbooks/playbook.yml&quot;<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    use_proxy               = false<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    ansible_ssh_extra_args  = [&quot;-o StrictHostKeyChecking=no -o IdentitiesOnly=yes&quot;]<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    ssh_authorized_key_file = &quot;var.public_key_path&quot;<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    extra_arguments = [&quot;-e&quot;, &quot;win_packages=${var.win_packages}&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      &quot;-e&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      &quot;ansible_shell_type=powershell&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      &quot;-e&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      &quot;ansible_shell_executable=None&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      &quot;-e&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      &quot;ansible_shell_executable=None&quot;<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    ]<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    user = var.packer_username<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  }<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">}<!-- -->
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-nested-hypervisor-example"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Nested Hypervisor Example permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#nested-hypervisor-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Nested Hypervisor Example</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">This is an example of using the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">image_licenses</code> configuration option to create
a GCE image that has nested virtualization enabled. See <a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://cloud.google.com/compute/docs/instances/enable-nested-virtualization-vm-instances">Enabling Nested
Virtualization for VM
Instances</a>
for details.</p><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>JSON</strong></p><div class="g-code-block style_root__rglDp language-json mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-json mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-json mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;source_image_family&quot;</span><span class="token operator">:</span> <span class="token string">&quot;centos-7&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;ssh_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;image_licenses&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;projects/vm-options/global/licenses/enable-vmx&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>HCL2</strong></p><div class="g-code-block style_root__rglDp language-hcl mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;basic-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my project&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">source_image_family</span> <span class="token punctuation">=</span> <span class="token string">&quot;centos-7&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">image_licenses</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;projects/vm-options/global/licenses/enable-vmx&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.basic-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-shared-vpc-example"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Shared VPC Example permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#shared-vpc-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Shared VPC Example</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">This is an example of using the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">network_project_id</code> configuration option to create
a GCE instance in a Shared VPC Network. See <a class="inline-link_root__jsfnc g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__1z8vI" href="https://cloud.google.com/vpc/docs/provisioning-shared-vpc#creating_an_instance_in_a_shared_subnet">Creating a GCE Instance using Shared
VPC</a>
for details. The user/service account running Packer must have <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">Compute Network User</code> role on
the Shared VPC Host Project to create the instance in addition to the other roles mentioned in the
Running on Google Cloud section.</p><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>JSON</strong></p><div class="g-code-block style_root__rglDp language-json mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-json mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-json mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;subnetwork&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;source_image_family&quot;</span><span class="token operator">:</span> <span class="token string">&quot;centos-7&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;network_project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SHARED_VPC_PROJECT&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;ssh_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;image_licenses&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;projects/vm-options/global/licenses/enable-vmx&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>HCL2</strong></p><div class="g-code-block style_root__rglDp language-hcl mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;sharedvpc-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my project&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">source_image_family</span> <span class="token punctuation">=</span> <span class="token string">&quot;centos-7&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">subnetwork</span> <span class="token punctuation">=</span> <span class="token string">&quot;default&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">network_project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;SHARED_VPC_PROJECT&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">image_licenses</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;projects/vm-options/global/licenses/enable-vmx&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.sharedvpc-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__T_KWX g-offset-scroll-margin-top mdx-headings_h4__gBHMJ" id="user-content-separate-image-project-example"><a class="mdx-heading-permalink_root__rMneC g-focus-ring-from-box-shadow" aria-label="Separate Image Project Example permalink" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#separate-image-project-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__wRuQa"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Separate Image Project Example</h4><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ">This is an example of using the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">image_project_id</code> configuration option to create
the generated image in a different GCP project than the one used to create the virtual machine. Make sure that Packer has permission in the target project to manage images, the <code class="mdx-inline-code_inlineCode__mRRzk mdx-inline-code_size-200__jzxqL hds-typography-code-200">Compute Storage Admin</code> role will grant the desired permissions.</p><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>JSON</strong></p><div class="g-code-block style_root__rglDp language-json mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-json mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-json mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;image_project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my image target project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;source_image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;debian-9-stretch-v20200805&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;ssh_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__WdIWm hds-typography-body-300 hds-font-weight-regular mdx-p_p__iAYvZ"><strong>HCL2</strong></p><div class="g-code-block style_root__rglDp language-hcl mdx-code-blocks_codeBlockMargin__TI7B4 style_codeMargin__yBb2n theme-dark_base__fkY9D theme-dark_syntax__HBUbm" data-heap-track="code-block"><div class="style_linesContainer__V510Y"><pre class="code-lines_pre__bRMIh language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><code class="code-lines_code__TAAF7 language-hcl mdx-code-blocks_codeBlockMargin__TI7B4"><span class="code-lines_linesColumn__szsmm code-lines_styledScrollbars__2NpYc"><span class="code-lines_linesScrollableContent___HFem"><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;basic-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my project&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">image_project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my image target project&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">source_image</span> <span class="token punctuation">=</span> <span class="token string">&quot;debian-9-stretch-v20200805&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.basic-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__Q1cnP g-type-code code-lines_padRight__jnuQs"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__H7t5c"><button class="style_button__pIRtg" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__85MLW"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div></div></div></main><div class="sidebar-sidecar-layout_sidecarPosition__p5onY"><div class="sidebar-sidecar-layout_sidecarTopSlot__o1T7C"></div><div class="sidecar-scroll-container_root__MHD0z"><div class="sidecar-scroll-container_scrollContainer__fvA5n"><div class="style_sidecarContents__Ls_2n"><div><nav aria-labelledby="react-aria-58"><p id="react-aria-58" class="outline-nav_navLabel__jk_MG hds-typography-body-100">On this page:</p><ol class="outline-nav_listRoot__cbYFw"><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#installation">Installation</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#components">Components</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#builders">Builders</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#post-processors">Post-Processors</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#authentication">Authentication</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#running-locally-on-your-workstation.">Running locally on your workstation.</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#running-on-google-cloud">Running on Google Cloud</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#running-outside-of-google-cloud">Running outside of Google Cloud</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#precedence-of-authentication-methods">Precedence of Authentication Methods</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#examples">Examples</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#basic-example">Basic Example</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#windows-example">Windows Example</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#windows-over-winssh-example">Windows over WinSSH Example</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#windows-over-winssh-ansible-provisioner">Windows over WinSSH - Ansible Provisioner</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#nested-hypervisor-example">Nested Hypervisor Example</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#shared-vpc-example">Shared VPC Example</a></li><li><a class="outline-link_root__K1_Dc hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/googlecompute#separate-image-project-example">Separate Image Project Example</a></li></ol></nav></div><div class="hds-surface-mid card_root__hKIbm card-link_root__z4SDk try-hcp-callout-compact_root__Ln0ug"><a aria-label="Try HCP Packer for free" class="card-link_anchor__2PMo1" data-heap-track="card-link " href="https://portal.cloud.hashicorp.com/sign-up"><span aria-hidden="true"></span></a><div class="try-hcp-callout-compact_background__NnH61 try-hcp-callout-compact_backgroundBase__HubbK"></div><div class="product-icon-heading_root__8Cf3Z"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="product-icon-heading_icon__xMiEC product-icon-heading_small__9LuzS hds-typography-display-200"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="product-icon-heading_heading__c2vQJ product-icon-heading_small__9LuzS hds-typography-display-200">HCP Packer</span></div><div class="description_root__ghy9B hds-typography-body-200">Automate build management across your cloud&nbsp;providers</div><span class="standalone-link-contents_root__PCkKQ standalone-link-contents_small__AoydN hds-typography-body-100">Try HCP Packer for free<!-- --> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" d="M8.235 4.045a.75.75 0 111.03-1.09l4.5 4.25a.75.75 0 010 1.09l-4.5 4.25a.75.75 0 01-1.03-1.09L11.364 8.5H2.75a.75.75 0 010-1.5h8.614L8.235 4.045z"></path></svg></span></div></div></div></div></div></div></div></div></div></div><div class="base-layout_footer__C73k2 base-layout_showFooterTopBorder__ajDfV"><footer class="footer_root__rBmjT"><span class="footer_logoAndSwitcher__X6G8O"><a href="https://www.hashicorp.com/" aria-label="Go to HashiCorp home page" class="footer_logo__SR4lJ g-focus-ring-from-box-shadow"><div><svg width="317" height="88" viewBox="0 0 317 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M107.692 64.421V47.4h-14.97v17.02h-7.623V24.06h7.622v16.602h14.971V24.06h7.622v40.36h-7.622zm35.567-.001h-6.053l-.548-1.996a16.137 16.137 0 01-8.789 2.607c-5.397 0-7.699-3.697-7.699-8.79 0-5.998 2.607-8.3 8.606-8.3h7.089v-3.095c0-3.27-.907-4.421-5.633-4.421a41.255 41.255 0 00-8.179.877l-.907-5.634a38.496 38.496 0 0110.122-1.395c9.269 0 11.998 3.27 11.998 10.672l-.007 19.476zm-7.394-11.151h-5.45c-2.424 0-3.087.663-3.087 2.912 0 2.058.663 2.973 2.972 2.973a11.629 11.629 0 005.572-1.525l-.007-4.36zm21.701 11.754a34.776 34.776 0 01-10.183-1.7l1.029-5.633a33.038 33.038 0 008.788 1.273c3.271 0 3.758-.762 3.758-2.973 0-1.814-.366-2.729-5.152-3.88-7.211-1.76-8.058-3.575-8.058-9.269 0-5.938 2.607-8.545 11.03-8.545 2.98.003 5.949.348 8.85 1.03l-.762 5.876a51.98 51.98 0 00-8.118-.846c-3.209 0-3.758.763-3.758 2.546 0 2.363.183 2.546 4.185 3.575 8.263 2.188 9.055 3.278 9.055 9.307 0 5.725-1.761 9.239-10.664 9.239zm32.663-.602V43.84c0-1.578-.663-2.363-2.363-2.363-1.814 0-5.031 1.09-7.699 2.485v20.459h-7.394V22.847l7.394-1.029v15.33a26.045 26.045 0 0110.786-2.852c4.909 0 6.662 3.453 6.662 8.728v21.397h-7.386zm12.844-33.692v-8.545h7.394v8.545h-7.394zm0 33.692V34.906h7.394v29.515h-7.394zM215.62 35.15c0-7.394 4.299-11.693 14.361-11.693 3.697 0 7.38.447 10.969 1.334l-.839 6.601a59.517 59.517 0 00-9.909-1.029c-5.275 0-6.967 1.822-6.967 6.098v15.512c0 4.3 1.7 6.098 6.967 6.098a59.506 59.506 0 009.909-1.029l.846 6.609a45.672 45.672 0 01-10.968 1.334c-10.062 0-14.361-4.3-14.361-11.693l-.008-18.142zm40.499 29.873c-10.123 0-12.844-5.572-12.844-11.632v-7.455c0-6.06 2.728-11.632 12.844-11.632 10.115 0 12.844 5.572 12.844 11.632v7.455c-.023 6.06-2.744 11.632-12.844 11.632zm0-24.392c-3.941 0-5.45 1.76-5.45 5.092v7.912c0 3.331 1.524 5.092 5.45 5.092 3.925 0 5.45-1.76 5.45-5.092v-7.943c-.015-3.33-1.532-5.092-5.45-5.092v.03zm32.457.457a57.835 57.835 0 00-7.821 4.3v19.056h-7.394V34.906h6.243l.488 3.27a33.064 33.064 0 017.76-3.88l.724 6.792zm28.035 13.515c0 6.548-2.911 10.42-9.756 10.42a40.76 40.76 0 01-7.882-.853v12.196l-7.394 1.029V34.906h5.877l.762 2.485a15.535 15.535 0 019.33-3.087c5.938 0 9.086 3.514 9.086 10.245l-.023 10.054zm-17.631 3.331c2.152.474 4.346.73 6.548.763 2.668 0 3.697-1.274 3.697-3.941V44.35c0-2.424-.907-3.758-3.636-3.758a10.46 10.46 0 00-6.609 2.668v14.673zM29.134 7L0 23.808v40.361l10.946 6.32V30.127l18.188-10.504V7z" fill="#000"/><path d="M40.758 7v32.144H29.133V27.147l-10.945 6.319V74.65l10.946 6.335V48.932h11.624v11.914l10.946-6.312V13.32L40.758 7z" fill="#000"/><path d="M40.758 81L69.89 64.192V23.831l-10.946-6.32v40.362L40.758 68.377V81z" fill="#000"/></svg></div></a><span class="footer_themeSwitcher__W26Rs hds-font-weight-regular"><label class="theme-switcher_label__bs8JE hds-typography-body-200" for="react-aria-77">Theme</label></span></span><ul class="footer_links__Ews9a"><li><a class="footer_linkAction__g2TXk g-focus-ring-from-box-shadow" href="/hashicorp-packer/certifications"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular">Certifications</span></a></li><li><a class="footer_linkAction__g2TXk g-focus-ring-from-box-shadow" href="https://status.hashicorp.com"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular">System Status</span></a></li><li><button class="footer_linkAction__g2TXk g-focus-ring-from-box-shadow"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular">Cookie Manager</span></button></li><li><a class="footer_linkAction__g2TXk g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/terms-of-service"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular">Terms of Use</span></a></li><li><a class="footer_linkAction__g2TXk g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/security"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular">Security</span></a></li><li><a class="footer_linkAction__g2TXk g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/privacy"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular">Privacy</span></a></li><li><a class="footer_linkAction__g2TXk g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trademark-policy"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular">Trademark Policy</span></a></li><li><a class="footer_linkAction__g2TXk g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trade-controls"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular">Trade Controls</span></a></li><li><a class="footer_linkAction__g2TXk g-focus-ring-from-box-shadow" aria-describedby="undefinedopens-in-new-tab-label-react-aria-85" target="_blank" href="https://forms.gle/fnHLuNahLEhjuKvE6"><span class="text_root__WdIWm hds-typography-body-200 hds-font-weight-regular">Give Feedback</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-85">(opens in new tab)</span></li></ul></footer></div></div></div><div class="style_root__Fb7pu"></div><div style="position:fixed;z-index:99;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none;inset:24px"></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"metadata":{"title":"Google Cloud Platform | Integrations","description":"The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE."},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://www.packer.io/packer-public/img/og-image.png","icon":[{"href":"/packer-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiConf","url":"https://hashiconf.com/2023?utm_source=direct\u0026utm_medium=banner\u0026utm_campaign=23Q3_HASHICONFGLOBAL_EVENT\u0026utm_content=\u0026utm_offer=event","text":"Our community conference is taking place in San Francisco and online October 10-12.","linkText":"Register now","expirationDate":""},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"},{"iconName":"plug","name":"Plugins","path":"plugins"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."}},"integration":{"id":"834b0c0c-be8e-4a62-add3-478673c04f95","slug":"googlecompute","name":"Google Cloud Platform","description":"The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE.","license_type":null,"license_url":null,"external_only":false,"external_url":null,"tier":"official","repo_url":"https://github.com/hashicorp/packer-plugin-googlecompute","subdirectory":"/.web-docs","created_at":"2023-06-15T19:02:47.779Z","updated_at":"2023-08-08T17:01:06.505Z","hide_versions":false,"organization":{"id":"a4a0551a-1451-4d89-9f56-8031c8350c77","slug":"hashicorp","created_at":"2022-11-09T22:56:32.391Z","updated_at":"2022-11-09T22:56:32.391Z"},"product":{"id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","slug":"packer","name":"Packer","created_at":"2022-11-09T22:56:29.896Z","updated_at":"2022-11-09T22:56:29.896Z"},"versions":["1.1.3","1.1.2","1.1.1"],"components":[{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors"},{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors"}],"flags":[],"integration_type":null},"activeRelease":{"id":"36ab9be0-c730-415e-bfee-02f0f804a813","integration_id":"834b0c0c-be8e-4a62-add3-478673c04f95","version":"1.1.3","readme":"The Google compute Packer plugin lets you create custom images for use within Google Compute Engine (GCE).\n\n### Installation\n\nTo install this plugin, copy and paste this code into your Packer configuration, then run [`packer init`](https://www.packer.io/docs/commands/init).\n\n```hcl\npacker {\n  required_plugins {\n    googlecompute = {\n      source  = \"github.com/hashicorp/googlecompute\"\n      version = \"~\u003e 1\"\n    }\n  }\n}\n```\n\nAlternatively, you can use `packer plugins install` to manage installation of this plugin.\n\n```sh\n$ packer plugins install github.com/hashicorp/googlecompute\n```\n\n### Components\n\n#### Builders\n\n- [googlecompute](/packer/integrations/hashicorp/googlecompute/latest/components/builder/googlecompute) - The\n  googlecompute builder creates images from existing ones, by launching an instance, provisioning it, then exporting\n  it as a reusable image.\n\n#### Post-Processors\n\n- [googlecompute-import](/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import) -\n  The googlecompute-import post-processor imports an existing raw disk image, and imports it as a GCE image that can be\n  used for launching instances from.\n\n- [googlecompute-export](/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-export) -\n  The googlecompute-export post-processor exports the image built by the googlecompute builder as a .tar.gz archive into Google\n  Cloud Storage (GCS).\n\n### Authentication\n\nAuthenticating with Google Cloud services requires either a User Application Default Credentials, \na JSON Service Account Key or an Access Token.  These are **not** required if you are\nrunning the `googlecompute` Packer builder on Google Cloud with a\nproperly-configured [Google Service\nAccount](https://cloud.google.com/compute/docs/authentication).\n\n#### Running locally on your workstation.\n\nIf you run the `googlecompute` Packer builder locally on your workstation, you will\nneed to install the Google Cloud SDK and authenticate using [User Application Default\nCredentials](https://cloud.google.com/sdk/gcloud/reference/auth/application-default).\nYou don't need to specify an _account file_ if you are using this method. Your user\nmust have at least `Compute Instance Admin (v1)` \u0026 `Service Account User` roles\nto use Packer succesfully.\n\n#### Running on Google Cloud\n\nIf you run the `googlecompute` Packer builder on GCE or GKE, you can\nconfigure that instance or cluster to use a [Google Service\nAccount](https://cloud.google.com/compute/docs/authentication). This will allow\nPacker to authenticate to Google Cloud without having to bake in a separate\ncredential/authentication file.\n\nIt is recommended that you create a custom service account for Packer and assign it\n`Compute Instance Admin (v1)` \u0026 `Service Account User` roles.\n\nFor `gcloud`, you can run the following commands:\n\n```shell-session\n$ gcloud iam service-accounts create packer \\\n  --project YOUR_GCP_PROJECT \\\n  --description=\"Packer Service Account\" \\\n  --display-name=\"Packer Service Account\"\n\n$ gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT \\\n    --member=serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \\\n    --role=roles/compute.instanceAdmin.v1\n\n$ gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT \\\n    --member=serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \\\n    --role=roles/iam.serviceAccountUser\n\n$ gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT \\\n    --member=serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \\\n    --role=roles/iap.tunnelResourceAccessor\n\n$ gcloud compute instances create INSTANCE-NAME \\\n  --project YOUR_GCP_PROJECT \\\n  --image-family ubuntu-2004-lts \\\n  --image-project ubuntu-os-cloud \\\n  --network YOUR_GCP_NETWORK \\\n  --zone YOUR_GCP_ZONE \\\n  --service-account=packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \\\n  --scopes=\"https://www.googleapis.com/auth/cloud-platform\"\n```\n\n**The service account will be used automatically by Packer as long as there is\nno _account file_ specified in the Packer configuration file.**\n\n#### Running outside of Google Cloud\n\nThe [Google Cloud Console](https://console.cloud.google.com) allows\nyou to create and download a credential file that will let you use the\n`googlecompute` Packer builder anywhere. To make the process more\nstraightforwarded, it is documented here.\n\n1.  Log into the [Google Cloud\n    Console](https://console.cloud.google.com/iam-admin/serviceaccounts) and select a project.\n\n2.  Click Select a project, choose your project, and click Open.\n\n3.  Click Create Service Account.\n\n4.  Enter a service account name (friendly display name), an optional description, select the `Compute Engine Instance Admin (v1)` and `Service Account User` roles, and then click Save.\n\n5.  Generate a JSON Key and save it in a secure location.\n\n6.  Set the Environment Variable `GOOGLE_APPLICATION_CREDENTIALS` to point to the path of the service account key.\n\n#### Precedence of Authentication Methods\n\nPacker looks for credentials in the following places, preferring the first\nlocation found:\n\n1.  An `access_token` option in your packer file.\n\n2.  An `account_file` option in your packer file.\n\n3.  A JSON file (Service Account) whose path is specified by the\n    `GOOGLE_APPLICATION_CREDENTIALS` environment variable.\n\n4.  A JSON file in a location known to the `gcloud` command-line tool.\n    (`gcloud auth application-default login` creates it)\n\n    On Windows, this is:\n\n        %APPDATA%/gcloud/application_default_credentials.json\n\n    On other systems:\n\n        $HOME/.config/gcloud/application_default_credentials.json\n\n5.  On Google Compute Engine and Google App Engine Managed VMs, it fetches\n    credentials from the metadata server. (Needs a correct VM authentication\n    scope configuration, see above.)\n\n### Examples\n\n#### Basic Example\n\nBelow is a fully functioning example. It doesn't do anything useful since no\nprovisioners or startup-script metadata are defined, but it will effectively\nrepackage an existing GCE image.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"source_image\": \"debian-9-stretch-v20200805\",\n      \"ssh_username\": \"packer\",\n      \"zone\": \"us-central1-a\"\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"basic-example\" {\n  project_id = \"my project\"\n  source_image = \"debian-9-stretch-v20200805\"\n  ssh_username = \"packer\"\n  zone = \"us-central1-a\"\n}\n\nbuild {\n  sources = [\"sources.googlecompute.basic-example\"]\n}\n```\n\n\n#### Windows Example\n\nBefore you can provision using the winrm communicator, you need to allow\ntraffic through google's firewall on the winrm port (tcp:5986). You can do so\nusing the gcloud command.\n\n    gcloud compute firewall-rules create allow-winrm --allow tcp:5986\n\nOr alternatively by navigating to [https://console.cloud.google.com/networking/firewalls/list](https://console.cloud.google.com/networking/firewalls/list).\n\nOnce this is set up, the following is a complete working packer config after\nsetting a valid `project_id`:\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"source_image\": \"windows-server-2019-dc-v20200813\",\n      \"disk_size\": \"50\",\n      \"machine_type\": \"n1-standard-2\",\n      \"communicator\": \"winrm\",\n      \"winrm_username\": \"packer_user\",\n      \"winrm_insecure\": true,\n      \"winrm_use_ssl\": true,\n      \"metadata\": {\n        \"sysprep-specialize-script-cmd\": \"winrm quickconfig -quiet \u0026 net user /add packer_user \u0026 net localgroup administrators packer_user /add \u0026 winrm set winrm/config/service/auth @{Basic=\\\"true\\\"}\"\n      },\n      \"zone\": \"us-central1-a\"\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"windows-example\" {\n  project_id = \"MY_PROJECT\"\n  source_image = \"windows-server-2019-dc-v20200813\"\n  zone = \"us-central1-a\"\n  disk_size = 50\n  machine_type = \"n1-standard-2\"\n  communicator = \"winrm\"\n  winrm_username = \"packer_user\"\n  winrm_insecure = true\n  winrm_use_ssl = true\n  metadata = {\n    sysprep-specialize-script-cmd = \"winrm quickconfig -quiet \u0026 net user /add packer_user \u0026 net localgroup administrators packer_user /add \u0026 winrm set winrm/config/service/auth @{Basic=\\\"true\\\"}\"\n  }\n}\n\nbuild {\n  sources = [\"sources.googlecompute.windows-example\"]\n}\n```\n\n-\u003e **Warning:** Please note that if you're setting up WinRM for provisioning, you'll probably want to turn it off or restrict its permissions as part of a shutdown script at the end of Packer's provisioning process. For more details on the why/how, check out this useful blog post and the associated code:\nhttps://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/\n\nThis build can take up to 15 min.\n\n#### Windows over WinSSH Example\n\nThe following uses Windows SSH as backend communicator\n[https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse](https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse)\n\n```hcl\nsource \"googlecompute\" \"windows-ssh-example\" {\n  project_id = \"MY_PROJECT\"\n  source_image = \"windows-server-2019-dc-v20200813\"\n  zone = \"us-east4-a\"\n  disk_size = 50\n  machine_type = \"n1-standard-2\"\n  communicator = \"ssh\"\n  ssh_username = var.packer_username\n  ssh_password = var.packer_user_password\n  ssh_timeout = \"1h\"\n  metadata = {\n    sysprep-specialize-script-cmd = \"net user ${var.packer_username} \\\"${var.packer_user_password}\\\" /add /y \u0026 wmic UserAccount where Name=\\\"${var.packer_username}\\\" set PasswordExpires=False \u0026 net localgroup administrators ${var.packer_username} /add \u0026 powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 \u0026 powershell Start-Service sshd \u0026 powershell Set-Service -Name sshd -StartupType 'Automatic' \u0026 powershell New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 \u0026 powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \\\"Set-ExecutionPolicy -ExecutionPolicy bypass -Force\\\"\"\n  }\n}\n\nbuild {\n  sources = [\"sources.googlecompute.windows-ssh-example\"]\n\n  provisioner \"powershell\" {\n    script = \"../scripts/install-features.ps1\"\n    elevated_user     = var.packer_username\n    elevated_password = var.packer_user_password\n  }\n}\n```\n\n#### Windows over WinSSH - Ansible Provisioner\n\nThe following uses Windows SSH as backend communicator\n[https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse](https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse)\nwith a private key.\n\n* The `sysprep-specialize-script-cmd` creates the `packer_user` and adds it to the local administrators group and configures the ssh key, firewall rule and required permissions.\n\n```\nsource \"googlecompute\" \"windows-ssh-ansible\" {\n  project_id              = var.project_id\n  source_image            = \"windows-server-2019-dc-v20200813\"\n  zone                    = \"us-east4-a\"\n  disk_size               = 50\n  machine_type            = \"n1-standard-8\"\n  communicator            = \"ssh\"\n  ssh_username            = var.packer_username\n  ssh_private_key_file    = var.ssh_key_file_path\n  ssh_timeout             = \"1h\"\n  \n  metadata = {\n    sysprep-specialize-script-cmd = \"net user ${var.packer_username} \\\"${var.packer_user_password}\\\" /add /y \u0026 wmic UserAccount where Name=\\\"${var.packer_username}\\\" set PasswordExpires=False \u0026 net localgroup administrators ${var.packer_username} /add \u0026 powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 \u0026 echo ${var.ssh_pub_key} \u003e C:\\\\ProgramData\\\\ssh\\\\administrators_authorized_keys \u0026 icacls.exe \\\"C:\\\\ProgramData\\\\ssh\\\\administrators_authorized_keys\\\" /inheritance:r /grant \\\"Administrators:F\\\" /grant \\\"SYSTEM:F\\\" \u0026 powershell New-ItemProperty -Path \\\"HKLM:\\\\SOFTWARE\\\\OpenSSH\\\" -Name DefaultShell -Value \\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\" -PropertyType String -Force  \u0026 powershell Start-Service sshd \u0026 powershell Set-Service -Name sshd -StartupType 'Automatic' \u0026 powershell New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 \u0026 powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \\\"Set-ExecutionPolicy -ExecutionPolicy bypass -Force\\\"\"\n  }\n  account_file = var.account_file_path\n\n}\n\nbuild {\n  sources = [\"sources.googlecompute.windows-ssh-ansible\"]\n\n  provisioner \"ansible\" {\n    playbook_file           = \"./playbooks/playbook.yml\"\n    use_proxy               = false\n    ansible_ssh_extra_args  = [\"-o StrictHostKeyChecking=no -o IdentitiesOnly=yes\"]\n    ssh_authorized_key_file = \"var.public_key_path\"\n    extra_arguments = [\"-e\", \"win_packages=${var.win_packages}\",\n      \"-e\",\n      \"ansible_shell_type=powershell\",\n      \"-e\",\n      \"ansible_shell_executable=None\",\n      \"-e\",\n      \"ansible_shell_executable=None\"\n    ]\n    user = var.packer_username\n  }\n\n}\n\n```\n\n#### Nested Hypervisor Example\n\nThis is an example of using the `image_licenses` configuration option to create\na GCE image that has nested virtualization enabled. See [Enabling Nested\nVirtualization for VM\nInstances](https://cloud.google.com/compute/docs/instances/enable-nested-virtualization-vm-instances)\nfor details.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"source_image_family\": \"centos-7\",\n      \"ssh_username\": \"packer\",\n      \"zone\": \"us-central1-a\",\n      \"image_licenses\": [\"projects/vm-options/global/licenses/enable-vmx\"]\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"basic-example\" {\n  project_id = \"my project\"\n  source_image_family = \"centos-7\"\n  ssh_username = \"packer\"\n  zone = \"us-central1-a\"\n  image_licenses = [\"projects/vm-options/global/licenses/enable-vmx\"]\n}\n\nbuild {\n  sources = [\"sources.googlecompute.basic-example\"]\n}\n```\n\n\n#### Shared VPC Example\n\nThis is an example of using the `network_project_id` configuration option to create\na GCE instance in a Shared VPC Network. See [Creating a GCE Instance using Shared\nVPC](https://cloud.google.com/vpc/docs/provisioning-shared-vpc#creating_an_instance_in_a_shared_subnet)\nfor details. The user/service account running Packer must have `Compute Network User` role on\nthe Shared VPC Host Project to create the instance in addition to the other roles mentioned in the\nRunning on Google Cloud section.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"subnetwork\": \"default\",\n      \"source_image_family\": \"centos-7\",\n      \"network_project_id\": \"SHARED_VPC_PROJECT\",\n      \"ssh_username\": \"packer\",\n      \"zone\": \"us-central1-a\",\n      \"image_licenses\": [\"projects/vm-options/global/licenses/enable-vmx\"]\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"sharedvpc-example\" {\n  project_id = \"my project\"\n  source_image_family = \"centos-7\"\n  subnetwork = \"default\"\n  network_project_id = \"SHARED_VPC_PROJECT\"\n  ssh_username = \"packer\"\n  zone = \"us-central1-a\"\n  image_licenses = [\"projects/vm-options/global/licenses/enable-vmx\"]\n}\n\nbuild {\n  sources = [\"sources.googlecompute.sharedvpc-example\"]\n}\n```\n\n\n#### Separate Image Project Example\n\nThis is an example of using the `image_project_id` configuration option to create\nthe generated image in a different GCP project than the one used to create the virtual machine. Make sure that Packer has permission in the target project to manage images, the `Compute Storage Admin` role will grant the desired permissions.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"image_project_id\": \"my image target project\",\n      \"source_image\": \"debian-9-stretch-v20200805\",\n      \"ssh_username\": \"packer\",\n      \"zone\": \"us-central1-a\"\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"basic-example\" {\n  project_id = \"my project\"\n  image_project_id = \"my image target project\"\n  source_image = \"debian-9-stretch-v20200805\"\n  ssh_username = \"packer\"\n  zone = \"us-central1-a\"\n}\n\nbuild {\n  sources = [\"sources.googlecompute.basic-example\"]\n}\n```\n","created_at":"2023-10-24T14:02:22.527Z","updated_at":"2023-10-24T14:02:22.527Z","components":[{"id":"088579ff-beee-46cd-8692-222e3165abec","integration_release_id":"36ab9be0-c730-415e-bfee-02f0f804a813","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `googlecompute`\nArtifact BuilderId: `packer.googlecompute`\n\nThe `googlecompute` Packer builder is able to create\n[images](https://developers.google.com/compute/docs/images) for use with\n[Google Compute Engine](https://cloud.google.com/products/compute-engine) (GCE)\nbased on existing images.\n\nIt is possible to build images from scratch, but not with the `googlecompute`\nPacker builder. The process is recommended only for advanced users, please see\n[Building GCE Images from Scratch](https://cloud.google.com/compute/docs/tutorials/building-images)\nand the [Google Compute Import\nPost-Processor](/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import) for more\ninformation.\n\n## Configuration Reference\n\nConfiguration options are organized below into two categories: required and\noptional. Within each category, the available options are alphabetized and\ndescribed.\n\nIn addition to the options listed here, a\n[communicator](/packer/docs/templates/legacy_json_templates/communicator) can be configured for this\nbuilder.\n\n### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/googlecompute/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `project_id` (string) - The project ID that will be used to launch instances and store images.\n\n- `source_image` (string) - The source image to use to create the new image from. You can also\n  specify source_image_family instead. If both source_image and\n  source_image_family are specified, source_image takes precedence.\n  Example: \"debian-8-jessie-v20161027\"\n\n- `source_image_family` (string) - The source image family to use to create the new image from. The image\n  family always returns its latest image that is not deprecated. Example:\n  \"debian-8\".\n\n- `zone` (string) - The zone in which to launch the instance used to create the image.\n  Example: \"us-central1-a\"\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/googlecompute/config.go; --\u003e\n\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/googlecompute/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_token` (string) - A temporary [OAuth 2.0 access token](https://developers.google.com/identity/protocols/oauth2)\n  obtained from the Google Authorization server, i.e. the `Authorization: Bearer` token used to\n  authenticate HTTP requests to GCP APIs.\n  This is an alternative to `account_file`, and ignores the `scopes` field.\n  If both are specified, `access_token` will be used over the `account_file` field.\n  \n  These access tokens cannot be renewed by Packer and thus will only work until they expire.\n  If you anticipate Packer needing access for longer than a token's lifetime (default `1 hour`),\n  please use a service account key with `account_file` instead.\n\n- `account_file` (string) - The JSON file containing your account credentials. Not required if you\n  run Packer on a GCE instance with a service account. Instructions for\n  creating the file or using service accounts are above.\n\n- `impersonate_service_account` (string) - This allows service account impersonation as per the [docs](https://cloud.google.com/iam/docs/impersonating-service-accounts).\n\n- `accelerator_type` (string) - Full or partial URL of the guest accelerator type. GPU accelerators can\n  only be used with `\"on_host_maintenance\": \"TERMINATE\"` option set.\n  Example:\n  `\"projects/project_id/zones/europe-west1-b/acceleratorTypes/nvidia-tesla-k80\"`\n\n- `accelerator_count` (int64) - Number of guest accelerator cards to add to the launched instance.\n\n- `address` (string) - The name of a pre-allocated static external IP address. Note, must be\n  the name and not the actual IP address.\n\n- `disable_default_service_account` (bool) - If true, the default service account will not be used if\n  service_account_email is not specified. Set this value to true and omit\n  service_account_email to provision a VM with no service account.\n\n- `disk_name` (string) - The name of the disk, if unset the instance name will be used.\n\n- `disk_size` (int64) - The size of the disk in GB. This defaults to 20, which is 20GB.\n\n- `disk_type` (string) - Type of disk used to back your instance, like pd-ssd or pd-standard.\n  Defaults to pd-standard.\n\n- `disk_encryption_key` (\\*CustomerEncryptionKey) - Disk encryption key to apply to the created boot disk. Possible values:\n  * kmsKeyName -  The name of the encryption key that is stored in Google Cloud KMS.\n  * RawKey: - A 256-bit customer-supplied encryption key, encodes in RFC 4648 base64.\n  \n  examples:\n  \n   ```json\n   {\n      \"kmsKeyName\": \"projects/${project}/locations/${region}/keyRings/computeEngine/cryptoKeys/computeEngine/cryptoKeyVersions/4\"\n   }\n   ```\n  \n   ```hcl\n    disk_encryption_key {\n      kmsKeyName = \"projects/${var.project}/locations/${var.region}/keyRings/computeEngine/cryptoKeys/computeEngine/cryptoKeyVersions/4\"\n    }\n   ```\n\n- `enable_nested_virtualization` (bool) - Create a instance with enabling nested virtualization.\n\n- `enable_secure_boot` (bool) - Create a Shielded VM image with Secure Boot enabled. It helps ensure that\n  the system only runs authentic software by verifying the digital signature\n  of all boot components, and halting the boot process if signature verification\n  fails. [Details](https://cloud.google.com/security/shielded-cloud/shielded-vm)\n\n- `enable_vtpm` (bool) - Create a Shielded VM image with virtual trusted platform module\n  Measured Boot enabled. A vTPM is a virtualized trusted platform module,\n  which is a specialized computer chip you can use to protect objects,\n  like keys and certificates, that you use to authenticate access to your\n  system. [Details](https://cloud.google.com/security/shielded-cloud/shielded-vm)\n\n- `enable_integrity_monitoring` (bool) - Integrity monitoring helps you understand and make decisions about the\n  state of your VM instances. Note: integrity monitoring relies on having\n  vTPM enabled. [Details](https://cloud.google.com/security/shielded-cloud/shielded-vm)\n\n- `disk_attachment` ([]BlockDevice) - Extra disks to attach to the instance that will build the final image.\n  \n  You may reference an existing external persistent disk, or you can configure\n  a set of disks to be created before the instance is created, and will\n  be deleted upon build completion.\n  \n  Scratch (ephemeral) SSDs are always created at launch, and deleted when the\n  instance is torn-down.\n  \n  Refer to the [Extra Disk Attachments](#extra-disk-attachments) section for\n  more information on this configuration type.\n\n- `skip_create_image` (bool) - Skip creating the image. Useful for setting to `true` during a build test stage. Defaults to `false`.\n\n- `image_name` (string) - The unique name of the resulting image. Defaults to\n  `packer-{{timestamp}}`.\n\n- `image_description` (string) - The description of the resulting image.\n\n- `image_encryption_key` (\\*CustomerEncryptionKey) - Image encryption key to apply to the created image. Possible values:\n  * kmsKeyName -  The name of the encryption key that is stored in Google Cloud KMS.\n  * RawKey: - A 256-bit customer-supplied encryption key, encodes in RFC 4648 base64.\n  \n  examples:\n  \n   ```json\n   {\n      \"kmsKeyName\": \"projects/${project}/locations/${region}/keyRings/computeEngine/cryptoKeys/computeEngine/cryptoKeyVersions/4\"\n   }\n   ```\n  \n   ```hcl\n    image_encryption_key {\n      kmsKeyName = \"projects/${var.project}/locations/${var.region}/keyRings/computeEngine/cryptoKeys/computeEngine/cryptoKeyVersions/4\"\n    }\n   ```\n\n- `image_family` (string) - The name of the image family to which the resulting image belongs. You\n  can create disks by specifying an image family instead of a specific\n  image name. The image family always returns its latest image that is not\n  deprecated.\n\n- `image_labels` (map[string]string) - Key/value pair labels to apply to the created image.\n\n- `image_licenses` ([]string) - Licenses to apply to the created image.\n\n- `image_guest_os_features` ([]string) - Guest OS features to apply to the created image.\n\n- `image_project_id` (string) - The project ID to push the build image into. Defaults to project_id.\n\n- `image_storage_locations` ([]string) - Storage location, either regional or multi-regional, where snapshot\n  content is to be stored and only accepts 1 value. Always defaults to a nearby regional or multi-regional\n  location.\n  \n  multi-regional example:\n  \n   ```json\n   {\n      \"image_storage_locations\": [\"us\"]\n   }\n   ```\n  regional example:\n  \n   ```json\n   {\n      \"image_storage_locations\": [\"us-east1\"]\n   }\n   ```\n\n- `instance_name` (string) - A name to give the launched instance. Beware that this must be unique.\n  Defaults to `packer-{{uuid}}`.\n\n- `labels` (map[string]string) - Key/value pair labels to apply to the launched instance.\n\n- `machine_type` (string) - The machine type. Defaults to \"e2-standard-2\".\n\n- `metadata` (map[string]string) - Metadata applied to the launched instance.\n  All metadata configuration values are expected to be of type string.\n  Google metadata options that take a value of `TRUE` or `FALSE` should be\n  set as a string (i.e  `\"TRUE\"` `\"FALSE\"` or `\"true\"` `\"false\"`).\n\n- `metadata_files` (map[string]string) - Metadata applied to the launched instance. Values are files.\n\n- `min_cpu_platform` (string) - A Minimum CPU Platform for VM Instance. Availability and default CPU\n  platforms vary across zones, based on the hardware available in each GCP\n  zone.\n  [Details](https://cloud.google.com/compute/docs/instances/specify-min-cpu-platform)\n\n- `network` (string) - The Google Compute network id or URL to use for the launched instance.\n  Defaults to \"default\". If the value is not a URL, it will be\n  interpolated to\n  `projects/((network_project_id))/global/networks/((network))`. This value\n  is not required if a subnet is specified.\n\n- `network_project_id` (string) - The project ID for the network and subnetwork to use for launched\n  instance. Defaults to project_id.\n\n- `omit_external_ip` (bool) - If true, the instance will not have an external IP. use_internal_ip must\n  be true if this property is true.\n\n- `on_host_maintenance` (string) - Sets Host Maintenance Option. Valid choices are `MIGRATE` and\n  `TERMINATE`. Please see [GCE Instance Scheduling\n  Options](https://cloud.google.com/compute/docs/instances/setting-instance-scheduling-options),\n  as not all machine\\_types support `MIGRATE` (i.e. machines with GPUs).\n  If preemptible is true this can only be `TERMINATE`. If preemptible is\n  false, it defaults to `MIGRATE`\n\n- `preemptible` (bool) - If true, launch a preemptible instance.\n\n- `node_affinity` ([]NodeAffinity) - Sets a node affinity label for the launched instance (eg. for sole tenancy).\n  Please see [Provisioning VMs on\n  sole-tenant nodes](https://cloud.google.com/compute/docs/nodes/provisioning-sole-tenant-vms)\n  for more information.\n  \n  ```hcl\n    key = \"workload\"\n    operator = \"IN\"\n    values = [\"packer\"]\n  ```\n\n- `state_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for instance state changes. Defaults to \"5m\".\n\n- `region` (string) - The region in which to launch the instance. Defaults to the region\n  hosting the specified zone.\n\n- `scopes` ([]string) - The service account scopes for launched\n  instance. Defaults to:\n  \n  ```json\n  [\n    \"https://www.googleapis.com/auth/userinfo.email\",\n    \"https://www.googleapis.com/auth/compute\",\n    \"https://www.googleapis.com/auth/devstorage.full_control\"\n  ]\n  ```\n\n- `service_account_email` (string) - The service account to be used for launched instance. Defaults to the\n  project's default service account unless disable_default_service_account\n  is true.\n\n- `source_image_project_id` ([]string) - A list of project IDs to search for the source image. Packer will search the first\n  project ID in the list first, and fall back to the next in the list, until it finds the source image.\n\n- `startup_script_file` (string) - The path to a startup script to run on the launched instance from which the image will\n  be made. When set, the contents of the startup script file will be added to the instance metadata\n  under the `\"startup_script\"` metadata property. See [Providing startup script contents directly](https://cloud.google.com/compute/docs/startupscript#providing_startup_script_contents_directly) for more details.\n  \n  When using `startup_script_file` the following rules apply:\n  - The contents of the script file will overwrite the value of the `\"startup_script\"` metadata property at runtime.\n  - The contents of the script file will be wrapped in Packer's startup script wrapper, unless `wrap_startup_script` is disabled. See `wrap_startup_script` for more details.\n  - Not supported by Windows instances. See [Startup Scripts for Windows](https://cloud.google.com/compute/docs/startupscript#providing_a_startup_script_for_windows_instances) for more details.\n\n- `windows_password_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for windows password to be retrieved. Defaults to \"3m\".\n\n- `wrap_startup_script` (boolean) - For backwards compatibility this option defaults to `\"true\"` in the future it will default to `\"false\"`.\n  If \"true\", the contents of `startup_script_file` or `\"startup_script\"` in the instance metadata\n  is wrapped in a Packer specific script that tracks the execution and completion of the provided\n  startup script. The wrapper ensures that the builder will not continue until the startup script has been executed.\n  - The use of the wrapped script file requires that the user or service account\n  running the build has the compute.instance.Metadata role.\n\n- `subnetwork` (string) - The Google Compute subnetwork id or URL to use for the launched\n  instance. Only required if the network has been created with custom\n  subnetting. Note, the region of the subnetwork must match the region or\n  zone in which the VM is launched. If the value is not a URL, it will be\n  interpolated to\n  `projects/((network_project_id))/regions/((region))/subnetworks/((subnetwork))`\n\n- `tags` ([]string) - Assign network tags to apply firewall rules to VM instance.\n\n- `use_internal_ip` (bool) - If true, use the instance's internal IP instead of its external IP\n  during building.\n\n- `use_os_login` (bool) - If true, OSLogin will be used to manage SSH access to the compute instance by\n  dynamically importing a temporary SSH key to the Google account's login profile,\n  and setting the `enable-oslogin` to `TRUE` in the instance metadata.\n  Optionally, `use_os_login` can be used with an existing `ssh_username` and `ssh_private_key_file`\n  if a SSH key has already been added to the Google account's login profile - See [Adding SSH Keys](https://cloud.google.com/compute/docs/instances/managing-instance-access#add_oslogin_keys).\n  \n  SSH keys can be added to an individual user account\n  \n  ```shell-session\n  $ gcloud compute os-login ssh-keys add --key-file=/home/user/.ssh/my-key.pub\n  \n  $ gcloud compute os-login describe-profile\n  PosixAccounts:\n  - accountId: \u003cproject-id\u003e\n   gid: '34567890754'\n   homeDirectory: /home/user_example_com\n   ...\n   primary: true\n   uid: '2504818925'\n   username: /home/user_example_com\n  sshPublicKeys:\n   000000000000000000000000000000000000000000000000000000000000000a:\n     fingerprint: 000000000000000000000000000000000000000000000000000000000000000a\n  ```\n  \n  Or SSH keys can be added to an associated service account\n  ```shell-session\n  $ gcloud auth activate-service-account --key-file=\u003cpath to service account credentials file (e.g account.json)\u003e\n  $ gcloud compute os-login ssh-keys add --key-file=/home/user/.ssh/my-key.pub\n  \n  $ gcloud compute os-login describe-profile\n  PosixAccounts:\n  - accountId: \u003cproject-id\u003e\n   gid: '34567890754'\n   homeDirectory: /home/sa_000000000000000000000\n   ...\n   primary: true\n   uid: '2504818925'\n   username: sa_000000000000000000000\n  sshPublicKeys:\n   000000000000000000000000000000000000000000000000000000000000000a:\n     fingerprint: 000000000000000000000000000000000000000000000000000000000000000a\n  ```\n\n- `vault_gcp_oauth_engine` (string) - Can be set instead of account_file. If set, this builder will use\n  HashiCorp Vault to generate an Oauth token for authenticating against\n  Google Cloud. The value should be the path of the token generator\n  within vault.\n  For information on how to configure your Vault + GCP engine to produce\n  Oauth tokens, see https://www.vaultproject.io/docs/auth/gcp\n  You must have the environment variables VAULT_ADDR and VAULT_TOKEN set,\n  along with any other relevant variables for accessing your vault\n  instance. For more information, see the Vault docs:\n  https://www.vaultproject.io/docs/commands/#environment-variables\n  Example:`\"vault_gcp_oauth_engine\": \"gcp/token/my-project-editor\",`\n\n- `wait_to_add_ssh_keys` (duration string | ex: \"1h5m2s\") - The time to wait between the creation of the instance used to create the image,\n  and the addition of SSH configuration, including SSH keys, to that instance.\n  The delay is intended to protect packer from anything in the instance boot\n  sequence that has potential to disrupt the creation of SSH configuration\n  (e.g. SSH user creation, SSH key creation) on the instance.\n  Note: All other instance metadata, including startup scripts, are still added to the instance\n  during it's creation.\n  Example value: `5m`.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/googlecompute/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the IAPConfig struct in builder/googlecompute/step_start_tunnel.go; DO NOT EDIT MANUALLY --\u003e\n\n- `use_iap` (bool) - Whether to use an IAP proxy.\n  Prerequisites and limitations for using IAP:\n  - You must manually enable the IAP API in the Google Cloud console.\n  - You must have the gcloud sdk installed on the computer running Packer.\n  - If you use a service account, you must add it to project level IAP permissions\n    in https://console.cloud.google.com/security/iap. To do so, click\n    \"project\" \u003e \"SSH and TCP resources\" \u003e \"All Tunnel Resources\" \u003e\n    \"Add Member\". Then add your service account and choose the role\n    \"IAP-secured Tunnel User\" and add any conditions you may care about.\n\n- `iap_localhost_port` (int) - Which port to connect the local end of the IAM localhost proxy to. If\n  left blank, Packer will choose a port for you from available ports.\n\n- `iap_hashbang` (string) - What \"hashbang\" to use to invoke script that sets up gcloud.\n  Default: \"/bin/sh\"\n\n- `iap_ext` (string) - What file extension to use for script that sets up gcloud.\n  Default: \".sh\"\n\n- `iap_tunnel_launch_wait` (int) - How long to wait, in seconds, before assuming a tunnel launch was\n  successful. Defaults to 30 seconds for SSH or 40 seconds for WinRM.\n\n\u003c!-- End of code generated from the comments of the IAPConfig struct in builder/googlecompute/step_start_tunnel.go; --\u003e\n\n\n### Startup Scripts\n\nStartup scripts can be a powerful tool for configuring the instance from which\nthe image is made. The builder will wait for a startup script to terminate. A\nstartup script can be provided via the `startup_script_file` or\n`startup-script` instance creation `metadata` field. Therefore, the build time\nwill vary depending on the duration of the startup script. If\n`startup_script_file` is set, the `startup-script` `metadata` field will be\noverwritten. In other words, `startup_script_file` takes precedence.\n\nThe builder does check for a pass/fail/error signal from the startup\nscript by tracking the `startup-script-status` metadata. Packer will check if this key\nis set to done and if it not set to done before the timeout, Packer will fail the build.\n\n### Windows\nA Windows startup script can only be provided as a metadata field option. The\nbuilder will _not_ wait for a Windows startup script to terminate. You have\nto ensure that it finishes before the instance shuts down. For a list of\nsupported startup script keys refer to [Using startup scripts on Windows](https://cloud.google.com/compute/docs/instances/startup-scripts/windows)\n\n```hcl\nmetadata = {\n  sysprep-specialize-script-cmd = \"...\"\n}\n```\n\n### Logging\n\nStartup script logs can be copied to a Google Cloud Storage (GCS) location\nspecified via the `startup-script-log-dest` instance creation `metadata` field.\nThe GCS location must be writeable by the service account of the instance that Packer created.\n\n### Communicator Configuration\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `communicator` (string) - Packer currently supports three kinds of communicators:\n  \n  -   `none` - No communicator will be used. If this is set, most\n      provisioners also can't be used.\n  \n  -   `ssh` - An SSH connection will be established to the machine. This\n      is usually the default.\n  \n  -   `winrm` - A WinRM connection will be established.\n  \n  In addition to the above, some builders have custom communicators they\n  can use. For example, the Docker builder has a \"docker\" communicator\n  that uses `docker exec` and `docker cp` to execute scripts and copy\n  files.\n\n- `pause_before_connecting` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\n  guest's bootstrap script, but sometimes you may have a race condition\n  where you need Packer to wait before attempting to connect to your\n  guest.\n  \n  If you end up in this situation, you can use the template option\n  `pause_before_connecting`. By default, there is no pause. For example if\n  you set `pause_before_connecting` to `10m` Packer will check whether it\n  can connect, as normal. But once a connection attempt is successful, it\n  will disconnect and then wait 10 minutes before connecting to the guest\n  and beginning provisioning.\n\n\u003c!-- End of code generated from the comments of the Config struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSH struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ssh_host` (string) - The address to SSH to. This usually is automatically configured by the\n  builder.\n\n- `ssh_port` (int) - The port to connect to SSH. This defaults to `22`.\n\n- `ssh_username` (string) - The username to connect to SSH with. Required if using SSH.\n\n- `ssh_password` (string) - A plaintext password to use to authenticate with SSH.\n\n- `ssh_ciphers` ([]string) - This overrides the value of ciphers supported by default by Golang.\n  The default value is [\n    \"aes128-gcm@openssh.com\",\n    \"chacha20-poly1305@openssh.com\",\n    \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n  ]\n  \n  Valid options for ciphers include:\n  \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\",\n  \"chacha20-poly1305@openssh.com\",\n  \"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",\n\n- `ssh_clear_authorized_keys` (bool) - If true, Packer will attempt to remove its temporary key from\n  `~/.ssh/authorized_keys` and `/root/.ssh/authorized_keys`. This is a\n  mostly cosmetic option, since Packer will delete the temporary private\n  key from the host system regardless of whether this is set to true\n  (unless the user has set the `-debug` flag). Defaults to \"false\";\n  currently only works on guests with `sed` installed.\n\n- `ssh_key_exchange_algorithms` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\n  supported by default by Golang. Acceptable values include:\n  \"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\",\n  \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n  \"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".\n\n- `ssh_certificate_file` (string) - Path to user certificate used to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_pty` (bool) - If `true`, a PTY will be requested for the SSH connection. This defaults\n  to `false`.\n\n- `ssh_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\n  determine when the machine has booted so this is usually quite long.\n  Example value: `10m`.\n  This defaults to `5m`, unless `ssh_handshake_attempts` is set.\n\n- `ssh_disable_agent_forwarding` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `false`.\n\n- `ssh_handshake_attempts` (int) - The number of handshakes to attempt with SSH once it can connect.\n  This defaults to `10`, unless a `ssh_timeout` is set.\n\n- `ssh_bastion_host` (string) - A bastion host to use for the actual SSH connection.\n\n- `ssh_bastion_port` (int) - The port of the bastion host. Defaults to `22`.\n\n- `ssh_bastion_agent_auth` (bool) - If `true`, the local SSH agent will be used to authenticate with the\n  bastion host. Defaults to `false`.\n\n- `ssh_bastion_username` (string) - The username to connect to the bastion host.\n\n- `ssh_bastion_password` (string) - The password to use to authenticate with the bastion host.\n\n- `ssh_bastion_interactive` (bool) - If `true`, the keyboard-interactive used to authenticate with bastion host.\n\n- `ssh_bastion_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with the\n  bastion host. The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_bastion_certificate_file` (string) - Path to user certificate used to authenticate with bastion host.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_file_transfer_method` (string) - `scp` or `sftp` - How to transfer files, Secure copy (default) or SSH\n  File Transfer Protocol.\n  \n  **NOTE**: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n  (the default protocol for copying data) returns a a non-zero error code since the MOTW\n  cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\n  with SFTP instead `ssh_file_transfer_protocol = \"sftp\"`.\n\n- `ssh_proxy_host` (string) - A SOCKS proxy host to use for SSH connection\n\n- `ssh_proxy_port` (int) - A port of the SOCKS proxy. Defaults to `1080`.\n\n- `ssh_proxy_username` (string) - The optional username to authenticate with the proxy server.\n\n- `ssh_proxy_password` (string) - The optional password to use to authenticate with the proxy server.\n\n- `ssh_keep_alive_interval` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\n  value (`-1s`) to disable. Example value: `10s`. Defaults to `5s`.\n\n- `ssh_read_write_timeout` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\n  useful if, for example, packer hangs on a connection after a reboot.\n  Example: `5m`. Disabled by default.\n\n- `ssh_remote_tunnels` ([]string) - \n\n- `ssh_local_tunnels` ([]string) - \n\n\u003c!-- End of code generated from the comments of the SSH struct in communicator/config.go; --\u003e\n\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n\n### Temporary SSH keypair\n\n\u003c!-- Code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\nWhen no ssh credentials are specified, Packer will generate a temporary SSH\nkeypair for the instance. You can change the algorithm type and bits\nsettings.\n\n\u003c!-- End of code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `temporary_key_pair_type` (string) - `dsa` | `ecdsa` | `ed25519` | `rsa` ( the default )\n  \n  Specifies the type of key to create. The possible values are 'dsa',\n  'ecdsa', 'ed25519', or 'rsa'.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure, please\n  consider other alternatives like RSA or ED25519.\n\n- `temporary_key_pair_bits` (int) - Specifies the number of bits in the key to create. For RSA keys, the\n  minimum size is 1024 bits and the default is 4096 bits. Generally, 3072\n  bits is considered sufficient. DSA keys must be exactly 1024 bits as\n  specified by FIPS 186-2. For ECDSA keys, bits determines the key length\n  by selecting from one of three elliptic curve sizes: 256, 384 or 521\n  bits. Attempting to use bit lengths other than these three values for\n  ECDSA keys will fail. Ed25519 keys have a fixed length and bits will be\n  ignored.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure as specified\n  by FIPS 186-5, please consider other alternatives like RSA or ED25519.\n\n\u003c!-- End of code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; --\u003e\n\n\n### Gotchas\n\nCentOS and recent Debian images have root ssh access disabled by default. Set\n`ssh_username` to any user, which will be created by packer with sudo access.\n\nThe machine type must have a scratch disk, which means you can't use an\n`f1-micro` or `g1-small` to build images.\n\n## Extra disk attachments\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/googlecompute/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\nBlockDevice is a block device attachement/creation to an instance when building an image.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/googlecompute/block_device.go; --\u003e\n\n\nThese can be defined using the [disk_attachment](#disk_attachment) block in the configuration.\n\nNote that this is an array, and therefore in HCL2 can be defined as multiple blocks, each\none corresponding to a disk that will be attached to the instance you are booting.\n\nExample:\n\n```hcl\nsource \"googlecompute\" \"example\" {\n  # Add whichever is necessary to build the image\n\n  disk_attachment {\n    volume_type     = \"scratch\"\n    volume_size     = 375\n  }\n\n  disk_attachment {\n    volume_type     = \"pd-standard\"\n    volume_size     = 25\n    interface_type  = \"SCSI\"\n  }\n}\n```\n\n### Required:\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/googlecompute/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `volume_size` (int) - Size of the volume to request, in gigabytes.\n  \n  The size specified must be in range of the sizes for the chosen volume type.\n\n- `volume_type` (BlockDeviceType) - The volume type is the type of storage to reserve and attach to the instance being provisioned.\n  \n  The following values are supported by this builder:\n  * scratch: local SSD data, always 375 GiB (default)\n  * pd_standard: persistent, HDD-backed disk\n  * pd_balanced: persistent, SSD-backed disk\n  * pd_ssd: persistent, SSD-backed disk, with extra performance guarantees\n  * pd_extreme: persistent, fastest SSD-backed disk, with custom IOPS\n  \n  For details on the different types, refer to: https://cloud.google.com/compute/docs/disks#disk-types\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/googlecompute/block_device.go; --\u003e\n\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/googlecompute/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `attachment_mode` (string) - How to attach the volume to the instance\n  \n  Can be either READ_ONLY or READ_WRITE (default).\n\n- `device_name` (string) - The device name as exposed to the OS in the /dev/disk/by-id/google-* directory\n  \n  If unspecified, the disk will have a default name in the form\n  persistent-disk-x with 'x' being a number assigned by GCE\n  \n  This field only applies to persistent disks, local SSDs will always\n  be exposed as /dev/disk/by-id/google-local-nvme-ssd-x.\n\n- `disk_encryption_key` (CustomerEncryptionKey) - Disk encryption key to apply to the requested disk.\n  \n  Possible values:\n  * kmsKeyName -  The name of the encryption key that is stored in Google Cloud KMS.\n  * RawKey: - A 256-bit customer-supplied encryption key, encodes in RFC 4648 base64.\n\n- `disk_name` (string) - Name of the disk to create.\n  This only applies to non-scratch disks. If the disk is persistent, and\n  not specified, Packer will generate a unique name for the disk.\n  \n  The name must be 1-63 characters long and comply to the regexp\n  '[a-z]([-a-z0-9]*[a-z0-9])?'\n\n- `interface_type` (string) - The interface to use for attaching the disk.\n  Can be either NVME or SCSI. Defaults to SCSI.\n  \n  The available options depend on the type of disk, SEE: https://cloud.google.com/compute/docs/disks/persistent-disks#choose_an_interface\n\n- `iops` (int) - The requested IOPS for the disk.\n  \n  This is only available for pd_extreme disks.\n\n- `keep_device` (bool) - Keep the device in the created disks after the instance is terminated.\n  By default, the builder will remove the disks at the end of the build.\n  \n  This cannot be used with 'scratch' volumes.\n\n- `replica_zones` ([]string) - The list of extra zones to replicate the disk into\n  \n  The zone in which the instance is created will automatically be\n  added to the zones in which the disk is replicated.\n\n- `source_volume` (string) - The URI of the volume to attach\n  \n  If this is specified, it won't be deleted after the instance is shut-down.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/googlecompute/block_device.go; --\u003e\n","created_at":"2023-10-24T14:02:23.427Z","updated_at":"2023-10-24T14:02:23.427Z","name":"Google Cloud Platform","slug":"googlecompute","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"5e966ee1-c0ea-4286-8e0a-786f95e0b4aa","integration_release_id":"36ab9be0-c730-415e-bfee-02f0f804a813","component_id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","readme":"Type: `googlecompute-import`\nArtifact BuilderId: `packer.post-processor.googlecompute-import`\n\nThe Google Compute Image Import post-processor takes a compressed raw disk\nimage and imports it to a GCE image available to Google Compute Engine.\n\n~\u003e This post-processor is for advanced users. Please ensure you read the\n[GCE import documentation](https://cloud.google.com/compute/docs/images/import-existing-image)\nbefore using this post-processor.\n\n## How Does it Work?\n\nThe import process operates by uploading a temporary copy of the compressed raw\ndisk image to a GCS bucket, and calling an import task in GCP on the raw disk\nfile. Once completed, a GCE image is created containing the converted virtual\nmachine. The temporary raw disk image copy in GCS can be discarded after the import is complete.\n\nGoogle Cloud has very specific requirements for images being imported. Please\nsee the [GCE import documentation](https://cloud.google.com/compute/docs/images/import-existing-image)\nfor details.\n\n~\u003e **Note**: To prevent Packer from deleting the compressed RAW disk image set the `keep_input_artifact` configuration option to `true`.\nSee [Post-Processor Input Artifacts](/packer/docs/templates/legacy_json_templates/post-processors#input-artifacts) for more details.\n\n## Configuration\n\n### Required\n\n\u003c!-- Code generated from the comments of the Config struct in post-processor/googlecompute-import/post-processor.go; DO NOT EDIT MANUALLY --\u003e\n\n- `project_id` (string) - The project ID where the GCS bucket exists and where the GCE image is stored.\n\n- `bucket` (string) - The name of the GCS bucket where the raw disk image will be uploaded.\n\n- `image_name` (string) - The unique name of the resulting image.\n\n\u003c!-- End of code generated from the comments of the Config struct in post-processor/googlecompute-import/post-processor.go; --\u003e\n\n\n### Optional\n\n\u003c!-- Code generated from the comments of the Config struct in post-processor/googlecompute-import/post-processor.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_token` (string) - A temporary OAuth 2.0 access token\n\n- `account_file` (string) - The JSON file containing your account credentials.\n  If specified, the account file will take precedence over any `googlecompute` builder authentication method.\n\n- `impersonate_service_account` (string) - This allows service account impersonation as per the [docs](https://cloud.google.com/iam/docs/impersonating-service-accounts).\n\n- `scopes` ([]string) - The service account scopes for launched importer post-processor instance.\n  Defaults to:\n  \n  ```json\n  [\n    \"https://www.googleapis.com/auth/cloud-platform\"\n  ]\n  ```\n\n- `gcs_object_name` (string) - The name of the GCS object in `bucket` where\n  the RAW disk image will be copied for import. This is treated as a\n  [template engine](/packer/docs/templates/legacy_json_templates/engine). Therefore, you\n  may use user variables and template functions in this field. Defaults to\n  `packer-import-{{timestamp}}.tar.gz`.\n\n- `image_architecture` (string) - Specifies the architecture or processor type that this image can support. Must be one of: `arm64` or `x86_64`. Defaults to `ARCHITECTURE_UNSPECIFIED`.\n\n- `image_description` (string) - The description of the resulting image.\n\n- `image_family` (string) - The name of the image family to which the resulting image belongs.\n\n- `image_guest_os_features` ([]string) - A list of features to enable on the guest operating system. Applicable only for bootable images. Valid\n  values are `MULTI_IP_SUBNET`, `UEFI_COMPATIBLE`,\n  `VIRTIO_SCSI_MULTIQUEUE`, `GVNIC` and `WINDOWS` currently.\n\n- `image_labels` (map[string]string) - Key/value pair labels to apply to the created image.\n\n- `image_storage_locations` ([]string) - Specifies a Cloud Storage location, either regional or multi-regional, where image content is to be stored. If not specified, the multi-region location closest to the source is chosen automatically.\n\n- `skip_clean` (bool) - Skip removing the TAR file uploaded to the GCS\n  bucket after the import process has completed. \"true\" means that we should\n  leave it in the GCS bucket, \"false\" means to clean it out. Defaults to\n  `false`.\n\n- `vault_gcp_oauth_engine` (string) - Vault GCP Oauth Engine\n\n- `image_platform_key` (string) - A key used to establish the trust relationship between the platform owner and the firmware. You may only specify one platform key, and it must be a valid X.509 certificate.\n\n- `image_key_exchange_key` ([]string) - A key used to establish a trust relationship between the firmware and the OS. You may specify multiple comma-separated keys for this value.\n\n- `image_signatures_db` ([]string) - A database of certificates that are trusted and can be used to sign boot files. You may specify single or multiple comma-separated values for this value.\n\n- `image_forbidden_signatures_db` ([]string) - A database of certificates that have been revoked and will cause the system to stop booting if a boot file is signed with one of them. You may specify single or multiple comma-separated values for this value.\n\n\u003c!-- End of code generated from the comments of the Config struct in post-processor/googlecompute-import/post-processor.go; --\u003e\n\n\n## Basic Example\n\nHere is a basic example. This assumes that the builder has produced an\ncompressed raw disk image artifact for us to work with, and that the GCS bucket\nhas been created.\n\n**HCL**\n\n```hcl\npost-processor \"googlecompute-import\"{\n  account_file = \"account.json\"\n  bucket = \"my-bucket\"\n  project_id = \"my-project\"\n  image_name = \"my-gce-image\"\n}\n```\n\n**JSON**\n\n```json\n{\n  \"type\": \"googlecompute-import\",\n  \"account_file\": \"account.json\",\n  \"project_id\": \"my-project\",\n  \"bucket\": \"my-bucket\",\n  \"image_name\": \"my-gce-image\"\n}\n```\n\n\n## QEMU Builder Example\n\nHere is a complete example for building a Fedora 31 server GCE image. For this\nexample Packer was run from a Debian Linux host with KVM installed.\n\n    $ packer build -var serial=$(tty) build.pkr.hcl\n\n**HCL2**\n\n```hcl\nvariables {\n  account_file = \"account.json\"\n  bucket = \"my-bucket\"\n  project = \"my-project\"\n  serial = \"\"\n}\n\nsource \"qemu\" \"example\" {\n    accelerator = \"kvm\"\n    boot_command = [\n      \"\u003ctab\u003e console=ttyS0,115200n8 inst.text inst.ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/fedora-31-ks.cfg rd.live.check=0\u003center\u003e\u003cwait\u003e\"\n    ]\n    disk_size = \"15000\"\n    format = \"raw\"\n    iso_checksum = \"sha256:225ebc160e40bb43c5de28bad9680e3a78a9db40c9e3f4f42f3ee3f10f95dbeb\"\n    iso_url = \"https://download-ib01.fedoraproject.org/pub/fedora/linux/releases/31/Server/x86_64/iso/Fedora-Server-dvd-x86_64-31-1.9.iso\"\n    headless = \"true\"\n    http_directory = \"http\"\n    http_port_max = \"10089\"\n    http_port_min = \"10082\"\n    output_directory = \"output\"\n    shutdown_timeout = \"30m\"\n\t\tshutdown_command = \"echo 'vagrant'|sudo -S shutdown -P now\"\n\t\tssh_username = \"vagrant\"\n\t\tssh_password = \"vagrant\"\n    vm_name = \"disk.raw\"\n    qemu_binary = \"/usr/bin/kvm\"\n    qemuargs = [\n      [\"-m\", \"1024\"],\n      [\"-cpu\", \"host\"],\n      [\"-chardev\", \"tty,id=pts,path=${var.serial}\"],\n      [\"-device\", \"isa-serial,chardev=pts\"],\n      [\"-device\", \"virtio-net,netdev=user.0\"]\n    ]\n}\n\nbuild {\n  sources = [\"source.qemu.example\"]\n\n  post-processors {\n    post-processor \"compress\" {\n        output = \"output/disk.raw.tar.gz\"\n    }\n    post-processor \"googlecompute-import\"  {\n        account_file = var.account_file\n        bucket = var.bucket\n        project_id = var.project\n        image_name = \"fedora31-server-packertest\"\n        image_description = \"Fedora 31 Server\"\n        image_family = \"fedora31-server\"\n      }\n    }\n}\n```\n\n  **JSON**\n\n```json\n{\n  \"variables\": {\n    \"account_file\": \"account.json\",\n    \"bucket\": \"my-bucket\",\n    \"project\": \"my-project\",\n    \"serial\": \"\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"qemu\",\n      \"accelerator\": \"kvm\",\n      \"boot_command\": [\n        \"\u003ctab\u003e console=ttyS0,115200n8 inst.text inst.ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/fedora-31-ks.cfg rd.live.check=0\u003center\u003e\u003cwait\u003e\"\n      ],\n      \"disk_size\": \"15000\",\n      \"format\": \"raw\",\n      \"iso_checksum\": \"sha256:225ebc160e40bb43c5de28bad9680e3a78a9db40c9e3f4f42f3ee3f10f95dbeb\",\n      \"iso_url\": \"https://download-ib01.fedoraproject.org/pub/fedora/linux/releases/31/Server/x86_64/iso/Fedora-Server-dvd-x86_64-31-1.9.iso\",\n      \"headless\": \"true\",\n      \"http_directory\": \"http\",\n      \"http_port_max\": \"10089\",\n      \"http_port_min\": \"10082\",\n      \"output_directory\": \"output\",\n      \"shutdown_timeout\": \"30m\",\n      \"shutdown_command\": \"echo 'vagrant'|sudo -S shutdown -P now\",\n      \"ssh_username\": \"vagrant\",\n      \"ssh_password\": \"vagrant\",\n      \"vm_name\": \"disk.raw\",\n      \"qemu_binary\": \"/usr/bin/kvm\",\n      \"qemuargs\": [\n        [\"-m\", \"1024\"],\n        [\"-cpu\", \"host\"],\n        [\"-chardev\", \"tty,id=pts,path={{user `serial`}}\"],\n        [\"-device\", \"isa-serial,chardev=pts\"],\n        [\"-device\", \"virtio-net,netdev=user.0\"]\n      ]\n    }\n  ],\n  \"post-processors\": [\n    [\n      {\n        \"type\": \"compress\",\n        \"output\": \"output/disk.raw.tar.gz\"\n      },\n      {\n        \"type\": \"googlecompute-import\",\n        \"project_id\": \"{{user `project`}}\",\n        \"account_file\": \"{{user `account_file`}}\",\n        \"bucket\": \"{{user `bucket`}}\",\n        \"image_name\": \"fedora31-server-packertest\",\n        \"image_description\": \"Fedora 31 Server\",\n        \"image_family\": \"fedora31-server\"\n      }\n    ]\n  ]\n}\n```\n","created_at":"2023-10-24T14:02:23.780Z","updated_at":"2023-10-24T14:02:23.780Z","name":"Google Cloud Platform Image Import","slug":"googlecompute-import","component":{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.157Z","updated_at":"2023-07-26T17:26:54.831Z"},"variable_groups":[]},{"id":"a7433aa9-0171-43a8-8ca6-ea55b08f16f6","integration_release_id":"36ab9be0-c730-415e-bfee-02f0f804a813","component_id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","readme":"Type: `googlecompute-export`\nArtifact BuilderId: `packer.post-processor.googlecompute-export`\n\nThe Google Compute Image Exporter post-processor exports the resultant image\nfrom a googlecompute build as a gzipped tarball to Google Cloud Storage (GCS).\n\nThe exporter uses the same Google Cloud Platform (GCP) project and\nauthentication credentials as the googlecompute build that produced the image.\nA temporary VM is started in the GCP project using these credentials. The VM\nmounts the built image as a disk then dumps, compresses, and tars the image.\nThe VM then uploads the tarball to the provided GCS `paths` using the same\ncredentials.\n\nAs such, the authentication credentials that built the image must have write\npermissions to the GCS `paths`.\n\n~\u003e **Note**: By default the GCE image being exported will be deleted once the image has been exported.\nTo prevent Packer from deleting the image set the `keep_input_artifact` configuration option to `true`. See [Post-Processor Input Artifacts](/packer/docs/templates/legacy_json_templates/post-processors#input-artifacts) for more details.\n\n## Configuration\n\n### Required\n\n\u003c!-- Code generated from the comments of the Config struct in post-processor/googlecompute-export/post-processor.go; DO NOT EDIT MANUALLY --\u003e\n\n- `paths` ([]string) - A list of GCS paths where the image will be exported.\n  For example `'gs://mybucket/path/to/file.tar.gz'`\n\n\u003c!-- End of code generated from the comments of the Config struct in post-processor/googlecompute-export/post-processor.go; --\u003e\n\n\n### Optional\n\n\u003c!-- Code generated from the comments of the Config struct in post-processor/googlecompute-export/post-processor.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_token` (string) - A temporary OAuth 2.0 access token\n\n- `account_file` (string) - The JSON file containing your account credentials.\n  If specified, the account file will take precedence over any `googlecompute` builder authentication method.\n\n- `impersonate_service_account` (string) - This allows service account impersonation as per the [docs](https://cloud.google.com/iam/docs/impersonating-service-accounts).\n\n- `scopes` ([]string) - The service account scopes for launched exporter post-processor instance.\n  Defaults to:\n  \n  ```json\n  [\n    \"https://www.googleapis.com/auth/cloud-platform\"\n  ]\n  ```\n\n- `disk_size` (int64) - The size of the export instances disk.\n  The disk is unused for the export but a larger size will increase `pd-ssd` read speed.\n  This defaults to `200`, which is 200GB.\n\n- `disk_type` (string) - Type of disk used to back the export instance, like\n  `pd-ssd` or `pd-standard`. Defaults to `pd-ssd`.\n\n- `machine_type` (string) - The export instance machine type. Defaults to `\"n1-highcpu-4\"`.\n\n- `network` (string) - The Google Compute network id or URL to use for the export instance.\n  Defaults to `\"default\"`. If the value is not a URL, it\n  will be interpolated to `projects/((builder_project_id))/global/networks/((network))`.\n  This value is not required if a `subnet` is specified.\n\n- `subnetwork` (string) - The Google Compute subnetwork id or URL to use for\n  the export instance. Only required if the `network` has been created with\n  custom subnetting. Note, the region of the subnetwork must match the\n  `zone` in which the VM is launched. If the value is not a URL,\n  it will be interpolated to\n  `projects/((builder_project_id))/regions/((region))/subnetworks/((subnetwork))`\n\n- `zone` (string) - The zone in which to launch the export instance. Defaults\n  to `googlecompute` builder zone. Example: `\"us-central1-a\"`\n\n- `vault_gcp_oauth_engine` (string) - Vault GCP Oauth Engine\n\n- `service_account_email` (string) - Service Account Email\n\n\u003c!-- End of code generated from the comments of the Config struct in post-processor/googlecompute-export/post-processor.go; --\u003e\n\n\n## Basic Example\n\nThe following example builds a GCE image in the project, `my-project`, with an\naccount whose keyfile is `account.json`. After the image build, a temporary VM\nwill be created to export the image as a gzipped tarball to\n`gs://mybucket1/path/to/file1.tar.gz` and\n`gs://mybucket2/path/to/file2.tar.gz`. `keep_input_artifact` is true, so the\nGCE image won't be deleted after the export.\n\nIn order for this example to work, the account associated with `account.json`\nmust have write access to both `gs://mybucket1/path/to/file1.tar.gz` and\n`gs://mybucket2/path/to/file2.tar.gz`.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"account_file\": \"account.json\",\n      \"project_id\": \"my-project\",\n      \"source_image\": \"debian-7-wheezy-v20150127\",\n      \"zone\": \"us-central1-a\"\n    }\n  ],\n  \"post-processors\": [\n    {\n      \"type\": \"googlecompute-export\",\n      \"paths\": [\n        \"gs://mybucket1/path/to/file1.tar.gz\",\n        \"gs://mybucket2/path/to/file2.tar.gz\"\n      ],\n      \"keep_input_artifact\": true\n    }\n  ]\n}\n```\n\n\n**HCL2**\n\n```hcl\n\n  source \"googlecompute\" \"example\" {\n    account_file = \"account.json\"\n    project_id = \"my-project\"\n    source_image = \"debian-7-wheezy-v20150127\"\n    zone = \"us-central1-a\"\n  }\n\n  build {\n    sources = [\"source.googlecompute.example\"]\n\n    post-processor \"googlecompute-export\" {\n      paths = [\n        \"gs://mybucket1/path/to/file1.tar.gz\",\n        \"gs://mybucket2/path/to/file2.tar.gz\"\n      ]\n      keep_input_artifact = true\n    }\n  }\n```\n","created_at":"2023-10-24T14:02:23.951Z","updated_at":"2023-10-24T14:02:23.951Z","name":"Google Cloud Platform Image Exporter","slug":"googlecompute-export","component":{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.157Z","updated_at":"2023-07-26T17:26:54.831Z"},"variable_groups":[]}]},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Integrations","url":"/packer/integrations"},{"title":"Google Cloud Platform","url":"/packer/integrations/hashicorp/googlecompute","isCurrentPage":true}],"anchorLinks":[{"id":"installation","level":3,"title":"Installation"},{"id":"components","level":3,"title":"Components"},{"id":"builders","level":4,"title":"Builders"},{"id":"post-processors","level":4,"title":"Post-Processors"},{"id":"authentication","level":3,"title":"Authentication"},{"id":"running-locally-on-your-workstation.","level":4,"title":"Running locally on your workstation."},{"id":"running-on-google-cloud","level":4,"title":"Running on Google Cloud"},{"id":"running-outside-of-google-cloud","level":4,"title":"Running outside of Google Cloud"},{"id":"precedence-of-authentication-methods","level":4,"title":"Precedence of Authentication Methods"},{"id":"examples","level":3,"title":"Examples"},{"id":"basic-example","level":4,"title":"Basic Example"},{"id":"windows-example","level":4,"title":"Windows Example"},{"id":"windows-over-winssh-example","level":4,"title":"Windows over WinSSH Example"},{"id":"windows-over-winssh-ansible-provisioner","level":4,"title":"Windows over WinSSH - Ansible Provisioner"},{"id":"nested-hypervisor-example","level":4,"title":"Nested Hypervisor Example"},{"id":"shared-vpc-example","level":4,"title":"Shared VPC Example"},{"id":"separate-image-project-example","level":4,"title":"Separate Image Project Example"}],"serializedREADME":{"compiledSource":"var N=Object.defineProperty,i=Object.defineProperties;var d=Object.getOwnPropertyDescriptors;var t=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;var r=(e,n,s)=\u003en in e?N(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,a=(e,n)=\u003e{for(var s in n||(n={}))o.call(n,s)\u0026\u0026r(e,s,n[s]);if(t)for(var s of t(n))c.call(n,s)\u0026\u0026r(e,s,n[s]);return e},m=(e,n)=\u003ei(e,d(n));var l=(e,n)=\u003e{var s={};for(var p in e)o.call(e,p)\u0026\u0026n.indexOf(p)\u003c0\u0026\u0026(s[p]=e[p]);if(e!=null\u0026\u0026t)for(var p of t(e))n.indexOf(p)\u003c0\u0026\u0026c.call(e,p)\u0026\u0026(s[p]=e[p]);return s};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(s){var p=s,{components:e}=p,n=l(p,[\"components\"]);return mdx(MDXLayout,m(a(a({},layoutProps),n),{components:e,mdxType:\"MDXLayout\"}),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"The Google compute Packer plugin lets you create custom images for use within Google Compute Engine (GCE).\"),mdx(\"h3\",a({},{id:\"user-content-installation\",\"data-text-content\":\"Installation\",className:\"g-type-display-4\"}),\"Installation\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"To install this plugin, copy and paste this code into your Packer configuration, then run \",mdx(\"a\",a({parentName:\"p\"},{href:\"https://www.packer.io/docs/commands/init\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"packer init\")),\".\"),mdx(\"pre\",a({},{className:\"language-hcl\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"packer\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"required_plugins\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"googlecompute\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"source\"),\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"github.com/hashicorp/googlecompute\"'),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"version\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"~\u003e 1\"'),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"Alternatively, you can use \",mdx(\"inlineCode\",{parentName:\"p\"},\"packer plugins install\"),\" to manage installation of this plugin.\"),mdx(\"pre\",a({},{className:\"language-sh\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-sh\"}),\"$ packer plugins install github.com/hashicorp/googlecompute\",`\n`)),mdx(\"h3\",a({},{id:\"user-content-components\",\"data-text-content\":\"Components\",className:\"g-type-display-4\"}),\"Components\"),mdx(\"h4\",a({},{id:\"user-content-builders\",\"data-text-content\":\"Builders\",className:\"g-type-display-5\"}),\"Builders\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",a({parentName:\"li\"},{href:\"/packer/integrations/hashicorp/googlecompute/latest/components/builder/googlecompute\"}),\"googlecompute\"),` - The\ngooglecompute builder creates images from existing ones, by launching an instance, provisioning it, then exporting\nit as a reusable image.`)),mdx(\"h4\",a({},{id:\"user-content-post-processors\",\"data-text-content\":\"Post-Processors\",className:\"g-type-display-5\"}),\"Post-Processors\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"a\",a({parentName:\"p\"},{href:\"/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import\"}),\"googlecompute-import\"),` -\nThe googlecompute-import post-processor imports an existing raw disk image, and imports it as a GCE image that can be\nused for launching instances from.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"a\",a({parentName:\"p\"},{href:\"/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-export\"}),\"googlecompute-export\"),` -\nThe googlecompute-export post-processor exports the image built by the googlecompute builder as a .tar.gz archive into Google\nCloud Storage (GCS).`))),mdx(\"h3\",a({},{id:\"user-content-authentication\",\"data-text-content\":\"Authentication\",className:\"g-type-display-4\"}),\"Authentication\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`Authenticating with Google Cloud services requires either a User Application Default Credentials,\na JSON Service Account Key or an Access Token.  These are `,mdx(\"strong\",{parentName:\"p\"},\"not\"),` required if you are\nrunning the `,mdx(\"inlineCode\",{parentName:\"p\"},\"googlecompute\"),` Packer builder on Google Cloud with a\nproperly-configured `,mdx(\"a\",a({parentName:\"p\"},{href:\"https://cloud.google.com/compute/docs/authentication\"}),`Google Service\nAccount`),\".\"),mdx(\"h4\",a({},{id:\"user-content-running-locally-on-your-workstation.\",\"data-text-content\":\"Running locally on your workstation\",className:\"g-type-display-5\"}),\"Running locally on your workstation.\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"If you run the \",mdx(\"inlineCode\",{parentName:\"p\"},\"googlecompute\"),` Packer builder locally on your workstation, you will\nneed to install the Google Cloud SDK and authenticate using `,mdx(\"a\",a({parentName:\"p\"},{href:\"https://cloud.google.com/sdk/gcloud/reference/auth/application-default\"}),`User Application Default\nCredentials`),`.\nYou don't need to specify an `,mdx(\"em\",{parentName:\"p\"},\"account file\"),` if you are using this method. Your user\nmust have at least `,mdx(\"inlineCode\",{parentName:\"p\"},\"Compute Instance Admin (v1)\"),\" \u0026 \",mdx(\"inlineCode\",{parentName:\"p\"},\"Service Account User\"),` roles\nto use Packer succesfully.`),mdx(\"h4\",a({},{id:\"user-content-running-on-google-cloud\",\"data-text-content\":\"Running on Google Cloud\",className:\"g-type-display-5\"}),\"Running on Google Cloud\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"If you run the \",mdx(\"inlineCode\",{parentName:\"p\"},\"googlecompute\"),` Packer builder on GCE or GKE, you can\nconfigure that instance or cluster to use a `,mdx(\"a\",a({parentName:\"p\"},{href:\"https://cloud.google.com/compute/docs/authentication\"}),`Google Service\nAccount`),`. This will allow\nPacker to authenticate to Google Cloud without having to bake in a separate\ncredential/authentication file.`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`It is recommended that you create a custom service account for Packer and assign it\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"Compute Instance Admin (v1)\"),\" \u0026 \",mdx(\"inlineCode\",{parentName:\"p\"},\"Service Account User\"),\" roles.\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"For \",mdx(\"inlineCode\",{parentName:\"p\"},\"gcloud\"),\", you can run the following commands:\"),mdx(\"pre\",a({},{className:\"language-shell-session\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"gcloud iam service-accounts create packer \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --project YOUR_GCP_PROJECT \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --description\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"Packer Service Account\"'),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --display-name\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"Packer Service Account\"'))),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"    --member\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"    --role\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"roles/compute.instanceAdmin.v1\")),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"    --member\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"    --role\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"roles/iam.serviceAccountUser\")),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"    --member\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"    --role\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"roles/iap.tunnelResourceAccessor\")),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"gcloud compute instances create \",mdx(\"span\",a({parentName:\"span\"},{className:\"token environment constant\"}),\"INSTANCE\"),\"-NAME \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --project YOUR_GCP_PROJECT \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --image-family ubuntu-2004-lts \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --image-project ubuntu-os-cloud \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --network YOUR_GCP_NETWORK \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --zone YOUR_GCP_ZONE \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --service-account\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"\\\\\"))),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token bash language-bash\"}),\"  --scopes\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"https://www.googleapis.com/auth/cloud-platform\"'))),`\n`)),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},`The service account will be used automatically by Packer as long as there is\nno `,mdx(\"em\",{parentName:\"strong\"},\"account file\"),\" specified in the Packer configuration file.\")),mdx(\"h4\",a({},{id:\"user-content-running-outside-of-google-cloud\",\"data-text-content\":\"Running outside of Google Cloud\",className:\"g-type-display-5\"}),\"Running outside of Google Cloud\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"The \",mdx(\"a\",a({parentName:\"p\"},{href:\"https://console.cloud.google.com\"}),\"Google Cloud Console\"),` allows\nyou to create and download a credential file that will let you use the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"googlecompute\"),` Packer builder anywhere. To make the process more\nstraightforwarded, it is documented here.`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Log into the \",mdx(\"a\",a({parentName:\"p\"},{href:\"https://console.cloud.google.com/iam-admin/serviceaccounts\"}),`Google Cloud\nConsole`),\" and select a project.\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click Select a project, choose your project, and click Open.\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click Create Service Account.\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enter a service account name (friendly display name), an optional description, select the \",mdx(\"inlineCode\",{parentName:\"p\"},\"Compute Engine Instance Admin (v1)\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"Service Account User\"),\" roles, and then click Save.\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Generate a JSON Key and save it in a secure location.\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Set the Environment Variable \",mdx(\"inlineCode\",{parentName:\"p\"},\"GOOGLE_APPLICATION_CREDENTIALS\"),\" to point to the path of the service account key.\"))),mdx(\"h4\",a({},{id:\"user-content-precedence-of-authentication-methods\",\"data-text-content\":\"Precedence of Authentication Methods\",className:\"g-type-display-5\"}),\"Precedence of Authentication Methods\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`Packer looks for credentials in the following places, preferring the first\nlocation found:`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"An \",mdx(\"inlineCode\",{parentName:\"p\"},\"access_token\"),\" option in your packer file.\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"An \",mdx(\"inlineCode\",{parentName:\"p\"},\"account_file\"),\" option in your packer file.\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),`A JSON file (Service Account) whose path is specified by the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"GOOGLE_APPLICATION_CREDENTIALS\"),\" environment variable.\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"A JSON file in a location known to the \",mdx(\"inlineCode\",{parentName:\"p\"},\"gcloud\"),` command-line tool.\n(`,mdx(\"inlineCode\",{parentName:\"p\"},\"gcloud auth application-default login\"),\" creates it)\"),mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"On Windows, this is:\"),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},\"%APPDATA%/gcloud/application_default_credentials.json\",`\n`)),mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),\"On other systems:\"),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},\"$HOME/.config/gcloud/application_default_credentials.json\",`\n`))),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",a({parentName:\"li\"},{className:\"g-type-long-body\"}),`On Google Compute Engine and Google App Engine Managed VMs, it fetches\ncredentials from the metadata server. (Needs a correct VM authentication\nscope configuration, see above.)`))),mdx(\"h3\",a({},{id:\"user-content-examples\",\"data-text-content\":\"Examples\",className:\"g-type-display-4\"}),\"Examples\"),mdx(\"h4\",a({},{id:\"user-content-basic-example\",\"data-text-content\":\"Basic Example\",className:\"g-type-display-5\"}),\"Basic Example\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`Below is a fully functioning example. It doesn't do anything useful since no\nprovisioners or startup-script metadata are defined, but it will effectively\nrepackage an existing GCE image.`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"JSON\")),mdx(\"pre\",a({},{className:\"language-json\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"builders\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"project_id\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my project\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"source_image\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"debian-9-stretch-v20200805\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"ssh_username\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"zone\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"HCL2\")),mdx(\"pre\",a({},{className:\"language-hcl\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-hcl\"}),\"source \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"basic-example\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"project_id\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my project\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"source_image\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"debian-9-stretch-v20200805\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"ssh_username\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"zone\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"build\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"sources\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"sources.googlecompute.basic-example\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h4\",a({},{id:\"user-content-windows-example\",\"data-text-content\":\"Windows Example\",className:\"g-type-display-5\"}),\"Windows Example\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`Before you can provision using the winrm communicator, you need to allow\ntraffic through google's firewall on the winrm port (tcp:5986). You can do so\nusing the gcloud command.`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},\"gcloud compute firewall-rules create allow-winrm --allow tcp:5986\",`\n`)),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"Or alternatively by navigating to \",mdx(\"a\",a({parentName:\"p\"},{href:\"https://console.cloud.google.com/networking/firewalls/list\"}),\"https://console.cloud.google.com/networking/firewalls/list\"),\".\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`Once this is set up, the following is a complete working packer config after\nsetting a valid `,mdx(\"inlineCode\",{parentName:\"p\"},\"project_id\"),\":\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"JSON\")),mdx(\"pre\",a({},{className:\"language-json\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"builders\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"project_id\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my project\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"source_image\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"windows-server-2019-dc-v20200813\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"disk_size\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"50\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"machine_type\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"n1-standard-2\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"communicator\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"winrm\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"winrm_username\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer_user\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"winrm_insecure\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token boolean\"}),\"true\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"winrm_use_ssl\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token boolean\"}),\"true\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"metadata\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"        \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"sysprep-specialize-script-cmd\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"winrm quickconfig -quiet \u0026 net user /add packer_user \u0026 net localgroup administrators packer_user /add \u0026 winrm set winrm/config/service/auth @{Basic=\\\\\"true\\\\\"}\"'),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"zone\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"HCL2\")),mdx(\"pre\",a({},{className:\"language-hcl\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-hcl\"}),\"source \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"windows-example\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"project_id\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"MY_PROJECT\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"source_image\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"windows-server-2019-dc-v20200813\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"zone\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"disk_size\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"50\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"machine_type\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"n1-standard-2\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"communicator\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"winrm\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"winrm_username\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer_user\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"winrm_insecure\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token boolean\"}),\"true\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"winrm_use_ssl\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token boolean\"}),\"true\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"metadata\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"sysprep-specialize-script-cmd\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"winrm quickconfig -quiet \u0026 net user /add packer_user \u0026 net localgroup administrators packer_user /add \u0026 winrm set winrm/config/service/auth @{Basic=\\\\\"true\\\\\"}\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"build\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"sources\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"sources.googlecompute.windows-example\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"div\",a({},{className:\"alert alert-info g-type-body\"}),mdx(\"p\",a({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"Warning:\"),` Please note that if you're setting up WinRM for provisioning, you'll probably want to turn it off or restrict its permissions as part of a shutdown script at the end of Packer's provisioning process. For more details on the why/how, check out this useful blog post and the associated code:\n`,mdx(\"a\",a({parentName:\"p\"},{href:\"https://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/\"}),\"https://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/\"))),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"This build can take up to 15 min.\"),mdx(\"h4\",a({},{id:\"user-content-windows-over-winssh-example\",\"data-text-content\":\"Windows over WinSSH Example\",className:\"g-type-display-5\"}),\"Windows over WinSSH Example\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`The following uses Windows SSH as backend communicator\n`,mdx(\"a\",a({parentName:\"p\"},{href:\"https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse\"}),\"https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse\")),mdx(\"pre\",a({},{className:\"language-hcl\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-hcl\"}),\"source \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"windows-ssh-example\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"project_id\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"MY_PROJECT\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"source_image\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"windows-server-2019-dc-v20200813\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"zone\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-east4-a\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"disk_size\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"50\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"machine_type\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"n1-standard-2\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"communicator\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"ssh\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"ssh_username\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.packer_username\",`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"ssh_password\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.packer_user_password\",`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"ssh_timeout\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"1h\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"metadata\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"sysprep-specialize-script-cmd\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"net user ',mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token type variable\"}),\"packer_username\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),' \\\\\"',mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token type variable\"}),\"packer_user_password\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'\\\\\" /add /y \u0026 wmic UserAccount where Name=\\\\\"',mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token type variable\"}),\"packer_username\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'\\\\\" set PasswordExpires=False \u0026 net localgroup administrators ',mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token type variable\"}),\"packer_username\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),` /add \u0026 powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 \u0026 powershell Start-Service sshd \u0026 powershell Set-Service -Name sshd -StartupType 'Automatic' \u0026 powershell New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 \u0026 powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \\\\\"Set-ExecutionPolicy -ExecutionPolicy bypass -Force\\\\\"\"`),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"build\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"sources\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"sources.googlecompute.windows-ssh-example\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"provisioner\",mdx(\"span\",a({parentName:\"span\"},{className:\"token type variable\"}),' \"powershell\" ')),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"script\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"../scripts/install-features.ps1\"'),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"elevated_user\"),\"     \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.packer_username\",`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"elevated_password\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.packer_user_password\",`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h4\",a({},{id:\"user-content-windows-over-winssh-ansible-provisioner\",\"data-text-content\":\"Windows over WinSSH - Ansible Provisioner\",className:\"g-type-display-5\"}),\"Windows over WinSSH - Ansible Provisioner\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),`The following uses Windows SSH as backend communicator\n`,mdx(\"a\",a({parentName:\"p\"},{href:\"https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse\"}),\"https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse\"),`\nwith a private key.`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"The \",mdx(\"inlineCode\",{parentName:\"li\"},\"sysprep-specialize-script-cmd\"),\" creates the \",mdx(\"inlineCode\",{parentName:\"li\"},\"packer_user\"),\" and adds it to the local administrators group and configures the ssh key, firewall rule and required permissions.\")),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},'source \"googlecompute\" \"windows-ssh-ansible\" {',`\n`,\"  project_id              = var.project_id\",`\n`,'  source_image            = \"windows-server-2019-dc-v20200813\"',`\n`,'  zone                    = \"us-east4-a\"',`\n`,\"  disk_size               = 50\",`\n`,'  machine_type            = \"n1-standard-8\"',`\n`,'  communicator            = \"ssh\"',`\n`,\"  ssh_username            = var.packer_username\",`\n`,\"  ssh_private_key_file    = var.ssh_key_file_path\",`\n`,'  ssh_timeout             = \"1h\"',`\n`,\"  \",`\n`,\"  metadata = {\",`\n`,`    sysprep-specialize-script-cmd = \"net user \\${var.packer_username} \\\\\"\\${var.packer_user_password}\\\\\" /add /y \u0026 wmic UserAccount where Name=\\\\\"\\${var.packer_username}\\\\\" set PasswordExpires=False \u0026 net localgroup administrators \\${var.packer_username} /add \u0026 powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 \u0026 echo \\${var.ssh_pub_key} \u003e C:\\\\\\\\ProgramData\\\\\\\\ssh\\\\\\\\administrators_authorized_keys \u0026 icacls.exe \\\\\"C:\\\\\\\\ProgramData\\\\\\\\ssh\\\\\\\\administrators_authorized_keys\\\\\" /inheritance:r /grant \\\\\"Administrators:F\\\\\" /grant \\\\\"SYSTEM:F\\\\\" \u0026 powershell New-ItemProperty -Path \\\\\"HKLM:\\\\\\\\SOFTWARE\\\\\\\\OpenSSH\\\\\" -Name DefaultShell -Value \\\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\WindowsPowerShell\\\\\\\\v1.0\\\\\\\\powershell.exe\\\\\" -PropertyType String -Force  \u0026 powershell Start-Service sshd \u0026 powershell Set-Service -Name sshd -StartupType 'Automatic' \u0026 powershell New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 \u0026 powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \\\\\"Set-ExecutionPolicy -ExecutionPolicy bypass -Force\\\\\"\"`,`\n`,\"  }\",`\n`,\"  account_file = var.account_file_path\",`\n`,`\n`,\"}\",`\n`,`\n`,\"build {\",`\n`,'  sources = [\"sources.googlecompute.windows-ssh-ansible\"]',`\n`,`\n`,'  provisioner \"ansible\" {',`\n`,'    playbook_file           = \"./playbooks/playbook.yml\"',`\n`,\"    use_proxy               = false\",`\n`,'    ansible_ssh_extra_args  = [\"-o StrictHostKeyChecking=no -o IdentitiesOnly=yes\"]',`\n`,'    ssh_authorized_key_file = \"var.public_key_path\"',`\n`,'    extra_arguments = [\"-e\", \"win_packages=${var.win_packages}\",',`\n`,'      \"-e\",',`\n`,'      \"ansible_shell_type=powershell\",',`\n`,'      \"-e\",',`\n`,'      \"ansible_shell_executable=None\",',`\n`,'      \"-e\",',`\n`,'      \"ansible_shell_executable=None\"',`\n`,\"    ]\",`\n`,\"    user = var.packer_username\",`\n`,\"  }\",`\n`,`\n`,\"}\",`\n`,`\n`)),mdx(\"h4\",a({},{id:\"user-content-nested-hypervisor-example\",\"data-text-content\":\"Nested Hypervisor Example\",className:\"g-type-display-5\"}),\"Nested Hypervisor Example\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"This is an example of using the \",mdx(\"inlineCode\",{parentName:\"p\"},\"image_licenses\"),` configuration option to create\na GCE image that has nested virtualization enabled. See `,mdx(\"a\",a({parentName:\"p\"},{href:\"https://cloud.google.com/compute/docs/instances/enable-nested-virtualization-vm-instances\"}),`Enabling Nested\nVirtualization for VM\nInstances`),`\nfor details.`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"JSON\")),mdx(\"pre\",a({},{className:\"language-json\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"builders\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"project_id\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my project\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"source_image_family\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"centos-7\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"ssh_username\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"zone\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"image_licenses\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"projects/vm-options/global/licenses/enable-vmx\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"HCL2\")),mdx(\"pre\",a({},{className:\"language-hcl\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-hcl\"}),\"source \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"basic-example\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"project_id\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my project\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"source_image_family\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"centos-7\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"ssh_username\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"zone\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"image_licenses\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"projects/vm-options/global/licenses/enable-vmx\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"build\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"sources\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"sources.googlecompute.basic-example\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h4\",a({},{id:\"user-content-shared-vpc-example\",\"data-text-content\":\"Shared VPC Example\",className:\"g-type-display-5\"}),\"Shared VPC Example\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"This is an example of using the \",mdx(\"inlineCode\",{parentName:\"p\"},\"network_project_id\"),` configuration option to create\na GCE instance in a Shared VPC Network. See `,mdx(\"a\",a({parentName:\"p\"},{href:\"https://cloud.google.com/vpc/docs/provisioning-shared-vpc#creating_an_instance_in_a_shared_subnet\"}),`Creating a GCE Instance using Shared\nVPC`),`\nfor details. The user/service account running Packer must have `,mdx(\"inlineCode\",{parentName:\"p\"},\"Compute Network User\"),` role on\nthe Shared VPC Host Project to create the instance in addition to the other roles mentioned in the\nRunning on Google Cloud section.`),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"JSON\")),mdx(\"pre\",a({},{className:\"language-json\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"builders\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"project_id\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my project\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"subnetwork\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"default\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"source_image_family\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"centos-7\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"network_project_id\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"SHARED_VPC_PROJECT\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"ssh_username\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"zone\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"image_licenses\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"projects/vm-options/global/licenses/enable-vmx\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"HCL2\")),mdx(\"pre\",a({},{className:\"language-hcl\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-hcl\"}),\"source \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"sharedvpc-example\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"project_id\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my project\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"source_image_family\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"centos-7\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"subnetwork\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"default\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"network_project_id\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"SHARED_VPC_PROJECT\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"ssh_username\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"zone\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"image_licenses\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"projects/vm-options/global/licenses/enable-vmx\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"build\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"sources\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"sources.googlecompute.sharedvpc-example\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h4\",a({},{id:\"user-content-separate-image-project-example\",\"data-text-content\":\"Separate Image Project Example\",className:\"g-type-display-5\"}),\"Separate Image Project Example\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),\"This is an example of using the \",mdx(\"inlineCode\",{parentName:\"p\"},\"image_project_id\"),` configuration option to create\nthe generated image in a different GCP project than the one used to create the virtual machine. Make sure that Packer has permission in the target project to manage images, the `,mdx(\"inlineCode\",{parentName:\"p\"},\"Compute Storage Admin\"),\" role will grant the desired permissions.\"),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"JSON\")),mdx(\"pre\",a({},{className:\"language-json\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"builders\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"project_id\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my project\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"image_project_id\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my image target project\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"source_image\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"debian-9-stretch-v20200805\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"ssh_username\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),'\"zone\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),`\n`,\"    \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",a({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"HCL2\")),mdx(\"pre\",a({},{className:\"language-hcl\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-hcl\"}),\"source \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"googlecompute\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"basic-example\"'),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"project_id\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my project\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"image_project_id\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"my image target project\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"source_image\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"debian-9-stretch-v20200805\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"ssh_username\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"packer\"'),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"zone\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"us-central1-a\"'),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"build\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token property\"}),\"sources\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"sources.googlecompute.basic-example\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)))}MDXContent.isMDXComponent=!0;\n","scope":{}}},"__N_SSG":true},"page":"/[productSlug]/integrations/[organizationSlug]/[integrationSlug]","query":{"productSlug":"packer","organizationSlug":"hashicorp","integrationSlug":"googlecompute"},"buildId":"VGXTUm1VCSgK23NSRIBql","assetPrefix":"/hashicorp-packer","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-warning.js"><\x2fscript>');</script></body></html>