<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Google Cloud Platform | Integrations | Packer | HashiCorp Developer</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE."/><meta name="twitter:description" content="The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE."/><meta property="og:site_name" content="Google Cloud Platform | Integrations | Packer | HashiCorp Developer"/><meta property="og:title" content="Google Cloud Platform | Integrations | Packer | HashiCorp Developer"/><meta property="og:image" content="https://developer.hashicorp.com/og-image/packer.jpg"/><link rel="canonical" href="https://developer.hashicorp.com/packer/integrations/hashicorp/googlecompute"/><link rel="icon" href="/favicon.ico" sizes="any"/><link rel="icon" href="/icon.svg" type="image/svg+xml"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="google-site-verification" content="zRQZqfAsOX-ypXfU0mzAIzb5rUvj5fA4Zw2jWJRN-JI"/><meta name="zd-site-verification" content="xnvnvv1i0wl4tf0pzaymb" data-product="hcp"/><meta name="zd-site-verification" content="36fp2i1pj67d8cjtzf4fi9" data-product="terraform"/><meta name="zd-site-verification" content="nbe87kfyp1sck7b13vj1i" data-product="packer"/><meta name="zd-site-verification" content="wvsmmqa1cfb9am9zlwfj" data-product="consul"/><meta name="zd-site-verification" content="cw22oopfwr68ujj0n5pn9i" data-product="boundary"/><meta name="zd-site-verification" content="lkslvganwfgfqfwpdeicgh" data-product="vault"/><meta name="zd-site-verification" content="jl2wp2hoej9rz6c8rmqdns" data-product="nomad"/><meta name="zd-site-verification" content="2eb0cu6xceo73t0038m0tb" data-product="waypoint"/><meta name="zd-site-verification" content="n52xisxdf3higs2q9kuogd" data-product="vagrant"/><meta name="twitter:image" content="https://developer.hashicorp.com/og-image/packer.jpg"/><link rel="prefetch" href="https://www.datadoghq-browser-agent.com/datadog-rum-v4.js"/><script type="application/ld+json">[{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Developer","item":"https://developer.hashicorp.com/"},{"@type":"ListItem","position":2,"name":"Packer","item":"https://developer.hashicorp.com/packer"},{"@type":"ListItem","position":3,"name":"Integrations","item":"https://developer.hashicorp.com/packer/integrations"},{"@type":"ListItem","position":4,"name":"Google Cloud Platform","item":"https://developer.hashicorp.com/packer/integrations/hashicorp/googlecompute"}]}]</script><meta name="next-head-count" content="31"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/62f3294bfc989add.css" as="style"/><link rel="stylesheet" href="/_next/static/css/62f3294bfc989add.css" data-n-g=""/><link rel="preload" href="/_next/static/css/dcb6e784b5764eb2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/dcb6e784b5764eb2.css" data-n-p=""/><link rel="preload" href="/_next/static/css/18ed324149c36ad6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/18ed324149c36ad6.css" data-n-p=""/><link rel="preload" href="/_next/static/css/fc1808d4a21f9a59.css" as="style"/><link rel="stylesheet" href="/_next/static/css/fc1808d4a21f9a59.css" data-n-p=""/><link rel="preload" href="/_next/static/css/d84fe9967a765e18.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d84fe9967a765e18.css" data-n-p=""/><link rel="preload" href="/_next/static/css/f2ebb3ebd6012437.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f2ebb3ebd6012437.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-f861fd4ab584f5dc.js" defer=""></script><script src="/_next/static/chunks/framework-56eb74ff06128874.js" defer=""></script><script src="/_next/static/chunks/main-0785f91db64576b8.js" defer=""></script><script src="/_next/static/chunks/pages/_app-49535d849d7ff472.js" defer=""></script><script src="/_next/static/chunks/832-1733acefac904547.js" defer=""></script><script src="/_next/static/chunks/1122-3f2be94f653ef8d7.js" defer=""></script><script src="/_next/static/chunks/5973-f4f8c1167cd72fd3.js" defer=""></script><script src="/_next/static/chunks/1306-699e21fe04afb846.js" defer=""></script><script src="/_next/static/chunks/5888-731e387770363bca.js" defer=""></script><script src="/_next/static/chunks/563-ec2e839822df3139.js" defer=""></script><script src="/_next/static/chunks/7963-cdf3ff11e5b4f7ec.js" defer=""></script><script src="/_next/static/chunks/9325-e0903af1b37d2118.js" defer=""></script><script src="/_next/static/chunks/2291-52f1771184c676af.js" defer=""></script><script src="/_next/static/chunks/1825-58a66b9e99dc9bcd.js" defer=""></script><script src="/_next/static/chunks/7775-e851d12df43ee2d5.js" defer=""></script><script src="/_next/static/chunks/6075-8fa8c2611ee20dbb.js" defer=""></script><script src="/_next/static/chunks/2642-29fe7da9d3d5571c.js" defer=""></script><script src="/_next/static/chunks/pages/%5BproductSlug%5D/integrations/%5BorganizationSlug%5D/%5BintegrationSlug%5D-613eb74b89e41229.js" defer=""></script><script src="/_next/static/QZMQfpnfAAfunlkxD2A4N/_buildManifest.js" defer=""></script><script src="/_next/static/QZMQfpnfAAfunlkxD2A4N/_ssgManifest.js" defer=""></script></head><body><script>!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://artemis.hashicorp.com/script/"+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics._cdn="https://artemis.hashicorp.com";analytics.SNIPPET_VERSION="4.1.0";}}();</script><div id="__next"><div class="style_root__dZhZu style_vagrant__u39kD style_isShown__D4mb6"><a href="https://www.hashicorp.com/blog/hashicorp-joins-ibm" class="style_linkElem__hCESK"><span class="style_textContainer__6CuI7 g-grid-container"><span class="style_tag__jbHGz g-type-body-small-x-strong">News<!-- --> </span><span class="style_text__rwS0u g-type-body-small">HashiCorp to join IBM to accelerate multi-cloud automation.<span class="style_linkText__E8GJf g-type-body-small-x-strong"> <!-- -->Read the blog â†’</span></span></span></a><button class="style_closeButton__57J9w"><div><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 20 20"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 5 5 15M5 5l10 10"/></svg></div><span style="position:absolute;border:0;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;word-wrap:normal">Dismiss alert</span></button></div><script type="text/javascript">
(function checkDismissAlertBanner() {
  try {
    if (document.cookie.includes('banner_hashicorp-to-join-ibm-to-accelerate-multi-cloud-automation.=1')) {
      const element = document.querySelector('.style_root__dZhZu')
      element.classList.remove('style_isShown__D4mb6')
    }
  } catch (_) {
    // do nothing
  }
})()
</script><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="core-dev-dot-layout_root__MT1PZ"><div class="base-layout_root___qiZs" data-layout="base-new"><div class="base-layout_header__XhkxS"><header class="navigation-header_root__oE_HT"><div class="navigation-header_leftSide__V0xlc"><div class="product-page-content_productsDropdown__haUyw"><div class="dropdown-menu_root__Hwy5S"><div class="dropdown-menu_activatorWrapper__LxPRt"><button aria-controls="navigation-header-menu-react-aria-1" aria-expanded="false" aria-label="Main menu" class="dropdown-menu_activator__xXb00 g-focus-ring-from-box-shadow-dark product-page-content_productsDropdownButton__bnKKs" data-heap-track="navigation-header-dropdown-menu-activator"><span class="dropdown-menu_activatorLeadingIcon__YQQlH"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true" class="product-page-content_productsDropdownIcon__gXtly"><g fill="currentColor"><path d="M10.336 1.5L2 6.268v11.456l3.131 1.793V8.061l5.205-2.979V1.5z"></path><path d="M13.664 1.5v9.123h-3.328V7.219L7.203 9.012V20.7l3.133 1.796V13.4h3.328v3.381l3.131-1.793V3.293L13.664 1.5z"></path><path d="M22 17.732L13.664 22.5v-3.582l5.203-2.98V4.484L22 6.276v11.456z"></path></g></svg></span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="dropdown-menu_activatorTrailingIcon__r_cCd"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button></div><div class="dropdown-menu_dropdownContainer__AZWxN product-page-content_productsDropdownPane__bcdWz" id="navigation-header-menu-react-aria-1" style="display:none"><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M7.846 2.574a.25.25 0 01.308 0l5.25 4.12a.25.25 0 01.096.196v7.36a.75.75 0 001.5 0V6.89a1.75 1.75 0 00-.67-1.377L9.08 1.394a1.75 1.75 0 00-2.16 0l-5.25 4.12A1.75 1.75 0 001 6.89v7.36a.75.75 0 001.5 0V6.89a.25.25 0 01.096-.196l5.25-4.12z"></path><path d="M6.5 14.25V10.5h3v3.75a.75.75 0 001.5 0v-4C11 9.56 10.44 9 9.75 9h-3.5C5.56 9 5 9.56 5 10.25v4a.75.75 0 001.5 0z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Developer</span></div></div></a></li></ul><hr class="dropdown-menu_itemGroupDivider__X38aR"/><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/hcp"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Cloud Platform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/terraform"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-terraform-brand)"><path d="M1 0v5.05l4.349 2.527V2.526L1 0zM10.175 5.344l-4.35-2.525v5.05l4.35 2.527V5.344zM10.651 10.396V5.344L15 2.819v5.05l-4.349 2.527zM10.174 16l-4.349-2.526v-5.05l4.349 2.525V16z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Terraform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/packer"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Packer</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/consul"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Consul</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/vault"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-vault-brand)" d="M0 0l7.971 15.516L16 0H0zm6.732 6.16h-1.27V4.89h1.27v1.27zm0-1.906h-1.27V2.985h1.27v1.269zm1.904 3.81h-1.27v-1.27h1.27v1.27zm0-1.905h-1.27V4.89h1.27v1.27zm0-1.905h-1.27V2.985h1.27v1.269zm1.894 1.905H9.26V4.89h1.27v1.27zM9.26 4.254V2.985h1.27v1.269H9.26z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vault</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/boundary"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-boundary-brand)"><path d="M4.81 15v-1.085h2.25v-.67H5.968v-1.093h5.149L8.726 8l2.392-4.154H5.84v5.76H3V1h9.775l1.631 2.832L12.006 8l2.448 4.252L12.872 15H4.81z"></path><path d="M5.248 12.152h-1.09v1.092h1.09v-1.092zM3 13.907h1.09v1.092H3v-1.092z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Boundary</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/nomad"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-nomad-brand)" d="M8 0L1 4v8l7 4 7-4V4L8 0zm3.119 8.797L9.254 9.863 7.001 8.65v2.549l-2.118 1.33v-5.33l1.68-1.018 2.332 1.216V4.794l2.23-1.322-.006 5.325z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Nomad</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/waypoint"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-waypoint-brand)"><path d="M4 5.312h1.334L10 13.4l3.334-5.777L10.666 3H8l2.666 4.623L10 8.778 6.667 3H0l6 10.4 1.333-2.31L4 5.311zM14.002 6.463L16 3h-3.996l1.998 3.463z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Waypoint</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" aria-describedby="" href="/vagrant"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="#1868F2" d="M13.08.75L9.924 2.58v1.123L8 8.245 6.076 3.703V2.58L2.92.75 1 1.864v1.293l4.276 10.514L8 15.25l2.724-1.579L15 3.157V1.864L13.08.75z"></path><path fill="#0850C5" d="M15 1.865l-3.157 1.829v1.124L9.28 10.57 8 11.312v3.939l2.724-1.579L15 3.158V1.865zM6.076 3.703V2.58l-1.92 1.113v1.125l2.564 5.751L8 9.827V8.245L6.076 3.703z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vagrant</span></div></div></a></li></ul></div></div></div><div class="product-page-content_productLinkAndNav__YTzcr"><a aria-label="Packer home" class="product-icon-text-link_root__bNTSz g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-product-logo-link" aria-describedby="" href="/packer"><div class="product-icon-text-lockup_root__358wV"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="product-icon-text-lockup_icon__Zp_5o"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="product-icon-text-lockup_text__nHTL7 hds-typography-body-200">Packer</span></div></a><nav class="nav-bar-list-container_nav__C_i0_"><ul class="nav-bar-list-container_ul___04HI"><li><a aria-label="Packer Install" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="" href="/packer/install"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Install</span></a></li><li><a aria-label="Packer Tutorials" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="" href="/packer/tutorials"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Tutorials</span></a></li><li><a aria-label="Packer Documentation" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="" href="/packer/docs"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Documentation</span></a></li><li><a aria-label="Packer Guides" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="" href="/packer/guides"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Guides</span></a></li><li><a aria-label="Packer Integrations" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="" href="/packer/integrations"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Integrations</span></a></li><li><a aria-label="Packer Try Cloud" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="opens-in-new-tab-label-react-aria-18" target="_blank" href="https://portal.cloud.hashicorp.com/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Try Cloud</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-18">(opens in new tab)</span></li></ul></nav></div></div><div class="navigation-header_rightSide___Vvh_"><button aria-label="Search" class="command-bar-activator_root__qgVMy g-focus-ring-from-box-shadow-dark"><span class="command-bar-activator_left__ATQTg"><span class="command-bar-activator_leadingIcon__jECP5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M7.25 2a5.25 5.25 0 103.144 9.455l2.326 2.325a.75.75 0 101.06-1.06l-2.325-2.326A5.25 5.25 0 007.25 2zM3.5 7.25a3.75 3.75 0 117.5 0 3.75 3.75 0 01-7.5 0z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular command-bar-activator_text__pTZN_">Search</span></span><span class="command-bar-activator_right__XejfJ"><span class="g-screen-reader-only">Command or control key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="cmd-ctrl-icon_root___TToz"><svg xmlns="http://www.w3.org/2000/svg" width="41" height="11" fill="none" viewBox="0 0 41 11"><path fill="#fff" fill-rule="evenodd" d="M4.125 2.063V3h2.25v-.937a2.062 2.062 0 1 1 2.063 2.062H7.5v2.25h.938a2.062 2.062 0 1 1-2.063 2.063V7.5h-2.25v.938a2.062 2.062 0 1 1-2.062-2.063H3v-2.25h-.937a2.062 2.062 0 1 1 2.062-2.062m-2.062-.938a.937.937 0 1 0 0 1.875H3v-.937a.937.937 0 0 0-.937-.938M7.5 7.5v.938a.937.937 0 1 0 .938-.938zM6.375 6.375v-2.25h-2.25v2.25zM2.063 7.5H3v.938a.937.937 0 1 1-.937-.938M7.5 3h.938a.937.937 0 1 0-.938-.937z" clip-rule="evenodd"/><path fill="#fff" d="M15.09 10.5 18.085 0h-1.097L14 10.5zM26.387 5.308c-.183-1.445-1.263-2.534-3.05-2.534C21.264 2.774 20 4.247 20 6.61c0 2.41 1.27 3.89 3.344 3.89 1.76 0 2.86-1.034 3.043-2.5H25.02c-.184.808-.792 1.247-1.682 1.247-1.172 0-1.898-.994-1.898-2.637 0-1.61.72-2.583 1.898-2.583.942 0 1.518.555 1.681 1.281zM28.6 1.041v1.897h-1.133v1.178H28.6v4.281c0 1.432.622 2.007 2.186 2.007.275 0 .537-.034.766-.075V9.158c-.196.02-.32.034-.537.034-.7 0-1.008-.35-1.008-1.15V4.115h1.545V2.938h-1.545V1.041zM33.207 10.356h1.407V5.911c0-1.048.752-1.767 1.819-1.767.249 0 .667.048.785.082V2.842a3.372 3.372 0 0 0-.628-.054c-.93 0-1.721.527-1.924 1.26h-.105v-1.13h-1.354zM38.638 10.356h1.407V0h-1.407z"/></svg></div></span><span class="g-screen-reader-only">K key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="k-icon_root__a_5pR"><svg xmlns="http://www.w3.org/2000/svg" width="8" height="10" fill="none" viewBox="0 0 8 10"><path fill="#fff" d="M1.512 9.84v-3l.986-1.147L5.445 9.84h1.704L3.46 4.745 6.857.84H5.244L1.61 5.094h-.098V.84H.15v9z"/></svg></div></span></span></button><div class="navigation-header_authenticationControls__EP1LY"><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj"><button aria-controls="disclosure-react-aria-19-content" aria-expanded="false" aria-label="User menu" class="disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo navigation-header_userDropdownDisclosureActivator__RayIV g-focus-ring-from-box-shadow-dark activator_hasIcon__5HO6W g-focus-ring-from-box-shadow"><span class="activator_childrenWrapper__kaK0w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path fill-rule="evenodd" d="M12 3a5 5 0 100 10 5 5 0 000-10zM8.5 8a3.5 3.5 0 117 0 3.5 3.5 0 01-7 0z" clip-rule="evenodd"></path><path d="M7.75 14.5A4.75 4.75 0 003 19.25v1a.75.75 0 001.5 0v-1A3.25 3.25 0 017.75 16h8.5a3.25 3.25 0 013.25 3.25v1a.75.75 0 001.5 0v-1a4.75 4.75 0 00-4.75-4.75h-8.5z"></path></g></svg></span><span class="activator_chevronWrapper__4_AVG"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></span></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-19-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><button class="list-item_button__nXy5K g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign in</span></button></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" aria-describedby="" href="/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign up</span></a></li><li class="list-item_root__ZdUej"><hr class="list-item_separator__cBVLs"/></li><li class="list-item_root__ZdUej user-dropdown-switcher_listItem__Q_GIj hds-font-weight-medium"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-21">Theme</label></li></ul></div></div></div><button aria-label="Open navigation menu" class="navigation-header_mobileMenuButton__74S4w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path d="M2 5.75A.75.75 0 012.75 5h18.5a.75.75 0 010 1.5H2.75A.75.75 0 012 5.75zM2 11.75a.75.75 0 01.75-.75h18.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2.75 17a.75.75 0 000 1.5h18.5a.75.75 0 000-1.5H2.75z"></path></g></svg></button></div></header></div><div class="base-layout_contentArea__BMvQn"><div class="sidebar-sidecar-layout_root__h5rD8 sidebar-sidecar-layout_mainWidth-wide__TwGq8"><div class="mobile-menu-container_root__fPUFu sidebar-sidecar-layout_sidebarContainer__4fcF8"><div class="sidebar-sidecar-layout_sidebarContentWrapper__ftn5q"><div class="sidebar_sidebar___fTlC"><div class="sidebar_backToLinkWrapper__F6iLs"><div class="sidebar-back-to-link_root__z_Hj1"><a class="standalone-link_standaloneLink__ahuej g-focus-ring-from-box-shadow standalone-link_primary__ESNCA" data-heap-track="standalone-link sidebar-back-to-link" aria-describedby="" href="/packer/integrations"><div class="standalone-link_standaloneLinkContents__4I2XN standalone-link_medium__J2yVM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M10.795 3.235a.75.75 0 01-.03 1.06L6.842 8l3.923 3.705a.75.75 0 01-1.03 1.09l-4.5-4.25a.75.75 0 010-1.09l4.5-4.25a.75.75 0 011.06.03z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__7GEyG">Packer Integrations</span></div></a></div></div><nav aria-labelledby="sidebar-label" class="sidebar_nav__IworY" id="sidebar-nav"><div><h2 class="sidebar-headings_root__tGfxC" id="sidebar-label"></h2></div><ul class="sidebar_navList__4Rg4g"><li><a aria-current="page" class="sidebar-nav-highlight-item_root___pPhp g-focus-ring-from-box-shadow sidebar-nav-highlight-item_theme-packer__I5KHY" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="sidebar-nav-highlight-item_icon__G8JxG"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="sidebar-nav-highlight-item_text__VORFJ hds-typography-body-200">Google Cloud Platform</span></a></li><li><button aria-controls="undefined-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="undefined-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Builders</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="undefined-list"><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/latest/components/builder/googlecompute"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Google Cloud Platform</span></a></li></ul></li><li><button aria-controls="undefined-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="undefined-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Post-Processors</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="undefined-list"><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Google Cloud Platform Image Import</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-export"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Google Cloud Platform Image Exporter</span></a></li></ul></li></ul><hr class="sidebar-horizontal-rule_root__UY7oh"/><ul class="sidebar_navList__4Rg4g"><li><h3 class="sidebar-headings_root__tGfxC">Resources</h3></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" aria-describedby="" href="/tutorials/library?product=packer"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Tutorial Library</span></a></li><li><a aria-label="Community Forum. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-28" target="_blank" href="https://discuss.hashicorp.com/c/packer/23"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Community Forum</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-28">(opens in new tab)</span></li><li><a aria-label="Support. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-29" target="_blank" href="https://www.hashicorp.com/customer-success"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Support</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-29">(opens in new tab)</span></li><li><a aria-label="GitHub. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-30" target="_blank" href="https://github.com/hashicorp/packer"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">GitHub</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-30">(opens in new tab)</span></li></ul></nav></div></div></div><div class="sidebar-sidecar-layout_contentWrapper__Z5BK4"><div class="sidebar-sidecar-layout_paddedAreaWrapper___S_Ff"><div class="sidebar-sidecar-layout_breadcrumbContainer__3uz7P"><div class="sidebar-sidecar-layout_breadcrumbMaxWidth__coOcu"><nav aria-label="Breadcrumb" class="breadcrumb-bar_root__wd_C5"><ol class="breadcrumb-bar_listRoot__8eupO"><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" aria-describedby="" href="/">Developer</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" aria-describedby="" href="/packer">Packer</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" aria-describedby="" href="/packer/integrations">Integrations</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><span class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" aria-current="page" data-heap-track="breadcrumb-bar-item">Google Cloud Platform</span></li></ol></nav></div></div><div class="sidebar-sidecar-layout_mainAndSidecar__UDm3Z"><main id="main" class="sidebar-sidecar-layout_main__0SN51"><div class="hds-surface-base card_root__RyqjV content-header-card_contentHeaderCard__SDMMP style_header__b3NdM"><div class="content-header-card_cardTop__GTpii"><span class="icon-tile_root__ShC0s icon-tile_size-large__NxGIv icon-tile_color-packer__LRaQF content-header-card_icon__A1Xna"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><div class="content-header-card_content__XPCtf"><div class="content-header-card_upper__PQsUG"><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj content-header-card_dropdown__Gt1Vp g-hide-on-desktop g-hide-on-tablet"><button aria-controls="disclosure-react-aria-34-content" aria-expanded="false" class="button_root__itF9E hds-font-weight-medium button_medium__Cm2eg button_secondary__m5f7i disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo" data-heap-track="button " type="button"><span>v1.1.4 (latest)</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="activator_chevronWrapper__4_AVG"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-34-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/v1.1.3"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.1.3</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/v1.1.2"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.1.2</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/v1.1.1"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.1.1</span></a></li></ul></div></div><div class="content-header-card_left__FSNcW"><div class="content-header-card_titleWrap__IAC6o"><span class="content-header-card_title__HGHfo hds-typography-display-300 from global, hds-font-weight-bold">Google Cloud Platform</span><p class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium content-header-card_attribution__yKU4q">@hashicorp</p></div><p class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular content-header-card_description__M_DkB">The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE.</p></div><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj content-header-card_dropdown__Gt1Vp g-hide-on-mobile"><button aria-controls="disclosure-react-aria-38-content" aria-expanded="false" class="button_root__itF9E hds-font-weight-medium button_medium__Cm2eg button_secondary__m5f7i disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo" data-heap-track="button " type="button"><span>v1.1.4 (latest)</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="activator_chevronWrapper__4_AVG"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-38-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/v1.1.3"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.1.3</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/v1.1.2"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.1.2</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/v1.1.1"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.1.1</span></a></li></ul></div></div></div><div class="content-header-card_lower__ut_Dv"><ul class="badge-list_badgeList__l_z6s content-header-card_badgeList__I_FGK"><li class="badge-list_badge__mQSlF"><span data-state="tooltip-hidden" data-reach-tooltip-trigger=""><span class="g-screen-reader-only">Official</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral__NhUW0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg><span>Official</span></span></span></li><li class="badge-list_badge__mQSlF"><span data-state="tooltip-hidden" data-reach-tooltip-trigger=""><span class="g-screen-reader-only">HCP Ready</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral__NhUW0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9.78 7.28a.75.75 0 00-1.06-1.06l-.5.5a.75.75 0 001.06 1.06l.5-.5z"></path><path fill-rule="evenodd" d="M12.627 1.32a1.731 1.731 0 012.054 2.053c-.27 1.28-.686 3.19-1.103 4.859a3.625 3.625 0 01-.58 1.224c.002.015.002.03.002.044v2.441a1.75 1.75 0 01-.833 1.49l-2.021 1.244a1.75 1.75 0 01-2.284-.397l-1.27-1.587a2.028 2.028 0 01-1.08-.917 3.426 3.426 0 00-.542-.744 3.428 3.428 0 00-.744-.542c-.4-.223-.755-.61-.917-1.08l-1.587-1.27a1.75 1.75 0 01-.398-2.284l1.244-2.021A1.75 1.75 0 014.058 3H6.5l.044.001c.37-.263.777-.467 1.224-.579 1.669-.417 3.58-.833 4.859-1.103zm-5.43 9.956a.754.754 0 00-.167-.025.517.517 0 01-.209-.208 4.913 4.913 0 00-.79-1.073 4.913 4.913 0 00-1.074-.791.516.516 0 01-.208-.21.754.754 0 00-.025-.166l.002-.008c.255-.78.694-1.941 1.307-2.958.634-1.05 1.353-1.773 2.099-1.96 1.641-.41 3.53-.821 4.804-1.09a.231.231 0 01.277.277c-.269 1.274-.68 3.163-1.09 4.804-.187.746-.91 1.465-1.96 2.099-1.017.613-2.177 1.052-2.958 1.307a.173.173 0 01-.008.002zm1.139 1.193l.697.872a.25.25 0 00.327.057l2.021-1.244a.25.25 0 00.119-.213v-1.056c-.186.13-.375.252-.562.366-.88.53-1.832.936-2.602 1.218zM2.659 6.967l.872.697c.282-.77.687-1.722 1.218-2.602.113-.187.235-.376.366-.562H4.059a.25.25 0 00-.213.119L2.602 6.64a.25.25 0 00.057.327z" clip-rule="evenodd"></path><path d="M4.442 11.558a.625.625 0 010 .884l-2 2a.625.625 0 11-.884-.884l2-2a.625.625 0 01.884 0zM2.692 10.308a.625.625 0 010 .884l-.75.75a.625.625 0 11-.884-.884l.75-.75a.625.625 0 01.884 0zM5.692 14.192a.625.625 0 10-.884-.884l-.75.75a.625.625 0 10.884.884l.75-.75z"></path></g></svg><span>HCP Ready</span></span></span></li></ul><p class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular content-header-card_note__QTtmc">Updated 9 months ago</p></div></div></div><div class="content-header-card_cardBottom__ndKDE"><ul class="content-header-card_linksList__vaxQ3"><li class="content-header-card_link___8sUH"><a class="standalone-link_standaloneLink__ahuej g-focus-ring-from-box-shadow standalone-link_secondary__H0E0A" data-heap-track="standalone-link " rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-42" target="_blank" href="https://github.com/hashicorp/packer-plugin-googlecompute/tree/main/docs"><div class="standalone-link_standaloneLinkContents__4I2XN standalone-link_medium__J2yVM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M8 1C4.133 1 1 4.13 1 7.993c0 3.09 2.006 5.71 4.787 6.635.35.064.478-.152.478-.337 0-.166-.006-.606-.01-1.19-1.947.423-2.357-.937-2.357-.937-.319-.808-.778-1.023-.778-1.023-.635-.434.048-.425.048-.425.703.05 1.073.72 1.073.72.624 1.07 1.638.76 2.037.582.063-.452.244-.76.444-.935-1.554-.176-3.188-.776-3.188-3.456 0-.763.273-1.388.72-1.876-.072-.177-.312-.888.07-1.85 0 0 .586-.189 1.924.716A6.711 6.711 0 018 4.381c.595.003 1.194.08 1.753.236 1.336-.905 1.923-.717 1.923-.717.382.963.142 1.674.07 1.85.448.49.72 1.114.72 1.877 0 2.686-1.638 3.278-3.197 3.45.251.216.475.643.475 1.296 0 .934-.009 1.688-.009 1.918 0 .187.127.404.482.336A6.996 6.996 0 0015 7.993 6.997 6.997 0 008 1z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__7GEyG">GitHub</span></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-42">(opens in new tab)</span></li></ul></div></div><h1>Google Cloud Platform</h1><div class="style_readmeView__MsBqd"><div class="dev-dot-content_root__UJDct hds-typography-body-300"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The Google compute Packer plugin lets you create custom images for use within Google Compute Engine (GCE).</p><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-installation"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Installation permalink" href="/packer/integrations/hashicorp/googlecompute#installation"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Installation</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">To install this plugin, copy and paste this code into your Packer configuration, then run <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://www.packer.io/docs/commands/init"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">packer init</code></a>.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">packer</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">required_plugins</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">googlecompute</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">source</span>  <span class="token punctuation">=</span> <span class="token string">&quot;github.com/hashicorp/googlecompute&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;~&gt; 1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Alternatively, you can use <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">packer plugins install</code> to manage installation of this plugin.</p><div class="g-code-block style_root__i1k0c language-sh mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-sh mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-sh mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">$ packer plugins install github.com/hashicorp/googlecompute<!-- -->
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-components"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Components permalink" href="/packer/integrations/hashicorp/googlecompute#components"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Components</h3><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-builders"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Builders permalink" href="/packer/integrations/hashicorp/googlecompute#builders"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Builders</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/latest/components/builder/googlecompute">googlecompute</a> - The
googlecompute builder creates images from existing ones, by launching an instance, provisioning it, then exporting
it as a reusable image.</li></ul><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-post-processors"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Post-Processors permalink" href="/packer/integrations/hashicorp/googlecompute#post-processors"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Post-Processors</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import">googlecompute-import</a> -
The googlecompute-import post-processor imports an existing raw disk image, and imports it as a GCE image that can be
used for launching instances from.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-export">googlecompute-export</a> -
The googlecompute-export post-processor exports the image built by the googlecompute builder as a .tar.gz archive into Google
Cloud Storage (GCS).</p></li></ul><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-authentication"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Authentication permalink" href="/packer/integrations/hashicorp/googlecompute#authentication"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Authentication</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Authenticating with Google Cloud services requires either a User Application Default Credentials,
a JSON Service Account Key or an Access Token.  These are <strong>not</strong> required if you are
running the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">googlecompute</code> Packer builder on Google Cloud with a
properly-configured <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://cloud.google.com/compute/docs/authentication">Google Service
Account</a>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following options are available for the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">googlecompute</code> builder, the googlecompute-export<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">, and
the </code>googlecompute-import`:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">access_token</code> (string) - A temporary <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://developers.google.com/identity/protocols/oauth2">OAuth 2.0 access token</a>
obtained from the Google Authorization server, i.e. the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Authorization: Bearer</code> token used to
authenticate HTTP requests to GCP APIs.
This is an alternative to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">account_file</code>, and ignores the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">scopes</code> field.
If both are specified, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">access_token</code> will be used over the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">account_file</code> field.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">These access tokens cannot be renewed by Packer and thus will only work until they expire.
If you anticipate Packer needing access for longer than a token&#x27;s lifetime (default <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">1 hour</code>),
please use a service account key with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">account_file</code> instead.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">account_file</code> (string) - The JSON file containing your account credentials. Not required if you
run Packer on a GCE instance with a service account. Instructions for
creating the file or using service accounts are above.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">credentials_file</code> (string) - The JSON file containing your account credentials.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The file&#x27;s contents may be anything supported by the Google Go client, i.e.:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg">Service account JSON</li><li class="mdx-lists_listItem__nkqhg">OIDC-provided token for federation</li><li class="mdx-lists_listItem__nkqhg">Gcloud user credentials file (refresh-token JSON)</li><li class="mdx-lists_listItem__nkqhg">A Google Developers Console client_credentials.json</li></ul></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">credentials_json</code> (string) - The raw JSON payload for credentials.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The accepted data formats are same as those described under
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#credentials_file">credentials_file</a>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">impersonate_service_account</code> (string) - This allows service account impersonation as per the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://cloud.google.com/iam/docs/impersonating-service-accounts">docs</a>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vault_gcp_oauth_engine</code> (string) - Can be set instead of account_file. If set, this builder will use
HashiCorp Vault to generate an Oauth token for authenticating against
Google Cloud. The value should be the path of the token generator
within vault.
For information on how to configure your Vault + GCP engine to produce
Oauth tokens, see <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://www.vaultproject.io/docs/auth/gcp">https://www.vaultproject.io/docs/auth/gcp</a>
You must have the environment variables VAULT_ADDR and VAULT_TOKEN set,
along with any other relevant variables for accessing your vault
instance. For more information, see the Vault docs:
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://www.vaultproject.io/docs/commands/#environment-variables">https://www.vaultproject.io/docs/commands/#environment-variables</a>
Example:<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&quot;vault_gcp_oauth_engine&quot;: &quot;gcp/token/my-project-editor&quot;,</code></p></li></ul><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-running-locally-on-your-workstation."><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Running locally on your workstation permalink" href="/packer/integrations/hashicorp/googlecompute#running-locally-on-your-workstation."><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Running locally on your workstation.</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If you run the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">googlecompute</code> Packer builder locally on your workstation, you will
need to install the Google Cloud SDK and authenticate using <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://cloud.google.com/sdk/gcloud/reference/auth/application-default">User Application Default
Credentials</a>.
You don&#x27;t need to specify an <em>account file</em> if you are using this method. Your user
must have at least <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Compute Instance Admin (v1)</code> &amp; <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Service Account User</code> roles
to use Packer succesfully.</p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-running-on-google-cloud"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Running on Google Cloud permalink" href="/packer/integrations/hashicorp/googlecompute#running-on-google-cloud"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Running on Google Cloud</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If you run the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">googlecompute</code> Packer builder on GCE or GKE, you can
configure that instance or cluster to use a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://cloud.google.com/compute/docs/authentication">Google Service
Account</a>. This will allow
Packer to authenticate to Google Cloud without having to bake in a separate
credential/authentication file.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">It is recommended that you create a custom service account for Packer and assign it
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Compute Instance Admin (v1)</code> &amp; <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Service Account User</code> roles.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">For <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">gcloud</code>, you can run the following commands:</p><div class="g-code-block style_root__i1k0c language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud iam service-accounts create packer <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --project YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --description<span class="token operator">=</span><span class="token string">&quot;Packer Service Account&quot;</span> <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --display-name<span class="token operator">=</span><span class="token string">&quot;Packer Service Account&quot;</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">    --member<span class="token operator">=</span>serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">    --role<span class="token operator">=</span>roles/compute.instanceAdmin.v1</span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">    --member<span class="token operator">=</span>serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">    --role<span class="token operator">=</span>roles/iam.serviceAccountUser</span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">    --member<span class="token operator">=</span>serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">    --role<span class="token operator">=</span>roles/iap.tunnelResourceAccessor</span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">gcloud compute instances create <span class="token environment constant">INSTANCE</span>-NAME <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --project YOUR_GCP_PROJECT <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --image-family ubuntu-2004-lts <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --image-project ubuntu-os-cloud <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --network YOUR_GCP_NETWORK <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --zone YOUR_GCP_ZONE <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --service-account<span class="token operator">=</span>packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com <span class="token punctuation">\</span></span></span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token bash language-bash">  --scopes<span class="token operator">=</span><span class="token string">&quot;https://www.googleapis.com/auth/cloud-platform&quot;</span></span></span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>The service account will be used automatically by Packer as long as there is
no <em>account file</em> specified in the Packer configuration file.</strong></p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-running-outside-of-google-cloud"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Running outside of Google Cloud permalink" href="/packer/integrations/hashicorp/googlecompute#running-outside-of-google-cloud"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Running outside of Google Cloud</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://console.cloud.google.com">Google Cloud Console</a> allows
you to create and download a credential file that will let you use the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">googlecompute</code> Packer builder anywhere. To make the process more
straightforwarded, it is documented here.</p><ol class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Log into the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://console.cloud.google.com/iam-admin/serviceaccounts">Google Cloud
Console</a> and select a project.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Click Select a project, choose your project, and click Open.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Click Create Service Account.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Enter a service account name (friendly display name), an optional description, select the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Compute Engine Instance Admin (v1)</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Service Account User</code> roles, and then click Save.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Generate a JSON Key and save it in a secure location.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Set the Environment Variable <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">GOOGLE_APPLICATION_CREDENTIALS</code> to point to the path of the service account key.</p></li></ol><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-precedence-of-authentication-methods"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Precedence of Authentication Methods permalink" href="/packer/integrations/hashicorp/googlecompute#precedence-of-authentication-methods"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Precedence of Authentication Methods</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Packer looks for credentials in the following places, preferring the first
location found:</p><ol class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">An <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">access_token</code> option in your packer file.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">An <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">account_file</code> option in your packer file.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">A JSON file (Service Account) whose path is specified by the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">GOOGLE_APPLICATION_CREDENTIALS</code> environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">A JSON file in a location known to the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">gcloud</code> command-line tool.
(<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">gcloud auth application-default login</code> creates it)</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">On Windows, this is:</p><div class="g-code-block style_root__i1k0c mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">%APPDATA%/gcloud/application_default_credentials.json<!-- -->
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">On other systems:</p><div class="g-code-block style_root__i1k0c mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">$HOME/.config/gcloud/application_default_credentials.json<!-- -->
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">On Google Compute Engine and Google App Engine Managed VMs, it fetches
credentials from the metadata server. (Needs a correct VM authentication
scope configuration, see above.)</p></li></ol><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-examples"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Examples permalink" href="/packer/integrations/hashicorp/googlecompute#examples"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Examples</h3><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-basic-example"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Basic Example permalink" href="/packer/integrations/hashicorp/googlecompute#basic-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Basic Example</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Below is a fully functioning example. It doesn&#x27;t do anything useful since no
provisioners or startup-script metadata are defined, but it will effectively
repackage an existing GCE image.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;source_image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;debian-9-stretch-v20200805&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;ssh_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;basic-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my project&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source_image</span> <span class="token punctuation">=</span> <span class="token string">&quot;debian-9-stretch-v20200805&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.basic-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-windows-example"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Windows Example permalink" href="/packer/integrations/hashicorp/googlecompute#windows-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Windows Example</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Before you can provision using the winrm communicator, you need to allow
traffic through google&#x27;s firewall on the winrm port (tcp:5986). You can do so
using the gcloud command.</p><div class="g-code-block style_root__i1k0c mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">gcloud compute firewall-rules create allow-winrm --allow tcp:5986<!-- -->
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Or alternatively by navigating to <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://console.cloud.google.com/networking/firewalls/list">https://console.cloud.google.com/networking/firewalls/list</a>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Once this is set up, the following is a complete working packer config after
setting a valid <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">project_id</code>:</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;source_image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;windows-server-2019-dc-v20200813&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;disk_size&quot;</span><span class="token operator">:</span> <span class="token string">&quot;50&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;machine_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;n1-standard-2&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;communicator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;winrm&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;winrm_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer_user&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;winrm_insecure&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;winrm_use_ssl&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">        <span class="token property">&quot;sysprep-specialize-script-cmd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;winrm quickconfig -quiet &amp; net user /add packer_user &amp; net localgroup administrators packer_user /add &amp; winrm set winrm/config/service/auth @{Basic=\&quot;true\&quot;}&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;windows-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;MY_PROJECT&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source_image</span> <span class="token punctuation">=</span> <span class="token string">&quot;windows-server-2019-dc-v20200813&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">disk_size</span> <span class="token punctuation">=</span> <span class="token number">50</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">machine_type</span> <span class="token punctuation">=</span> <span class="token string">&quot;n1-standard-2&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">communicator</span> <span class="token punctuation">=</span> <span class="token string">&quot;winrm&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">winrm_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer_user&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">winrm_insecure</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">winrm_use_ssl</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">metadata</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">sysprep-specialize-script-cmd</span> <span class="token punctuation">=</span> <span class="token string">&quot;winrm quickconfig -quiet &amp; net user /add packer_user &amp; net localgroup administrators packer_user /add &amp; winrm set winrm/config/service/auth @{Basic=\&quot;true\&quot;}&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.windows-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Warning:</strong> Please note that if you&#x27;re setting up WinRM for provisioning, you&#x27;ll probably want to turn it off or restrict its permissions as part of a shutdown script at the end of Packer&#x27;s provisioning process. For more details on the why/how, check out this useful blog post and the associated code:
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/">https://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/</a></p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This build can take up to 15 min.</p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-windows-over-winssh-example"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Windows over WinSSH Example permalink" href="/packer/integrations/hashicorp/googlecompute#windows-over-winssh-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Windows over WinSSH Example</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following uses Windows SSH as backend communicator
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse">https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse</a></p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;windows-ssh-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;MY_PROJECT&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source_image</span> <span class="token punctuation">=</span> <span class="token string">&quot;windows-server-2019-dc-v20200813&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-east4-a&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">disk_size</span> <span class="token punctuation">=</span> <span class="token number">50</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">machine_type</span> <span class="token punctuation">=</span> <span class="token string">&quot;n1-standard-2&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">communicator</span> <span class="token punctuation">=</span> <span class="token string">&quot;ssh&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> var.packer_username<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">ssh_password</span> <span class="token punctuation">=</span> var.packer_user_password<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">ssh_timeout</span> <span class="token punctuation">=</span> <span class="token string">&quot;1h&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">metadata</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">sysprep-specialize-script-cmd</span> <span class="token punctuation">=</span> <span class="token string">&quot;net user <span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">packer_username</span><span class="token punctuation">}</span></span> \&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">packer_user_password</span><span class="token punctuation">}</span></span>\&quot; /add /y &amp; wmic UserAccount where Name=\&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">packer_username</span><span class="token punctuation">}</span></span>\&quot; set PasswordExpires=False &amp; net localgroup administrators <span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">packer_username</span><span class="token punctuation">}</span></span> /add &amp; powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 &amp; powershell Start-Service sshd &amp; powershell Set-Service -Name sshd -StartupType &#x27;Automatic&#x27; &amp; powershell New-NetFirewallRule -Name &#x27;OpenSSH-Server-In-TCP&#x27; -DisplayName &#x27;OpenSSH Server (sshd)&#x27; -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 &amp; powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \&quot;Set-ExecutionPolicy -ExecutionPolicy bypass -Force\&quot;&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.windows-ssh-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">provisioner<span class="token type variable"> &quot;powershell&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">script</span> <span class="token punctuation">=</span> <span class="token string">&quot;../scripts/install-features.ps1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">elevated_user</span>     <span class="token punctuation">=</span> var.packer_username<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">elevated_password</span> <span class="token punctuation">=</span> var.packer_user_password<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-windows-over-winssh-ansible-provisioner"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Windows over WinSSH - Ansible Provisioner permalink" href="/packer/integrations/hashicorp/googlecompute#windows-over-winssh-ansible-provisioner"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Windows over WinSSH - Ansible Provisioner</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following uses Windows SSH as backend communicator
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse">https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse</a>
with a private key.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">sysprep-specialize-script-cmd</code> creates the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">packer_user</code> and adds it to the local administrators group and configures the ssh key, firewall rule and required permissions.</li></ul><div class="g-code-block style_root__i1k0c mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source &quot;googlecompute&quot; &quot;windows-ssh-ansible&quot; {<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  project_id              = var.project_id<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  source_image            = &quot;windows-server-2019-dc-v20200813&quot;<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  zone                    = &quot;us-east4-a&quot;<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  disk_size               = 50<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  machine_type            = &quot;n1-standard-8&quot;<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  communicator            = &quot;ssh&quot;<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  ssh_username            = var.packer_username<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  ssh_private_key_file    = var.ssh_key_file_path<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  ssh_timeout             = &quot;1h&quot;<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  metadata = {<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    sysprep-specialize-script-cmd = &quot;net user ${var.packer_username} \&quot;${var.packer_user_password}\&quot; /add /y &amp; wmic UserAccount where Name=\&quot;${var.packer_username}\&quot; set PasswordExpires=False &amp; net localgroup administrators ${var.packer_username} /add &amp; powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 &amp; echo ${var.ssh_pub_key} &gt; C:\\ProgramData\\ssh\\administrators_authorized_keys &amp; icacls.exe \&quot;C:\\ProgramData\\ssh\\administrators_authorized_keys\&quot; /inheritance:r /grant \&quot;Administrators:F\&quot; /grant \&quot;SYSTEM:F\&quot; &amp; powershell New-ItemProperty -Path \&quot;HKLM:\\SOFTWARE\\OpenSSH\&quot; -Name DefaultShell -Value \&quot;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\&quot; -PropertyType String -Force  &amp; powershell Start-Service sshd &amp; powershell Set-Service -Name sshd -StartupType &#x27;Automatic&#x27; &amp; powershell New-NetFirewallRule -Name &#x27;OpenSSH-Server-In-TCP&#x27; -DisplayName &#x27;OpenSSH Server (sshd)&#x27; -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 &amp; powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \&quot;Set-ExecutionPolicy -ExecutionPolicy bypass -Force\&quot;&quot;<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  }<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  account_file = var.account_file_path<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">}<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">build {<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  sources = [&quot;sources.googlecompute.windows-ssh-ansible&quot;]<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  provisioner &quot;ansible&quot; {<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    playbook_file           = &quot;./playbooks/playbook.yml&quot;<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    use_proxy               = false<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    ansible_ssh_extra_args  = [&quot;-o StrictHostKeyChecking=no -o IdentitiesOnly=yes&quot;]<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    ssh_authorized_key_file = &quot;var.public_key_path&quot;<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    extra_arguments = [&quot;-e&quot;, &quot;win_packages=${var.win_packages}&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      &quot;-e&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      &quot;ansible_shell_type=powershell&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      &quot;-e&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      &quot;ansible_shell_executable=None&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      &quot;-e&quot;,<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      &quot;ansible_shell_executable=None&quot;<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    ]<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    user = var.packer_username<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  }<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">}<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-nested-hypervisor-example"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Nested Hypervisor Example permalink" href="/packer/integrations/hashicorp/googlecompute#nested-hypervisor-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Nested Hypervisor Example</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This is an example of using the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">image_licenses</code> configuration option to create
a GCE image that has nested virtualization enabled. See <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://cloud.google.com/compute/docs/instances/enable-nested-virtualization-vm-instances">Enabling Nested
Virtualization for VM
Instances</a>
for details.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;source_image_family&quot;</span><span class="token operator">:</span> <span class="token string">&quot;centos-7&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;ssh_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;image_licenses&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;projects/vm-options/global/licenses/enable-vmx&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;basic-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my project&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source_image_family</span> <span class="token punctuation">=</span> <span class="token string">&quot;centos-7&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">image_licenses</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;projects/vm-options/global/licenses/enable-vmx&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.basic-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-shared-vpc-example"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Shared VPC Example permalink" href="/packer/integrations/hashicorp/googlecompute#shared-vpc-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Shared VPC Example</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This is an example of using the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">network_project_id</code> configuration option to create
a GCE instance in a Shared VPC Network. See <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="" href="https://cloud.google.com/vpc/docs/provisioning-shared-vpc#creating_an_instance_in_a_shared_subnet">Creating a GCE Instance using Shared
VPC</a>
for details. The user/service account running Packer must have <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Compute Network User</code> role on
the Shared VPC Host Project to create the instance in addition to the other roles mentioned in the
Running on Google Cloud section.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;subnetwork&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;source_image_family&quot;</span><span class="token operator">:</span> <span class="token string">&quot;centos-7&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;network_project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SHARED_VPC_PROJECT&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;ssh_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;image_licenses&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;projects/vm-options/global/licenses/enable-vmx&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;sharedvpc-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my project&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source_image_family</span> <span class="token punctuation">=</span> <span class="token string">&quot;centos-7&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">subnetwork</span> <span class="token punctuation">=</span> <span class="token string">&quot;default&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">network_project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;SHARED_VPC_PROJECT&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">image_licenses</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;projects/vm-options/global/licenses/enable-vmx&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.sharedvpc-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-separate-image-project-example"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Separate Image Project Example permalink" href="/packer/integrations/hashicorp/googlecompute#separate-image-project-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Separate Image Project Example</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This is an example of using the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">image_project_id</code> configuration option to create
the generated image in a different GCP project than the one used to create the virtual machine. Make sure that Packer has permission in the target project to manage images, the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Compute Storage Admin</code> role will grant the desired permissions.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googlecompute&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;image_project_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my image target project&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;source_image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;debian-9-stretch-v20200805&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;ssh_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packer&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;zone&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source <span class="token string">&quot;googlecompute&quot;</span> <span class="token string">&quot;basic-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my project&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">image_project_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;my image target project&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source_image</span> <span class="token punctuation">=</span> <span class="token string">&quot;debian-9-stretch-v20200805&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;packer&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">zone</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-central1-a&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.googlecompute.basic-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div></div></div></main><div class="sidebar-sidecar-layout_sidecarPosition__WtTq0"><div class="sidebar-sidecar-layout_sidecarTopSlot__qRAEI"></div><div class="sidecar-scroll-container_root__a8nIj"><div class="sidecar-scroll-container_scrollContainer__Dw9id"><div class="style_sidecarContents__mn8YF"><div><nav aria-labelledby="react-aria-63"><p id="react-aria-63" class="outline-nav_navLabel__HrjQb hds-typography-body-100">On this page:</p><ol class="outline-nav_listRoot__Sm1fr"><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#installation">Installation</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#components">Components</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#builders">Builders</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#post-processors">Post-Processors</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#authentication">Authentication</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#running-locally-on-your-workstation.">Running locally on your workstation.</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#running-on-google-cloud">Running on Google Cloud</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#running-outside-of-google-cloud">Running outside of Google Cloud</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#precedence-of-authentication-methods">Precedence of Authentication Methods</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#examples">Examples</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#basic-example">Basic Example</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#windows-example">Windows Example</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#windows-over-winssh-example">Windows over WinSSH Example</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#windows-over-winssh-ansible-provisioner">Windows over WinSSH - Ansible Provisioner</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#nested-hypervisor-example">Nested Hypervisor Example</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#shared-vpc-example">Shared VPC Example</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" aria-describedby="" href="/packer/integrations/hashicorp/googlecompute#separate-image-project-example">Separate Image Project Example</a></li></ol></nav></div><div class="hds-surface-mid card_root__RyqjV card-link_root__xgxTP try-hcp-callout-compact_root___7XiC"><a aria-label="Try HCP Packer for free" class="card-link_anchor___5xoF" data-heap-track="card-link " aria-describedby="" href="https://portal.cloud.hashicorp.com/sign-up"><span aria-hidden="true">Â </span></a><div class="try-hcp-callout-compact_background__JtvVp try-hcp-callout-compact_backgroundBase__iMMMT"></div><div class="product-icon-heading_root__o8B6U"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="product-icon-heading_icon__Tvv78 product-icon-heading_small__t6tVT hds-typography-display-200"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="product-icon-heading_heading__VsKZU product-icon-heading_small__t6tVT hds-typography-display-200">HCP Packer</span></div><div class="description_root__46_SL hds-typography-body-200">Automate build management across your cloud&nbsp;providers</div><span class="standalone-link-contents_root__aKU34 standalone-link-contents_small__74len hds-typography-body-100">Try HCP Packer for free<!-- --> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" d="M8.235 4.045a.75.75 0 111.03-1.09l4.5 4.25a.75.75 0 010 1.09l-4.5 4.25a.75.75 0 01-1.03-1.09L11.364 8.5H2.75a.75.75 0 010-1.5h8.614L8.235 4.045z"></path></svg></span></div></div></div></div></div></div></div></div></div></div><div class="base-layout_footer__HGqK8 base-layout_showFooterTopBorder__4_CwH"><footer class="footer_root__qJO_k"><span class="footer_logoAndSwitcher__CJkN3"><a href="https://www.hashicorp.com/" aria-label="Go to HashiCorp home page" class="footer_logo__pe9i3 g-focus-ring-from-box-shadow"><div><svg xmlns="http://www.w3.org/2000/svg" width="254" height="53" fill="none" viewBox="0 0 254 53"><g fill="#000" clip-path="url(#a)"><g><path d="M63.01 12.22h5.32v11.43h12.19V12.22h5.36V40.2h-5.36V28.45H68.33V40.2h-5.32zM89.28 34.77c0-4.2 2.96-5.6 6.56-6.44l6.079-1.4v-.48c0-2.04-1.32-3.32-3.44-3.32s-3.36 1.16-3.76 3.08l-4.56-.52c.68-3.84 3.92-6.32 8.52-6.32 5.08 0 8.4 3.2 8.4 7.88v8.2c0 .52.16.68.52.68h1.12v4.08h-3.12c-1.96 0-2.84-.64-2.84-2.24 0-.48.08-1.04.28-1.76l-.44-.16c-1.44 3.12-3.56 4.48-6.56 4.48-4.12 0-6.76-2.28-6.76-5.76m8.12 2c2.639 0 4.519-1.92 4.519-4.96v-1.6l-4.36 1.04c-2.2.52-3.12 1.28-3.12 2.96s1.16 2.56 2.96 2.56M110.59 34.69l4.88-.96c.52 2.16 2.24 3.24 4.52 3.24 2.28 0 3.56-.92 3.56-2.48s-1.52-1.88-4.4-2.4c-3.64-.56-8.35-1.24-8.35-6.28 0-3.8 3.24-6.44 8.52-6.44 4.68 0 8.32 1.96 9.15 5.92l-4.92.8c-.44-2-2.08-3.04-4.24-3.04-2.36 0-3.48 1-3.48 2.36 0 1.56 1.56 1.88 4.44 2.4 3.6.56 8.32 1.24 8.32 6.28 0 3.96-3.2 6.6-8.6 6.6-4.88 0-8.52-2-9.4-6M136.94 40.21h-5.2V11.42h5.2v8.96c0 1.04-.2 2.04-.48 3.52l.48.16c1.24-2.96 3.12-4.68 6.6-4.68 4.44 0 6.8 2.8 6.8 7.56v13.27h-5.2V27.1c0-2.32-1.16-3.6-3.48-3.6-2.64 0-4.72 2-4.72 5.52zM161.01 35.05c0 .8.28 1.04.88 1.04h2.28v4.12h-4.72c-2.36 0-3.64-1.32-3.64-3.76V23.98h-2.88v-4.12h8.08zm-5.92-20.63c0-1.76 1.44-3.2 3.16-3.2 1.72 0 3.16 1.44 3.16 3.2 0 1.76-1.4 3.16-3.16 3.16-1.76 0-3.16-1.4-3.16-3.16M165.89 26.22c0-8.4 5.52-14.47 13.51-14.47 6.72 0 11.31 3.88 12.55 9.15l-5.28 1.28c-1-3.68-3.44-5.76-7.28-5.76-4.88 0-7.96 4.04-7.96 9.79 0 5.75 3.2 9.79 8.16 9.79 3.92 0 6.32-2.12 7.32-6.04l5 .56c-1.2 6.28-5.84 10.15-12.39 10.15-8.08 0-13.63-6.08-13.63-14.47zM194.08 30.01c0-6.2 4.36-10.63 10.39-10.63s10.39 4.44 10.39 10.63-4.36 10.67-10.39 10.67-10.39-4.48-10.39-10.67m15.59 0c0-3.84-2.04-6.4-5.2-6.4s-5.2 2.56-5.2 6.4c0 3.84 2.08 6.44 5.2 6.44s5.2-2.56 5.2-6.44M218.149 19.86h4.8v.8c0 1.08-.04 1.96-.36 3.6l.48.12c.76-2.68 2.16-4.52 5.44-4.52h1.48v5.04h-2.12c-2.92 0-4.52 1.76-4.52 5v10.31h-5.2zM232.43 19.86h5.12v.92c0 .92-.08 1.64-.36 3.28l.48.12c1.24-3.24 3.56-4.8 6.56-4.8 4.96 0 8.88 4.08 8.88 10.63 0 6.55-3.92 10.67-8.88 10.67-3 0-5.2-1.56-6.48-4.84l-.44.16c.24 1.6.32 2.36.32 3.24v9.15h-5.2V19.85zm15.51 10.15c0-3.96-2.16-6.4-5.2-6.4s-5.2 2.44-5.2 6.4c0 3.96 2.16 6.44 5.2 6.44s5.2-2.44 5.2-6.44"/></g><g><path d="M20.79.01.07 11.97v28.71l7.78 4.5V16.46l12.94-7.47z"/><path d="M29.06.01v22.87h-8.27v-8.54L13 18.84v29.3l7.79 4.5v-22.8h8.27v8.48l7.79-4.49V4.51z"/><path d="M29.06 52.65 49.78 40.7V11.99L42 7.49V36.2l-12.94 7.47z"/></g></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h254v53H0z"/></clipPath></defs></svg></div></a><span class="footer_themeSwitcher__CPJxw hds-font-weight-regular"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-82">Theme</label></span></span><ul class="footer_links__t81SU"><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="" href="/certifications"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Certifications</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="" href="https://status.hashicorp.com"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">System Status</span></a></li><li><button class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Cookie Manager</span></button></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="" href="https://www.hashicorp.com/terms-of-service"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Terms of Use</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="" href="https://www.hashicorp.com/security"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Security</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="" href="https://www.hashicorp.com/privacy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Privacy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="" href="https://www.hashicorp.com/trademark-policy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trademark Policy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="" href="https://www.hashicorp.com/trade-controls"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trade Controls</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="opens-in-new-tab-label-react-aria-90" target="_blank" href="https://forms.gle/fnHLuNahLEhjuKvE6"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Give Feedback</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-90">(opens in new tab)</span></li></ul></footer></div></div></div><div class="style_root__owpNH"></div><div style="position:fixed;z-index:99;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none;inset:24px"></div><!--$--><!--/$--></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"metadata":{"title":"Google Cloud Platform | Integrations","description":"The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE."},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://www.packer.io/packer-public/img/og-image.png","icon":[{"href":"/packer-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiDays","url":"https://hashicorp.com/conferences/hashidays","text":"One conference. Three cities.","linkText":"Find a city near you","expirationDate":"2024-06-14T00:00:00-08:00"},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."}},"integration":{"id":"834b0c0c-be8e-4a62-add3-478673c04f95","slug":"googlecompute","name":"Google Cloud Platform","description":"The googlecompute plugin can be used with HashiCorp Packer to create custom images on GCE.","license_type":null,"license_url":null,"external_only":false,"external_url":null,"tier":"official","repo_url":"https://github.com/hashicorp/packer-plugin-googlecompute","subdirectory":"/.web-docs","created_at":"2023-06-15T19:02:47.779Z","updated_at":"2023-08-08T17:01:06.505Z","hide_versions":false,"organization":{"id":"a4a0551a-1451-4d89-9f56-8031c8350c77","slug":"hashicorp","created_at":"2022-11-09T22:56:32.391Z","updated_at":"2022-11-09T22:56:32.391Z"},"product":{"id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","slug":"packer","name":"Packer","created_at":"2022-11-09T22:56:29.896Z","updated_at":"2022-11-09T22:56:29.896Z"},"versions":["1.1.4","1.1.3","1.1.2","1.1.1"],"components":[{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors"},{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors"},{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"}],"flags":[{"id":"3709e036-b45f-4be8-9043-f7c8cc2af00f","slug":"hcp-ready","name":"HCP Ready","description":"This integration has been tested to work with HashiCorp Cloud Platform (HCP)","created_at":"2022-11-09T22:56:30.673Z","updated_at":"2022-11-09T22:56:30.673Z"}],"integration_type":null},"activeRelease":{"id":"76ef66e5-9c2d-4b5d-9823-d9019727c2d8","integration_id":"834b0c0c-be8e-4a62-add3-478673c04f95","version":"1.1.4","readme":"The Google compute Packer plugin lets you create custom images for use within Google Compute Engine (GCE).\n\n### Installation\n\nTo install this plugin, copy and paste this code into your Packer configuration, then run [`packer init`](https://www.packer.io/docs/commands/init).\n\n```hcl\npacker {\n  required_plugins {\n    googlecompute = {\n      source  = \"github.com/hashicorp/googlecompute\"\n      version = \"~\u003e 1\"\n    }\n  }\n}\n```\n\nAlternatively, you can use `packer plugins install` to manage installation of this plugin.\n\n```sh\n$ packer plugins install github.com/hashicorp/googlecompute\n```\n\n### Components\n\n#### Builders\n\n- [googlecompute](/packer/integrations/hashicorp/googlecompute/latest/components/builder/googlecompute) - The\n  googlecompute builder creates images from existing ones, by launching an instance, provisioning it, then exporting\n  it as a reusable image.\n\n#### Post-Processors\n\n- [googlecompute-import](/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import) -\n  The googlecompute-import post-processor imports an existing raw disk image, and imports it as a GCE image that can be\n  used for launching instances from.\n\n- [googlecompute-export](/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-export) -\n  The googlecompute-export post-processor exports the image built by the googlecompute builder as a .tar.gz archive into Google\n  Cloud Storage (GCS).\n\n### Authentication\n\nAuthenticating with Google Cloud services requires either a User Application Default Credentials,\na JSON Service Account Key or an Access Token.  These are **not** required if you are\nrunning the `googlecompute` Packer builder on Google Cloud with a\nproperly-configured [Google Service\nAccount](https://cloud.google.com/compute/docs/authentication).\n\nThe following options are available for the `googlecompute` builder, the googlecompute-export`, and\nthe `googlecompute-import`:\n\n\u003c!-- Code generated from the comments of the Authentication struct in lib/common/auth.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_token` (string) - A temporary [OAuth 2.0 access token](https://developers.google.com/identity/protocols/oauth2)\n  obtained from the Google Authorization server, i.e. the `Authorization: Bearer` token used to\n  authenticate HTTP requests to GCP APIs.\n  This is an alternative to `account_file`, and ignores the `scopes` field.\n  If both are specified, `access_token` will be used over the `account_file` field.\n  \n  These access tokens cannot be renewed by Packer and thus will only work until they expire.\n  If you anticipate Packer needing access for longer than a token's lifetime (default `1 hour`),\n  please use a service account key with `account_file` instead.\n\n- `account_file` (string) - The JSON file containing your account credentials. Not required if you\n  run Packer on a GCE instance with a service account. Instructions for\n  creating the file or using service accounts are above.\n\n- `credentials_file` (string) - The JSON file containing your account credentials.\n  \n  The file's contents may be anything supported by the Google Go client, i.e.:\n  \n  * Service account JSON\n  * OIDC-provided token for federation\n  * Gcloud user credentials file (refresh-token JSON)\n  * A Google Developers Console client_credentials.json\n\n- `credentials_json` (string) - The raw JSON payload for credentials.\n  \n  The accepted data formats are same as those described under\n  [credentials_file](#credentials_file).\n\n- `impersonate_service_account` (string) - This allows service account impersonation as per the [docs](https://cloud.google.com/iam/docs/impersonating-service-accounts).\n\n- `vault_gcp_oauth_engine` (string) - Can be set instead of account_file. If set, this builder will use\n  HashiCorp Vault to generate an Oauth token for authenticating against\n  Google Cloud. The value should be the path of the token generator\n  within vault.\n  For information on how to configure your Vault + GCP engine to produce\n  Oauth tokens, see https://www.vaultproject.io/docs/auth/gcp\n  You must have the environment variables VAULT_ADDR and VAULT_TOKEN set,\n  along with any other relevant variables for accessing your vault\n  instance. For more information, see the Vault docs:\n  https://www.vaultproject.io/docs/commands/#environment-variables\n  Example:`\"vault_gcp_oauth_engine\": \"gcp/token/my-project-editor\",`\n\n\u003c!-- End of code generated from the comments of the Authentication struct in lib/common/auth.go; --\u003e\n\n\n#### Running locally on your workstation.\n\nIf you run the `googlecompute` Packer builder locally on your workstation, you will\nneed to install the Google Cloud SDK and authenticate using [User Application Default\nCredentials](https://cloud.google.com/sdk/gcloud/reference/auth/application-default).\nYou don't need to specify an _account file_ if you are using this method. Your user\nmust have at least `Compute Instance Admin (v1)` \u0026 `Service Account User` roles\nto use Packer succesfully.\n\n#### Running on Google Cloud\n\nIf you run the `googlecompute` Packer builder on GCE or GKE, you can\nconfigure that instance or cluster to use a [Google Service\nAccount](https://cloud.google.com/compute/docs/authentication). This will allow\nPacker to authenticate to Google Cloud without having to bake in a separate\ncredential/authentication file.\n\nIt is recommended that you create a custom service account for Packer and assign it\n`Compute Instance Admin (v1)` \u0026 `Service Account User` roles.\n\nFor `gcloud`, you can run the following commands:\n\n```shell-session\n$ gcloud iam service-accounts create packer \\\n  --project YOUR_GCP_PROJECT \\\n  --description=\"Packer Service Account\" \\\n  --display-name=\"Packer Service Account\"\n\n$ gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT \\\n    --member=serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \\\n    --role=roles/compute.instanceAdmin.v1\n\n$ gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT \\\n    --member=serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \\\n    --role=roles/iam.serviceAccountUser\n\n$ gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT \\\n    --member=serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \\\n    --role=roles/iap.tunnelResourceAccessor\n\n$ gcloud compute instances create INSTANCE-NAME \\\n  --project YOUR_GCP_PROJECT \\\n  --image-family ubuntu-2004-lts \\\n  --image-project ubuntu-os-cloud \\\n  --network YOUR_GCP_NETWORK \\\n  --zone YOUR_GCP_ZONE \\\n  --service-account=packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com \\\n  --scopes=\"https://www.googleapis.com/auth/cloud-platform\"\n```\n\n**The service account will be used automatically by Packer as long as there is\nno _account file_ specified in the Packer configuration file.**\n\n#### Running outside of Google Cloud\n\nThe [Google Cloud Console](https://console.cloud.google.com) allows\nyou to create and download a credential file that will let you use the\n`googlecompute` Packer builder anywhere. To make the process more\nstraightforwarded, it is documented here.\n\n1.  Log into the [Google Cloud\n    Console](https://console.cloud.google.com/iam-admin/serviceaccounts) and select a project.\n\n2.  Click Select a project, choose your project, and click Open.\n\n3.  Click Create Service Account.\n\n4.  Enter a service account name (friendly display name), an optional description, select the `Compute Engine Instance Admin (v1)` and `Service Account User` roles, and then click Save.\n\n5.  Generate a JSON Key and save it in a secure location.\n\n6.  Set the Environment Variable `GOOGLE_APPLICATION_CREDENTIALS` to point to the path of the service account key.\n\n#### Precedence of Authentication Methods\n\nPacker looks for credentials in the following places, preferring the first\nlocation found:\n\n1.  An `access_token` option in your packer file.\n\n2.  An `account_file` option in your packer file.\n\n3.  A JSON file (Service Account) whose path is specified by the\n    `GOOGLE_APPLICATION_CREDENTIALS` environment variable.\n\n4.  A JSON file in a location known to the `gcloud` command-line tool.\n    (`gcloud auth application-default login` creates it)\n\n    On Windows, this is:\n\n        %APPDATA%/gcloud/application_default_credentials.json\n\n    On other systems:\n\n        $HOME/.config/gcloud/application_default_credentials.json\n\n5.  On Google Compute Engine and Google App Engine Managed VMs, it fetches\n    credentials from the metadata server. (Needs a correct VM authentication\n    scope configuration, see above.)\n\n### Examples\n\n#### Basic Example\n\nBelow is a fully functioning example. It doesn't do anything useful since no\nprovisioners or startup-script metadata are defined, but it will effectively\nrepackage an existing GCE image.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"source_image\": \"debian-9-stretch-v20200805\",\n      \"ssh_username\": \"packer\",\n      \"zone\": \"us-central1-a\"\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"basic-example\" {\n  project_id = \"my project\"\n  source_image = \"debian-9-stretch-v20200805\"\n  ssh_username = \"packer\"\n  zone = \"us-central1-a\"\n}\n\nbuild {\n  sources = [\"sources.googlecompute.basic-example\"]\n}\n```\n\n\n#### Windows Example\n\nBefore you can provision using the winrm communicator, you need to allow\ntraffic through google's firewall on the winrm port (tcp:5986). You can do so\nusing the gcloud command.\n\n    gcloud compute firewall-rules create allow-winrm --allow tcp:5986\n\nOr alternatively by navigating to [https://console.cloud.google.com/networking/firewalls/list](https://console.cloud.google.com/networking/firewalls/list).\n\nOnce this is set up, the following is a complete working packer config after\nsetting a valid `project_id`:\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"source_image\": \"windows-server-2019-dc-v20200813\",\n      \"disk_size\": \"50\",\n      \"machine_type\": \"n1-standard-2\",\n      \"communicator\": \"winrm\",\n      \"winrm_username\": \"packer_user\",\n      \"winrm_insecure\": true,\n      \"winrm_use_ssl\": true,\n      \"metadata\": {\n        \"sysprep-specialize-script-cmd\": \"winrm quickconfig -quiet \u0026 net user /add packer_user \u0026 net localgroup administrators packer_user /add \u0026 winrm set winrm/config/service/auth @{Basic=\\\"true\\\"}\"\n      },\n      \"zone\": \"us-central1-a\"\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"windows-example\" {\n  project_id = \"MY_PROJECT\"\n  source_image = \"windows-server-2019-dc-v20200813\"\n  zone = \"us-central1-a\"\n  disk_size = 50\n  machine_type = \"n1-standard-2\"\n  communicator = \"winrm\"\n  winrm_username = \"packer_user\"\n  winrm_insecure = true\n  winrm_use_ssl = true\n  metadata = {\n    sysprep-specialize-script-cmd = \"winrm quickconfig -quiet \u0026 net user /add packer_user \u0026 net localgroup administrators packer_user /add \u0026 winrm set winrm/config/service/auth @{Basic=\\\"true\\\"}\"\n  }\n}\n\nbuild {\n  sources = [\"sources.googlecompute.windows-example\"]\n}\n```\n\n-\u003e **Warning:** Please note that if you're setting up WinRM for provisioning, you'll probably want to turn it off or restrict its permissions as part of a shutdown script at the end of Packer's provisioning process. For more details on the why/how, check out this useful blog post and the associated code:\nhttps://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/\n\nThis build can take up to 15 min.\n\n#### Windows over WinSSH Example\n\nThe following uses Windows SSH as backend communicator\n[https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse](https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse)\n\n```hcl\nsource \"googlecompute\" \"windows-ssh-example\" {\n  project_id = \"MY_PROJECT\"\n  source_image = \"windows-server-2019-dc-v20200813\"\n  zone = \"us-east4-a\"\n  disk_size = 50\n  machine_type = \"n1-standard-2\"\n  communicator = \"ssh\"\n  ssh_username = var.packer_username\n  ssh_password = var.packer_user_password\n  ssh_timeout = \"1h\"\n  metadata = {\n    sysprep-specialize-script-cmd = \"net user ${var.packer_username} \\\"${var.packer_user_password}\\\" /add /y \u0026 wmic UserAccount where Name=\\\"${var.packer_username}\\\" set PasswordExpires=False \u0026 net localgroup administrators ${var.packer_username} /add \u0026 powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 \u0026 powershell Start-Service sshd \u0026 powershell Set-Service -Name sshd -StartupType 'Automatic' \u0026 powershell New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 \u0026 powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \\\"Set-ExecutionPolicy -ExecutionPolicy bypass -Force\\\"\"\n  }\n}\n\nbuild {\n  sources = [\"sources.googlecompute.windows-ssh-example\"]\n\n  provisioner \"powershell\" {\n    script = \"../scripts/install-features.ps1\"\n    elevated_user     = var.packer_username\n    elevated_password = var.packer_user_password\n  }\n}\n```\n\n#### Windows over WinSSH - Ansible Provisioner\n\nThe following uses Windows SSH as backend communicator\n[https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse](https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse)\nwith a private key.\n\n* The `sysprep-specialize-script-cmd` creates the `packer_user` and adds it to the local administrators group and configures the ssh key, firewall rule and required permissions.\n\n```\nsource \"googlecompute\" \"windows-ssh-ansible\" {\n  project_id              = var.project_id\n  source_image            = \"windows-server-2019-dc-v20200813\"\n  zone                    = \"us-east4-a\"\n  disk_size               = 50\n  machine_type            = \"n1-standard-8\"\n  communicator            = \"ssh\"\n  ssh_username            = var.packer_username\n  ssh_private_key_file    = var.ssh_key_file_path\n  ssh_timeout             = \"1h\"\n  \n  metadata = {\n    sysprep-specialize-script-cmd = \"net user ${var.packer_username} \\\"${var.packer_user_password}\\\" /add /y \u0026 wmic UserAccount where Name=\\\"${var.packer_username}\\\" set PasswordExpires=False \u0026 net localgroup administrators ${var.packer_username} /add \u0026 powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 \u0026 echo ${var.ssh_pub_key} \u003e C:\\\\ProgramData\\\\ssh\\\\administrators_authorized_keys \u0026 icacls.exe \\\"C:\\\\ProgramData\\\\ssh\\\\administrators_authorized_keys\\\" /inheritance:r /grant \\\"Administrators:F\\\" /grant \\\"SYSTEM:F\\\" \u0026 powershell New-ItemProperty -Path \\\"HKLM:\\\\SOFTWARE\\\\OpenSSH\\\" -Name DefaultShell -Value \\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\" -PropertyType String -Force  \u0026 powershell Start-Service sshd \u0026 powershell Set-Service -Name sshd -StartupType 'Automatic' \u0026 powershell New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 \u0026 powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \\\"Set-ExecutionPolicy -ExecutionPolicy bypass -Force\\\"\"\n  }\n  account_file = var.account_file_path\n\n}\n\nbuild {\n  sources = [\"sources.googlecompute.windows-ssh-ansible\"]\n\n  provisioner \"ansible\" {\n    playbook_file           = \"./playbooks/playbook.yml\"\n    use_proxy               = false\n    ansible_ssh_extra_args  = [\"-o StrictHostKeyChecking=no -o IdentitiesOnly=yes\"]\n    ssh_authorized_key_file = \"var.public_key_path\"\n    extra_arguments = [\"-e\", \"win_packages=${var.win_packages}\",\n      \"-e\",\n      \"ansible_shell_type=powershell\",\n      \"-e\",\n      \"ansible_shell_executable=None\",\n      \"-e\",\n      \"ansible_shell_executable=None\"\n    ]\n    user = var.packer_username\n  }\n\n}\n\n```\n\n#### Nested Hypervisor Example\n\nThis is an example of using the `image_licenses` configuration option to create\na GCE image that has nested virtualization enabled. See [Enabling Nested\nVirtualization for VM\nInstances](https://cloud.google.com/compute/docs/instances/enable-nested-virtualization-vm-instances)\nfor details.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"source_image_family\": \"centos-7\",\n      \"ssh_username\": \"packer\",\n      \"zone\": \"us-central1-a\",\n      \"image_licenses\": [\"projects/vm-options/global/licenses/enable-vmx\"]\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"basic-example\" {\n  project_id = \"my project\"\n  source_image_family = \"centos-7\"\n  ssh_username = \"packer\"\n  zone = \"us-central1-a\"\n  image_licenses = [\"projects/vm-options/global/licenses/enable-vmx\"]\n}\n\nbuild {\n  sources = [\"sources.googlecompute.basic-example\"]\n}\n```\n\n\n#### Shared VPC Example\n\nThis is an example of using the `network_project_id` configuration option to create\na GCE instance in a Shared VPC Network. See [Creating a GCE Instance using Shared\nVPC](https://cloud.google.com/vpc/docs/provisioning-shared-vpc#creating_an_instance_in_a_shared_subnet)\nfor details. The user/service account running Packer must have `Compute Network User` role on\nthe Shared VPC Host Project to create the instance in addition to the other roles mentioned in the\nRunning on Google Cloud section.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"subnetwork\": \"default\",\n      \"source_image_family\": \"centos-7\",\n      \"network_project_id\": \"SHARED_VPC_PROJECT\",\n      \"ssh_username\": \"packer\",\n      \"zone\": \"us-central1-a\",\n      \"image_licenses\": [\"projects/vm-options/global/licenses/enable-vmx\"]\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"sharedvpc-example\" {\n  project_id = \"my project\"\n  source_image_family = \"centos-7\"\n  subnetwork = \"default\"\n  network_project_id = \"SHARED_VPC_PROJECT\"\n  ssh_username = \"packer\"\n  zone = \"us-central1-a\"\n  image_licenses = [\"projects/vm-options/global/licenses/enable-vmx\"]\n}\n\nbuild {\n  sources = [\"sources.googlecompute.sharedvpc-example\"]\n}\n```\n\n\n#### Separate Image Project Example\n\nThis is an example of using the `image_project_id` configuration option to create\nthe generated image in a different GCP project than the one used to create the virtual machine. Make sure that Packer has permission in the target project to manage images, the `Compute Storage Admin` role will grant the desired permissions.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"project_id\": \"my project\",\n      \"image_project_id\": \"my image target project\",\n      \"source_image\": \"debian-9-stretch-v20200805\",\n      \"ssh_username\": \"packer\",\n      \"zone\": \"us-central1-a\"\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nsource \"googlecompute\" \"basic-example\" {\n  project_id = \"my project\"\n  image_project_id = \"my image target project\"\n  source_image = \"debian-9-stretch-v20200805\"\n  ssh_username = \"packer\"\n  zone = \"us-central1-a\"\n}\n\nbuild {\n  sources = [\"sources.googlecompute.basic-example\"]\n}\n```\n","created_at":"2023-11-27T19:16:54.483Z","updated_at":"2024-02-05T16:03:42.578Z","components":[{"id":"86be1a73-6062-415d-b741-0d5ebfad8cfa","integration_release_id":"76ef66e5-9c2d-4b5d-9823-d9019727c2d8","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `googlecompute`\nArtifact BuilderId: `packer.googlecompute`\n\nThe `googlecompute` Packer builder is able to create\n[images](https://developers.google.com/compute/docs/images) for use with\n[Google Compute Engine](https://cloud.google.com/products/compute-engine) (GCE)\nbased on existing images.\n\nIt is possible to build images from scratch, but not with the `googlecompute`\nPacker builder. The process is recommended only for advanced users, please see\n[Building GCE Images from Scratch](https://cloud.google.com/compute/docs/tutorials/building-images)\nand the [Google Compute Import\nPost-Processor](/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import) for more\ninformation.\n\n## Authentication\n\nTo authenticate with GCE, this builder supports everything the plugin does.\nTo get more information on this, refer to the plugin's description page, under\nthe [authentication](/packer/integrations/hashicorp/googlecompute#authentication) section.\n\n## Configuration Reference\n\nConfiguration options are organized below into two categories: required and\noptional. Within each category, the available options are alphabetized and\ndescribed.\n\nIn addition to the options listed here, a\n[communicator](/packer/docs/templates/legacy_json_templates/communicator) can be configured for this\nbuilder.\n\n### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/googlecompute/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `project_id` (string) - The project ID that will be used to launch instances and store images.\n\n- `source_image` (string) - The source image to use to create the new image from. You can also\n  specify source_image_family instead. If both source_image and\n  source_image_family are specified, source_image takes precedence.\n  Example: \"debian-8-jessie-v20161027\"\n\n- `source_image_family` (string) - The source image family to use to create the new image from. The image\n  family always returns its latest image that is not deprecated. Example:\n  \"debian-8\".\n\n- `zone` (string) - The zone in which to launch the instance used to create the image.\n  Example: \"us-central1-a\"\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/googlecompute/config.go; --\u003e\n\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/googlecompute/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `accelerator_type` (string) - Full or partial URL of the guest accelerator type. GPU accelerators can\n  only be used with `\"on_host_maintenance\": \"TERMINATE\"` option set.\n  Example:\n  `\"projects/project_id/zones/europe-west1-b/acceleratorTypes/nvidia-tesla-k80\"`\n\n- `accelerator_count` (int64) - Number of guest accelerator cards to add to the launched instance.\n\n- `address` (string) - The name of a pre-allocated static external IP address. Note, must be\n  the name and not the actual IP address.\n\n- `disable_default_service_account` (bool) - If true, the default service account will not be used if\n  service_account_email is not specified. Set this value to true and omit\n  service_account_email to provision a VM with no service account.\n\n- `disk_name` (string) - The name of the disk, if unset the instance name will be used.\n\n- `disk_size` (int64) - The size of the disk in GB. This defaults to 20, which is 20GB.\n\n- `disk_type` (string) - Type of disk used to back your instance, like pd-ssd or pd-standard.\n  Defaults to pd-standard.\n\n- `disk_encryption_key` (\\*common.CustomerEncryptionKey) - Disk encryption key to apply to the created boot disk. Possible values:\n  * kmsKeyName -  The name of the encryption key that is stored in Google Cloud KMS.\n  * RawKey: - A 256-bit customer-supplied encryption key, encodes in RFC 4648 base64.\n  \n  examples:\n  \n   ```json\n   {\n      \"kmsKeyName\": \"projects/${project}/locations/${region}/keyRings/computeEngine/cryptoKeys/computeEngine/cryptoKeyVersions/4\"\n   }\n   ```\n  \n   ```hcl\n    disk_encryption_key {\n      kmsKeyName = \"projects/${var.project}/locations/${var.region}/keyRings/computeEngine/cryptoKeys/computeEngine/cryptoKeyVersions/4\"\n    }\n   ```\n  \n  Refer to the [Customer Encryption Key](#customer-encryption-key) section for more information on the contents of this block.\n\n- `enable_nested_virtualization` (bool) - Create a instance with enabling nested virtualization.\n\n- `enable_secure_boot` (bool) - Create a Shielded VM image with Secure Boot enabled. It helps ensure that\n  the system only runs authentic software by verifying the digital signature\n  of all boot components, and halting the boot process if signature verification\n  fails. [Details](https://cloud.google.com/security/shielded-cloud/shielded-vm)\n\n- `enable_vtpm` (bool) - Create a Shielded VM image with virtual trusted platform module\n  Measured Boot enabled. A vTPM is a virtualized trusted platform module,\n  which is a specialized computer chip you can use to protect objects,\n  like keys and certificates, that you use to authenticate access to your\n  system. [Details](https://cloud.google.com/security/shielded-cloud/shielded-vm)\n\n- `enable_integrity_monitoring` (bool) - Integrity monitoring helps you understand and make decisions about the\n  state of your VM instances. Note: integrity monitoring relies on having\n  vTPM enabled. [Details](https://cloud.google.com/security/shielded-cloud/shielded-vm)\n\n- `disk_attachment` ([]common.BlockDevice) - Extra disks to attach to the instance that will build the final image.\n  \n  You may reference an existing external persistent disk, or you can configure\n  a set of disks to be created before the instance is created, and will\n  be deleted upon build completion.\n  \n  Scratch (ephemeral) SSDs are always created at launch, and deleted when the\n  instance is torn-down.\n  \n  Note: local SSDs are not supported on all machine types, refer to the\n  [docs](https://cloud.google.com/compute/docs/disks/local-ssd#choose_number_local_ssds)\n  for more information on that.\n  \n  Refer to the [Extra Disk Attachments](#extra-disk-attachments) section for\n  more information on this configuration type.\n\n- `skip_create_image` (bool) - Skip creating the image. Useful for setting to `true` during a build test stage. Defaults to `false`.\n\n- `image_name` (string) - The unique name of the resulting image. Defaults to\n  `packer-{{timestamp}}`.\n\n- `image_description` (string) - The description of the resulting image.\n\n- `image_encryption_key` (\\*common.CustomerEncryptionKey) - Image encryption key to apply to the created image. Possible values:\n  * kmsKeyName -  The name of the encryption key that is stored in Google Cloud KMS.\n  * RawKey: - A 256-bit customer-supplied encryption key, encodes in RFC 4648 base64.\n  \n  examples:\n  \n   ```json\n   {\n      \"kmsKeyName\": \"projects/${project}/locations/${region}/keyRings/computeEngine/cryptoKeys/computeEngine/cryptoKeyVersions/4\"\n   }\n   ```\n  \n   ```hcl\n    image_encryption_key {\n      kmsKeyName = \"projects/${var.project}/locations/${var.region}/keyRings/computeEngine/cryptoKeys/computeEngine/cryptoKeyVersions/4\"\n    }\n   ```\n  \n  Refer to the [Customer Encryption Key](#customer-encryption-key) section for more information on the contents of this block.\n\n- `image_family` (string) - The name of the image family to which the resulting image belongs. You\n  can create disks by specifying an image family instead of a specific\n  image name. The image family always returns its latest image that is not\n  deprecated.\n\n- `image_labels` (map[string]string) - Key/value pair labels to apply to the created image.\n\n- `image_licenses` ([]string) - Licenses to apply to the created image.\n\n- `image_guest_os_features` ([]string) - Guest OS features to apply to the created image.\n\n- `image_project_id` (string) - The project ID to push the build image into. Defaults to project_id.\n\n- `image_storage_locations` ([]string) - Storage location, either regional or multi-regional, where snapshot\n  content is to be stored and only accepts 1 value. Always defaults to a nearby regional or multi-regional\n  location.\n  \n  multi-regional example:\n  \n   ```json\n   {\n      \"image_storage_locations\": [\"us\"]\n   }\n   ```\n  regional example:\n  \n   ```json\n   {\n      \"image_storage_locations\": [\"us-east1\"]\n   }\n   ```\n\n- `instance_name` (string) - A name to give the launched instance. Beware that this must be unique.\n  Defaults to `packer-{{uuid}}`.\n\n- `labels` (map[string]string) - Key/value pair labels to apply to the launched instance.\n\n- `machine_type` (string) - The machine type. Defaults to \"e2-standard-2\".\n\n- `metadata` (map[string]string) - Metadata applied to the launched instance.\n  All metadata configuration values are expected to be of type string.\n  Google metadata options that take a value of `TRUE` or `FALSE` should be\n  set as a string (i.e  `\"TRUE\"` `\"FALSE\"` or `\"true\"` `\"false\"`).\n\n- `metadata_files` (map[string]string) - Metadata applied to the launched instance. Values are files.\n\n- `min_cpu_platform` (string) - A Minimum CPU Platform for VM Instance. Availability and default CPU\n  platforms vary across zones, based on the hardware available in each GCP\n  zone.\n  [Details](https://cloud.google.com/compute/docs/instances/specify-min-cpu-platform)\n\n- `network` (string) - The Google Compute network id or URL to use for the launched instance.\n  Defaults to \"default\". If the value is not a URL, it will be\n  interpolated to\n  `projects/((network_project_id))/global/networks/((network))`. This value\n  is not required if a subnet is specified.\n\n- `network_project_id` (string) - The project ID for the network and subnetwork to use for launched\n  instance. Defaults to project_id.\n\n- `omit_external_ip` (bool) - If true, the instance will not have an external IP. use_internal_ip must\n  be true if this property is true.\n\n- `on_host_maintenance` (string) - Sets Host Maintenance Option. Valid choices are `MIGRATE` and\n  `TERMINATE`. Please see [GCE Instance Scheduling\n  Options](https://cloud.google.com/compute/docs/instances/setting-instance-scheduling-options),\n  as not all machine\\_types support `MIGRATE` (i.e. machines with GPUs).\n  If preemptible is true this can only be `TERMINATE`. If preemptible is\n  false, it defaults to `MIGRATE`\n\n- `preemptible` (bool) - If true, launch a preemptible instance.\n\n- `node_affinity` ([]common.NodeAffinity) - Sets a node affinity label for the launched instance (eg. for sole tenancy).\n  Please see [Provisioning VMs on\n  sole-tenant nodes](https://cloud.google.com/compute/docs/nodes/provisioning-sole-tenant-vms)\n  for more information.\n  \n  ```hcl\n    key = \"workload\"\n    operator = \"IN\"\n    values = [\"packer\"]\n  ```\n  \n  Refer to the [Node Affinity](#node-affinities) for more information on affinities.\n\n- `state_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for instance state changes. Defaults to \"5m\".\n\n- `region` (string) - The region in which to launch the instance. Defaults to the region\n  hosting the specified zone.\n\n- `scopes` ([]string) - The service account scopes for launched\n  instance. Defaults to:\n  \n  ```json\n  [\n    \"https://www.googleapis.com/auth/userinfo.email\",\n    \"https://www.googleapis.com/auth/compute\",\n    \"https://www.googleapis.com/auth/devstorage.full_control\"\n  ]\n  ```\n\n- `service_account_email` (string) - The service account to be used for launched instance. Defaults to the\n  project's default service account unless disable_default_service_account\n  is true.\n\n- `source_image_project_id` ([]string) - A list of project IDs to search for the source image. Packer will search the first\n  project ID in the list first, and fall back to the next in the list, until it finds the source image.\n\n- `startup_script_file` (string) - The path to a startup script to run on the launched instance from which the image will\n  be made. When set, the contents of the startup script file will be added to the instance metadata\n  under the `\"startup_script\"` metadata property. See [Providing startup script contents directly](https://cloud.google.com/compute/docs/startupscript#providing_startup_script_contents_directly) for more details.\n  \n  When using `startup_script_file` the following rules apply:\n  - The contents of the script file will overwrite the value of the `\"startup_script\"` metadata property at runtime.\n  - The contents of the script file will be wrapped in Packer's startup script wrapper, unless `wrap_startup_script` is disabled. See `wrap_startup_script` for more details.\n  - Not supported by Windows instances. See [Startup Scripts for Windows](https://cloud.google.com/compute/docs/startupscript#providing_a_startup_script_for_windows_instances) for more details.\n\n- `windows_password_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for windows password to be retrieved. Defaults to \"3m\".\n\n- `wrap_startup_script` (boolean) - For backwards compatibility this option defaults to `\"true\"` in the future it will default to `\"false\"`.\n  If \"true\", the contents of `startup_script_file` or `\"startup_script\"` in the instance metadata\n  is wrapped in a Packer specific script that tracks the execution and completion of the provided\n  startup script. The wrapper ensures that the builder will not continue until the startup script has been executed.\n  - The use of the wrapped script file requires that the user or service account\n  running the build has the compute.instance.Metadata role.\n\n- `subnetwork` (string) - The Google Compute subnetwork id or URL to use for the launched\n  instance. Only required if the network has been created with custom\n  subnetting. Note, the region of the subnetwork must match the region or\n  zone in which the VM is launched. If the value is not a URL, it will be\n  interpolated to\n  `projects/((network_project_id))/regions/((region))/subnetworks/((subnetwork))`\n\n- `tags` ([]string) - Assign network tags to apply firewall rules to VM instance.\n\n- `use_internal_ip` (bool) - If true, use the instance's internal IP instead of its external IP\n  during building.\n\n- `use_os_login` (bool) - If true, OSLogin will be used to manage SSH access to the compute instance by\n  dynamically importing a temporary SSH key to the Google account's login profile,\n  and setting the `enable-oslogin` to `TRUE` in the instance metadata.\n  Optionally, `use_os_login` can be used with an existing `ssh_username` and `ssh_private_key_file`\n  if a SSH key has already been added to the Google account's login profile - See [Adding SSH Keys](https://cloud.google.com/compute/docs/instances/managing-instance-access#add_oslogin_keys).\n  \n  SSH keys can be added to an individual user account\n  \n  ```shell-session\n  $ gcloud compute os-login ssh-keys add --key-file=/home/user/.ssh/my-key.pub\n  \n  $ gcloud compute os-login describe-profile\n  PosixAccounts:\n  - accountId: \u003cproject-id\u003e\n   gid: '34567890754'\n   homeDirectory: /home/user_example_com\n   ...\n   primary: true\n   uid: '2504818925'\n   username: /home/user_example_com\n  sshPublicKeys:\n   000000000000000000000000000000000000000000000000000000000000000a:\n     fingerprint: 000000000000000000000000000000000000000000000000000000000000000a\n  ```\n  \n  Or SSH keys can be added to an associated service account\n  ```shell-session\n  $ gcloud auth activate-service-account --key-file=\u003cpath to service account credentials file (e.g account.json)\u003e\n  $ gcloud compute os-login ssh-keys add --key-file=/home/user/.ssh/my-key.pub\n  \n  $ gcloud compute os-login describe-profile\n  PosixAccounts:\n  - accountId: \u003cproject-id\u003e\n   gid: '34567890754'\n   homeDirectory: /home/sa_000000000000000000000\n   ...\n   primary: true\n   uid: '2504818925'\n   username: sa_000000000000000000000\n  sshPublicKeys:\n   000000000000000000000000000000000000000000000000000000000000000a:\n     fingerprint: 000000000000000000000000000000000000000000000000000000000000000a\n  ```\n\n- `wait_to_add_ssh_keys` (duration string | ex: \"1h5m2s\") - The time to wait between the creation of the instance used to create the image,\n  and the addition of SSH configuration, including SSH keys, to that instance.\n  The delay is intended to protect packer from anything in the instance boot\n  sequence that has potential to disrupt the creation of SSH configuration\n  (e.g. SSH user creation, SSH key creation) on the instance.\n  Note: All other instance metadata, including startup scripts, are still added to the instance\n  during it's creation.\n  Example value: `5m`.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/googlecompute/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the IAPConfig struct in builder/googlecompute/step_start_tunnel.go; DO NOT EDIT MANUALLY --\u003e\n\n- `use_iap` (bool) - Whether to use an IAP proxy.\n  Prerequisites and limitations for using IAP:\n  - You must manually enable the IAP API in the Google Cloud console.\n  - You must have the gcloud sdk installed on the computer running Packer.\n  - If you use a service account, you must add it to project level IAP permissions\n    in https://console.cloud.google.com/security/iap. To do so, click\n    \"project\" \u003e \"SSH and TCP resources\" \u003e \"All Tunnel Resources\" \u003e\n    \"Add Member\". Then add your service account and choose the role\n    \"IAP-secured Tunnel User\" and add any conditions you may care about.\n\n- `iap_localhost_port` (int) - Which port to connect the local end of the IAM localhost proxy to. If\n  left blank, Packer will choose a port for you from available ports.\n\n- `iap_hashbang` (string) - What \"hashbang\" to use to invoke script that sets up gcloud.\n  Default: \"/bin/sh\"\n\n- `iap_ext` (string) - What file extension to use for script that sets up gcloud.\n  Default: \".sh\"\n\n- `iap_tunnel_launch_wait` (int) - How long to wait, in seconds, before assuming a tunnel launch was\n  successful. Defaults to 30 seconds for SSH or 40 seconds for WinRM.\n\n\u003c!-- End of code generated from the comments of the IAPConfig struct in builder/googlecompute/step_start_tunnel.go; --\u003e\n\n\n### Startup Scripts\n\nStartup scripts can be a powerful tool for configuring the instance from which\nthe image is made. The builder will wait for a startup script to terminate. A\nstartup script can be provided via the `startup_script_file` or\n`startup-script` instance creation `metadata` field. Therefore, the build time\nwill vary depending on the duration of the startup script. If\n`startup_script_file` is set, the `startup-script` `metadata` field will be\noverwritten. In other words, `startup_script_file` takes precedence.\n\nThe builder does check for a pass/fail/error signal from the startup\nscript by tracking the `startup-script-status` metadata. Packer will check if this key\nis set to done and if it not set to done before the timeout, Packer will fail the build.\n\n### Windows\nA Windows startup script can only be provided as a metadata field option. The\nbuilder will _not_ wait for a Windows startup script to terminate. You have\nto ensure that it finishes before the instance shuts down. For a list of\nsupported startup script keys refer to [Using startup scripts on Windows](https://cloud.google.com/compute/docs/instances/startup-scripts/windows)\n\n```hcl\nmetadata = {\n  sysprep-specialize-script-cmd = \"...\"\n}\n```\n\n### Logging\n\nStartup script logs can be copied to a Google Cloud Storage (GCS) location\nspecified via the `startup-script-log-dest` instance creation `metadata` field.\nThe GCS location must be writeable by the service account of the instance that Packer created.\n\n### Communicator Configuration\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `communicator` (string) - Packer currently supports three kinds of communicators:\n  \n  -   `none` - No communicator will be used. If this is set, most\n      provisioners also can't be used.\n  \n  -   `ssh` - An SSH connection will be established to the machine. This\n      is usually the default.\n  \n  -   `winrm` - A WinRM connection will be established.\n  \n  In addition to the above, some builders have custom communicators they\n  can use. For example, the Docker builder has a \"docker\" communicator\n  that uses `docker exec` and `docker cp` to execute scripts and copy\n  files.\n\n- `pause_before_connecting` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\n  guest's bootstrap script, but sometimes you may have a race condition\n  where you need Packer to wait before attempting to connect to your\n  guest.\n  \n  If you end up in this situation, you can use the template option\n  `pause_before_connecting`. By default, there is no pause. For example if\n  you set `pause_before_connecting` to `10m` Packer will check whether it\n  can connect, as normal. But once a connection attempt is successful, it\n  will disconnect and then wait 10 minutes before connecting to the guest\n  and beginning provisioning.\n\n\u003c!-- End of code generated from the comments of the Config struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSH struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ssh_host` (string) - The address to SSH to. This usually is automatically configured by the\n  builder.\n\n- `ssh_port` (int) - The port to connect to SSH. This defaults to `22`.\n\n- `ssh_username` (string) - The username to connect to SSH with. Required if using SSH.\n\n- `ssh_password` (string) - A plaintext password to use to authenticate with SSH.\n\n- `ssh_ciphers` ([]string) - This overrides the value of ciphers supported by default by Golang.\n  The default value is [\n    \"aes128-gcm@openssh.com\",\n    \"chacha20-poly1305@openssh.com\",\n    \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n  ]\n  \n  Valid options for ciphers include:\n  \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\",\n  \"chacha20-poly1305@openssh.com\",\n  \"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",\n\n- `ssh_clear_authorized_keys` (bool) - If true, Packer will attempt to remove its temporary key from\n  `~/.ssh/authorized_keys` and `/root/.ssh/authorized_keys`. This is a\n  mostly cosmetic option, since Packer will delete the temporary private\n  key from the host system regardless of whether this is set to true\n  (unless the user has set the `-debug` flag). Defaults to \"false\";\n  currently only works on guests with `sed` installed.\n\n- `ssh_key_exchange_algorithms` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\n  supported by default by Golang. Acceptable values include:\n  \"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\",\n  \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n  \"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".\n\n- `ssh_certificate_file` (string) - Path to user certificate used to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_pty` (bool) - If `true`, a PTY will be requested for the SSH connection. This defaults\n  to `false`.\n\n- `ssh_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\n  determine when the machine has booted so this is usually quite long.\n  Example value: `10m`.\n  This defaults to `5m`, unless `ssh_handshake_attempts` is set.\n\n- `ssh_disable_agent_forwarding` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `false`.\n\n- `ssh_handshake_attempts` (int) - The number of handshakes to attempt with SSH once it can connect.\n  This defaults to `10`, unless a `ssh_timeout` is set.\n\n- `ssh_bastion_host` (string) - A bastion host to use for the actual SSH connection.\n\n- `ssh_bastion_port` (int) - The port of the bastion host. Defaults to `22`.\n\n- `ssh_bastion_agent_auth` (bool) - If `true`, the local SSH agent will be used to authenticate with the\n  bastion host. Defaults to `false`.\n\n- `ssh_bastion_username` (string) - The username to connect to the bastion host.\n\n- `ssh_bastion_password` (string) - The password to use to authenticate with the bastion host.\n\n- `ssh_bastion_interactive` (bool) - If `true`, the keyboard-interactive used to authenticate with bastion host.\n\n- `ssh_bastion_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with the\n  bastion host. The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_bastion_certificate_file` (string) - Path to user certificate used to authenticate with bastion host.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_file_transfer_method` (string) - `scp` or `sftp` - How to transfer files, Secure copy (default) or SSH\n  File Transfer Protocol.\n  \n  **NOTE**: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n  (the default protocol for copying data) returns a a non-zero error code since the MOTW\n  cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\n  with SFTP instead `ssh_file_transfer_protocol = \"sftp\"`.\n\n- `ssh_proxy_host` (string) - A SOCKS proxy host to use for SSH connection\n\n- `ssh_proxy_port` (int) - A port of the SOCKS proxy. Defaults to `1080`.\n\n- `ssh_proxy_username` (string) - The optional username to authenticate with the proxy server.\n\n- `ssh_proxy_password` (string) - The optional password to use to authenticate with the proxy server.\n\n- `ssh_keep_alive_interval` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\n  value (`-1s`) to disable. Example value: `10s`. Defaults to `5s`.\n\n- `ssh_read_write_timeout` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\n  useful if, for example, packer hangs on a connection after a reboot.\n  Example: `5m`. Disabled by default.\n\n- `ssh_remote_tunnels` ([]string) - \n\n- `ssh_local_tunnels` ([]string) - \n\n\u003c!-- End of code generated from the comments of the SSH struct in communicator/config.go; --\u003e\n\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n\n### Temporary SSH keypair\n\n\u003c!-- Code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\nWhen no ssh credentials are specified, Packer will generate a temporary SSH\nkeypair for the instance. You can change the algorithm type and bits\nsettings.\n\n\u003c!-- End of code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `temporary_key_pair_type` (string) - `dsa` | `ecdsa` | `ed25519` | `rsa` ( the default )\n  \n  Specifies the type of key to create. The possible values are 'dsa',\n  'ecdsa', 'ed25519', or 'rsa'.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure, please\n  consider other alternatives like RSA or ED25519.\n\n- `temporary_key_pair_bits` (int) - Specifies the number of bits in the key to create. For RSA keys, the\n  minimum size is 1024 bits and the default is 4096 bits. Generally, 3072\n  bits is considered sufficient. DSA keys must be exactly 1024 bits as\n  specified by FIPS 186-2. For ECDSA keys, bits determines the key length\n  by selecting from one of three elliptic curve sizes: 256, 384 or 521\n  bits. Attempting to use bit lengths other than these three values for\n  ECDSA keys will fail. Ed25519 keys have a fixed length and bits will be\n  ignored.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure as specified\n  by FIPS 186-5, please consider other alternatives like RSA or ED25519.\n\n\u003c!-- End of code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; --\u003e\n\n\n### Gotchas\n\nCentOS and recent Debian images have root ssh access disabled by default. Set\n`ssh_username` to any user, which will be created by packer with sudo access.\n\nThe machine type must have a scratch disk, which means you can't use an\n`f1-micro` or `g1-small` to build images.\n\n## Extra disk attachments\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in lib/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\nBlockDevice is a block device attachement/creation to an instance when building an image.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in lib/common/block_device.go; --\u003e\n\n\nThese can be defined using the [disk_attachment](#disk_attachment) block in the configuration.\n\nNote that this is an array, and therefore in HCL2 can be defined as multiple blocks, each\none corresponding to a disk that will be attached to the instance you are booting.\n\nExample:\n\n```hcl\nsource \"googlecompute\" \"example\" {\n  # Add whichever is necessary to build the image\n\n  disk_attachment {\n    volume_type     = \"scratch\"\n    volume_size     = 375\n  }\n\n  disk_attachment {\n    volume_type     = \"pd-standard\"\n    volume_size     = 25\n    interface_type  = \"SCSI\"\n  }\n}\n```\n\n### Required:\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in lib/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `volume_size` (int) - Size of the volume to request, in gigabytes.\n  \n  The size specified must be in range of the sizes for the chosen volume type.\n\n- `volume_type` (BlockDeviceType) - The volume type is the type of storage to reserve and attach to the instance being provisioned.\n  \n  The following values are supported by this builder:\n  * scratch: local SSD data, always 375 GiB (default)\n  * pd_standard: persistent, HDD-backed disk\n  * pd_balanced: persistent, SSD-backed disk\n  * pd_ssd: persistent, SSD-backed disk, with extra performance guarantees\n  * pd_extreme: persistent, fastest SSD-backed disk, with custom IOPS\n  \n  For details on the different types, refer to: https://cloud.google.com/compute/docs/disks#disk-types\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in lib/common/block_device.go; --\u003e\n\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in lib/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `attachment_mode` (string) - How to attach the volume to the instance\n  \n  Can be either READ_ONLY or READ_WRITE (default).\n\n- `create_image` (bool) - If true, an image will be created for this disk, instead of the boot disk.\n  \n  This only applies to non-scratch disks, and can only be specified on one disk at a\n  time.\n\n- `device_name` (string) - The device name as exposed to the OS in the /dev/disk/by-id/google-* directory\n  \n  If unspecified, the disk will have a default name in the form\n  persistent-disk-x with 'x' being a number assigned by GCE\n  \n  This field only applies to persistent disks, local SSDs will always\n  be exposed as /dev/disk/by-id/google-local-nvme-ssd-x.\n\n- `disk_encryption_key` (CustomerEncryptionKey) - Disk encryption key to apply to the requested disk.\n  \n  Possible values:\n  * kmsKeyName -  The name of the encryption key that is stored in Google Cloud KMS.\n  * RawKey: - A 256-bit customer-supplied encryption key, encodes in RFC 4648 base64.\n  \n  Refer to the [Customer Encryption Key](#customer-encryption-key) section for more information on the contents of this block.\n\n- `disk_name` (string) - Name of the disk to create.\n  This only applies to non-scratch disks. If the disk is persistent, and\n  not specified, Packer will generate a unique name for the disk.\n  \n  The name must be 1-63 characters long and comply to the regexp\n  '[a-z]([-a-z0-9]*[a-z0-9])?'\n\n- `interface_type` (string) - The interface to use for attaching the disk.\n  Can be either NVME or SCSI. Defaults to SCSI.\n  \n  The available options depend on the type of disk, SEE: https://cloud.google.com/compute/docs/disks/persistent-disks#choose_an_interface\n\n- `iops` (int) - The requested IOPS for the disk.\n  \n  This is only available for pd_extreme disks.\n\n- `keep_device` (bool) - Keep the device in the created disks after the instance is terminated.\n  By default, the builder will remove the disks at the end of the build.\n  \n  This cannot be used with 'scratch' volumes.\n\n- `replica_zones` ([]string) - The list of extra zones to replicate the disk into\n  \n  The zone in which the instance is created will automatically be\n  added to the zones in which the disk is replicated.\n\n- `source_volume` (string) - The URI of the volume to attach\n  \n  If this is specified, it won't be deleted after the instance is shut-down.\n\n- `_` (string) - Zone is the zone in which to create the disk in.\n  \n  It is not exposed since the parent config already specifies it\n  and it will be set for the block device when preparing it.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in lib/common/block_device.go; --\u003e\n\n\n## Customer Encryption Key\n\nSpecifying a custom key allows you to use your own encryption keys to encrypt the data\nof the image you are creating.\n\nNote: you will need to reuse the same key later on when reusing the image.\n\n\u003c!-- Code generated from the comments of the CustomerEncryptionKey struct in lib/common/client_keys.go; DO NOT EDIT MANUALLY --\u003e\n\n- `kmsKeyName` (string) - KmsKeyName: The name of the encryption key that is stored in Google\n  Cloud KMS.\n\n- `rawKey` (string) - RawKey: Specifies a 256-bit customer-supplied encryption key, encoded\n  in RFC 4648 base64 to either encrypt or decrypt this resource.\n\n\u003c!-- End of code generated from the comments of the CustomerEncryptionKey struct in lib/common/client_keys.go; --\u003e\n\n\n## Node Affinities\n\nNode affinity configuration allows you to restrict the nodes on which to run the\ninstance that Packer will build the image from.\nThis requires configuring [sole-tenant node groups](https://cloud.google.com/compute/docs/nodes/provisioning-sole-tenant-vms) first.\n\n\u003c!-- Code generated from the comments of the NodeAffinity struct in lib/common/affinities.go; DO NOT EDIT MANUALLY --\u003e\n\n- `key` (string) - Key: Corresponds to the label key of Node resource.\n\n- `operator` (string) - Operator: Defines the operation of node selection. Valid operators are IN for affinity and\n  NOT_IN for anti-affinity.\n\n- `values` ([]string) - Values: Corresponds to the label values of Node resource.\n\n\u003c!-- End of code generated from the comments of the NodeAffinity struct in lib/common/affinities.go; --\u003e\n","created_at":"2023-11-27T19:16:55.821Z","updated_at":"2024-02-05T16:03:44.005Z","name":"Google Cloud Platform","slug":"googlecompute","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"f5cce882-8401-4157-a93e-0d030486ae76","integration_release_id":"76ef66e5-9c2d-4b5d-9823-d9019727c2d8","component_id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","readme":"Type: `googlecompute-import`\nArtifact BuilderId: `packer.post-processor.googlecompute-import`\n\nThe Google Compute Image Import post-processor takes a compressed raw disk\nimage and imports it to a GCE image available to Google Compute Engine.\n\n~\u003e This post-processor is for advanced users. Please ensure you read the\n[GCE import documentation](https://cloud.google.com/compute/docs/images/import-existing-image)\nbefore using this post-processor.\n\n## How Does it Work?\n\nThe import process operates by uploading a temporary copy of the compressed raw\ndisk image to a GCS bucket, and calling an import task in GCP on the raw disk\nfile. Once completed, a GCE image is created containing the converted virtual\nmachine. The temporary raw disk image copy in GCS can be discarded after the import is complete.\n\nGoogle Cloud has very specific requirements for images being imported. Please\nsee the [GCE import documentation](https://cloud.google.com/compute/docs/images/import-existing-image)\nfor details.\n\n~\u003e **Note**: To prevent Packer from deleting the compressed RAW disk image set the `keep_input_artifact` configuration option to `true`.\nSee [Post-Processor Input Artifacts](/packer/docs/templates/legacy_json_templates/post-processors#input-artifacts) for more details.\n\n## Authentication\n\nTo authenticate with GCE, this builder supports everything the plugin does.\nTo get more information on this, refer to the plugin's description page, under\nthe [authentication](/packer/integrations/hashicorp/googlecompute#authentication) section.\n\n## Configuration\n\n### Required\n\n\u003c!-- Code generated from the comments of the Config struct in post-processor/googlecompute-import/post-processor.go; DO NOT EDIT MANUALLY --\u003e\n\n- `project_id` (string) - The project ID where the GCS bucket exists and where the GCE image is stored.\n\n- `bucket` (string) - The name of the GCS bucket where the raw disk image will be uploaded.\n\n- `image_name` (string) - The unique name of the resulting image.\n\n\u003c!-- End of code generated from the comments of the Config struct in post-processor/googlecompute-import/post-processor.go; --\u003e\n\n\n### Optional\n\n\u003c!-- Code generated from the comments of the Config struct in post-processor/googlecompute-import/post-processor.go; DO NOT EDIT MANUALLY --\u003e\n\n- `scopes` ([]string) - The service account scopes for launched importer post-processor instance.\n  Defaults to:\n  \n  ```json\n  [\n    \"https://www.googleapis.com/auth/cloud-platform\"\n  ]\n  ```\n\n- `gcs_object_name` (string) - The name of the GCS object in `bucket` where\n  the RAW disk image will be copied for import. This is treated as a\n  [template engine](/packer/docs/templates/legacy_json_templates/engine). Therefore, you\n  may use user variables and template functions in this field. Defaults to\n  `packer-import-{{timestamp}}.tar.gz`.\n\n- `image_architecture` (string) - Specifies the architecture or processor type that this image can support. Must be one of: `arm64` or `x86_64`. Defaults to `ARCHITECTURE_UNSPECIFIED`.\n\n- `image_description` (string) - The description of the resulting image.\n\n- `image_family` (string) - The name of the image family to which the resulting image belongs.\n\n- `image_guest_os_features` ([]string) - A list of features to enable on the guest operating system. Applicable only for bootable images. Valid\n  values are `MULTI_IP_SUBNET`, `UEFI_COMPATIBLE`,\n  `VIRTIO_SCSI_MULTIQUEUE`, `GVNIC` and `WINDOWS` currently.\n\n- `image_labels` (map[string]string) - Key/value pair labels to apply to the created image.\n\n- `image_storage_locations` ([]string) - Specifies a Cloud Storage location, either regional or multi-regional, where image content is to be stored. If not specified, the multi-region location closest to the source is chosen automatically.\n\n- `skip_clean` (bool) - Skip removing the TAR file uploaded to the GCS\n  bucket after the import process has completed. \"true\" means that we should\n  leave it in the GCS bucket, \"false\" means to clean it out. Defaults to\n  `false`.\n\n- `image_platform_key` (string) - A key used to establish the trust relationship between the platform owner and the firmware. You may only specify one platform key, and it must be a valid X.509 certificate.\n\n- `image_key_exchange_key` ([]string) - A key used to establish a trust relationship between the firmware and the OS. You may specify multiple comma-separated keys for this value.\n\n- `image_signatures_db` ([]string) - A database of certificates that are trusted and can be used to sign boot files. You may specify single or multiple comma-separated values for this value.\n\n- `image_forbidden_signatures_db` ([]string) - A database of certificates that have been revoked and will cause the system to stop booting if a boot file is signed with one of them. You may specify single or multiple comma-separated values for this value.\n\n\u003c!-- End of code generated from the comments of the Config struct in post-processor/googlecompute-import/post-processor.go; --\u003e\n\n\n## Basic Example\n\nHere is a basic example. This assumes that the builder has produced an\ncompressed raw disk image artifact for us to work with, and that the GCS bucket\nhas been created.\n\n**HCL**\n\n```hcl\npost-processor \"googlecompute-import\"{\n  account_file = \"account.json\"\n  bucket = \"my-bucket\"\n  project_id = \"my-project\"\n  image_name = \"my-gce-image\"\n}\n```\n\n**JSON**\n\n```json\n{\n  \"type\": \"googlecompute-import\",\n  \"account_file\": \"account.json\",\n  \"project_id\": \"my-project\",\n  \"bucket\": \"my-bucket\",\n  \"image_name\": \"my-gce-image\"\n}\n```\n\n\n## QEMU Builder Example\n\nHere is a complete example for building a Fedora 31 server GCE image. For this\nexample Packer was run from a Debian Linux host with KVM installed.\n\n    $ packer build -var serial=$(tty) build.pkr.hcl\n\n**HCL2**\n\n```hcl\nvariables {\n  account_file = \"account.json\"\n  bucket = \"my-bucket\"\n  project = \"my-project\"\n  serial = \"\"\n}\n\nsource \"qemu\" \"example\" {\n    accelerator = \"kvm\"\n    boot_command = [\n      \"\u003ctab\u003e console=ttyS0,115200n8 inst.text inst.ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/fedora-31-ks.cfg rd.live.check=0\u003center\u003e\u003cwait\u003e\"\n    ]\n    disk_size = \"15000\"\n    format = \"raw\"\n    iso_checksum = \"sha256:225ebc160e40bb43c5de28bad9680e3a78a9db40c9e3f4f42f3ee3f10f95dbeb\"\n    iso_url = \"https://download-ib01.fedoraproject.org/pub/fedora/linux/releases/31/Server/x86_64/iso/Fedora-Server-dvd-x86_64-31-1.9.iso\"\n    headless = \"true\"\n    http_directory = \"http\"\n    http_port_max = \"10089\"\n    http_port_min = \"10082\"\n    output_directory = \"output\"\n    shutdown_timeout = \"30m\"\n\t\tshutdown_command = \"echo 'vagrant'|sudo -S shutdown -P now\"\n\t\tssh_username = \"vagrant\"\n\t\tssh_password = \"vagrant\"\n    vm_name = \"disk.raw\"\n    qemu_binary = \"/usr/bin/kvm\"\n    qemuargs = [\n      [\"-m\", \"1024\"],\n      [\"-cpu\", \"host\"],\n      [\"-chardev\", \"tty,id=pts,path=${var.serial}\"],\n      [\"-device\", \"isa-serial,chardev=pts\"],\n      [\"-device\", \"virtio-net,netdev=user.0\"]\n    ]\n}\n\nbuild {\n  sources = [\"source.qemu.example\"]\n\n  post-processors {\n    post-processor \"compress\" {\n        output = \"output/disk.raw.tar.gz\"\n    }\n    post-processor \"googlecompute-import\"  {\n        account_file = var.account_file\n        bucket = var.bucket\n        project_id = var.project\n        image_name = \"fedora31-server-packertest\"\n        image_description = \"Fedora 31 Server\"\n        image_family = \"fedora31-server\"\n      }\n    }\n}\n```\n\n  **JSON**\n\n```json\n{\n  \"variables\": {\n    \"account_file\": \"account.json\",\n    \"bucket\": \"my-bucket\",\n    \"project\": \"my-project\",\n    \"serial\": \"\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"qemu\",\n      \"accelerator\": \"kvm\",\n      \"boot_command\": [\n        \"\u003ctab\u003e console=ttyS0,115200n8 inst.text inst.ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/fedora-31-ks.cfg rd.live.check=0\u003center\u003e\u003cwait\u003e\"\n      ],\n      \"disk_size\": \"15000\",\n      \"format\": \"raw\",\n      \"iso_checksum\": \"sha256:225ebc160e40bb43c5de28bad9680e3a78a9db40c9e3f4f42f3ee3f10f95dbeb\",\n      \"iso_url\": \"https://download-ib01.fedoraproject.org/pub/fedora/linux/releases/31/Server/x86_64/iso/Fedora-Server-dvd-x86_64-31-1.9.iso\",\n      \"headless\": \"true\",\n      \"http_directory\": \"http\",\n      \"http_port_max\": \"10089\",\n      \"http_port_min\": \"10082\",\n      \"output_directory\": \"output\",\n      \"shutdown_timeout\": \"30m\",\n      \"shutdown_command\": \"echo 'vagrant'|sudo -S shutdown -P now\",\n      \"ssh_username\": \"vagrant\",\n      \"ssh_password\": \"vagrant\",\n      \"vm_name\": \"disk.raw\",\n      \"qemu_binary\": \"/usr/bin/kvm\",\n      \"qemuargs\": [\n        [\"-m\", \"1024\"],\n        [\"-cpu\", \"host\"],\n        [\"-chardev\", \"tty,id=pts,path={{user `serial`}}\"],\n        [\"-device\", \"isa-serial,chardev=pts\"],\n        [\"-device\", \"virtio-net,netdev=user.0\"]\n      ]\n    }\n  ],\n  \"post-processors\": [\n    [\n      {\n        \"type\": \"compress\",\n        \"output\": \"output/disk.raw.tar.gz\"\n      },\n      {\n        \"type\": \"googlecompute-import\",\n        \"project_id\": \"{{user `project`}}\",\n        \"account_file\": \"{{user `account_file`}}\",\n        \"bucket\": \"{{user `bucket`}}\",\n        \"image_name\": \"fedora31-server-packertest\",\n        \"image_description\": \"Fedora 31 Server\",\n        \"image_family\": \"fedora31-server\"\n      }\n    ]\n  ]\n}\n```\n","created_at":"2023-11-27T19:16:56.231Z","updated_at":"2024-02-05T16:03:44.456Z","name":"Google Cloud Platform Image Import","slug":"googlecompute-import","component":{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.157Z","updated_at":"2023-07-26T17:26:54.831Z"},"variable_groups":[]},{"id":"960849fe-41aa-43a9-8387-844b0cc21656","integration_release_id":"76ef66e5-9c2d-4b5d-9823-d9019727c2d8","component_id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","readme":"Type: `googlecompute-export`\nArtifact BuilderId: `packer.post-processor.googlecompute-export`\n\nThe Google Compute Image Exporter post-processor exports the resultant image\nfrom a googlecompute build as a gzipped tarball to Google Cloud Storage (GCS).\n\nThe exporter uses the same Google Cloud Platform (GCP) project and\nauthentication credentials as the googlecompute build that produced the image.\nA temporary VM is started in the GCP project using these credentials. The VM\nmounts the built image as a disk then dumps, compresses, and tars the image.\nThe VM then uploads the tarball to the provided GCS `paths` using the same\ncredentials.\n\nAs such, the authentication credentials that built the image must have write\npermissions to the GCS `paths`.\n\n~\u003e **Note**: By default the GCE image being exported will be deleted once the image has been exported.\nTo prevent Packer from deleting the image set the `keep_input_artifact` configuration option to `true`. See [Post-Processor Input Artifacts](/packer/docs/templates/legacy_json_templates/post-processors#input-artifacts) for more details.\n\n## Authentication\n\nTo authenticate with GCE, this builder supports everything the plugin does.\nTo get more information on this, refer to the plugin's description page, under\nthe [authentication](/packer/integrations/hashicorp/googlecompute#authentication) section.\n\n## Configuration\n\n### Required\n\n\u003c!-- Code generated from the comments of the Config struct in post-processor/googlecompute-export/post-processor.go; DO NOT EDIT MANUALLY --\u003e\n\n- `paths` ([]string) - A list of GCS paths where the image will be exported.\n  For example `'gs://mybucket/path/to/file.tar.gz'`\n\n\u003c!-- End of code generated from the comments of the Config struct in post-processor/googlecompute-export/post-processor.go; --\u003e\n\n\n### Optional\n\n\u003c!-- Code generated from the comments of the Config struct in post-processor/googlecompute-export/post-processor.go; DO NOT EDIT MANUALLY --\u003e\n\n- `scopes` ([]string) - The service account scopes for launched exporter post-processor instance.\n  Defaults to:\n  \n  ```json\n  [\n    \"https://www.googleapis.com/auth/cloud-platform\"\n  ]\n  ```\n\n- `disk_size` (int64) - The size of the export instances disk.\n  The disk is unused for the export but a larger size will increase `pd-ssd` read speed.\n  This defaults to `200`, which is 200GB.\n\n- `disk_type` (string) - Type of disk used to back the export instance, like\n  `pd-ssd` or `pd-standard`. Defaults to `pd-ssd`.\n\n- `machine_type` (string) - The export instance machine type. Defaults to `\"n1-highcpu-4\"`.\n\n- `network` (string) - The Google Compute network id or URL to use for the export instance.\n  Defaults to `\"default\"`. If the value is not a URL, it\n  will be interpolated to `projects/((builder_project_id))/global/networks/((network))`.\n  This value is not required if a `subnet` is specified.\n\n- `subnetwork` (string) - The Google Compute subnetwork id or URL to use for\n  the export instance. Only required if the `network` has been created with\n  custom subnetting. Note, the region of the subnetwork must match the\n  `zone` in which the VM is launched. If the value is not a URL,\n  it will be interpolated to\n  `projects/((builder_project_id))/regions/((region))/subnetworks/((subnetwork))`\n\n- `zone` (string) - The zone in which to launch the export instance. Defaults\n  to `googlecompute` builder zone. Example: `\"us-central1-a\"`\n\n- `service_account_email` (string) - Service Account Email\n\n\u003c!-- End of code generated from the comments of the Config struct in post-processor/googlecompute-export/post-processor.go; --\u003e\n\n\n## Basic Example\n\nThe following example builds a GCE image in the project, `my-project`, with an\naccount whose keyfile is `account.json`. After the image build, a temporary VM\nwill be created to export the image as a gzipped tarball to\n`gs://mybucket1/path/to/file1.tar.gz` and\n`gs://mybucket2/path/to/file2.tar.gz`. `keep_input_artifact` is true, so the\nGCE image won't be deleted after the export.\n\nIn order for this example to work, the account associated with `account.json`\nmust have write access to both `gs://mybucket1/path/to/file1.tar.gz` and\n`gs://mybucket2/path/to/file2.tar.gz`.\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"googlecompute\",\n      \"account_file\": \"account.json\",\n      \"project_id\": \"my-project\",\n      \"source_image\": \"debian-7-wheezy-v20150127\",\n      \"zone\": \"us-central1-a\"\n    }\n  ],\n  \"post-processors\": [\n    {\n      \"type\": \"googlecompute-export\",\n      \"paths\": [\n        \"gs://mybucket1/path/to/file1.tar.gz\",\n        \"gs://mybucket2/path/to/file2.tar.gz\"\n      ],\n      \"keep_input_artifact\": true\n    }\n  ]\n}\n```\n\n\n**HCL2**\n\n```hcl\n\n  source \"googlecompute\" \"example\" {\n    account_file = \"account.json\"\n    project_id = \"my-project\"\n    source_image = \"debian-7-wheezy-v20150127\"\n    zone = \"us-central1-a\"\n  }\n\n  build {\n    sources = [\"source.googlecompute.example\"]\n\n    post-processor \"googlecompute-export\" {\n      paths = [\n        \"gs://mybucket1/path/to/file1.tar.gz\",\n        \"gs://mybucket2/path/to/file2.tar.gz\"\n      ]\n      keep_input_artifact = true\n    }\n  }\n```\n","created_at":"2023-11-27T19:16:56.568Z","updated_at":"2024-02-05T16:03:44.752Z","name":"Google Cloud Platform Image Exporter","slug":"googlecompute-export","component":{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.157Z","updated_at":"2023-07-26T17:26:54.831Z"},"variable_groups":[]}]},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Integrations","url":"/packer/integrations"},{"title":"Google Cloud Platform","url":"/packer/integrations/hashicorp/googlecompute","isCurrentPage":true}],"anchorLinks":[{"id":"installation","level":3,"title":"Installation"},{"id":"components","level":3,"title":"Components"},{"id":"builders","level":4,"title":"Builders"},{"id":"post-processors","level":4,"title":"Post-Processors"},{"id":"authentication","level":3,"title":"Authentication"},{"id":"running-locally-on-your-workstation.","level":4,"title":"Running locally on your workstation."},{"id":"running-on-google-cloud","level":4,"title":"Running on Google Cloud"},{"id":"running-outside-of-google-cloud","level":4,"title":"Running outside of Google Cloud"},{"id":"precedence-of-authentication-methods","level":4,"title":"Precedence of Authentication Methods"},{"id":"examples","level":3,"title":"Examples"},{"id":"basic-example","level":4,"title":"Basic Example"},{"id":"windows-example","level":4,"title":"Windows Example"},{"id":"windows-over-winssh-example","level":4,"title":"Windows over WinSSH Example"},{"id":"windows-over-winssh-ansible-provisioner","level":4,"title":"Windows over WinSSH - Ansible Provisioner"},{"id":"nested-hypervisor-example","level":4,"title":"Nested Hypervisor Example"},{"id":"shared-vpc-example","level":4,"title":"Shared VPC Example"},{"id":"separate-image-project-example","level":4,"title":"Separate Image Project Example"}],"serializedREADME":{"compiledSource":"const layoutProps={};const MDXLayout=\"wrapper\";function MDXContent({components,...props}){return mdx(MDXLayout,{...layoutProps,...props,components:components,mdxType:\"MDXLayout\"},mdx(\"p\",{\"className\":\"g-type-long-body\"},`The Google compute Packer plugin lets you create custom images for use within Google Compute Engine (GCE).`),mdx(\"h3\",{\"id\":\"user-content-installation\",\"data-text-content\":\"Installation\",\"className\":\"g-type-display-4\"},`Installation`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`To install this plugin, copy and paste this code into your Packer configuration, then run `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.packer.io/docs/commands/init\"},mdx(\"inlineCode\",{parentName:\"a\"},`packer init`)),`.`),mdx(\"pre\",{\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`packer`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`required_plugins`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`googlecompute`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`source`),`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"github.com/hashicorp/googlecompute\"`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`version`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"~\u003e 1\"`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Alternatively, you can use `,mdx(\"inlineCode\",{parentName:\"p\"},`packer plugins install`),` to manage installation of this plugin.`),mdx(\"pre\",{\"className\":\"language-sh\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-sh\"},`$ packer plugins install github.com/hashicorp/googlecompute`,`\n`)),mdx(\"h3\",{\"id\":\"user-content-components\",\"data-text-content\":\"Components\",\"className\":\"g-type-display-4\"},`Components`),mdx(\"h4\",{\"id\":\"user-content-builders\",\"data-text-content\":\"Builders\",\"className\":\"g-type-display-5\"},`Builders`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"/packer/integrations/hashicorp/googlecompute/latest/components/builder/googlecompute\"},`googlecompute`),` - The\ngooglecompute builder creates images from existing ones, by launching an instance, provisioning it, then exporting\nit as a reusable image.`)),mdx(\"h4\",{\"id\":\"user-content-post-processors\",\"data-text-content\":\"Post-Processors\",\"className\":\"g-type-display-5\"},`Post-Processors`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-import\"},`googlecompute-import`),` -\nThe googlecompute-import post-processor imports an existing raw disk image, and imports it as a GCE image that can be\nused for launching instances from.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/integrations/hashicorp/googlecompute/latest/components/post-processor/googlecompute-export\"},`googlecompute-export`),` -\nThe googlecompute-export post-processor exports the image built by the googlecompute builder as a .tar.gz archive into Google\nCloud Storage (GCS).`))),mdx(\"h3\",{\"id\":\"user-content-authentication\",\"data-text-content\":\"Authentication\",\"className\":\"g-type-display-4\"},`Authentication`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Authenticating with Google Cloud services requires either a User Application Default Credentials,\na JSON Service Account Key or an Access Token.  These are `,mdx(\"strong\",{parentName:\"p\"},`not`),` required if you are\nrunning the `,mdx(\"inlineCode\",{parentName:\"p\"},`googlecompute`),` Packer builder on Google Cloud with a\nproperly-configured `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://cloud.google.com/compute/docs/authentication\"},`Google Service\nAccount`),`.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The following options are available for the `,mdx(\"inlineCode\",{parentName:\"p\"},`googlecompute`),` builder, the googlecompute-export`,mdx(\"inlineCode\",{parentName:\"p\"},`, and\nthe `),`googlecompute-import\\`:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`access_token`),` (string) - A temporary `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://developers.google.com/identity/protocols/oauth2\"},`OAuth 2.0 access token`),`\nobtained from the Google Authorization server, i.e. the `,mdx(\"inlineCode\",{parentName:\"p\"},`Authorization: Bearer`),` token used to\nauthenticate HTTP requests to GCP APIs.\nThis is an alternative to `,mdx(\"inlineCode\",{parentName:\"p\"},`account_file`),`, and ignores the `,mdx(\"inlineCode\",{parentName:\"p\"},`scopes`),` field.\nIf both are specified, `,mdx(\"inlineCode\",{parentName:\"p\"},`access_token`),` will be used over the `,mdx(\"inlineCode\",{parentName:\"p\"},`account_file`),` field.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`These access tokens cannot be renewed by Packer and thus will only work until they expire.\nIf you anticipate Packer needing access for longer than a token's lifetime (default `,mdx(\"inlineCode\",{parentName:\"p\"},`1 hour`),`),\nplease use a service account key with `,mdx(\"inlineCode\",{parentName:\"p\"},`account_file`),` instead.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`account_file`),` (string) - The JSON file containing your account credentials. Not required if you\nrun Packer on a GCE instance with a service account. Instructions for\ncreating the file or using service accounts are above.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`credentials_file`),` (string) - The JSON file containing your account credentials.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`The file's contents may be anything supported by the Google Go client, i.e.:`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},`Service account JSON`),mdx(\"li\",{parentName:\"ul\"},`OIDC-provided token for federation`),mdx(\"li\",{parentName:\"ul\"},`Gcloud user credentials file (refresh-token JSON)`),mdx(\"li\",{parentName:\"ul\"},`A Google Developers Console client_credentials.json`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`credentials_json`),` (string) - The raw JSON payload for credentials.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`The accepted data formats are same as those described under\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"#credentials_file\"},`credentials_file`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`impersonate_service_account`),` (string) - This allows service account impersonation as per the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://cloud.google.com/iam/docs/impersonating-service-accounts\"},`docs`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`vault_gcp_oauth_engine`),` (string) - Can be set instead of account_file. If set, this builder will use\nHashiCorp Vault to generate an Oauth token for authenticating against\nGoogle Cloud. The value should be the path of the token generator\nwithin vault.\nFor information on how to configure your Vault + GCP engine to produce\nOauth tokens, see `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.vaultproject.io/docs/auth/gcp\"},`https://www.vaultproject.io/docs/auth/gcp`),`\nYou must have the environment variables VAULT_ADDR and VAULT_TOKEN set,\nalong with any other relevant variables for accessing your vault\ninstance. For more information, see the Vault docs:\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.vaultproject.io/docs/commands/#environment-variables\"},`https://www.vaultproject.io/docs/commands/#environment-variables`),`\nExample:`,mdx(\"inlineCode\",{parentName:\"p\"},`\"vault_gcp_oauth_engine\": \"gcp/token/my-project-editor\",`)))),mdx(\"h4\",{\"id\":\"user-content-running-locally-on-your-workstation.\",\"data-text-content\":\"Running locally on your workstation\",\"className\":\"g-type-display-5\"},`Running locally on your workstation.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`If you run the `,mdx(\"inlineCode\",{parentName:\"p\"},`googlecompute`),` Packer builder locally on your workstation, you will\nneed to install the Google Cloud SDK and authenticate using `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://cloud.google.com/sdk/gcloud/reference/auth/application-default\"},`User Application Default\nCredentials`),`.\nYou don't need to specify an `,mdx(\"em\",{parentName:\"p\"},`account file`),` if you are using this method. Your user\nmust have at least `,mdx(\"inlineCode\",{parentName:\"p\"},`Compute Instance Admin (v1)`),` \u0026 `,mdx(\"inlineCode\",{parentName:\"p\"},`Service Account User`),` roles\nto use Packer succesfully.`),mdx(\"h4\",{\"id\":\"user-content-running-on-google-cloud\",\"data-text-content\":\"Running on Google Cloud\",\"className\":\"g-type-display-5\"},`Running on Google Cloud`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`If you run the `,mdx(\"inlineCode\",{parentName:\"p\"},`googlecompute`),` Packer builder on GCE or GKE, you can\nconfigure that instance or cluster to use a `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://cloud.google.com/compute/docs/authentication\"},`Google Service\nAccount`),`. This will allow\nPacker to authenticate to Google Cloud without having to bake in a separate\ncredential/authentication file.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`It is recommended that you create a custom service account for Packer and assign it\n`,mdx(\"inlineCode\",{parentName:\"p\"},`Compute Instance Admin (v1)`),` \u0026 `,mdx(\"inlineCode\",{parentName:\"p\"},`Service Account User`),` roles.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`For `,mdx(\"inlineCode\",{parentName:\"p\"},`gcloud`),`, you can run the following commands:`),mdx(\"pre\",{\"className\":\"language-shell-session\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shell-session\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token shell-symbol important\"},`$`),` `,mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`gcloud iam service-accounts create packer `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --project YOUR_GCP_PROJECT `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --description`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},`\"Packer Service Account\"`),` `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --display-name`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},`\"Packer Service Account\"`))),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token shell-symbol important\"},`$`),` `,mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`    --member`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),`serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`    --role`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),`roles/compute.instanceAdmin.v1`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token shell-symbol important\"},`$`),` `,mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`    --member`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),`serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`    --role`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),`roles/iam.serviceAccountUser`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token shell-symbol important\"},`$`),` `,mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`gcloud projects add-iam-policy-binding YOUR_GCP_PROJECT `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`    --member`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),`serviceAccount:packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`    --role`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),`roles/iap.tunnelResourceAccessor`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token shell-symbol important\"},`$`),` `,mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`gcloud compute instances create `,mdx(\"span\",{parentName:\"span\",\"className\":\"token environment constant\"},`INSTANCE`),`-NAME `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --project YOUR_GCP_PROJECT `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --image-family ubuntu-2004-lts `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --image-project ubuntu-os-cloud `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --network YOUR_GCP_NETWORK `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --zone YOUR_GCP_ZONE `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --service-account`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),`packer@YOUR_GCP_PROJECT.iam.gserviceaccount.com `,mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`\\\\`))),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token command\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token bash language-bash\"},`  --scopes`,mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},`=`),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},`\"https://www.googleapis.com/auth/cloud-platform\"`))),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`The service account will be used automatically by Packer as long as there is\nno `,mdx(\"em\",{parentName:\"strong\"},`account file`),` specified in the Packer configuration file.`)),mdx(\"h4\",{\"id\":\"user-content-running-outside-of-google-cloud\",\"data-text-content\":\"Running outside of Google Cloud\",\"className\":\"g-type-display-5\"},`Running outside of Google Cloud`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://console.cloud.google.com\"},`Google Cloud Console`),` allows\nyou to create and download a credential file that will let you use the\n`,mdx(\"inlineCode\",{parentName:\"p\"},`googlecompute`),` Packer builder anywhere. To make the process more\nstraightforwarded, it is documented here.`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Log into the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://console.cloud.google.com/iam-admin/serviceaccounts\"},`Google Cloud\nConsole`),` and select a project.`)),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Click Select a project, choose your project, and click Open.`)),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Click Create Service Account.`)),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Enter a service account name (friendly display name), an optional description, select the `,mdx(\"inlineCode\",{parentName:\"p\"},`Compute Engine Instance Admin (v1)`),` and `,mdx(\"inlineCode\",{parentName:\"p\"},`Service Account User`),` roles, and then click Save.`)),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Generate a JSON Key and save it in a secure location.`)),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Set the Environment Variable `,mdx(\"inlineCode\",{parentName:\"p\"},`GOOGLE_APPLICATION_CREDENTIALS`),` to point to the path of the service account key.`))),mdx(\"h4\",{\"id\":\"user-content-precedence-of-authentication-methods\",\"data-text-content\":\"Precedence of Authentication Methods\",\"className\":\"g-type-display-5\"},`Precedence of Authentication Methods`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Packer looks for credentials in the following places, preferring the first\nlocation found:`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`An `,mdx(\"inlineCode\",{parentName:\"p\"},`access_token`),` option in your packer file.`)),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`An `,mdx(\"inlineCode\",{parentName:\"p\"},`account_file`),` option in your packer file.`)),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`A JSON file (Service Account) whose path is specified by the\n`,mdx(\"inlineCode\",{parentName:\"p\"},`GOOGLE_APPLICATION_CREDENTIALS`),` environment variable.`)),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`A JSON file in a location known to the `,mdx(\"inlineCode\",{parentName:\"p\"},`gcloud`),` command-line tool.\n(`,mdx(\"inlineCode\",{parentName:\"p\"},`gcloud auth application-default login`),` creates it)`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`On Windows, this is:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},`%APPDATA%/gcloud/application_default_credentials.json`,`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`On other systems:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},`$HOME/.config/gcloud/application_default_credentials.json`,`\n`))),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`On Google Compute Engine and Google App Engine Managed VMs, it fetches\ncredentials from the metadata server. (Needs a correct VM authentication\nscope configuration, see above.)`))),mdx(\"h3\",{\"id\":\"user-content-examples\",\"data-text-content\":\"Examples\",\"className\":\"g-type-display-4\"},`Examples`),mdx(\"h4\",{\"id\":\"user-content-basic-example\",\"data-text-content\":\"Basic Example\",\"className\":\"g-type-display-5\"},`Basic Example`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Below is a fully functioning example. It doesn't do anything useful since no\nprovisioners or startup-script metadata are defined, but it will effectively\nrepackage an existing GCE image.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`JSON`)),mdx(\"pre\",{\"className\":\"language-json\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-json\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"builders\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"type\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"project_id\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my project\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"source_image\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"debian-9-stretch-v20200805\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"ssh_username\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"zone\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`HCL2`)),mdx(\"pre\",{\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},`source `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"basic-example\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`project_id`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my project\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`source_image`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"debian-9-stretch-v20200805\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`ssh_username`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`zone`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`build`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`sources`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"sources.googlecompute.basic-example\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"h4\",{\"id\":\"user-content-windows-example\",\"data-text-content\":\"Windows Example\",\"className\":\"g-type-display-5\"},`Windows Example`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Before you can provision using the winrm communicator, you need to allow\ntraffic through google's firewall on the winrm port (tcp:5986). You can do so\nusing the gcloud command.`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},`gcloud compute firewall-rules create allow-winrm --allow tcp:5986`,`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Or alternatively by navigating to `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://console.cloud.google.com/networking/firewalls/list\"},`https://console.cloud.google.com/networking/firewalls/list`),`.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Once this is set up, the following is a complete working packer config after\nsetting a valid `,mdx(\"inlineCode\",{parentName:\"p\"},`project_id`),`:`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`JSON`)),mdx(\"pre\",{\"className\":\"language-json\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-json\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"builders\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"type\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"project_id\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my project\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"source_image\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"windows-server-2019-dc-v20200813\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"disk_size\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"50\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"machine_type\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"n1-standard-2\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"communicator\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"winrm\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"winrm_username\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer_user\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"winrm_insecure\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},`true`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"winrm_use_ssl\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},`true`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"metadata\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`        `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"sysprep-specialize-script-cmd\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"winrm quickconfig -quiet \u0026 net user /add packer_user \u0026 net localgroup administrators packer_user /add \u0026 winrm set winrm/config/service/auth @{Basic=\\\\\"true\\\\\"}\"`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"zone\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`HCL2`)),mdx(\"pre\",{\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},`source `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"windows-example\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`project_id`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"MY_PROJECT\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`source_image`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"windows-server-2019-dc-v20200813\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`zone`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`disk_size`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},`50`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`machine_type`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"n1-standard-2\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`communicator`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"winrm\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`winrm_username`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer_user\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`winrm_insecure`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},`true`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`winrm_use_ssl`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},`true`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`metadata`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`sysprep-specialize-script-cmd`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"winrm quickconfig -quiet \u0026 net user /add packer_user \u0026 net localgroup administrators packer_user /add \u0026 winrm set winrm/config/service/auth @{Basic=\\\\\"true\\\\\"}\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`build`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`sources`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"sources.googlecompute.windows-example\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"div\",{\"className\":\"alert alert-info g-type-body\"},mdx(\"p\",{parentName:\"div\",\"className\":\"g-type-long-body\"},``,mdx(\"strong\",{parentName:\"p\"},`Warning:`),` Please note that if you're setting up WinRM for provisioning, you'll probably want to turn it off or restrict its permissions as part of a shutdown script at the end of Packer's provisioning process. For more details on the why/how, check out this useful blog post and the associated code:\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/\"},`https://missionimpossiblecode.io/post/winrm-for-provisioning-close-the-door-on-the-way-out-eh/`))),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This build can take up to 15 min.`),mdx(\"h4\",{\"id\":\"user-content-windows-over-winssh-example\",\"data-text-content\":\"Windows over WinSSH Example\",\"className\":\"g-type-display-5\"},`Windows over WinSSH Example`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The following uses Windows SSH as backend communicator\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse\"},`https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse`)),mdx(\"pre\",{\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},`source `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"windows-ssh-example\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`project_id`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"MY_PROJECT\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`source_image`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"windows-server-2019-dc-v20200813\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`zone`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-east4-a\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`disk_size`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},`50`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`machine_type`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"n1-standard-2\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`communicator`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"ssh\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`ssh_username`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` var.packer_username`,`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`ssh_password`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` var.packer_user_password`,`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`ssh_timeout`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"1h\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`metadata`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`sysprep-specialize-script-cmd`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"net user `,mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`$`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`{`),mdx(\"span\",{parentName:\"span\",\"className\":\"token keyword\"},`var`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`.`),mdx(\"span\",{parentName:\"span\",\"className\":\"token type variable\"},`packer_username`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`}`)),` \\\\\"`,mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`$`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`{`),mdx(\"span\",{parentName:\"span\",\"className\":\"token keyword\"},`var`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`.`),mdx(\"span\",{parentName:\"span\",\"className\":\"token type variable\"},`packer_user_password`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`}`)),`\\\\\" /add /y \u0026 wmic UserAccount where Name=\\\\\"`,mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`$`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`{`),mdx(\"span\",{parentName:\"span\",\"className\":\"token keyword\"},`var`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`.`),mdx(\"span\",{parentName:\"span\",\"className\":\"token type variable\"},`packer_username`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`}`)),`\\\\\" set PasswordExpires=False \u0026 net localgroup administrators `,mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`$`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`{`),mdx(\"span\",{parentName:\"span\",\"className\":\"token keyword\"},`var`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`.`),mdx(\"span\",{parentName:\"span\",\"className\":\"token type variable\"},`packer_username`),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},`}`)),` /add \u0026 powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 \u0026 powershell Start-Service sshd \u0026 powershell Set-Service -Name sshd -StartupType 'Automatic' \u0026 powershell New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 \u0026 powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \\\\\"Set-ExecutionPolicy -ExecutionPolicy bypass -Force\\\\\"\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`build`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`sources`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"sources.googlecompute.windows-ssh-example\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`provisioner`,mdx(\"span\",{parentName:\"span\",\"className\":\"token type variable\"},` \"powershell\" `)),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`script`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"../scripts/install-features.ps1\"`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`elevated_user`),`     `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` var.packer_username`,`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`elevated_password`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` var.packer_user_password`,`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"h4\",{\"id\":\"user-content-windows-over-winssh-ansible-provisioner\",\"data-text-content\":\"Windows over WinSSH - Ansible Provisioner\",\"className\":\"g-type-display-5\"},`Windows over WinSSH - Ansible Provisioner`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The following uses Windows SSH as backend communicator\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse\"},`https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse`),`\nwith a private key.`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},`The `,mdx(\"inlineCode\",{parentName:\"li\"},`sysprep-specialize-script-cmd`),` creates the `,mdx(\"inlineCode\",{parentName:\"li\"},`packer_user`),` and adds it to the local administrators group and configures the ssh key, firewall rule and required permissions.`)),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},`source \"googlecompute\" \"windows-ssh-ansible\" {`,`\n`,`  project_id              = var.project_id`,`\n`,`  source_image            = \"windows-server-2019-dc-v20200813\"`,`\n`,`  zone                    = \"us-east4-a\"`,`\n`,`  disk_size               = 50`,`\n`,`  machine_type            = \"n1-standard-8\"`,`\n`,`  communicator            = \"ssh\"`,`\n`,`  ssh_username            = var.packer_username`,`\n`,`  ssh_private_key_file    = var.ssh_key_file_path`,`\n`,`  ssh_timeout             = \"1h\"`,`\n`,`  `,`\n`,`  metadata = {`,`\n`,`    sysprep-specialize-script-cmd = \"net user \\${var.packer_username} \\\\\"\\${var.packer_user_password}\\\\\" /add /y \u0026 wmic UserAccount where Name=\\\\\"\\${var.packer_username}\\\\\" set PasswordExpires=False \u0026 net localgroup administrators \\${var.packer_username} /add \u0026 powershell Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0 \u0026 echo \\${var.ssh_pub_key} \u003e C:\\\\\\\\ProgramData\\\\\\\\ssh\\\\\\\\administrators_authorized_keys \u0026 icacls.exe \\\\\"C:\\\\\\\\ProgramData\\\\\\\\ssh\\\\\\\\administrators_authorized_keys\\\\\" /inheritance:r /grant \\\\\"Administrators:F\\\\\" /grant \\\\\"SYSTEM:F\\\\\" \u0026 powershell New-ItemProperty -Path \\\\\"HKLM:\\\\\\\\SOFTWARE\\\\\\\\OpenSSH\\\\\" -Name DefaultShell -Value \\\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\WindowsPowerShell\\\\\\\\v1.0\\\\\\\\powershell.exe\\\\\" -PropertyType String -Force  \u0026 powershell Start-Service sshd \u0026 powershell Set-Service -Name sshd -StartupType 'Automatic' \u0026 powershell New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 \u0026 powershell.exe -NoProfile -ExecutionPolicy Bypass -Command \\\\\"Set-ExecutionPolicy -ExecutionPolicy bypass -Force\\\\\"\"`,`\n`,`  }`,`\n`,`  account_file = var.account_file_path`,`\n`,`\n`,`}`,`\n`,`\n`,`build {`,`\n`,`  sources = [\"sources.googlecompute.windows-ssh-ansible\"]`,`\n`,`\n`,`  provisioner \"ansible\" {`,`\n`,`    playbook_file           = \"./playbooks/playbook.yml\"`,`\n`,`    use_proxy               = false`,`\n`,`    ansible_ssh_extra_args  = [\"-o StrictHostKeyChecking=no -o IdentitiesOnly=yes\"]`,`\n`,`    ssh_authorized_key_file = \"var.public_key_path\"`,`\n`,`    extra_arguments = [\"-e\", \"win_packages=\\${var.win_packages}\",`,`\n`,`      \"-e\",`,`\n`,`      \"ansible_shell_type=powershell\",`,`\n`,`      \"-e\",`,`\n`,`      \"ansible_shell_executable=None\",`,`\n`,`      \"-e\",`,`\n`,`      \"ansible_shell_executable=None\"`,`\n`,`    ]`,`\n`,`    user = var.packer_username`,`\n`,`  }`,`\n`,`\n`,`}`,`\n`,`\n`)),mdx(\"h4\",{\"id\":\"user-content-nested-hypervisor-example\",\"data-text-content\":\"Nested Hypervisor Example\",\"className\":\"g-type-display-5\"},`Nested Hypervisor Example`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This is an example of using the `,mdx(\"inlineCode\",{parentName:\"p\"},`image_licenses`),` configuration option to create\na GCE image that has nested virtualization enabled. See `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://cloud.google.com/compute/docs/instances/enable-nested-virtualization-vm-instances\"},`Enabling Nested\nVirtualization for VM\nInstances`),`\nfor details.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`JSON`)),mdx(\"pre\",{\"className\":\"language-json\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-json\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"builders\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"type\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"project_id\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my project\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"source_image_family\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"centos-7\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"ssh_username\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"zone\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"image_licenses\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"projects/vm-options/global/licenses/enable-vmx\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`HCL2`)),mdx(\"pre\",{\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},`source `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"basic-example\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`project_id`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my project\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`source_image_family`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"centos-7\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`ssh_username`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`zone`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`image_licenses`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"projects/vm-options/global/licenses/enable-vmx\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`build`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`sources`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"sources.googlecompute.basic-example\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"h4\",{\"id\":\"user-content-shared-vpc-example\",\"data-text-content\":\"Shared VPC Example\",\"className\":\"g-type-display-5\"},`Shared VPC Example`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This is an example of using the `,mdx(\"inlineCode\",{parentName:\"p\"},`network_project_id`),` configuration option to create\na GCE instance in a Shared VPC Network. See `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://cloud.google.com/vpc/docs/provisioning-shared-vpc#creating_an_instance_in_a_shared_subnet\"},`Creating a GCE Instance using Shared\nVPC`),`\nfor details. The user/service account running Packer must have `,mdx(\"inlineCode\",{parentName:\"p\"},`Compute Network User`),` role on\nthe Shared VPC Host Project to create the instance in addition to the other roles mentioned in the\nRunning on Google Cloud section.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`JSON`)),mdx(\"pre\",{\"className\":\"language-json\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-json\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"builders\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"type\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"project_id\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my project\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"subnetwork\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"default\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"source_image_family\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"centos-7\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"network_project_id\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"SHARED_VPC_PROJECT\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"ssh_username\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"zone\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"image_licenses\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"projects/vm-options/global/licenses/enable-vmx\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`HCL2`)),mdx(\"pre\",{\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},`source `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"sharedvpc-example\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`project_id`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my project\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`source_image_family`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"centos-7\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`subnetwork`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"default\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`network_project_id`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"SHARED_VPC_PROJECT\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`ssh_username`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`zone`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`image_licenses`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"projects/vm-options/global/licenses/enable-vmx\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`build`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`sources`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"sources.googlecompute.sharedvpc-example\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"h4\",{\"id\":\"user-content-separate-image-project-example\",\"data-text-content\":\"Separate Image Project Example\",\"className\":\"g-type-display-5\"},`Separate Image Project Example`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This is an example of using the `,mdx(\"inlineCode\",{parentName:\"p\"},`image_project_id`),` configuration option to create\nthe generated image in a different GCP project than the one used to create the virtual machine. Make sure that Packer has permission in the target project to manage images, the `,mdx(\"inlineCode\",{parentName:\"p\"},`Compute Storage Admin`),` role will grant the desired permissions.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`JSON`)),mdx(\"pre\",{\"className\":\"language-json\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-json\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"builders\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"type\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"project_id\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my project\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"image_project_id\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my image target project\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"source_image\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"debian-9-stretch-v20200805\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"ssh_username\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`,`),`\n`,`      `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`\"zone\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},`:`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),`\n`,`    `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`HCL2`)),mdx(\"pre\",{\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},`source `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"googlecompute\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"basic-example\"`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`project_id`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my project\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`image_project_id`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"my image target project\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`source_image`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"debian-9-stretch-v20200805\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`ssh_username`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"packer\"`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`zone`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"us-central1-a\"`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},`build`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`{`),`\n`,`  `,mdx(\"span\",{parentName:\"code\",\"className\":\"token property\"},`sources`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`=`),` `,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`[`),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},`\"sources.googlecompute.basic-example\"`),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`]`),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},`}`),`\n`)))};MDXContent.isMDXComponent=true;","scope":{}}},"__N_SSG":true},"page":"/[productSlug]/integrations/[organizationSlug]/[integrationSlug]","query":{"productSlug":"packer","organizationSlug":"hashicorp","integrationSlug":"googlecompute"},"buildId":"QZMQfpnfAAfunlkxD2A4N","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-warning.js"><\x2fscript>');</script></body></html>