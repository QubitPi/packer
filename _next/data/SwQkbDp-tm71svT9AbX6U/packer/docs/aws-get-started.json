{"pageProps":{"layoutProps":{"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Documentation","url":"/packer/docs","isCurrentPage":false},{"title":"Getting Started with AWS","url":"/packer/docs/aws-get-started","isCurrentPage":true}],"sidebarNavDataLevels":[{"levelButtonProps":{"levelDownButtonText":"Packer Home"},"menuItems":[{"leadingIconName":"home","title":"HashiCorp Developer","href":"/"},{"leadingIconName":"guide","title":"Tutorials","href":"/tutorials"},{"divider":true},{"heading":"Products"},{"leadingIconName":"hcp","title":"HashiCorp Cloud Platform","href":"/hcp"},{"leadingIconName":"terraform","title":"Terraform","href":"/terraform"},{"leadingIconName":"packer","title":"Packer","href":"/packer"},{"leadingIconName":"consul","title":"Consul","href":"/consul"},{"leadingIconName":"vault","title":"Vault","href":"/vault"},{"leadingIconName":"boundary","title":"Boundary","href":"/boundary"},{"leadingIconName":"nomad","title":"Nomad","href":"/nomad"},{"leadingIconName":"waypoint","title":"Waypoint","href":"/waypoint"},{"leadingIconName":"vagrant","title":"Vagrant","href":"/vagrant"}],"showFilterInput":false,"title":"Main Menu"},{"levelButtonProps":{"levelUpButtonText":"Main Menu","levelDownButtonText":"Previous"},"menuItems":[{"title":"Packer","fullPath":"/packer","theme":"packer"},{"title":"Install","fullPath":"/packer/install"},{"title":"Tutorials","fullPath":"/packer/tutorials"},{"title":"Documentation","fullPath":"/packer/docs"},{"title":"Guides","fullPath":"/packer/guides"},{"title":"Integrations","fullPath":"/packer/integrations"}],"showFilterInput":false,"title":"Packer","visuallyHideTitle":true},{"backToLinkProps":{"text":"Packer Home","href":"/packer"},"levelButtonProps":{"levelUpButtonText":"Packer Home"},"menuItems":[{"title":"Documentation","fullPath":"/packer/docs","theme":"packer"},{"title":"What is Packer?","routes":[{"title":"Overview","path":"intro","filePath":"../content/docs/intro/index.mdx","fullPath":"/packer/docs/intro","id":"sidebar-nav-item-1"},{"title":"Why Use Packer?","path":"intro/why","filePath":"../content/docs/intro/why.mdx","fullPath":"/packer/docs/intro/why","id":"sidebar-nav-item-2"},{"title":"Use Cases","path":"intro/use-cases","filePath":"../content/docs/intro/use-cases.mdx","fullPath":"/packer/docs/intro/use-cases","id":"sidebar-nav-item-3"}],"id":"sidebar-nav-item-0"},{"title":"HCP Packer","path":"hcp","filePath":"../content/docs/hcp/index.mdx","fullPath":"/packer/docs/hcp","id":"sidebar-nav-item-4"},{"divider":true,"id":"sidebar-nav-item-5"},{"title":"Getting Started with AWS","path":"aws-get-started","filePath":"../content/docs/aws-get-started.mdx","fullPath":"/packer/docs/aws-get-started","id":"sidebar-nav-item-6"},{"divider":true,"id":"sidebar-nav-item-7"},{"title":"Terminology","path":"terminology","filePath":"../content/docs/terminology.mdx","fullPath":"/packer/docs/terminology","id":"sidebar-nav-item-8"},{"title":"Commands (CLI)","routes":[{"title":"Overview","path":"commands","filePath":"../content/docs/commands/index.mdx","fullPath":"/packer/docs/commands","id":"sidebar-nav-item-10"},{"title":"<code>init</code>","path":"commands/init","filePath":"../content/docs/commands/init.mdx","fullPath":"/packer/docs/commands/init","id":"sidebar-nav-item-11"},{"title":"<code>plugins</code>","routes":[{"title":"Overview","path":"commands/plugins","filePath":"../content/docs/commands/plugins/index.mdx","fullPath":"/packer/docs/commands/plugins","id":"sidebar-nav-item-13"},{"title":"<code>install</code>","path":"commands/plugins/install","filePath":"../content/docs/commands/plugins/install.mdx","fullPath":"/packer/docs/commands/plugins/install","id":"sidebar-nav-item-14"},{"title":"<code>installed</code>","path":"commands/plugins/installed","filePath":"../content/docs/commands/plugins/installed.mdx","fullPath":"/packer/docs/commands/plugins/installed","id":"sidebar-nav-item-15"},{"title":"<code>remove</code>","path":"commands/plugins/remove","filePath":"../content/docs/commands/plugins/remove.mdx","fullPath":"/packer/docs/commands/plugins/remove","id":"sidebar-nav-item-16"},{"title":"<code>required</code>","path":"commands/plugins/required","filePath":"../content/docs/commands/plugins/required.mdx","fullPath":"/packer/docs/commands/plugins/required","id":"sidebar-nav-item-17"}],"id":"sidebar-nav-item-12"},{"title":"<code>build</code>","path":"commands/build","filePath":"../content/docs/commands/build.mdx","fullPath":"/packer/docs/commands/build","id":"sidebar-nav-item-18"},{"title":"<code>console</code>","path":"commands/console","filePath":"../content/docs/commands/console.mdx","fullPath":"/packer/docs/commands/console","id":"sidebar-nav-item-19"},{"title":"<code>fix</code>","path":"commands/fix","filePath":"../content/docs/commands/fix.mdx","fullPath":"/packer/docs/commands/fix","id":"sidebar-nav-item-20"},{"title":"<code>fmt</code>","path":"commands/fmt","filePath":"../content/docs/commands/fmt.mdx","fullPath":"/packer/docs/commands/fmt","id":"sidebar-nav-item-21"},{"title":"<code>inspect</code>","path":"commands/inspect","filePath":"../content/docs/commands/inspect.mdx","fullPath":"/packer/docs/commands/inspect","id":"sidebar-nav-item-22"},{"title":"<code>validate</code>","path":"commands/validate","filePath":"../content/docs/commands/validate.mdx","fullPath":"/packer/docs/commands/validate","id":"sidebar-nav-item-23"},{"title":"<code>hcl2_upgrade</code>","path":"commands/hcl2_upgrade","filePath":"../content/docs/commands/hcl2_upgrade.mdx","fullPath":"/packer/docs/commands/hcl2_upgrade","id":"sidebar-nav-item-24"}],"id":"sidebar-nav-item-9"},{"title":"Templates","routes":[{"title":"Overview","path":"templates","filePath":"../content/docs/templates/index.mdx","fullPath":"/packer/docs/templates","id":"sidebar-nav-item-26"},{"title":"JSON to HCL2","path":"templates/json_to_hcl","filePath":"../content/docs/templates/json_to_hcl.mdx","fullPath":"/packer/docs/templates/json_to_hcl","id":"sidebar-nav-item-27"},{"title":"HCL Templates","routes":[{"title":"Overview","path":"templates/hcl_templates","filePath":"../content/docs/templates/hcl_templates/index.mdx","fullPath":"/packer/docs/templates/hcl_templates","id":"sidebar-nav-item-29"},{"title":"Blocks","routes":[{"title":"Overview","path":"templates/hcl_templates/blocks","filePath":"../content/docs/templates/hcl_templates/blocks/index.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks","id":"sidebar-nav-item-31"},{"title":"<code>build</code>","routes":[{"title":"Overview","path":"templates/hcl_templates/blocks/build","filePath":"../content/docs/templates/hcl_templates/blocks/build/index.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/build","id":"sidebar-nav-item-33"},{"title":"<code>hcp_packer_registry</code>","path":"templates/hcl_templates/blocks/build/hcp_packer_registry","filePath":"../content/docs/templates/hcl_templates/blocks/build/hcp_packer_registry.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/build/hcp_packer_registry","id":"sidebar-nav-item-34"},{"title":"<code>source</code>","path":"templates/hcl_templates/blocks/build/source","filePath":"../content/docs/templates/hcl_templates/blocks/build/source.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/build/source","id":"sidebar-nav-item-35"},{"title":"<code>provisioner</code>","path":"templates/hcl_templates/blocks/build/provisioner","filePath":"../content/docs/templates/hcl_templates/blocks/build/provisioner.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/build/provisioner","id":"sidebar-nav-item-36"},{"title":"<code>post-processor</code>","path":"templates/hcl_templates/blocks/build/post-processor","filePath":"../content/docs/templates/hcl_templates/blocks/build/post-processor.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/build/post-processor","id":"sidebar-nav-item-37"},{"title":"<code>post-processors</code>","path":"templates/hcl_templates/blocks/build/post-processors","filePath":"../content/docs/templates/hcl_templates/blocks/build/post-processors.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/build/post-processors","id":"sidebar-nav-item-38"}],"id":"sidebar-nav-item-32"},{"title":"<code>locals</code>","path":"templates/hcl_templates/blocks/locals","filePath":"../content/docs/templates/hcl_templates/blocks/locals.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/locals","id":"sidebar-nav-item-39"},{"title":"<code>source</code>","path":"templates/hcl_templates/blocks/source","filePath":"../content/docs/templates/hcl_templates/blocks/source.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/source","id":"sidebar-nav-item-40"},{"title":"<code>variable</code>","path":"templates/hcl_templates/blocks/variable","filePath":"../content/docs/templates/hcl_templates/blocks/variable.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/variable","id":"sidebar-nav-item-41"},{"title":"<code>packer</code>","path":"templates/hcl_templates/blocks/packer","filePath":"../content/docs/templates/hcl_templates/blocks/packer.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/packer","id":"sidebar-nav-item-42"},{"title":"<code>data</code>","path":"templates/hcl_templates/blocks/data","filePath":"../content/docs/templates/hcl_templates/blocks/data.mdx","fullPath":"/packer/docs/templates/hcl_templates/blocks/data","id":"sidebar-nav-item-43"}],"id":"sidebar-nav-item-30"},{"title":"Functions","routes":[{"title":"Overview","path":"templates/hcl_templates/functions","filePath":"../content/docs/templates/hcl_templates/functions/index.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions","id":"sidebar-nav-item-45"},{"title":"Contextual Functions","routes":[{"title":"aws_secretsmanager","path":"templates/hcl_templates/functions/contextual/aws_secretsmanager","filePath":"../content/docs/templates/hcl_templates/functions/contextual/aws_secretsmanager.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/contextual/aws_secretsmanager","id":"sidebar-nav-item-47"},{"title":"consul","path":"templates/hcl_templates/functions/contextual/consul","filePath":"../content/docs/templates/hcl_templates/functions/contextual/consul.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/contextual/consul","id":"sidebar-nav-item-48"},{"title":"env","path":"templates/hcl_templates/functions/contextual/env","filePath":"../content/docs/templates/hcl_templates/functions/contextual/env.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/contextual/env","id":"sidebar-nav-item-49"},{"title":"vault","path":"templates/hcl_templates/functions/contextual/vault","filePath":"../content/docs/templates/hcl_templates/functions/contextual/vault.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/contextual/vault","id":"sidebar-nav-item-50"}],"id":"sidebar-nav-item-46"},{"title":"Numeric Functions","routes":[{"title":"abs","path":"templates/hcl_templates/functions/numeric/abs","filePath":"../content/docs/templates/hcl_templates/functions/numeric/abs.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/numeric/abs","id":"sidebar-nav-item-52"},{"title":"ceil","path":"templates/hcl_templates/functions/numeric/ceil","filePath":"../content/docs/templates/hcl_templates/functions/numeric/ceil.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/numeric/ceil","id":"sidebar-nav-item-53"},{"title":"floor","path":"templates/hcl_templates/functions/numeric/floor","filePath":"../content/docs/templates/hcl_templates/functions/numeric/floor.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/numeric/floor","id":"sidebar-nav-item-54"},{"title":"log","path":"templates/hcl_templates/functions/numeric/log","filePath":"../content/docs/templates/hcl_templates/functions/numeric/log.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/numeric/log","id":"sidebar-nav-item-55"},{"title":"max","path":"templates/hcl_templates/functions/numeric/max","filePath":"../content/docs/templates/hcl_templates/functions/numeric/max.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/numeric/max","id":"sidebar-nav-item-56"},{"title":"min","path":"templates/hcl_templates/functions/numeric/min","filePath":"../content/docs/templates/hcl_templates/functions/numeric/min.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/numeric/min","id":"sidebar-nav-item-57"},{"title":"parseint","path":"templates/hcl_templates/functions/numeric/parseint","filePath":"../content/docs/templates/hcl_templates/functions/numeric/parseint.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/numeric/parseint","id":"sidebar-nav-item-58"},{"title":"pow","path":"templates/hcl_templates/functions/numeric/pow","filePath":"../content/docs/templates/hcl_templates/functions/numeric/pow.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/numeric/pow","id":"sidebar-nav-item-59"},{"title":"signum","path":"templates/hcl_templates/functions/numeric/signum","filePath":"../content/docs/templates/hcl_templates/functions/numeric/signum.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/numeric/signum","id":"sidebar-nav-item-60"}],"id":"sidebar-nav-item-51"},{"title":"String Functions","routes":[{"title":"chomp","path":"templates/hcl_templates/functions/string/chomp","filePath":"../content/docs/templates/hcl_templates/functions/string/chomp.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/chomp","id":"sidebar-nav-item-62"},{"title":"format","path":"templates/hcl_templates/functions/string/format","filePath":"../content/docs/templates/hcl_templates/functions/string/format.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/format","id":"sidebar-nav-item-63"},{"title":"formatlist","path":"templates/hcl_templates/functions/string/formatlist","filePath":"../content/docs/templates/hcl_templates/functions/string/formatlist.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/formatlist","id":"sidebar-nav-item-64"},{"title":"indent","path":"templates/hcl_templates/functions/string/indent","filePath":"../content/docs/templates/hcl_templates/functions/string/indent.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/indent","id":"sidebar-nav-item-65"},{"title":"join","path":"templates/hcl_templates/functions/string/join","filePath":"../content/docs/templates/hcl_templates/functions/string/join.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/join","id":"sidebar-nav-item-66"},{"title":"lower","path":"templates/hcl_templates/functions/string/lower","filePath":"../content/docs/templates/hcl_templates/functions/string/lower.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/lower","id":"sidebar-nav-item-67"},{"title":"replace","path":"templates/hcl_templates/functions/string/replace","filePath":"../content/docs/templates/hcl_templates/functions/string/replace.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/replace","id":"sidebar-nav-item-68"},{"title":"regex_replace","path":"templates/hcl_templates/functions/string/regex_replace","filePath":"../content/docs/templates/hcl_templates/functions/string/regex_replace.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/regex_replace","id":"sidebar-nav-item-69"},{"title":"regex","path":"templates/hcl_templates/functions/string/regex","filePath":"../content/docs/templates/hcl_templates/functions/string/regex.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/regex","id":"sidebar-nav-item-70"},{"title":"regexall","path":"templates/hcl_templates/functions/string/regexall","filePath":"../content/docs/templates/hcl_templates/functions/string/regexall.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/regexall","id":"sidebar-nav-item-71"},{"title":"split","path":"templates/hcl_templates/functions/string/split","filePath":"../content/docs/templates/hcl_templates/functions/string/split.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/split","id":"sidebar-nav-item-72"},{"title":"strrev","path":"templates/hcl_templates/functions/string/strrev","filePath":"../content/docs/templates/hcl_templates/functions/string/strrev.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/strrev","id":"sidebar-nav-item-73"},{"title":"substr","path":"templates/hcl_templates/functions/string/substr","filePath":"../content/docs/templates/hcl_templates/functions/string/substr.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/substr","id":"sidebar-nav-item-74"},{"title":"title","path":"templates/hcl_templates/functions/string/title","filePath":"../content/docs/templates/hcl_templates/functions/string/title.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/title","id":"sidebar-nav-item-75"},{"title":"trim","path":"templates/hcl_templates/functions/string/trim","filePath":"../content/docs/templates/hcl_templates/functions/string/trim.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/trim","id":"sidebar-nav-item-76"},{"title":"trimprefix","path":"templates/hcl_templates/functions/string/trimprefix","filePath":"../content/docs/templates/hcl_templates/functions/string/trimprefix.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/trimprefix","id":"sidebar-nav-item-77"},{"title":"trimsuffix","path":"templates/hcl_templates/functions/string/trimsuffix","filePath":"../content/docs/templates/hcl_templates/functions/string/trimsuffix.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/trimsuffix","id":"sidebar-nav-item-78"},{"title":"trimspace","path":"templates/hcl_templates/functions/string/trimspace","filePath":"../content/docs/templates/hcl_templates/functions/string/trimspace.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/trimspace","id":"sidebar-nav-item-79"},{"title":"upper","path":"templates/hcl_templates/functions/string/upper","filePath":"../content/docs/templates/hcl_templates/functions/string/upper.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/string/upper","id":"sidebar-nav-item-80"}],"id":"sidebar-nav-item-61"},{"title":"Collection Functions","routes":[{"title":"chunklist","path":"templates/hcl_templates/functions/collection/chunklist","filePath":"../content/docs/templates/hcl_templates/functions/collection/chunklist.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/chunklist","id":"sidebar-nav-item-82"},{"title":"coalesce","path":"templates/hcl_templates/functions/collection/coalesce","filePath":"../content/docs/templates/hcl_templates/functions/collection/coalesce.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/coalesce","id":"sidebar-nav-item-83"},{"title":"coalescelist","path":"templates/hcl_templates/functions/collection/coalescelist","filePath":"../content/docs/templates/hcl_templates/functions/collection/coalescelist.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/coalescelist","id":"sidebar-nav-item-84"},{"title":"compact","path":"templates/hcl_templates/functions/collection/compact","filePath":"../content/docs/templates/hcl_templates/functions/collection/compact.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/compact","id":"sidebar-nav-item-85"},{"title":"concat","path":"templates/hcl_templates/functions/collection/concat","filePath":"../content/docs/templates/hcl_templates/functions/collection/concat.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/concat","id":"sidebar-nav-item-86"},{"title":"contains","path":"templates/hcl_templates/functions/collection/contains","filePath":"../content/docs/templates/hcl_templates/functions/collection/contains.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/contains","id":"sidebar-nav-item-87"},{"title":"distinct","path":"templates/hcl_templates/functions/collection/distinct","filePath":"../content/docs/templates/hcl_templates/functions/collection/distinct.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/distinct","id":"sidebar-nav-item-88"},{"title":"element","path":"templates/hcl_templates/functions/collection/element","filePath":"../content/docs/templates/hcl_templates/functions/collection/element.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/element","id":"sidebar-nav-item-89"},{"title":"flatten","path":"templates/hcl_templates/functions/collection/flatten","filePath":"../content/docs/templates/hcl_templates/functions/collection/flatten.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/flatten","id":"sidebar-nav-item-90"},{"title":"index","path":"templates/hcl_templates/functions/collection/index-fn","filePath":"../content/docs/templates/hcl_templates/functions/collection/index-fn.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/index-fn","id":"sidebar-nav-item-91"},{"title":"keys","path":"templates/hcl_templates/functions/collection/keys","filePath":"../content/docs/templates/hcl_templates/functions/collection/keys.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/keys","id":"sidebar-nav-item-92"},{"title":"length","path":"templates/hcl_templates/functions/collection/length","filePath":"../content/docs/templates/hcl_templates/functions/collection/length.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/length","id":"sidebar-nav-item-93"},{"title":"lookup","path":"templates/hcl_templates/functions/collection/lookup","filePath":"../content/docs/templates/hcl_templates/functions/collection/lookup.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/lookup","id":"sidebar-nav-item-94"},{"title":"merge","path":"templates/hcl_templates/functions/collection/merge","filePath":"../content/docs/templates/hcl_templates/functions/collection/merge.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/merge","id":"sidebar-nav-item-95"},{"title":"range","path":"templates/hcl_templates/functions/collection/range","filePath":"../content/docs/templates/hcl_templates/functions/collection/range.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/range","id":"sidebar-nav-item-96"},{"title":"reverse","path":"templates/hcl_templates/functions/collection/reverse","filePath":"../content/docs/templates/hcl_templates/functions/collection/reverse.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/reverse","id":"sidebar-nav-item-97"},{"title":"setintersection","path":"templates/hcl_templates/functions/collection/setintersection","filePath":"../content/docs/templates/hcl_templates/functions/collection/setintersection.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/setintersection","id":"sidebar-nav-item-98"},{"title":"setproduct","path":"templates/hcl_templates/functions/collection/setproduct","filePath":"../content/docs/templates/hcl_templates/functions/collection/setproduct.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/setproduct","id":"sidebar-nav-item-99"},{"title":"setunion","path":"templates/hcl_templates/functions/collection/setunion","filePath":"../content/docs/templates/hcl_templates/functions/collection/setunion.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/setunion","id":"sidebar-nav-item-100"},{"title":"slice","path":"templates/hcl_templates/functions/collection/slice","filePath":"../content/docs/templates/hcl_templates/functions/collection/slice.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/slice","id":"sidebar-nav-item-101"},{"title":"sort","path":"templates/hcl_templates/functions/collection/sort","filePath":"../content/docs/templates/hcl_templates/functions/collection/sort.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/sort","id":"sidebar-nav-item-102"},{"title":"values","path":"templates/hcl_templates/functions/collection/values","filePath":"../content/docs/templates/hcl_templates/functions/collection/values.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/values","id":"sidebar-nav-item-103"},{"title":"zipmap","path":"templates/hcl_templates/functions/collection/zipmap","filePath":"../content/docs/templates/hcl_templates/functions/collection/zipmap.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/collection/zipmap","id":"sidebar-nav-item-104"}],"id":"sidebar-nav-item-81"},{"title":"Encoding Functions","routes":[{"title":"base64decode","path":"templates/hcl_templates/functions/encoding/base64decode","filePath":"../content/docs/templates/hcl_templates/functions/encoding/base64decode.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/base64decode","id":"sidebar-nav-item-106"},{"title":"base64encode","path":"templates/hcl_templates/functions/encoding/base64encode","filePath":"../content/docs/templates/hcl_templates/functions/encoding/base64encode.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/base64encode","id":"sidebar-nav-item-107"},{"title":"csvdecode","path":"templates/hcl_templates/functions/encoding/csvdecode","filePath":"../content/docs/templates/hcl_templates/functions/encoding/csvdecode.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/csvdecode","id":"sidebar-nav-item-108"},{"title":"jsondecode","path":"templates/hcl_templates/functions/encoding/jsondecode","filePath":"../content/docs/templates/hcl_templates/functions/encoding/jsondecode.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/jsondecode","id":"sidebar-nav-item-109"},{"title":"jsonencode","path":"templates/hcl_templates/functions/encoding/jsonencode","filePath":"../content/docs/templates/hcl_templates/functions/encoding/jsonencode.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/jsonencode","id":"sidebar-nav-item-110"},{"title":"urlencode","path":"templates/hcl_templates/functions/encoding/urlencode","filePath":"../content/docs/templates/hcl_templates/functions/encoding/urlencode.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/urlencode","id":"sidebar-nav-item-111"},{"title":"textencodebase64","path":"templates/hcl_templates/functions/encoding/textencodebase64","filePath":"../content/docs/templates/hcl_templates/functions/encoding/textencodebase64.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/textencodebase64","id":"sidebar-nav-item-112"},{"title":"textdecodebase64","path":"templates/hcl_templates/functions/encoding/textdecodebase64","filePath":"../content/docs/templates/hcl_templates/functions/encoding/textdecodebase64.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/textdecodebase64","id":"sidebar-nav-item-113"},{"title":"yamldecode","path":"templates/hcl_templates/functions/encoding/yamldecode","filePath":"../content/docs/templates/hcl_templates/functions/encoding/yamldecode.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/yamldecode","id":"sidebar-nav-item-114"},{"title":"yamlencode","path":"templates/hcl_templates/functions/encoding/yamlencode","filePath":"../content/docs/templates/hcl_templates/functions/encoding/yamlencode.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/encoding/yamlencode","id":"sidebar-nav-item-115"}],"id":"sidebar-nav-item-105"},{"title":"Filesystem Functions","routes":[{"title":"abspath","path":"templates/hcl_templates/functions/file/abspath","filePath":"../content/docs/templates/hcl_templates/functions/file/abspath.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/file/abspath","id":"sidebar-nav-item-117"},{"title":"basename","path":"templates/hcl_templates/functions/file/basename","filePath":"../content/docs/templates/hcl_templates/functions/file/basename.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/file/basename","id":"sidebar-nav-item-118"},{"title":"dirname","path":"templates/hcl_templates/functions/file/dirname","filePath":"../content/docs/templates/hcl_templates/functions/file/dirname.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/file/dirname","id":"sidebar-nav-item-119"},{"title":"file","path":"templates/hcl_templates/functions/file/file","filePath":"../content/docs/templates/hcl_templates/functions/file/file.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/file/file","id":"sidebar-nav-item-120"},{"title":"fileexists","path":"templates/hcl_templates/functions/file/fileexists","filePath":"../content/docs/templates/hcl_templates/functions/file/fileexists.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/file/fileexists","id":"sidebar-nav-item-121"},{"title":"fileset","path":"templates/hcl_templates/functions/file/fileset","filePath":"../content/docs/templates/hcl_templates/functions/file/fileset.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/file/fileset","id":"sidebar-nav-item-122"},{"title":"pathexpand","path":"templates/hcl_templates/functions/file/pathexpand","filePath":"../content/docs/templates/hcl_templates/functions/file/pathexpand.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/file/pathexpand","id":"sidebar-nav-item-123"},{"title":"templatefile","path":"templates/hcl_templates/functions/file/templatefile","filePath":"../content/docs/templates/hcl_templates/functions/file/templatefile.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/file/templatefile","id":"sidebar-nav-item-124"}],"id":"sidebar-nav-item-116"},{"title":"Date and Time Functions","routes":[{"title":"formatdate","path":"templates/hcl_templates/functions/datetime/formatdate","filePath":"../content/docs/templates/hcl_templates/functions/datetime/formatdate.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/datetime/formatdate","id":"sidebar-nav-item-126"},{"title":"timeadd","path":"templates/hcl_templates/functions/datetime/timeadd","filePath":"../content/docs/templates/hcl_templates/functions/datetime/timeadd.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/datetime/timeadd","id":"sidebar-nav-item-127"},{"title":"timestamp","path":"templates/hcl_templates/functions/datetime/timestamp","filePath":"../content/docs/templates/hcl_templates/functions/datetime/timestamp.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/datetime/timestamp","id":"sidebar-nav-item-128"},{"title":"legacy_isotime","path":"templates/hcl_templates/functions/datetime/legacy_isotime","filePath":"../content/docs/templates/hcl_templates/functions/datetime/legacy_isotime.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/datetime/legacy_isotime","id":"sidebar-nav-item-129"},{"title":"legacy_strftime","path":"templates/hcl_templates/functions/datetime/legacy_strftime","filePath":"../content/docs/templates/hcl_templates/functions/datetime/legacy_strftime.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/datetime/legacy_strftime","id":"sidebar-nav-item-130"}],"id":"sidebar-nav-item-125"},{"title":"Hash and Crypto Functions","routes":[{"title":"bcrypt","path":"templates/hcl_templates/functions/crypto/bcrypt","filePath":"../content/docs/templates/hcl_templates/functions/crypto/bcrypt.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/crypto/bcrypt","id":"sidebar-nav-item-132"},{"title":"md5","path":"templates/hcl_templates/functions/crypto/md5","filePath":"../content/docs/templates/hcl_templates/functions/crypto/md5.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/crypto/md5","id":"sidebar-nav-item-133"},{"title":"rsadecrypt","path":"templates/hcl_templates/functions/crypto/rsadecrypt","filePath":"../content/docs/templates/hcl_templates/functions/crypto/rsadecrypt.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/crypto/rsadecrypt","id":"sidebar-nav-item-134"},{"title":"sha1","path":"templates/hcl_templates/functions/crypto/sha1","filePath":"../content/docs/templates/hcl_templates/functions/crypto/sha1.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/crypto/sha1","id":"sidebar-nav-item-135"},{"title":"sha256","path":"templates/hcl_templates/functions/crypto/sha256","filePath":"../content/docs/templates/hcl_templates/functions/crypto/sha256.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/crypto/sha256","id":"sidebar-nav-item-136"},{"title":"sha512","path":"templates/hcl_templates/functions/crypto/sha512","filePath":"../content/docs/templates/hcl_templates/functions/crypto/sha512.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/crypto/sha512","id":"sidebar-nav-item-137"}],"id":"sidebar-nav-item-131"},{"title":"UUID Functions","routes":[{"title":"uuidv4","path":"templates/hcl_templates/functions/uuid/uuidv4","filePath":"../content/docs/templates/hcl_templates/functions/uuid/uuidv4.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/uuid/uuidv4","id":"sidebar-nav-item-139"},{"title":"uuidv5","path":"templates/hcl_templates/functions/uuid/uuidv5","filePath":"../content/docs/templates/hcl_templates/functions/uuid/uuidv5.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/uuid/uuidv5","id":"sidebar-nav-item-140"}],"id":"sidebar-nav-item-138"},{"title":"IP Network Functions","routes":[{"title":"cidrhost","path":"templates/hcl_templates/functions/ipnet/cidrhost","filePath":"../content/docs/templates/hcl_templates/functions/ipnet/cidrhost.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/ipnet/cidrhost","id":"sidebar-nav-item-142"},{"title":"cidrnetmask","path":"templates/hcl_templates/functions/ipnet/cidrnetmask","filePath":"../content/docs/templates/hcl_templates/functions/ipnet/cidrnetmask.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/ipnet/cidrnetmask","id":"sidebar-nav-item-143"},{"title":"cidrsubnet","path":"templates/hcl_templates/functions/ipnet/cidrsubnet","filePath":"../content/docs/templates/hcl_templates/functions/ipnet/cidrsubnet.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/ipnet/cidrsubnet","id":"sidebar-nav-item-144"},{"title":"cidrsubnets","path":"templates/hcl_templates/functions/ipnet/cidrsubnets","filePath":"../content/docs/templates/hcl_templates/functions/ipnet/cidrsubnets.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/ipnet/cidrsubnets","id":"sidebar-nav-item-145"}],"id":"sidebar-nav-item-141"},{"title":"Type Conversion Functions","routes":[{"title":"can","path":"templates/hcl_templates/functions/conversion/can","filePath":"../content/docs/templates/hcl_templates/functions/conversion/can.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/conversion/can","id":"sidebar-nav-item-147"},{"title":"convert","path":"templates/hcl_templates/functions/conversion/convert","filePath":"../content/docs/templates/hcl_templates/functions/conversion/convert.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/conversion/convert","id":"sidebar-nav-item-148"},{"title":"try","path":"templates/hcl_templates/functions/conversion/try","filePath":"../content/docs/templates/hcl_templates/functions/conversion/try.mdx","fullPath":"/packer/docs/templates/hcl_templates/functions/conversion/try","id":"sidebar-nav-item-149"}],"id":"sidebar-nav-item-146"}],"id":"sidebar-nav-item-44"},{"title":"Variables","path":"templates/hcl_templates/variables","filePath":"../content/docs/templates/hcl_templates/variables.mdx","fullPath":"/packer/docs/templates/hcl_templates/variables","id":"sidebar-nav-item-150"},{"title":"Locals","path":"templates/hcl_templates/locals","filePath":"../content/docs/templates/hcl_templates/locals.mdx","fullPath":"/packer/docs/templates/hcl_templates/locals","id":"sidebar-nav-item-151"},{"title":"Contextual Variables","path":"templates/hcl_templates/contextual-variables","filePath":"../content/docs/templates/hcl_templates/contextual-variables.mdx","fullPath":"/packer/docs/templates/hcl_templates/contextual-variables","id":"sidebar-nav-item-152"},{"title":"Data Sources","path":"templates/hcl_templates/datasources","filePath":"../content/docs/templates/hcl_templates/datasources.mdx","fullPath":"/packer/docs/templates/hcl_templates/datasources","id":"sidebar-nav-item-153"},{"title":"Path Variables","path":"templates/hcl_templates/path-variables","filePath":"../content/docs/templates/hcl_templates/path-variables.mdx","fullPath":"/packer/docs/templates/hcl_templates/path-variables","id":"sidebar-nav-item-154"},{"title":"Syntax","path":"templates/hcl_templates/syntax","filePath":"../content/docs/templates/hcl_templates/syntax.mdx","fullPath":"/packer/docs/templates/hcl_templates/syntax","id":"sidebar-nav-item-155"},{"title":"Only Except","path":"templates/hcl_templates/onlyexcept","filePath":"../content/docs/templates/hcl_templates/onlyexcept.mdx","fullPath":"/packer/docs/templates/hcl_templates/onlyexcept","id":"sidebar-nav-item-156"},{"title":"Expressions","path":"templates/hcl_templates/expressions","filePath":"../content/docs/templates/hcl_templates/expressions.mdx","fullPath":"/packer/docs/templates/hcl_templates/expressions","id":"sidebar-nav-item-157"},{"title":"JSON Syntax","path":"templates/hcl_templates/syntax-json","filePath":"../content/docs/templates/hcl_templates/syntax-json.mdx","fullPath":"/packer/docs/templates/hcl_templates/syntax-json","id":"sidebar-nav-item-158"}],"id":"sidebar-nav-item-28"},{"title":"JSON Templates","routes":[{"title":"Overview","path":"templates/legacy_json_templates","filePath":"../content/docs/templates/legacy_json_templates/index.mdx","fullPath":"/packer/docs/templates/legacy_json_templates","id":"sidebar-nav-item-160"},{"title":"Builders","path":"templates/legacy_json_templates/builders","filePath":"../content/docs/templates/legacy_json_templates/builders.mdx","fullPath":"/packer/docs/templates/legacy_json_templates/builders","id":"sidebar-nav-item-161"},{"title":"Communicators","path":"templates/legacy_json_templates/communicator","filePath":"../content/docs/templates/legacy_json_templates/communicator.mdx","fullPath":"/packer/docs/templates/legacy_json_templates/communicator","id":"sidebar-nav-item-162"},{"title":"Engine","path":"templates/legacy_json_templates/engine","filePath":"../content/docs/templates/legacy_json_templates/engine.mdx","fullPath":"/packer/docs/templates/legacy_json_templates/engine","id":"sidebar-nav-item-163"},{"title":"Post-Processors","path":"templates/legacy_json_templates/post-processors","filePath":"../content/docs/templates/legacy_json_templates/post-processors.mdx","fullPath":"/packer/docs/templates/legacy_json_templates/post-processors","id":"sidebar-nav-item-164"},{"title":"Provisioners","path":"templates/legacy_json_templates/provisioners","filePath":"../content/docs/templates/legacy_json_templates/provisioners.mdx","fullPath":"/packer/docs/templates/legacy_json_templates/provisioners","id":"sidebar-nav-item-165"},{"title":"User Variables","path":"templates/legacy_json_templates/user-variables","filePath":"../content/docs/templates/legacy_json_templates/user-variables.mdx","fullPath":"/packer/docs/templates/legacy_json_templates/user-variables","id":"sidebar-nav-item-166"}],"id":"sidebar-nav-item-159"}],"id":"sidebar-nav-item-25"},{"divider":true,"id":"sidebar-nav-item-167"},{"title":"Communicators","routes":[{"title":"Overview","path":"communicators","filePath":"../content/docs/communicators/index.mdx","fullPath":"/packer/docs/communicators","id":"sidebar-nav-item-169"},{"title":"SSH","path":"communicators/ssh","filePath":"../content/docs/communicators/ssh.mdx","fullPath":"/packer/docs/communicators/ssh","id":"sidebar-nav-item-170"},{"title":"WINRM","path":"communicators/winrm","filePath":"../content/docs/communicators/winrm.mdx","fullPath":"/packer/docs/communicators/winrm","id":"sidebar-nav-item-171"}],"id":"sidebar-nav-item-168"},{"title":"Builders","routes":[{"title":"Overview","path":"builders","filePath":"../content/docs/builders/index.mdx","fullPath":"/packer/docs/builders","id":"sidebar-nav-item-173"},{"title":"File","path":"builders/file","filePath":"../content/docs/builders/file.mdx","fullPath":"/packer/docs/builders/file","id":"sidebar-nav-item-174"},{"title":"Null","path":"builders/null","filePath":"../content/docs/builders/null.mdx","fullPath":"/packer/docs/builders/null","id":"sidebar-nav-item-175"},{"title":"Custom","path":"builders/custom","filePath":"../content/docs/builders/custom.mdx","fullPath":"/packer/docs/builders/custom","id":"sidebar-nav-item-176"},{"title":"Community-Supported","path":"builders/community-supported","filePath":"../content/docs/builders/community-supported.mdx","fullPath":"/packer/docs/builders/community-supported","id":"sidebar-nav-item-177"}],"id":"sidebar-nav-item-172"},{"title":"Data Sources","routes":[{"title":"Overview","path":"datasources","filePath":"../content/docs/datasources/index.mdx","fullPath":"/packer/docs/datasources","id":"sidebar-nav-item-179"},{"title":"HCP Packer","routes":[{"title":"Overview","path":"datasources/hcp","filePath":"../content/docs/datasources/hcp/index.mdx","fullPath":"/packer/docs/datasources/hcp","id":"sidebar-nav-item-181"},{"title":"Version","path":"datasources/hcp/hcp-packer-version","filePath":"../content/docs/datasources/hcp/hcp-packer-version.mdx","fullPath":"/packer/docs/datasources/hcp/hcp-packer-version","id":"sidebar-nav-item-182"},{"title":"Artifact","path":"datasources/hcp/hcp-packer-artifact","filePath":"../content/docs/datasources/hcp/hcp-packer-artifact.mdx","fullPath":"/packer/docs/datasources/hcp/hcp-packer-artifact","id":"sidebar-nav-item-183"},{"title":"Iteration","path":"datasources/hcp/hcp-packer-iteration","filePath":"../content/docs/datasources/hcp/hcp-packer-iteration.mdx","fullPath":"/packer/docs/datasources/hcp/hcp-packer-iteration","id":"sidebar-nav-item-184"},{"title":"Image","path":"datasources/hcp/hcp-packer-image","filePath":"../content/docs/datasources/hcp/hcp-packer-image.mdx","fullPath":"/packer/docs/datasources/hcp/hcp-packer-image","id":"sidebar-nav-item-185"}],"id":"sidebar-nav-item-180"},{"title":"HTTP","path":"datasources/http","filePath":"../content/docs/datasources/http.mdx","fullPath":"/packer/docs/datasources/http","id":"sidebar-nav-item-186"}],"id":"sidebar-nav-item-178"},{"title":"Provisioners","routes":[{"title":"Overview","path":"provisioners","filePath":"../content/docs/provisioners/index.mdx","fullPath":"/packer/docs/provisioners","id":"sidebar-nav-item-188"},{"title":"Breakpoint","path":"provisioners/breakpoint","filePath":"../content/docs/provisioners/breakpoint.mdx","fullPath":"/packer/docs/provisioners/breakpoint","id":"sidebar-nav-item-189"},{"title":"File","path":"provisioners/file","filePath":"../content/docs/provisioners/file.mdx","fullPath":"/packer/docs/provisioners/file","id":"sidebar-nav-item-190"},{"title":"PowerShell","path":"provisioners/powershell","filePath":"../content/docs/provisioners/powershell.mdx","fullPath":"/packer/docs/provisioners/powershell","id":"sidebar-nav-item-191"},{"title":"Shell","path":"provisioners/shell","filePath":"../content/docs/provisioners/shell.mdx","fullPath":"/packer/docs/provisioners/shell","id":"sidebar-nav-item-192"},{"title":"Shell (Local)","path":"provisioners/shell-local","filePath":"../content/docs/provisioners/shell-local.mdx","fullPath":"/packer/docs/provisioners/shell-local","id":"sidebar-nav-item-193"},{"title":"Windows Shell","path":"provisioners/windows-shell","filePath":"../content/docs/provisioners/windows-shell.mdx","fullPath":"/packer/docs/provisioners/windows-shell","id":"sidebar-nav-item-194"},{"title":"Windows Restart","path":"provisioners/windows-restart","filePath":"../content/docs/provisioners/windows-restart.mdx","fullPath":"/packer/docs/provisioners/windows-restart","id":"sidebar-nav-item-195"},{"title":"Custom","path":"provisioners/custom","filePath":"../content/docs/provisioners/custom.mdx","fullPath":"/packer/docs/provisioners/custom","id":"sidebar-nav-item-196"},{"title":"Community-Supported","path":"provisioners/community-supported","filePath":"../content/docs/provisioners/community-supported.mdx","fullPath":"/packer/docs/provisioners/community-supported","id":"sidebar-nav-item-197"}],"id":"sidebar-nav-item-187"},{"title":"Post-Processors","routes":[{"title":"Overview","path":"post-processors","filePath":"../content/docs/post-processors/index.mdx","fullPath":"/packer/docs/post-processors","id":"sidebar-nav-item-199"},{"title":"Artifice","path":"post-processors/artifice","filePath":"../content/docs/post-processors/artifice.mdx","fullPath":"/packer/docs/post-processors/artifice","id":"sidebar-nav-item-200"},{"title":"Compress","path":"post-processors/compress","filePath":"../content/docs/post-processors/compress.mdx","fullPath":"/packer/docs/post-processors/compress","id":"sidebar-nav-item-201"},{"title":"Checksum","path":"post-processors/checksum","filePath":"../content/docs/post-processors/checksum.mdx","fullPath":"/packer/docs/post-processors/checksum","id":"sidebar-nav-item-202"},{"title":"Manifest","path":"post-processors/manifest","filePath":"../content/docs/post-processors/manifest.mdx","fullPath":"/packer/docs/post-processors/manifest","id":"sidebar-nav-item-203"},{"title":"Shell (Local)","path":"post-processors/shell-local","filePath":"../content/docs/post-processors/shell-local.mdx","fullPath":"/packer/docs/post-processors/shell-local","id":"sidebar-nav-item-204"},{"title":"Community-Supported","path":"post-processors/community-supported","filePath":"../content/docs/post-processors/community-supported.mdx","fullPath":"/packer/docs/post-processors/community-supported","id":"sidebar-nav-item-205"}],"id":"sidebar-nav-item-198"},{"divider":true,"id":"sidebar-nav-item-206"},{"title":"Installing Packer","path":"install","filePath":"../content/docs/install.mdx","fullPath":"/packer/docs/install","id":"sidebar-nav-item-207"},{"title":"Configuring Packer","path":"configure","filePath":"../content/docs/configure.mdx","fullPath":"/packer/docs/configure","id":"sidebar-nav-item-208"},{"title":"Release notes","routes":[{"title":"v1.11","path":"release-notes/v1_11","filePath":"../content/docs/release-notes/v1_11.mdx","fullPath":"/packer/docs/release-notes/v1_11","id":"sidebar-nav-item-210"}],"id":"sidebar-nav-item-209"},{"title":"Upgrades","routes":[{"title":"Upgrade to v1.11","path":"upgrade/v1_11","filePath":"../content/docs/upgrade/v1_11.mdx","fullPath":"/packer/docs/upgrade/v1_11","id":"sidebar-nav-item-212"}],"id":"sidebar-nav-item-211"},{"divider":true,"id":"sidebar-nav-item-213"},{"title":"Plugins","routes":[{"title":"Overview","path":"plugins","filePath":"../content/docs/plugins/index.mdx","fullPath":"/packer/docs/plugins","id":"sidebar-nav-item-215"},{"title":"Installing Plugins","path":"plugins/install","filePath":"../content/docs/plugins/install.mdx","fullPath":"/packer/docs/plugins/install","id":"sidebar-nav-item-216"},{"title":"Developing Plugins","routes":[{"title":"Overview","path":"plugins/creation","filePath":"../content/docs/plugins/creation/index.mdx","fullPath":"/packer/docs/plugins/creation","id":"sidebar-nav-item-218"},{"title":"Custom Builders","path":"plugins/creation/custom-builders","filePath":"../content/docs/plugins/creation/custom-builders.mdx","fullPath":"/packer/docs/plugins/creation/custom-builders","id":"sidebar-nav-item-219"},{"title":"Custom Post-Processors","path":"plugins/creation/custom-post-processors","filePath":"../content/docs/plugins/creation/custom-post-processors.mdx","fullPath":"/packer/docs/plugins/creation/custom-post-processors","id":"sidebar-nav-item-220"},{"title":"Custom Provisioners","path":"plugins/creation/custom-provisioners","filePath":"../content/docs/plugins/creation/custom-provisioners.mdx","fullPath":"/packer/docs/plugins/creation/custom-provisioners","id":"sidebar-nav-item-221"},{"title":"Custom Data Sources","path":"plugins/creation/custom-datasources","filePath":"../content/docs/plugins/creation/custom-datasources.mdx","fullPath":"/packer/docs/plugins/creation/custom-datasources","id":"sidebar-nav-item-222"},{"title":"HCP Packer Support","path":"plugins/creation/hcp-support","filePath":"../content/docs/plugins/creation/hcp-support.mdx","fullPath":"/packer/docs/plugins/creation/hcp-support","id":"sidebar-nav-item-223"},{"title":"Plugin Loading Specification","path":"plugins/creation/plugin-load-spec","filePath":"../content/docs/plugins/creation/plugin-load-spec.mdx","fullPath":"/packer/docs/plugins/creation/plugin-load-spec","id":"sidebar-nav-item-224"}],"id":"sidebar-nav-item-217"}],"id":"sidebar-nav-item-214"},{"title":"Integration Program","path":"partnerships","filePath":"../content/docs/partnerships.mdx","fullPath":"/packer/docs/partnerships","id":"sidebar-nav-item-225"},{"title":"Community Tools","path":"community-tools","filePath":"../content/docs/community-tools.mdx","fullPath":"/packer/docs/community-tools","id":"sidebar-nav-item-226"},{"divider":true,"id":"sidebar-nav-item-227"},{"title":"Debugging","path":"debugging","filePath":"../content/docs/debugging.mdx","fullPath":"/packer/docs/debugging","id":"sidebar-nav-item-228"}],"title":"Documentation","visuallyHideTitle":true}],"mainWidth":"narrow","githubFileUrl":"https://github.com/hashicorp/packer/blob/main/website/../content/docs/aws-get-started.mdx"},"metadata":{"title":"Getting Started with AWS","description":null,"layout":null},"outlineItems":[{"title":"Install Packer","url":"#install-packer"},{"title":"Build an Image","url":"#build-an-image"},{"title":"Authenticating to AWS","url":"#authenticating-to-aws"},{"title":"Initialize Packer Configuration","url":"#initialize-packer-configuration"},{"title":"Formatting and Validating Packer Template","url":"#formatting-and-validating-packer-template"},{"title":"Building Packer Image","url":"#building-packer-image"},{"title":"Managing the Image","url":"#managing-the-image"},{"title":"Deploying Packer Image with Terraform","url":"#deploying-packer-image-with-terraform"},{"title":"GitHub Actions","url":"#github-actions"}],"pageHeading":{"id":"aws-get-started","title":"aws-get-started"},"mdxSource":{"compiledSource":"const layoutProps={};const MDXLayout=\"wrapper\";function MDXContent({components,...props}){return mdx(MDXLayout,{...layoutProps,...props,components:components,mdxType:\"MDXLayout\"},mdx(\"p\",null,`This post is the alternative of\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://qubitpi.github.io/hashicorp-packer/packer/tutorials/aws-get-started\"},`Getting Started with AWS`),` and\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/terraform/tutorials/provision/packer#build-your-packer-image\"},`Provision Infrastructure with Packer`),`, whose contents\nhave been closed sourced by HashiCorp.`),mdx(\"p\",null,`HashiCorp Packer automates the creation of any type of machine image, including AWS AMIs. You'll build an Ubuntu\nmachine image on AWS in this tutorial.`),mdx(\"h2\",{\"id\":\"install-packer\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#install-packer\",\"aria-label\":\"install packer permalink\"},`\\xbb`),`Install Packer`),mdx(\"h3\",{\"id\":\"macos\"},mdx(\"a\",{parentName:\"h3\",\"className\":\"__permalink-h\",\"href\":\"#macos\",\"aria-label\":\"macos permalink\"},`\\xbb`),`macOS`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` brew tap hashicorp/tap`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` brew install hashicorp/tap/packer`)),`\n`)),mdx(\"h2\",{\"id\":\"build-an-image\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#build-an-image\",\"aria-label\":\"build an image permalink\"},`\\xbb`),`Build an Image`),mdx(\"p\",null,`With Packer installed, it is time to build your first image. In this tutorial, we will build a `,mdx(\"inlineCode\",{parentName:\"p\"},`t2.micro`),`\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://aws.amazon.com/ec2/\"},`Amazon EC2 AMI`),`.`),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"strong\",{parentName:\"p\"},`Note`),`: This tutorial will provision resources that qualify under the AWS free-tier. If our account doesn't qualify\nunder the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://aws.amazon.com/free/\"},`AWS free-tier`),`, Packer is not responsible for any charges that may incur.`)),mdx(\"h3\",{\"id\":\"write-packer-template\"},mdx(\"a\",{parentName:\"h3\",\"className\":\"__permalink-h\",\"href\":\"#write-packer-template\",\"aria-label\":\"write packer template permalink\"},`\\xbb`),`Write Packer Template`),mdx(\"p\",null,`A `,mdx(\"strong\",{parentName:\"p\"},`Packer template`),` is a configuration file that defines the image we want to build and how to build it. Packer\ntemplates use the `,mdx(\"strong\",{parentName:\"p\"},`Hashicorp Configuration Language`),` (`,mdx(\"strong\",{parentName:\"p\"},`HCL`),`).`),mdx(\"p\",null,`HashiCorp has a comprehensive `,mdx(\"a\",{parentName:\"p\",\"href\":\"/terraform/tutorials/provision/packer\"},`tutorial`),` on how\nto build an image and deploys an instance of that image to AWS. The tutorial introduces a standard directory structure\nfor storing HashiCorp related files. This structure can be found in their\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/stealth-tech-startup/learn-terraform-provisioning\"},`tutorial code repo`),`. We will be using that as\nour reference file structure:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},`.\n my-app/\n     hashicorp/\n        images/\n           aws-my-app.pkr.hcl\n           variables.pkr.hcl\n        instances/\n           main.tf\n        scripts/\n            script.sh\n     src\n     ...\n`)),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},`The `,mdx(\"strong\",{parentName:\"p\"},`images/`),` contains Packer related files`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},`The `,mdx(\"strong\",{parentName:\"li\"},`scripts/`),` directory has the post-build script for the AMI image, which we will cover later`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},`The `,mdx(\"strong\",{parentName:\"p\"},`instances/`),` contains Terraform related files`))),mdx(\"p\",null,`Create the file `,mdx(\"strong\",{parentName:\"p\"},`aws-my-ami.pkr.hcl`),` and add the following HCL block to it, and save the file.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"hcl\",\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`packer`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  required_plugins`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    amazon `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      version `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \">= 0.0.2\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      source  `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"github.com/hashicorp/amazon\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"my-ami\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ami_name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"my-ami\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  force_deregister `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"true\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  force_delete_snapshot `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"true\"`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  instance_type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"t2.micro\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  region `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"us-west-1\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  source_ami_filter`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    filters `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu/images/*ubuntu-*-20.04-amd64-server-*\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      root-device-type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ebs\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      virtualization-type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"hvm\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    most_recent `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    owners `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"099720109477\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ssh_username `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"install-my-ami\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  sources `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`    \"source.amazon-ebs.my-ami\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ]`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  provisioner`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"shell\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    environment_vars `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`      \"GH_PAT_READ=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`var`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`gh_pat_read`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    ]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    script `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"../scripts/setup.sh\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",null,`This is a complete Packer template that we will use to build an AWS Ubuntu AMI in the `,mdx(\"inlineCode\",{parentName:\"p\"},`us-west-1`),` region. In the\nfollowing sections, we will review each block of this template in more detail.`),mdx(\"h4\",{\"id\":\"packer-block\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#packer-block\",\"aria-label\":\"packer block permalink\"},`\\xbb`),`Packer Block`),mdx(\"p\",null,`The \\`packer {} block contains Packer settings, including specifying a required Packer version.`),mdx(\"p\",null,`In addition, we will find `,mdx(\"strong\",{parentName:\"p\"},`required_plugins`),` block in the Packer block, which specifies all the plugins required by\nthe template to build our image. Even though Packer is packaged into a single binary, it depends on plugins for much of\nits functionality. Some of these plugins, like the Amazon AMI Builder (AMI builder) which we will to use, are built,\nmaintained, and distributed by HashiCorp; but anyone can write and use plugins.`),mdx(\"p\",null,`Each plugin block contains a `,mdx(\"strong\",{parentName:\"p\"},`version`),` and `,mdx(\"strong\",{parentName:\"p\"},`source`),` attribute. Packer will use these attributes to download the\nappropriate plugin(s).`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},`The `,mdx(\"em\",{parentName:\"li\"},`source`),` attribute is only necessary when requiring a plugin outside the HashiCorp domain. We can find the full\nlist of HashiCorp and community maintained builders plugins in the `,mdx(\"a\",{parentName:\"li\",\"href\":\"/packer/docs/builders\"},`Packer Builders`),` documentation\npage.`),mdx(\"li\",{parentName:\"ul\"},`The `,mdx(\"em\",{parentName:\"li\"},`version`),` attribute is optional, but we recommend using it to constrain the plugin version so that Packer does\nnot install a version of the plugin that does not work with our template. If we do not specify a plugin version,\nPacker will automatically download the most recent version during initialization.`)),mdx(\"p\",null,`In the example template above, Packer will use the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/stealth-tech-startup/packer-plugin-amazon/blob/main/docs/builders/index.mdx\"},`Packer Amazon AMI builder plugin`),`\nthat is greater than version 0.0.2.`),mdx(\"h4\",{\"id\":\"source-block\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#source-block\",\"aria-label\":\"source block permalink\"},`\\xbb`),`Source Block`),mdx(\"p\",null,`The `,mdx(\"strong\",{parentName:\"p\"},`source`),` block configures a specific builder plugin, which is then invoked by a `,mdx(\"a\",{parentName:\"p\",\"href\":\"#packer-block\"},`build block`),`.\nSource blocks use `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/builders\"},`builders`),` and `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/communicators\"},`communicators`),` to define what kind of\nvirtualization to use, how to launch the image we want to provision, and how to connect to it. Builders and\ncommunicators are bundled together and configured side-by-side in a source block. A `,mdx(\"em\",{parentName:\"p\"},`source`),` can be reused across\nmultiple `,mdx(\"a\",{parentName:\"p\",\"href\":\"#the-build-block\"},`builds`),`, and we can use multiple sources in a single build. A builder plugin is a component\nof Packer that is responsible for creating a machine and turning that machine into an image.`),mdx(\"p\",null,`A source block has two important labels: a builder type and a name. These two labels together will allow us to uniquely\nreference sources later on when we define build runs. In the example template above, the builder type is `,mdx(\"inlineCode\",{parentName:\"p\"},`amazon-ebs`),`\nand the name is `,mdx(\"inlineCode\",{parentName:\"p\"},`my-ami`),`.`),mdx(\"p\",null,`Each builder has its own unique set of configuration attributes. The\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/stealth-tech-startup/packer-plugin-amazon/blob/main/docs/builders/ebs.mdx\"},`amazon-ebs`),` builder\nlaunches the source AMI, runs provisioners within this instance, then repackages it into an EBS-backed AMI.`),mdx(\"p\",null,`In the example template, the `,mdx(\"em\",{parentName:\"p\"},`amazon-ebs`),` builder configuration launches a `,mdx(\"inlineCode\",{parentName:\"p\"},`t2.micro`),` AMI in the `,mdx(\"inlineCode\",{parentName:\"p\"},`us-west-1`),` region\nusing an `,mdx(\"em\",{parentName:\"p\"},`ubuntu:20.04`),` AMI as the base image, then creates an image named \"my-ami\" from that instance. The builder\nwill create all the temporary resources necessary (for example, keypairs, security group rules, etc..) to temporarily\naccess the instance while the image is being created.`),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},`Note that the `,mdx(\"inlineCode\",{parentName:\"p\"},`owners      = [\"099720109477\"]`),` is the \"owner\" who publishes the Ubuntu AMI image, not the image ID`)),mdx(\"p\",null,`This example template also uses the `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/communicators/ssh\"},`SSH communicator`),`. By specifying the `,mdx(\"strong\",{parentName:\"p\"},`ssh_username`),`\nattribute, Packer is able to SSH into EC2 instance using a temporary keypair and security group to provision our\ninstances.`),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"strong\",{parentName:\"p\"},`About `,mdx(\"inlineCode\",{parentName:\"strong\"},`force_deregister = \"true\"`),` & `,mdx(\"inlineCode\",{parentName:\"strong\"},`force_delete_snapshot = \"true\"`))),mdx(\"p\",{parentName:\"blockquote\"},`Force Packer to first deregister an existing AMI if one with the same name already exists; then delete snapshots\nassociated with AMIs, which have been deregistered by `,mdx(\"inlineCode\",{parentName:\"p\"},`force_deregister`),`. This is very important because otherwise\nPacker fails by complaining that AMI with the same name is already there. In addition, we don't have to worry about\ncleaning up AMI on AWS; we simply keep AMI version controlled as code rather than a hard-to-main AMI infrastructures.\nSee `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://awsbloglink.wordpress.com/2017/12/11/how-to-overwrite-aws-ec2-ami-with-packer/\"},`this post`),` and\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/stealth-tech-startup/packer-plugin-amazon/blob/main/docs/builders/ebs.mdx\"},`Packer doc`),` for more\ninfo`)),mdx(\"h4\",{\"id\":\"the-build-block\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#the-build-block\",\"aria-label\":\"the build block permalink\"},`\\xbb`),`The Build Block`),mdx(\"p\",null,`The `,mdx(\"strong\",{parentName:\"p\"},`build block`),` defines what Packer should do with the EC2 instance after it launches.`),mdx(\"p\",null,`In the example template, the build block references the AMI defined by the source block above\n(`,mdx(\"inlineCode\",{parentName:\"p\"},`source.amazon-ebs.my-ami`),`).`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"hcl\",\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  sources `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`    \"source.amazon-ebs.ubuntu\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"h5\",{\"id\":\"provisioners\"},mdx(\"a\",{parentName:\"h5\",\"className\":\"__permalink-h\",\"href\":\"#provisioners\",\"aria-label\":\"provisioners permalink\"},`\\xbb`),`Provisioners`),mdx(\"p\",null,`Historically, pre-baked images have been frowned upon because changing them was so tedious and slow. Because Packer is\ncompletely automated (including provisioning) images can be changed quickly and integrated with modern configuration\nmanagement tools such as Chef or Puppet. Using provisioners allow us to do exactly for that`),mdx(\"p\",null,`Notice that the `,mdx(\"inlineCode\",{parentName:\"p\"},`source.amazon-ebs.my-ami`),` uses the `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/communicators/ssh\"},`SSH communicator`),`. By specifying the\n`,mdx(\"em\",{parentName:\"p\"},`ssh_username`),` attribute, Packer is able to SSH into EC2 instance using a temporary keypair and security group to\nprovision our instances.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"hcl\",\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"my-ami\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`  ## ...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ssh_username `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",null,`Our provisioner block is in our Packer template, inside the build block and underneath the `,mdx(\"em\",{parentName:\"p\"},`sources`),` assignment:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"hcl\",\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  ...`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  provisioner`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"shell\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    environment_vars `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`      \"GH_PAT_READ=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`var`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`gh_pat_read`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    ]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    script `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"../scripts/setup.sh\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",null,`This block defines a `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/provisioners/shell\"},`shell provisioner`),` which sets an environment variable named GH_PAT_READ\nin the shell execution environment and runs the script at a specified relative path. The\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://qubitpi.github.io/hashicorp-packer/packer/docs/provisioners/shell#environment_vars\"},mdx(\"strong\",{parentName:\"a\"},`environment_vars`)),`\noption is used to pass argument into the provisioner script so that the script can reference it via `,mdx(\"inlineCode\",{parentName:\"p\"},`$GH_PAT_READ`),`:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"bash\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`#!/bin/bash`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`set`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` -x`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`sudo`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` apt`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` update`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},` &&`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},` sudo`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` apt`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` upgrade`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` -y`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`sudo`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` apt`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` install`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` software-properties-common`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` -y`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`sudo`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` add-apt-repository`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` ppa:deadsnakes/ppa`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`sudo`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` apt`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` install`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` python3.10`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` -y`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`sudo`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` apt`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` install`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` python3-pip`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` -y`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`git`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` clone`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` https://`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`$GH_PAT_READ`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`@github.com/MyGitHub/my-app.git`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`cd`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` /home/ubuntu/my-app`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`sudo`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` pip3`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` install`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` .`)),`\n`)),mdx(\"p\",null,`The script, when IAM image is up for customization, installs some system dependencies, clones some repositories, and\nsetup the app in the script. Note that the repository clone uses the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://stackoverflow.com/a/70320541\"},`GitHub PAT token`),`, which we pass in`),mdx(\"p\",null,`We've passed dynamic data from Template file into our provisioner script. However, our Packer template is usually run\nin some CI/CD process and those dynamic data usually originate from the CI/CD configurations. How do we pass those\nconfigurations into the Packer build/template then?`),mdx(\"p\",null,`We can use input variables to serve as parameters for a Packer build, allowing aspects of the build to be customized\nwithout altering Packer template. In addition, Packer variables are useful when we want to reference a specific value\nthroughout our template. To do that, we have the following variable block in our\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/guides/hcl/variables\"},mdx(\"strong\",{parentName:\"a\"},`hashicorp/images/variables.pkr.hcl file`)),`::`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"hcl\",\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`variable`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"gh_pat_read\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  string`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  sensitive `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"h2\",{\"id\":\"authenticating-to-aws\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#authenticating-to-aws\",\"aria-label\":\"authenticating to aws permalink\"},`\\xbb`),`Authenticating to AWS`),mdx(\"p\",null,`Before we can build the AMI, we need to provide our AWS credentials to Packer. These credentials have permissions to\ncreate, modify and delete EC2 instances. Refer to the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/stealth-tech-startup/packer-plugin-amazon/blob/main/docs/builders/index.mdx#iam-task-or-instance-role\"},`documentation`),`\nto find the full list IAM permissions required to run the `,mdx(\"em\",{parentName:\"p\"},`amazon-ebs`),` builder.`),mdx(\"p\",null,`To allow Packer to access our IAM user credentials, set our AWS access key ID as an environment variable.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},` export`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` AWS_ACCESS_KEY_ID`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"<YOUR_AWS_ACCESS_KEY_ID>\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},` export`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` AWS_SECRET_ACCESS_KEY`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"<YOUR_AWS_SECRET_ACCESS_KEY>\"`)),`\n`)),mdx(\"div\",{\"className\":\"alert alert-warning g-type-body\"},mdx(\"p\",{parentName:\"div\"},``,mdx(\"strong\",{parentName:\"p\"},`Note`),`: If we don't have access to IAM user credentials, use another authentication method described in the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/stealth-tech-startup/packer-plugin-amazon/blob/main/docs/builders/index.mdx#authentication\"},`Packer documentation`),`.`)),mdx(\"h2\",{\"id\":\"initialize-packer-configuration\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#initialize-packer-configuration\",\"aria-label\":\"initialize packer configuration permalink\"},`\\xbb`),`Initialize Packer Configuration`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` packer init `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`.`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Installed plugin github.com/hashicorp/amazon v0.0.2 in \"/Users/youruser/.packer.d/plugins/github.com/hashicorp/amazon/packer-plugin-amazon_v0.0.2_x5.0_darwin_amd64\"`)),`\n`)),mdx(\"p\",null,`Packer will download the plugin we've defined above. In this case, Packer will download the Packer Amazon plugin that\nis greater than version 0.0.2. We can run packer init as many times as you'd like. If we already have the plugins we\nneed, Packer will exit without an output.`),mdx(\"p\",null,`Packer has now downloaded and installed the Amazon plugin. It is ready to build the AMI!`),mdx(\"h2\",{\"id\":\"formatting-and-validating-packer-template\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#formatting-and-validating-packer-template\",\"aria-label\":\"formatting and validating packer template permalink\"},`\\xbb`),`Formatting and Validating Packer Template`),mdx(\"p\",null,`We recommend using consistent formatting in all template files. The packer `,mdx(\"strong\",{parentName:\"p\"},`fmt command`),` updates templates in the\ncurrent directory for readability and consistency.`),mdx(\"p\",null,`By formatting our template. Packer will print out the names of the files it modified, if any. In this case, our\ntemplate file was already formatted correctly, so Packer won't return any file names.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` packer fmt `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`.`)),`\n`)),mdx(\"p\",null,`We can also make sure our configuration is syntactically valid and internally consistent by using the packer `,mdx(\"strong\",{parentName:\"p\"},`validate\ncommand`),`. If Packer detects any invalid configuration, Packer will print out the file name, the error type and line\nnumber of the invalid configuration. The example configuration provided above is valid, so Packer will return nothing.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` packer validate `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`.`)),`\n`)),mdx(\"h2\",{\"id\":\"building-packer-image\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#building-packer-image\",\"aria-label\":\"building packer image permalink\"},`\\xbb`),`Building Packer Image`),mdx(\"p\",null,`Build the image with the `,mdx(\"strong\",{parentName:\"p\"},`packer build`),` command. Packer will print output similar to what is shown below.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` packer build aws-my-ami.pkr.hcl`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  learn-packer.amazon-ebs.ubuntu: output will be in this color.`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Prevalidating any provided VPC information`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Prevalidating AMI Name: learn-packer-linux-aws`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      learn-packer.amazon-ebs.ubuntu: Found Image ID: ami-0dd273d94ed0540c0`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Creating temporary keypair: packer_608a6435-e0b2-c633-95f0-bf168f01e891`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Creating temporary security group for this instance: packer_608a6437-6b48-288e-6d5e-c085366a5541`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Authorizing access to port 22 from [0.0.0.0/0] in the temporary security groups...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Launching a source AWS instance...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Adding tags to source instance`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      learn-packer.amazon-ebs.ubuntu: Adding tag: \"Name\": \"Packer Builder\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      learn-packer.amazon-ebs.ubuntu: Instance ID: i-023d696a318e9594c`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Waiting for instance (i-023d696a318e9594c) to become ready...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Using ssh communicator to connect: 35.166.142.55`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Waiting for SSH to become available...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Connected to SSH!`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Stopping the source instance...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      learn-packer.amazon-ebs.ubuntu: Stopping instance`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Waiting for the instance to stop...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Creating AMI learn-packer-linux-aws from instance i-023d696a318e9594c`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      learn-packer.amazon-ebs.ubuntu: AMI: ami-0703a21445140541e`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Waiting for AMI to become ready...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Terminating the source AWS instance...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Cleaning up any extra volumes...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: No volumes to clean up, skipping`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Deleting temporary security group...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> learn-packer.amazon-ebs.ubuntu: Deleting temporary keypair...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  Build 'learn-packer.amazon-ebs.ubuntu' finished after 3 minutes 5 seconds.`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> Wait completed after 3 minutes 5 seconds`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ==> Builds finished. The artifacts of successful builds are:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  --> learn-packer.amazon-ebs.my-ami: AMIs were created:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  us-west-2: ami-0703a21445140541e`)),`\n`)),mdx(\"p\",null,`Now visit the AWS AMI page to verify that Packer successfully built your AMI.`),mdx(\"h2\",{\"id\":\"managing-the-image\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#managing-the-image\",\"aria-label\":\"managing the image permalink\"},`\\xbb`),`Managing the Image`),mdx(\"p\",null,`Packer only builds images. It does not attempt to manage them in any way. After they're built, it is up to us to launch\nor destroy them as we see fit.`),mdx(\"p\",null,`After running the example above, our AWS account now has an AMI associated with it. AMIs are stored in S3 by Amazon so\nwe may be charged.`),mdx(\"p\",null,`We can remove the AMI by first deregistering it on the AWS AMI management page. Next, delete the associated snapshot on\nthe AWS snapshot management page.`),mdx(\"h2\",{\"id\":\"deploying-packer-image-with-terraform\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#deploying-packer-image-with-terraform\",\"aria-label\":\"deploying packer image with terraform permalink\"},`\\xbb`),`Deploying Packer Image with Terraform`),mdx(\"h3\",{\"id\":\"install-terraform\"},mdx(\"a\",{parentName:\"h3\",\"className\":\"__permalink-h\",\"href\":\"#install-terraform\",\"aria-label\":\"install terraform permalink\"},`\\xbb`),`Install Terraform`),mdx(\"p\",null,`We have seen Packer as HashiCorp's open-source tool for creating machine images from source configuration. We can\nconfigure Packer images with an operating system and software for our specific use-case.`),mdx(\"p\",null,mdx(\"a\",{parentName:\"p\",\"href\":\"https://qubitpi.github.io/hashicorp-terraform/terraform/docs\"},`Terraform`),` configuration for a compute instance can use\na Packer image to provision our instance without manual configuration.`),mdx(\"p\",null,`In this section, we will deploy the AMI image we just created using Terraform.`),mdx(\"h4\",{\"id\":\"macos-1\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#macos-1\",\"aria-label\":\"macos permalink\"},`\\xbb`),`macOS`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` brew tap hashicorp/tap`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` brew install hashicorp/tap/terraform`)),`\n`)),mdx(\"h3\",{\"id\":\"building-infrastructure\"},mdx(\"a\",{parentName:\"h3\",\"className\":\"__permalink-h\",\"href\":\"#building-infrastructure\",\"aria-label\":\"building infrastructure permalink\"},`\\xbb`),`Building Infrastructure`),mdx(\"h4\",{\"id\":\"writing-configuration\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#writing-configuration\",\"aria-label\":\"writing configuration permalink\"},`\\xbb`),`Writing Configuration`),mdx(\"p\",null,`To use the AMI in our Terraform environment, navigate to the instances directory (Each Terraform configuration must be\nin its own working directory. Create a directory for your configuration).`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` cd hashicorp/instances`)),`\n`)),mdx(\"p\",null,`Create a `,mdx(\"inlineCode\",{parentName:\"p\"},`main.tf`),` file with the following contents:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"hcl\",\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`terraform`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  required_providers`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    aws `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      source  `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"hashicorp/aws\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      version `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"~> 4.42.0\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  required_version `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \">= 0.14.5\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`provider`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"aws\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  region `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"us-west-1\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`data`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"aws_ami\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"latest-my-ami\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  most_recent `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  owners `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"255643778305\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  filter`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    name   `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"name\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    values `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"my-ami\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  filter`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    name   `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"virtualization-type\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    values `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"hvm\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`resource`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"aws_instance\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"my-ami-instance\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ami `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`data`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`aws_ami`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`latest-my-ami`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`id`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  instance_type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"t2.micro\"`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  user_data `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},` <<-EOF`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`    #!/bin/bash`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`    cd /home/ubuntu/my-ami`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`    # command that starts app, e.g. flask --app server run --host=0.0.0.0`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  EOF`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",null,`The file above in Terraform is known as a `,mdx(\"strong\",{parentName:\"p\"},`Terraform configuration`),`. The following sections review each block of this\nconfiguration in more detail.`),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"strong\",{parentName:\"p\"},`Hands-on:`),` Getting the Latest AWS AMI ID with Terraform using `,mdx(\"strong\",{parentName:\"p\"},`data block`),` and AWS API`),mdx(\"p\",{parentName:\"blockquote\"},`This is a great time saver, it stops us from having to hard code any AMI IDs within Terraform. This solution will\nalso enable us to get the latest AMIs in the region we are working in by dynamically querying the AWS API. Good\nstuff!`)),mdx(\"h5\",{\"id\":\"terraform-block\"},mdx(\"a\",{parentName:\"h5\",\"className\":\"__permalink-h\",\"href\":\"#terraform-block\",\"aria-label\":\"terraform block permalink\"},`\\xbb`),`Terraform Block`),mdx(\"p\",null,`The `,mdx(\"strong\",{parentName:\"p\"},`terraform {}`),` block contains Terraform settings, including the required providers Terraform will use to\nprovision our infrastructure. For each provider, the source attribute defines an optional hostname, a namespace, and\nthe provider type. Terraform installs providers from the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://registry.terraform.io/\"},`Terraform Registry`),` by\ndefault. In this example configuration, the aws provider's source is defined as `,mdx(\"em\",{parentName:\"p\"},`hashicorp/aws`),`, which is shorthand for\n`,mdx(\"em\",{parentName:\"p\"},`registry.terraform.io/hashicorp/aws`),`.`),mdx(\"p\",null,`We can also set a version constraint for each provider defined in the `,mdx(\"em\",{parentName:\"p\"},`required_providers`),` block. The version attribute\nis optional, but we recommend using it to constrain the provider version so that Terraform does not install a version\nof the provider that does not work with our configuration. If we do not specify a provider version, Terraform will\nautomatically download the most recent version during initialization.`),mdx(\"p\",null,`To learn more, please reference the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://qubitpi.github.io/hashicorp-terraform/terraform/language/providers/requirements\"},`provider source documentation`),`.`),mdx(\"h5\",{\"id\":\"providers\"},mdx(\"a\",{parentName:\"h5\",\"className\":\"__permalink-h\",\"href\":\"#providers\",\"aria-label\":\"providers permalink\"},`\\xbb`),`Providers`),mdx(\"p\",null,`The `,mdx(\"strong\",{parentName:\"p\"},`provider block`),` configures the specified provider, in this case `,mdx(\"inlineCode\",{parentName:\"p\"},`aws`),`. A provider is a plugin that Terraform\nuses to create and manage our resources.`),mdx(\"p\",null,`We can use multiple provider blocks in our Terraform configuration to manage resources from different providers. We can\neven use different providers together. For example, we could pass the IP address of our AWS EC2 instance to a\nmonitoring resource from DataDog.`),mdx(\"h5\",{\"id\":\"resources\"},mdx(\"a\",{parentName:\"h5\",\"className\":\"__permalink-h\",\"href\":\"#resources\",\"aria-label\":\"resources permalink\"},`\\xbb`),`Resources`),mdx(\"p\",null,`Use `,mdx(\"strong\",{parentName:\"p\"},`resource blocks`),` to define components of our infrastructure. A resource might be a physical or virtual component\nsuch as an EC2 instance, or it can be a logical resource such as a Heroku application.`),mdx(\"p\",null,`Resource blocks have two strings before the block: the resource type and the resource name. In this example, the\nresource type is `,mdx(\"em\",{parentName:\"p\"},`aws_instance`),` and the name is `,mdx(\"em\",{parentName:\"p\"},`my-ami-instance`),`. The prefix of the type maps to the name of the\nprovider. In the example configuration, Terraform manages the aws`,mdx(\"em\",{parentName:\"p\"},`instance resource with the `,mdx(\"inlineCode\",{parentName:\"em\"},`aws`),` provider. Together,\nthe resource type and resource name form a unique ID for the resource. For example, the ID for your EC2 instance is\n_aws`,`_`,`instance.my-ami-instance`),`.`),mdx(\"p\",null,`Resource blocks contain arguments which we use to configure the resource. Arguments can include things like machine\nsizes, disk image names, or VPC IDs. HashiCorp's\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://qubitpi.github.io/hashicorp-terraform/terraform/language/providers\"},`providers reference`),` lists the required\nand optional arguments for each resource. For our EC2 instance, the example configuration sets the AMI ID to our\n`,mdx(\"em\",{parentName:\"p\"},`my-ami`),` image we created above, and the instance type to `,mdx(\"em\",{parentName:\"p\"},`t2.micro`),`, which qualifies for AWS' free tier. It also sets\na tag to give the instance a name.`),mdx(\"p\",null,`We are also baking a startup script directly into the creation of our EC2 instance using Terraform. We do that using an\ninline bash script specified in the `,mdx(\"strong\",{parentName:\"p\"},`user_data`),` parameter that, for example, starts a web server.`),mdx(\"h4\",{\"id\":\"initializing-the-directory\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#initializing-the-directory\",\"aria-label\":\"initializing the directory permalink\"},`\\xbb`),`Initializing the Directory`),mdx(\"p\",null,`When we create a new configuration - or check out an existing configuration from version control - we need to\ninitialize the directory with terraform init.`),mdx(\"p\",null,`Initializing a configuration directory downloads and installs the providers defined in the configuration, which in this\ncase is the aws provider.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` terraform init`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Initializing the backend...`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Initializing provider plugins...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`- Finding hashicorp/aws versions matching \"~> 4.16\"...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`- Installing hashicorp/aws v4.17.0...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`- Installed hashicorp/aws v4.17.0 (signed by HashiCorp)`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Terraform has created a lock file .terraform.lock.hcl to record the provider`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`selections it made above. Include this file in your version control repository`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`so that Terraform can guarantee to make the same selections by default when`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`you run \"terraform init\" in the future.`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Terraform has been successfully initialized!`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`You may now begin working with Terraform. Try running \"terraform plan\" to see`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`any changes that are required for your infrastructure. All Terraform commands`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`should now work.`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`If you ever set or change modules or backend configuration for Terraform,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`rerun this command to reinitialize your working directory. If you forget, other`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`commands will detect it and remind you to do so if necessary.`)),`\n`)),mdx(\"p\",null,`Terraform downloads the `,mdx(\"inlineCode\",{parentName:\"p\"},`aws`),` provider and installs it in a hidden subdirectory of our current working directory, named\n`,mdx(\"em\",{parentName:\"p\"},`.terraform`),`. The terraform init command prints out which version of the provider was installed. Terraform also creates\na lock file named `,mdx(\"em\",{parentName:\"p\"},`.terraform.lock.hcl`),` which specifies the exact provider versions used, so that we can control when\nwe want to update the providers used for our project.`),mdx(\"h4\",{\"id\":\"formatting-and-validating-the-configuration\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#formatting-and-validating-the-configuration\",\"aria-label\":\"formatting and validating the configuration permalink\"},`\\xbb`),`Formatting and validating the Configuration`),mdx(\"p\",null,`We recommend using consistent formatting in all configuration files. The terraform `,mdx(\"strong\",{parentName:\"p\"},`fmt command`),` automatically\nupdates configurations in the current directory for readability and consistency.`),mdx(\"p\",null,`By formatting our configuration, terraform will print out the names of the files it modified, if any. In this case, our\nconfiguration file was already formatted correctly, so Terraform won't return any file names.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` terraform fmt`)),`\n`)),mdx(\"p\",null,`We can also make sure our configuration is syntactically valid and internally consistent by using the terraform\n`,mdx(\"strong\",{parentName:\"p\"},`validate command`),`:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` terraform validate`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Success! The configuration is valid.`)),`\n`)),mdx(\"h4\",{\"id\":\"creating-infrastructure\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#creating-infrastructure\",\"aria-label\":\"creating infrastructure permalink\"},`\\xbb`),`Creating Infrastructure`),mdx(\"p\",null,`Apply the configuration now with the `,mdx(\"strong\",{parentName:\"p\"},`terraform apply`),` command. Terraform will print output similar to what is shown\nbelow. We have truncated some of the output to save space.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` terraform apply`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Terraform used the selected providers to generate the following execution plan.`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Resource actions are indicated with the following symbols:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  + create`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Terraform will perform the following actions:`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`   aws_instance.app_server will be created`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  + resource \"aws_instance\" \"app_server\" {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      + ami                          = \"ami-830c94e3\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      + arn                          = (known after apply)`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`#...`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Plan: 1 to add, 0 to change, 0 to destroy.`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Do you want to perform these actions?`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  Terraform will perform the actions described above.`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  Only 'yes' will be accepted to approve.`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  Enter a value:`)),`\n`)),mdx(\"p\",null,`Before it applies any changes, Terraform prints out the execution plan which describes the actions Terraform will take\nin order to change our infrastructure to match the configuration.`),mdx(\"p\",null,`The output format is similar to the diff format generated by tools such as Git. The output has a `,mdx(\"inlineCode\",{parentName:\"p\"},`+`),` next to\n`,mdx(\"inlineCode\",{parentName:\"p\"},`aws_instance.my-ami-instance`),`, meaning that Terraform will create this resource. Beneath that, it shows the attributes\nthat will be set. When the value displayed is `,mdx(\"inlineCode\",{parentName:\"p\"},`(known after apply)`),`, it means that the value will not be known until\nthe resource is created. For example, AWS assigns Amazon Resource Names (ARNs) to instances upon creation, so Terraform\ncannot know the value of the arn attribute until we apply the change and the AWS provider returns that value from the\nAWS API.`),mdx(\"p\",null,`Terraform will now pause and wait for your approval before proceeding. If anything in the plan seems incorrect or\ndangerous, it is safe to abort here before Terraform modifies your infrastructure.`),mdx(\"p\",null,`In this case the plan is acceptable, so type \"yes\" at the confirmation prompt to proceed. Executing the plan will take\na few minutes since Terraform waits for the EC2 instance to become available.`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  Enter a value: yes`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`aws_instance.app_server: Creating...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`aws_instance.app_server: Still creating... [10s elapsed]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`aws_instance.app_server: Still creating... [20s elapsed]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`aws_instance.app_server: Still creating... [30s elapsed]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`aws_instance.app_server: Creation complete after 36s [id=i-01e03375ba238b384]`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`Apply complete! Resources: 1 added, 0 changed, 0 destroyed.`)),`\n`)),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"strong\",{parentName:\"p\"},`Hands-on:`),` To execute Terraform actions without the interactive prompt (for example, in a CI/CD environment), use\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://stackoverflow.com/a/59958372\"},mdx(\"inlineCode\",{parentName:\"a\"},`terraform apply -auto-approve`)))),mdx(\"h4\",{\"id\":\"initial-deployment-only-inspect-instance\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#initial-deployment-only-inspect-instance\",\"aria-label\":\"initial deployment only inspect instance permalink\"},`\\xbb`),`(Initial Deployment Only) Inspect Instance`),mdx(\"p\",null,`We would normally undergo lots of debugging and tuning for our first app deployment by ssh into the EC2 instance.\nTerraform can generate SSL/SSH private keys using the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://registry.terraform.io/providers/hashicorp/tls/latest/docs/resources/private_key\"},`tls_private_key resource`),`.`),mdx(\"p\",null,`So if we wanted to generate SSH keys on the fly we could do something like this (this behavior is not in the example\nconfiguration above):`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"hcl\",\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`resource`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"tls_private_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  algorithm `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"RSA\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  rsa_bits  `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 4096`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`resource`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"aws_key_pair\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"generated_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  key_name   `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"initial-deployment-tuning-ssh-key\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  public_key `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` tls_private_key.example.public_key_openssh`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`...`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`resource`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"aws_instance\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"my-ami-instance\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ami `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`data`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`aws_ami`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`latest-my-ami`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`id`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  instance_type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"t2.micro\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  key_name      `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` aws_key_pair.generated_key.key_name`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  user_data `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},` <<-EOF`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`    #!/bin/bash`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`    cd /home/ubuntu/my-ami`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`    # command that starts app, e.g. flask --app server run --host=0.0.0.0`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  EOF`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`output`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"private_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  value     `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` tls_private_key.example.private_key_pem`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  sensitive `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",null,`This will create an SSH key pair that lives in the Terraform state (it is not written to disk in files other than what\nmight be done for the Terraform state itself when not using remote state), creates an AWS key pair based on the public\nkey and then creates an Ubuntu 20.04 instance where the ubuntu user is accessible with the private key that was\ngenerated.`),mdx(\"p\",null,`We would then have to extract the private key from the state file for us to use in `,mdx(\"inlineCode\",{parentName:\"p\"},`ssh`),` command. We could use an\n`,mdx(\"inlineCode\",{parentName:\"p\"},`output`),` to spit this straight out to stdout when Terraform is applied by`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` terraform output -raw private_key`)),`\n`)),mdx(\"div\",{\"className\":\"alert alert-info g-type-body\"},mdx(\"p\",{parentName:\"div\"},``,mdx(\"strong\",{parentName:\"p\"},`Security caveats:`),` It should be pointed out here that passing private keys around is generally a bad idea and\nwe'd be much better having developers create their own key pairs and provide others with the public key that people (or\nthem) can use to generate an AWS key pair (potentially using the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/key_pair.html\"},`aws_key_pair resource`),` as\nused in the above example) that can then be specified when creating instances. In general we should only use something\nlike the above way of generating SSH keys for very temporary dev environments that we are controlling so we don't need\nto pass private keys to anyone. If we do need to pass private keys to people we will need to make sure that we do this\nin a secure channel and that we make sure the Terraform state (which contains the private key in plain text) is also\nsecured appropriately.`)),mdx(\"p\",null,`To Log in with the SSH private key we obtained above,`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"bash\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`nano`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` private-key.pem`)),`\n`)),mdx(\"p\",null,`Paste private key, such as the one in the following image, into the file. Be sure to include the BEGIN and END lines.`),mdx(\"p\",null,mdx(\"img\",{parentName:\"p\",\"src\":\"https://d33wubrfki0l68.cloudfront.net/7a74a036032b0f73c7e4d2f1e2795ce698fb9456/edee6/how-to/logging-in-with-an-ssh-private-key-on-linuxmac/linux2.png\",\"alt\":null})),mdx(\"p\",null,`Run the following command to change the file permissions to 600 to secure the key. We can also set them to 400. This\nstep is required:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"bash\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`chmod`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 600`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` private-key.pem`)),`\n`)),mdx(\"p\",null,`Use the key to log in to the SSH client as shown in the following example, which loads the key in file\n`,mdx(\"em\",{parentName:\"p\"},`private-key.pem`),`, and logs in as user`,mdx(\"em\",{parentName:\"p\"},`ubuntu`),` to IP 192.237.248.66:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"bash\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`ssh`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` -i`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` private-key.pem`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` ubuntu@192.237.248.66`)),`\n`)),mdx(\"h2\",{\"id\":\"github-actions\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#github-actions\",\"aria-label\":\"github actions permalink\"},`\\xbb`),`GitHub Actions`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"https://github.com/hashicorp/setup-packer\"},`GitHub Action setup-packer`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"https://github.com/marketplace/actions/hashicorp-setup-terraform\"},`GitHub Action setup-terraform`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"/packer/tutorials/cloud-production/github-actions\"},`Setup AWS Access Key in GitHub Action`))),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"yml\",\"className\":\"language-yml\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-yml\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`---`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` My App CI/CD`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},`on`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  pull_request`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    branches`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`master`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  push`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    branches`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`master`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`env`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  HASHICORP_PRODUCT_VERSION`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"latest\"`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`jobs`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  release`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Release IAM image to AWS and Deploys instance to EC2`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    runs-on`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` ubuntu-latest`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    defaults`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      run`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        working-directory`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` hashicorp`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    steps`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Checkout`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        uses`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` actions/checkout@v3`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Configure AWS credentials`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        if`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` github.ref == 'refs/heads/master'`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        uses`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` aws-actions/configure-aws-credentials@v1`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        with`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          aws-access-key-id`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \\${{ secrets.AWS_ACCESS_KEY_ID }}`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          aws-secret-access-key`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \\${{ secrets.AWS_SECRET_ACCESS_KEY }}`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          aws-region`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` us-west-1`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Setup HashiCorp Packer`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        uses`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` hashicorp/setup-packer@main`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        with`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          version`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \\${{ env.HASHICORP_PRODUCT_VERSION }}`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Initialize Packer configuration`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        run`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` packer init .`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        working-directory`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` hashicorp/images`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Validate Packer template`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        run`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` packer validate -var \"gh_pat_read=\\${{ secrets.GH_PAT_READ }}\" .`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        working-directory`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` hashicorp/images`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Build and release AMI image`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        if`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` github.ref == 'refs/heads/master'`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        run`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` packer build -var \"gh_pat_read=\\${{ secrets.GH_PAT_READ }}\" .`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        working-directory`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` hashicorp/images`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Setup HashiCorp Terraform`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        uses`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` hashicorp/setup-terraform@v2`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        with`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          terraform_version`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \\${{ env.HASHICORP_PRODUCT_VERSION }}`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Initialize Terraform configuration`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        run`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` terraform init`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        working-directory`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` hashicorp/instances`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Validate Terraform template`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        run`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` terraform validate`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        working-directory`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` hashicorp/instances`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` Create EC2 instance`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        if`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` github.ref == 'refs/heads/master'`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        run`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` terraform apply -auto-approve`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        working-directory`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` hashicorp/instances`)),`\n`)),mdx(\"p\",null,`Note that to get the aforementioned debugging private key, we would change the last step from`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"yml\",\"className\":\"language-yml\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-yml\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`run`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` terraform apply -auto-approve`)),`\n`)),mdx(\"p\",null,`to`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"yml\",\"className\":\"language-yml\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-yml\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`run`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` terraform apply -auto-approve && terraform output -raw private_key`)),`\n`)))};MDXContent.isMDXComponent=true;","scope":{"version":"latest"}},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://docs.hashicorp.com/sentinel-public/img/og-image.png","icon":[{"href":"/sentinel-public/favicon.svg","sizes":"16x16"},{"href":"/sentinel-public/favicon.svg","sizes":"32x32"},{"href":"/sentinel-public/favicon.svg","sizes":"96x96"},{"href":"/sentinel-public/favicon.svg","sizes":"192x192"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiDays","url":"https://hashicorp.com/conferences/hashidays","text":"One conference. Three cities.","linkText":"Find a city near you","expirationDate":"2024-06-14T00:00:00-08:00"},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."},"currentRootDocsPath":{"iconName":"docs","name":"Documentation","path":"docs"}},"projectName":null,"versions":null},"__N_SSG":true}