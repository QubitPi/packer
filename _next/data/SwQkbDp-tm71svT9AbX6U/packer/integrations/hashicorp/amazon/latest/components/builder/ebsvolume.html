<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Amazon Builder | Integrations | Packer | HashiCorp Developer</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="Explore Packer product documentation, tutorials, and examples."/><meta name="twitter:description" content="Explore Packer product documentation, tutorials, and examples."/><meta property="og:site_name" content="Amazon Builder | Integrations | Packer | HashiCorp Developer"/><meta property="og:title" content="Amazon Builder | Integrations | Packer | HashiCorp Developer"/><meta property="og:image" content="https://developer.hashicorp.com/og-image/packer.jpg"/><link rel="canonical" href="https://developer.hashicorp.com/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume"/><link rel="icon" href="/favicon.ico" sizes="48x48"/><link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="google-site-verification" content="zRQZqfAsOX-ypXfU0mzAIzb5rUvj5fA4Zw2jWJRN-JI"/><meta name="ahrefs-site-verification" content="9d739b21c466a84dae91df1c79396081a9072152e64f765c9390fed6f249fb84"/><meta name="zd-site-verification" content="xnvnvv1i0wl4tf0pzaymb" data-product="hcp"/><meta name="zd-site-verification" content="36fp2i1pj67d8cjtzf4fi9" data-product="terraform"/><meta name="zd-site-verification" content="nbe87kfyp1sck7b13vj1i" data-product="packer"/><meta name="zd-site-verification" content="wvsmmqa1cfb9am9zlwfj" data-product="consul"/><meta name="zd-site-verification" content="cw22oopfwr68ujj0n5pn9i" data-product="boundary"/><meta name="zd-site-verification" content="lkslvganwfgfqfwpdeicgh" data-product="vault"/><meta name="zd-site-verification" content="jl2wp2hoej9rz6c8rmqdns" data-product="nomad"/><meta name="zd-site-verification" content="2eb0cu6xceo73t0038m0tb" data-product="waypoint"/><meta name="zd-site-verification" content="n52xisxdf3higs2q9kuogd" data-product="vagrant"/><meta name="twitter:image" content="https://developer.hashicorp.com/og-image/packer.jpg"/><link rel="prefetch" href="https://www.datadoghq-browser-agent.com/datadog-rum-v4.js"/><script type="application/ld+json">[{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Developer","item":"https://developer.hashicorp.com/"},{"@type":"ListItem","position":2,"name":"Packer","item":"https://developer.hashicorp.com/packer"},{"@type":"ListItem","position":3,"name":"Integrations","item":"https://developer.hashicorp.com/packer/integrations"},{"@type":"ListItem","position":4,"name":"Amazon","item":"https://developer.hashicorp.com/packer/integrations/hashicorp/amazon"},{"@type":"ListItem","position":5,"name":"v1.3.2","item":"https://developer.hashicorp.com/packer/integrations/hashicorp/amazon/v1.3.2"},{"@type":"ListItem","position":6,"name":"Amazon EBS Volume","item":"https://developer.hashicorp.com/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume"}]}]</script><meta name="next-head-count" content="32"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/0a3ef9c875075792.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0a3ef9c875075792.css" data-n-g=""/><link rel="preload" href="/_next/static/css/3ad6c3802e156a79.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3ad6c3802e156a79.css" data-n-p=""/><link rel="preload" href="/_next/static/css/ad224e6864ca6fd6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ad224e6864ca6fd6.css" data-n-p=""/><link rel="preload" href="/_next/static/css/eb7499f4942666a6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/eb7499f4942666a6.css" data-n-p=""/><link rel="preload" href="/_next/static/css/f1847941b1d3db61.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f1847941b1d3db61.css" data-n-p=""/><link rel="preload" href="/_next/static/css/c4367c2f8a8aadc4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c4367c2f8a8aadc4.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-106a414ea0458477.js" defer=""></script><script src="/_next/static/chunks/framework-56eb74ff06128874.js" defer=""></script><script src="/_next/static/chunks/main-0785f91db64576b8.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f12faad372f07f6f.js" defer=""></script><script src="/_next/static/chunks/4819-bab3fb94ee0c378b.js" defer=""></script><script src="/_next/static/chunks/3713-0a83bd3cd768e186.js" defer=""></script><script src="/_next/static/chunks/1965-de91f49a7b70adcb.js" defer=""></script><script src="/_next/static/chunks/1306-699e21fe04afb846.js" defer=""></script><script src="/_next/static/chunks/563-ec2e839822df3139.js" defer=""></script><script src="/_next/static/chunks/3652-ce43471e7283c3ba.js" defer=""></script><script src="/_next/static/chunks/4762-e57bd9d3b7453da8.js" defer=""></script><script src="/_next/static/chunks/9325-9027f7f3bd62792d.js" defer=""></script><script src="/_next/static/chunks/2291-52f1771184c676af.js" defer=""></script><script src="/_next/static/chunks/1825-93559152dbf033f6.js" defer=""></script><script src="/_next/static/chunks/2460-e1e3286f1330a793.js" defer=""></script><script src="/_next/static/chunks/6075-eff04cc051a0a6a9.js" defer=""></script><script src="/_next/static/chunks/3367-62761ef699b6ef58.js" defer=""></script><script src="/_next/static/chunks/pages/%5BproductSlug%5D/integrations/%5BorganizationSlug%5D/%5BintegrationSlug%5D/%5BintegrationVersion%5D/components/%5BcomponentType%5D/%5BcomponentSlug%5D-bb0178fe066e239b.js" defer=""></script><script src="/_next/static/SwQkbDp-tm71svT9AbX6U/_buildManifest.js" defer=""></script><script src="/_next/static/SwQkbDp-tm71svT9AbX6U/_ssgManifest.js" defer=""></script></head><body><script>!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://artemis.hashicorp.com/script/"+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics._cdn="https://artemis.hashicorp.com";analytics.SNIPPET_VERSION="4.1.0";}}();</script><div id="__next"><div class="style_root__dZhZu"><a href="https://hashicorp.com/conferences/hashidays" class="style_linkElem__hCESK"><span class="style_textContainer__6CuI7 g-grid-container"><span class="style_tag__jbHGz g-type-body-small-x-strong">HashiDays<!-- --> </span><span class="style_text__rwS0u g-type-body-small">One conference. Three cities.<span class="style_linkText__E8GJf g-type-body-small-x-strong"> <!-- -->Find a city near you</span></span></span></a><button class="style_closeButton__57J9w"><div><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 20 20"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 5 5 15M5 5l10 10"/></svg></div><span style="position:absolute;border:0;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;word-wrap:normal">Dismiss alert</span></button></div><script type="text/javascript">
(function checkDismissAlertBanner() {
  try {
    if (document.cookie.includes('banner_one-conference.-three-cities.=1')) {
      const element = document.querySelector('.style_root__dZhZu')
      element.classList.remove('style_isShown__D4mb6')
    }
  } catch (_) {
    // do nothing
  }
})()
</script><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="core-dev-dot-layout_root__MT1PZ"><div class="base-layout_root___qiZs" data-layout="base-new"><div class="base-layout_header__XhkxS"><header class="navigation-header_root__oE_HT"><div class="navigation-header_leftSide__V0xlc"><div class="product-page-content_productsDropdown__haUyw"><div class="dropdown-menu_root__Hwy5S"><div class="dropdown-menu_activatorWrapper__LxPRt"><button aria-controls="navigation-header-menu-react-aria-1" aria-expanded="false" aria-label="Main menu" class="dropdown-menu_activator__xXb00 g-focus-ring-from-box-shadow-dark product-page-content_productsDropdownButton__bnKKs"><span class="dropdown-menu_activatorLeadingIcon__YQQlH"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true" class="product-page-content_productsDropdownIcon__gXtly"><g fill="currentColor"><path d="M10.336 1.5L2 6.268v11.456l3.131 1.793V8.061l5.205-2.979V1.5z"></path><path d="M13.664 1.5v9.123h-3.328V7.219L7.203 9.012V20.7l3.133 1.796V13.4h3.328v3.381l3.131-1.793V3.293L13.664 1.5z"></path><path d="M22 17.732L13.664 22.5v-3.582l5.203-2.98V4.484L22 6.276v11.456z"></path></g></svg></span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="dropdown-menu_activatorTrailingIcon__r_cCd"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button></div><div class="dropdown-menu_dropdownContainer__AZWxN product-page-content_productsDropdownPane__bcdWz" id="navigation-header-menu-react-aria-1" style="display:none"><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M7.846 2.574a.25.25 0 01.308 0l5.25 4.12a.25.25 0 01.096.196v7.36a.75.75 0 001.5 0V6.89a1.75 1.75 0 00-.67-1.377L9.08 1.394a1.75 1.75 0 00-2.16 0l-5.25 4.12A1.75 1.75 0 001 6.89v7.36a.75.75 0 001.5 0V6.89a.25.25 0 01.096-.196l5.25-4.12z"></path><path d="M6.5 14.25V10.5h3v3.75a.75.75 0 001.5 0v-4C11 9.56 10.44 9 9.75 9h-3.5C5.56 9 5 9.56 5 10.25v4a.75.75 0 001.5 0z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Developer</span></div></div></a></li></ul><hr class="dropdown-menu_itemGroupDivider__X38aR"/><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/hcp"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Cloud Platform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/terraform"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-terraform-brand)"><path d="M1 0v5.05l4.349 2.527V2.526L1 0zM10.175 5.344l-4.35-2.525v5.05l4.35 2.527V5.344zM10.651 10.396V5.344L15 2.819v5.05l-4.349 2.527zM10.174 16l-4.349-2.526v-5.05l4.349 2.525V16z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Terraform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/packer"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Packer</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/consul"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Consul</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/vault"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-vault-brand)" d="M0 0l7.971 15.516L16 0H0zm6.732 6.16h-1.27V4.89h1.27v1.27zm0-1.906h-1.27V2.985h1.27v1.269zm1.904 3.81h-1.27v-1.27h1.27v1.27zm0-1.905h-1.27V4.89h1.27v1.27zm0-1.905h-1.27V2.985h1.27v1.269zm1.894 1.905H9.26V4.89h1.27v1.27zM9.26 4.254V2.985h1.27v1.269H9.26z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vault</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/boundary"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-boundary-brand)"><path d="M4.81 15v-1.085h2.25v-.67H5.968v-1.093h5.149L8.726 8l2.392-4.154H5.84v5.76H3V1h9.775l1.631 2.832L12.006 8l2.448 4.252L12.872 15H4.81z"></path><path d="M5.248 12.152h-1.09v1.092h1.09v-1.092zM3 13.907h1.09v1.092H3v-1.092z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Boundary</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/nomad"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-nomad-brand)" d="M8 0L1 4v8l7 4 7-4V4L8 0zm3.119 8.797L9.254 9.863 7.001 8.65v2.549l-2.118 1.33v-5.33l1.68-1.018 2.332 1.216V4.794l2.23-1.322-.006 5.325z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Nomad</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/waypoint"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-waypoint-brand)"><path d="M4 5.312h1.334L10 13.4l3.334-5.777L10.666 3H8l2.666 4.623L10 8.778 6.667 3H0l6 10.4 1.333-2.31L4 5.311zM14.002 6.463L16 3h-3.996l1.998 3.463z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Waypoint</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" href="/vagrant"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="#1868F2"><path d="M1 1.559h4.667v3.4l4.666 9.482H5.667L1 4.959v-3.4zM10.333 4.96V1.559H15v3.4l-4.269 8.672-2.335-4.74 1.937-3.931z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vagrant</span></div></div></a></li></ul></div></div></div><div class="product-page-content_productLinkAndNav__YTzcr"><a aria-label="Packer home" class="product-icon-text-link_root__bNTSz g-focus-ring-from-box-shadow-dark" href="/packer"><div class="product-icon-text-lockup_root__358wV"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="product-icon-text-lockup_icon__Zp_5o"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="product-icon-text-lockup_text__nHTL7 hds-typography-body-200">Packer</span></div></a><nav class="nav-bar-list-container_nav__C_i0_"><ul class="nav-bar-list-container_ul___04HI"><li><a aria-label="Packer Install" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/packer/install"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Install</span></a></li><li><a aria-label="Packer Tutorials" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/packer/tutorials"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Tutorials</span></a></li><li><a aria-label="Packer Documentation" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/packer/docs"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Documentation</span></a></li><li><a aria-label="Packer Guides" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/packer/guides"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Guides</span></a></li><li><a aria-label="Packer Integrations" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/packer/integrations"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Integrations</span></a></li><li><a aria-label="Packer Try Cloud" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" aria-describedby="opens-in-new-tab-label-react-aria-18" target="_blank" href="https://portal.cloud.hashicorp.com/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Try Cloud</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-18">(opens in new tab)</span></li></ul></nav></div></div><div class="navigation-header_rightSide___Vvh_"><button aria-label="Search" class="command-bar-activator_root__qgVMy g-focus-ring-from-box-shadow-dark"><span class="command-bar-activator_left__ATQTg"><span class="command-bar-activator_leadingIcon__jECP5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M6.344.969a5.375 5.375 0 103.233 9.669l4.174 4.174a.75.75 0 001.06-1.061l-4.173-4.174A5.375 5.375 0 006.344.97zM2.469 6.344a3.875 3.875 0 117.75 0 3.875 3.875 0 01-7.75 0z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular command-bar-activator_text__pTZN_">Search</span></span><span class="command-bar-activator_right__XejfJ"><span class="g-screen-reader-only">Command or control key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="cmd-ctrl-icon_root___TToz"><svg xmlns="http://www.w3.org/2000/svg" width="41" height="11" fill="none" viewBox="0 0 41 11"><path fill="#fff" fill-rule="evenodd" d="M4.125 2.063V3h2.25v-.937a2.062 2.062 0 1 1 2.063 2.062H7.5v2.25h.938a2.062 2.062 0 1 1-2.063 2.063V7.5h-2.25v.938a2.062 2.062 0 1 1-2.062-2.063H3v-2.25h-.937a2.062 2.062 0 1 1 2.062-2.062m-2.062-.938a.937.937 0 1 0 0 1.875H3v-.937a.937.937 0 0 0-.937-.938M7.5 7.5v.938a.937.937 0 1 0 .938-.938zM6.375 6.375v-2.25h-2.25v2.25zM2.063 7.5H3v.938a.937.937 0 1 1-.937-.938M7.5 3h.938a.937.937 0 1 0-.938-.937z" clip-rule="evenodd"/><path fill="#fff" d="M15.09 10.5 18.085 0h-1.097L14 10.5zM26.387 5.308c-.183-1.445-1.263-2.534-3.05-2.534C21.264 2.774 20 4.247 20 6.61c0 2.41 1.27 3.89 3.344 3.89 1.76 0 2.86-1.034 3.043-2.5H25.02c-.184.808-.792 1.247-1.682 1.247-1.172 0-1.898-.994-1.898-2.637 0-1.61.72-2.583 1.898-2.583.942 0 1.518.555 1.681 1.281zM28.6 1.041v1.897h-1.133v1.178H28.6v4.281c0 1.432.622 2.007 2.186 2.007.275 0 .537-.034.766-.075V9.158c-.196.02-.32.034-.537.034-.7 0-1.008-.35-1.008-1.15V4.115h1.545V2.938h-1.545V1.041zM33.207 10.356h1.407V5.911c0-1.048.752-1.767 1.819-1.767.249 0 .667.048.785.082V2.842a3.372 3.372 0 0 0-.628-.054c-.93 0-1.721.527-1.924 1.26h-.105v-1.13h-1.354zM38.638 10.356h1.407V0h-1.407z"/></svg></div></span><span class="g-screen-reader-only">K key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="k-icon_root__a_5pR"><svg xmlns="http://www.w3.org/2000/svg" width="8" height="10" fill="none" viewBox="0 0 8 10"><path fill="#fff" d="M1.512 9.84v-3l.986-1.147L5.445 9.84h1.704L3.46 4.745 6.857.84H5.244L1.61 5.094h-.098V.84H.15v9z"/></svg></div></span></span></button><div class="navigation-header_authenticationControls__EP1LY"><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj"><button aria-controls="disclosure-react-aria-19-content" aria-expanded="false" aria-label="User menu" class="disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo navigation-header_userDropdownDisclosureActivator__RayIV g-focus-ring-from-box-shadow-dark activator_hasIcon__5HO6W g-focus-ring-from-box-shadow"><span class="activator_childrenWrapper__kaK0w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path fill-rule="evenodd" d="M12 3a5 5 0 100 10 5 5 0 000-10zM8.5 8a3.5 3.5 0 117 0 3.5 3.5 0 01-7 0z" clip-rule="evenodd"></path><path d="M7.75 14.5A4.75 4.75 0 003 19.25v1a.75.75 0 001.5 0v-1A3.25 3.25 0 017.75 16h8.5a3.25 3.25 0 013.25 3.25v1a.75.75 0 001.5 0v-1a4.75 4.75 0 00-4.75-4.75h-8.5z"></path></g></svg></span><span class="activator_chevronWrapper__4_AVG"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></span></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-19-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><button class="list-item_button__nXy5K g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign in</span></button></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign up</span></a></li><li class="list-item_root__ZdUej"><hr class="list-item_separator__cBVLs"/></li><li class="list-item_root__ZdUej user-dropdown-switcher_listItem__Q_GIj hds-font-weight-medium"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-21">Theme</label></li></ul></div></div></div><button aria-label="Open navigation menu" class="navigation-header_mobileMenuButton__74S4w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path d="M2 5.75A.75.75 0 012.75 5h18.5a.75.75 0 010 1.5H2.75A.75.75 0 012 5.75zM2 11.75a.75.75 0 01.75-.75h18.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2.75 17a.75.75 0 000 1.5h18.5a.75.75 0 000-1.5H2.75z"></path></g></svg></button></div></header></div><div class="base-layout_contentArea__BMvQn"><div class="sidebar-sidecar-layout_root__h5rD8 sidebar-sidecar-layout_mainWidth-wide__TwGq8"><div class="mobile-menu-container_root__fPUFu sidebar-sidecar-layout_sidebarContainer__4fcF8"><div class="sidebar-sidecar-layout_sidebarContentWrapper__ftn5q"><div class="sidebar_sidebar___fTlC"><div class="sidebar_backToLinkWrapper__F6iLs"><div class="sidebar-back-to-link_root__z_Hj1"><a class="standalone-link_standaloneLink__ahuej g-focus-ring-from-box-shadow standalone-link_primary__ESNCA" href="/packer/integrations"><div class="standalone-link_standaloneLinkContents__4I2XN standalone-link_medium__J2yVM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M10.795 3.235a.75.75 0 01-.03 1.06L6.842 8l3.923 3.705a.75.75 0 01-1.03 1.09l-4.5-4.25a.75.75 0 010-1.09l4.5-4.25a.75.75 0 011.06.03z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__7GEyG">Packer Integrations</span></div></a></div></div><nav aria-labelledby="sidebar-label" class="sidebar_nav__IworY" id="sidebar-nav"><div><h2 class="sidebar-headings_root__tGfxC" id="sidebar-label"></h2></div><ul class="sidebar_navList__4Rg4g"><li><a class="sidebar-nav-highlight-item_root___pPhp g-focus-ring-from-box-shadow sidebar-nav-highlight-item_theme-packer__I5KHY" href="/packer/integrations/hashicorp/amazon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="sidebar-nav-highlight-item_icon__G8JxG"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="sidebar-nav-highlight-item_text__VORFJ hds-typography-body-200">Amazon</span></a></li><li><button aria-controls="undefined-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="undefined-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Data Sources</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="undefined-list"><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/data-source/parameterstore"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Parameter Store</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/data-source/secretsmanager"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Secrets Manager</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/data-source/ami"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Amazon AMI</span></a></li></ul></li><li><button aria-controls="undefined-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="undefined-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Builders</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="undefined-list"><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Amazon chroot</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebs"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Amazon EBS</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebssurrogate"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Amazon EBS Surrogate</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/instance"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Amazon instance-store</span></a></li><li><a aria-current="page" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Amazon EBS Volume</span></a></li></ul></li><li><button aria-controls="undefined-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="undefined-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Post-Processors</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="undefined-list"><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/post-processor/import"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Amazon Import</span></a></li></ul></li></ul><hr class="sidebar-horizontal-rule_root__UY7oh"/><ul class="sidebar_navList__4Rg4g"><li><h3 class="sidebar-headings_root__tGfxC">Resources</h3></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/tutorials/library?product=packer"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Tutorial Library</span></a></li><li><a aria-label="Community Forum. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-34" target="_blank" href="https://discuss.hashicorp.com/c/packer/23"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Community Forum</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-34">(opens in new tab)</span></li><li><a aria-label="Support. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-35" target="_blank" href="https://www.hashicorp.com/customer-success"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Support</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-35">(opens in new tab)</span></li><li><a aria-label="GitHub. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-36" target="_blank" href="https://github.com/hashicorp/packer"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">GitHub</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-36">(opens in new tab)</span></li></ul></nav></div></div></div><div class="sidebar-sidecar-layout_contentWrapper__Z5BK4"><div class="sidebar-sidecar-layout_paddedAreaWrapper___S_Ff"><div class="sidebar-sidecar-layout_breadcrumbContainer__3uz7P"><div class="sidebar-sidecar-layout_breadcrumbMaxWidth__coOcu"><nav aria-label="Breadcrumb" class="breadcrumb-bar_root__wd_C5"><ol class="breadcrumb-bar_listRoot__8eupO"><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" href="/">Developer</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" href="/packer">Packer</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" href="/packer/integrations">Integrations</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon">Amazon</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.3.2">v1.3.2</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><span class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" aria-current="page">Amazon EBS Volume</span></li></ol></nav></div></div><div class="sidebar-sidecar-layout_mainAndSidecar__UDm3Z"><main id="main" class="sidebar-sidecar-layout_main__0SN51"><div class="hds-surface-base card_root__RyqjV content-header-card_contentHeaderCard__SDMMP style_header__b3NdM"><div class="content-header-card_cardTop__GTpii"><span class="icon-tile_root__ShC0s icon-tile_size-large__NxGIv icon-tile_color-packer__LRaQF content-header-card_icon__A1Xna"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><div class="content-header-card_content__XPCtf"><div class="content-header-card_upper__PQsUG"><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj content-header-card_dropdown__Gt1Vp g-hide-on-desktop g-hide-on-tablet"><button aria-controls="disclosure-react-aria-42-content" aria-expanded="false" class="button_root__itF9E hds-font-weight-medium button_medium__Cm2eg button_secondary__m5f7i disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo" type="button"><span>v1.3.2 (latest)</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="activator_chevronWrapper__4_AVG"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-42-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.3.1/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.3.1</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.3.0/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.3.0</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.2.9/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.2.9</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.2.8/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.2.8</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.2.6/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.2.6</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.0.1/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.1</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.0.0/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.0</span></a></li></ul></div></div><div class="content-header-card_left__FSNcW"><div class="content-header-card_titleWrap__IAC6o"><span class="content-header-card_title__HGHfo hds-typography-display-300 from global, hds-font-weight-bold">Amazon</span><p class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium content-header-card_attribution__yKU4q">@hashicorp</p></div><p class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular content-header-card_description__M_DkB">The Amazon plugin can be used with HashiCorp Packer to create custom images on AWS.</p></div><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj content-header-card_dropdown__Gt1Vp g-hide-on-mobile"><button aria-controls="disclosure-react-aria-50-content" aria-expanded="false" class="button_root__itF9E hds-font-weight-medium button_medium__Cm2eg button_secondary__m5f7i disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo" type="button"><span>v1.3.2 (latest)</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="activator_chevronWrapper__4_AVG"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-50-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.3.1/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.3.1</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.3.0/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.3.0</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.2.9/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.2.9</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.2.8/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.2.8</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.2.6/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.2.6</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.0.1/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.1</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/v1.0.0/components/builder/ebsvolume"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.0</span></a></li></ul></div></div></div><div class="content-header-card_lower__ut_Dv"><ul class="badge-list_badgeList__l_z6s content-header-card_badgeList__I_FGK"><li class="badge-list_badge__mQSlF"><span data-state="tooltip-hidden" data-reach-tooltip-trigger=""><span class="g-screen-reader-only">Official</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral__NhUW0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg><span>Official</span></span></span></li><li class="badge-list_badge__mQSlF"><span data-state="tooltip-hidden" data-reach-tooltip-trigger=""><span class="g-screen-reader-only">HCP Ready</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral__NhUW0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9.78 7.28a.75.75 0 00-1.06-1.06l-.5.5a.75.75 0 001.06 1.06l.5-.5z"></path><path fill-rule="evenodd" d="M12.627 1.32a1.731 1.731 0 012.054 2.053c-.27 1.28-.686 3.19-1.103 4.859a3.625 3.625 0 01-.58 1.224c.002.015.002.03.002.044v2.441a1.75 1.75 0 01-.833 1.49l-2.021 1.244a1.75 1.75 0 01-2.284-.397l-1.27-1.587a2.028 2.028 0 01-1.08-.917 3.426 3.426 0 00-.542-.744 3.428 3.428 0 00-.744-.542c-.4-.223-.755-.61-.917-1.08l-1.587-1.27a1.75 1.75 0 01-.398-2.284l1.244-2.021A1.75 1.75 0 014.058 3H6.5l.044.001c.37-.263.777-.467 1.224-.579 1.669-.417 3.58-.833 4.859-1.103zm-5.43 9.956a.754.754 0 00-.167-.025.517.517 0 01-.209-.208 4.913 4.913 0 00-.79-1.073 4.913 4.913 0 00-1.074-.791.516.516 0 01-.208-.21.754.754 0 00-.025-.166l.002-.008c.255-.78.694-1.941 1.307-2.958.634-1.05 1.353-1.773 2.099-1.96 1.641-.41 3.53-.821 4.804-1.09a.231.231 0 01.277.277c-.269 1.274-.68 3.163-1.09 4.804-.187.746-.91 1.465-1.96 2.099-1.017.613-2.177 1.052-2.958 1.307a.173.173 0 01-.008.002zm1.139 1.193l.697.872a.25.25 0 00.327.057l2.021-1.244a.25.25 0 00.119-.213v-1.056c-.186.13-.375.252-.562.366-.88.53-1.832.936-2.602 1.218zM2.659 6.967l.872.697c.282-.77.687-1.722 1.218-2.602.113-.187.235-.376.366-.562H4.059a.25.25 0 00-.213.119L2.602 6.64a.25.25 0 00.057.327z" clip-rule="evenodd"></path><path d="M4.442 11.558a.625.625 0 010 .884l-2 2a.625.625 0 11-.884-.884l2-2a.625.625 0 01.884 0zM2.692 10.308a.625.625 0 010 .884l-.75.75a.625.625 0 11-.884-.884l.75-.75a.625.625 0 01.884 0zM5.692 14.192a.625.625 0 10-.884-.884l-.75.75a.625.625 0 10.884.884l.75-.75z"></path></g></svg><span>HCP Ready</span></span></span></li></ul><p class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular content-header-card_note__QTtmc">Updated last year</p></div></div></div><div class="content-header-card_cardBottom__ndKDE"><ul class="content-header-card_linksList__vaxQ3"><li class="content-header-card_link___8sUH"><a class="standalone-link_standaloneLink__ahuej g-focus-ring-from-box-shadow standalone-link_secondary__H0E0A" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-58" target="_blank" href="https://github.com/hashicorp/packer-plugin-amazon/tree/main/docs"><div class="standalone-link_standaloneLinkContents__4I2XN standalone-link_medium__J2yVM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M8 1C4.133 1 1 4.13 1 7.993c0 3.09 2.006 5.71 4.787 6.635.35.064.478-.152.478-.337 0-.166-.006-.606-.01-1.19-1.947.423-2.357-.937-2.357-.937-.319-.808-.778-1.023-.778-1.023-.635-.434.048-.425.048-.425.703.05 1.073.72 1.073.72.624 1.07 1.638.76 2.037.582.063-.452.244-.76.444-.935-1.554-.176-3.188-.776-3.188-3.456 0-.763.273-1.388.72-1.876-.072-.177-.312-.888.07-1.85 0 0 .586-.189 1.924.716A6.711 6.711 0 018 4.381c.595.003 1.194.08 1.753.236 1.336-.905 1.923-.717 1.923-.717.382.963.142 1.674.07 1.85.448.49.72 1.114.72 1.877 0 2.686-1.638 3.278-3.197 3.45.251.216.475.643.475 1.296 0 .934-.009 1.688-.009 1.918 0 .187.127.404.482.336A6.996 6.996 0 0015 7.993 6.997 6.997 0 008 1z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__7GEyG">GitHub</span></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-58">(opens in new tab)</span></li></ul></div></div><h1>Amazon EBS Volume</h1><div class="style_integrationComponentView__dxO7C"><div class="style_mdxWrapper__6wQJC"><div class="dev-dot-content_root__UJDct hds-typography-body-300"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Type: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">amazon-ebsvolume</code>
Artifact BuilderId: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">mitchellh.amazon.ebsvolume</code></p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">amazon-ebsvolume</code> Packer builder is able to create Amazon Elastic Block
Store volumes which are prepopulated with filesystems or data.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This builder creates EBS volumes by launching an EC2 instance from a source
AMI. One or more EBS volumes are attached to the running instance, allowing
them to be provisioned into from the running machine. Once provisioning is
complete the source machine is destroyed. The provisioned volumes are kept
intact.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This is all done in your own AWS account. The builder will create temporary key
pairs, security group rules, etc. that provide it temporary access to the
instance while the image is being created.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The builder does <em>not</em> manage EBS Volumes. Once it creates volumes and stores
it in your account, it is up to you to use, delete, etc. the volumes.</p><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Note:</strong> Temporary resources are, by default, all created with the
prefix <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">packer</code>. This can be useful if you want to restrict the security groups
and key pairs Packer is able to operate on.</p></div><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-configuration-reference"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Configuration Reference permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#configuration-reference"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Configuration Reference</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">There are many configuration options available for the builder. In addition to
the items listed here, you will want to look at the general configuration
references for <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#ami-configuration">AMI</a>,
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#block-devices-configuration">BlockDevices</a>,
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#access-configuration">Access</a>,
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#run-configuration">Run</a> and
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#communicator-configuration">Communicator</a>
configuration references, which are
necessary for this build to succeed and can be found further down the page.</p><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-optional:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Optional permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Optional:</h3><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ena_support</code> (boolean) - Enable enhanced networking (ENA but not SriovNetSupport) on
HVM-compatible AMIs. If set, add <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ec2:ModifyInstanceAttribute</code> to your
AWS IAM policy. Note: you must make sure enhanced networking is enabled
on your instance. See <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking">Amazon&#x27;s documentation on enabling enhanced
networking</a>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">sriov_support</code> (bool) - Enable enhanced networking (SriovNetSupport but not ENA) on
HVM-compatible AMIs. If true, add <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ec2:ModifyInstanceAttribute</code> to your
AWS IAM policy. Note: you must make sure enhanced networking is enabled
on your instance. See <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking">Amazon&#x27;s documentation on enabling enhanced
networking</a>.
Default <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ebs_volumes</code> (BlockDevices) - Add the block device mappings to the AMI. If you add instance store
volumes or EBS volumes in addition to the root device volume, the
created AMI will contain block device mapping information for those
volumes. Amazon creates snapshots of the source instance&#x27;s root volume
and any other EBS volumes described here. When you launch an instance
from this new AMI, the instance automatically launches with these
additional volumes, and will restore them from snapshots taken from the
source instance. See the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#block-devices-configuration">BlockDevices</a>
documentation for fields.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run_volume_tags</code> (map<!-- -->[string]<!-- -->string) - Key/value pair tags to apply to the volumes of the instance that is
<em>launched</em> to create EBS Volumes. These tags will <em>not</em> appear in the
tags of the resulting EBS volumes unless they&#x27;re duplicated under <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">tags</code>
in the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ebs_volumes</code> setting. This is a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/legacy_json_templates/engine">template
engine</a>, see <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-template-data">Build template
data</a> for more information.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"> Note: The tags specified here will be <em>temporarily</em> applied to volumes
specified in <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ebs_volumes</code> - but only while the instance is being
created. Packer will replace all tags on the volume with the tags
configured in the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ebs_volumes</code> section as soon as the instance is
reported as &#x27;ready&#x27;.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run_volume_tag</code> ([]{key string, value string}) - Same as <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#run_volume_tags"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run_volume_tags</code></a> but defined as a singular
repeatable block containing a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">key</code> and a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">value</code> field. In HCL2 mode
the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/hcl_templates/expressions#dynamic-blocks"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">dynamic_block</code></a>
will allow you to create those programatically.</p></li></ul><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-access-configuration"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Access Configuration permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#access-configuration"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Access Configuration</h3><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-required:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Required permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#required:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Required:</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">access_key</code> (string) - The access key used to communicate with AWS. <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon#specifying-amazon-credentials">Learn how  to set this</a>.
On EBS, this is not required if you are using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">use_vault_aws_engine</code>
for authentication instead.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">region</code> (string) - The name of the region, such as <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">us-east-1</code>, in which
to launch the EC2 instance to create the AMI.
When chroot building, this value is guessed from environment.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">secret_key</code> (string) - The secret key used to communicate with AWS. <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon#specifying-amazon-credentials">Learn how to set
this</a>. This is not required
if you are using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">use_vault_aws_engine</code> for authentication instead.</p></li></ul><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-optional:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Optional permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Optional:</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">assume_role</code> (AssumeRoleConfig) - If provided with a role ARN, Packer will attempt to assume this role
using the supplied credentials. See
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#assume-role-configuration">AssumeRoleConfig</a> below for more
details on all of the options available, and for a usage example.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">custom_endpoint_ec2</code> (string) - This option is useful if you use a cloud
provider whose API is compatible with aws EC2. Specify another endpoint
like this <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://ec2.custom.endpoint.com">https://ec2.custom.endpoint.com</a>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">shared_credentials_file</code> (string) - Path to a credentials file to load credentials from</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">decode_authorization_messages</code> (bool) - Enable automatic decoding of any encoded authorization (error) messages
using the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">sts:DecodeAuthorizationMessage</code> API. Note: requires that the
effective user/role have permissions to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">sts:DecodeAuthorizationMessage</code>
on resource <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">*</code>. Default <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">insecure_skip_tls_verify</code> (bool) - This allows skipping TLS
verification of the AWS EC2 endpoint. The default is false.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">max_retries</code> (int) - This is the maximum number of times an API call is retried, in the case
where requests are being throttled or experiencing transient failures.
The delay between the subsequent API calls increases exponentially.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">mfa_code</code> (string) - The MFA
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm">TOTP</a>
code. This should probably be a user variable since it changes all the
time.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">profile</code> (string) - The profile to use in the shared credentials file for
AWS. See Amazon&#x27;s documentation on <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles">specifying
profiles</a>
for more details.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">skip_metadata_api_check</code> (bool) - Skip Metadata Api Check</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">skip_credential_validation</code> (bool) - Set to true if you want to skip validating AWS credentials before runtime.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">token</code> (string) - The access token to use. This is different from the
access key and secret key. If you&#x27;re not sure what this is, then you
probably don&#x27;t need it. This will also be read from the AWS_SESSION_TOKEN
environmental variable.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vault_aws_engine</code> (VaultAWSEngineOptions) - Get credentials from HashiCorp Vault&#x27;s aws secrets engine. You must
already have created a role to use. For more information about
generating credentials via the Vault engine, see the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://www.vaultproject.io/api/secret/aws#generate-credentials">Vault
docs.</a>
If you set this flag, you must also set the below options:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">name</code> (string) - Required. Specifies the name of the role to generate
credentials against. This is part of the request URL.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">engine_name</code> (string) - The name of the aws secrets engine. In the
Vault docs, this is normally referred to as &quot;aws&quot;, and Packer will
default to &quot;aws&quot; if <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">engine_name</code> is not set.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">role_arn</code> (string)- The ARN of the role to assume if credential<!-- -->_<!-- -->type
on the Vault role is assumed<!-- -->_<!-- -->role. Must match one of the allowed role
ARNs in the Vault role. Optional if the Vault role only allows a single
AWS role ARN; required otherwise.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ttl</code> (string) - Specifies the TTL for the use of the STS token. This
is specified as a string with a duration suffix. Valid only when
credential<!-- -->_<!-- -->type is assumed<!-- -->_<!-- -->role or federation<!-- -->_<!-- -->token. When not
specified, the default<!-- -->_<!-- -->sts<!-- -->_<!-- -->ttl set for the role will be used. If that
is also not set, then the default value of 3600s will be used. AWS
places limits on the maximum TTL allowed. See the AWS documentation on
the DurationSeconds parameter for AssumeRole (for assumed<!-- -->_<!-- -->role
credential types) and GetFederationToken (for federation<!-- -->_<!-- -->token
credential types) for more details.</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R161uhdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">vault_aws_engine</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;myrole&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    role_arn </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;myarn&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    ttl </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;3600s&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R161uhdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R1r61uhdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R1m1uhdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;vault_aws_engine&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;myrole&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;role_arn&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;myarn&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;ttl&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;3600s&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R1m1uhdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R1rm1uhdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws_polling</code> (<!-- -->*<!-- -->AWSPollingConfig) - <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#polling-configuration">Polling configuration</a> for the AWS waiter. Configures the waiter that checks
resource state.</p></li></ul><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-assume-role-configuration"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Assume Role Configuration permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#assume-role-configuration"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Assume Role Configuration</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">AssumeRoleConfig lets users set configuration options for assuming a special
role when executing Packer.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Usage example:</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL config example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R2ihdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">    source</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">        assume_role</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">            role_arn     </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">            session_name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;SESSION_NAME&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">            external_id  </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;EXTERNAL_ID&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R2ihdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Reiihdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON config example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R2qhdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    builder{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;assume_role&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;role_arn&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">    :</span><span style="color:var(--hds-code-block-color-string)">  &quot;arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;session_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)">  &quot;SESSION_NAME&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;external_id&quot;</span><span style="color:var(--hds-code-block-color-punctuation)"> :</span><span style="color:var(--hds-code-block-color-string)">  &quot;EXTERNAL_ID&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R2qhdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Reiqhdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">role_arn</code> (string) - Amazon Resource Name (ARN) of the IAM Role to assume.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">duration_seconds</code> (int) - Number of seconds to restrict the assume role session duration.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">external_id</code> (string) - The external ID to use when assuming the role. If omitted, no external
ID is passed to the AssumeRole call.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">policy</code> (string) - IAM Policy JSON describing further restricting permissions for the IAM
Role being assumed.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">policy_arns</code> ([]string) - Set of Amazon Resource Names (ARNs) of IAM Policies describing further
restricting permissions for the IAM Role being</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session_name</code> (string) - Session name to use when assuming the role.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">tags</code> (map<!-- -->[string]<!-- -->string) - Map of assume role session tags.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">transitive_tag_keys</code> ([]string) - Set of assume role session tag keys to pass to any subsequent sessions.</p></li></ul><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-polling-configuration"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Polling Configuration permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#polling-configuration"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Polling Configuration</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Polling configuration for the AWS waiter. Configures the waiter for resources creation or actions like attaching
volumes or importing image.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R3ehdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">    aws_polling</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">         delay_seconds </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> 30</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">         max_attempts </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> 50</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R3ehdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Rejehdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R3mhdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">    &quot;aws_polling&quot;</span><span style="color:var(--hds-code-block-color-token)"> : {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">         &quot;delay_seconds&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> 30</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">         &quot;max_attempts&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> 50</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R3mhdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Rejmhdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">max_attempts</code> (int) - Specifies the maximum number of attempts the waiter will check for resource state.
This value can also be set via the AWS_MAX_ATTEMPTS.
If both option and environment variable are set, the max_attempts will be considered over the AWS_MAX_ATTEMPTS.
If none is set, defaults to AWS waiter default which is 40 max_attempts.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">delay_seconds</code> (int) - Specifies the delay in seconds between attempts to check the resource state.
This value can also be set via the AWS_POLL_DELAY_SECONDS.
If both option and environment variable are set, the delay_seconds will be considered over the AWS_POLL_DELAY_SECONDS.
If none is set, defaults to AWS waiter default which is 15 seconds.</p></li></ul><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-block-devices-configuration"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Block Devices Configuration permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#block-devices-configuration"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Block Devices Configuration</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Block devices can be nested in the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#ebs_volumes">ebs_volumes</a> array.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">These will be attached when launching your instance. Your
options here may vary depending on the type of VM you use.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Example use case:</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following mapping will tell Packer to encrypt the root volume of the
build instance at launch using a specific non-default kms key:</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R4mhdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">    launch_block_device_mappings</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        device_name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;/dev/sda1&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        encrypted </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> true</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        kms_key_id </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R4mhdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Rekmhdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R4uhdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">&quot;launch_block_device_mappings&quot;</span><span style="color:var(--hds-code-block-color-token)">: [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">       &quot;device_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;/dev/sda1&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">       &quot;encrypted&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> true</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">       &quot;kms_key_id&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R4uhdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Rekuhdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Please note that the kms_key_id option in this example exists for
launch_block_device_mappings but not ami_block_device_mappings.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Documentation for Block Devices Mappings can be found here:
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html</a></p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-optional:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Optional permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Optional:</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">delete_on_termination</code> (bool) - Indicates whether the EBS volume is deleted on instance termination.
Default false. NOTE: If this value is not explicitly set to true and
volumes are not cleaned up by an alternative method, additional volumes
will accumulate after every build.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">device_name</code> (string) - The device name exposed to the instance (for example, /dev/sdh or xvdh).
Required for every device in the block device mapping.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">encrypted</code> (boolean) - Indicates whether or not to encrypt the volume. By default, Packer will
keep the encryption setting to what it was in the source image. Setting
false will result in an unencrypted device, and true will result in an
encrypted one.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">iops</code> (<!-- -->*<!-- -->int64) - The number of I/O operations per second (IOPS) that the volume supports.
See the documentation on
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html">IOPs</a>
for more information</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">no_device</code> (bool) - Suppresses the specified device included in the block device mapping of
the AMI.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_id</code> (string) - The ID of the snapshot.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">throughput</code> (<!-- -->*<!-- -->int64) - The throughput for gp3 volumes, only valid for gp3 types
See the documentation on
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html">Throughput</a>
for more information</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">virtual_name</code> (string) - The virtual device name. See the documentation on Block Device Mapping
for more information.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">volume_type</code> (string) - The volume type. gp2 &amp; gp3 for General Purpose (SSD) volumes, io1 &amp; io2
for Provisioned IOPS (SSD) volumes, st1 for Throughput Optimized HDD,
sc1 for Cold HDD, and standard for Magnetic volumes.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">volume_size</code> (int64) - The size of the volume, in GiB. Required if not specifying a
snapshot_id.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">kms_key_id</code> (string) - ID, alias or ARN of the KMS key to use for boot volume encryption.
This option exists for launch_block_device_mappings but not
ami_block_device_mappings. The kms key id defined here only applies to
the original build region; if the AMI gets copied to other regions, the
volume in those regions will be encrypted by the default EBS KMS key.
For valid formats see KmsKeyId in the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html">AWS API docs -
CopyImage</a>
This field is validated by Packer. When using an alias, you will have to
prefix kms_key_id with alias/.</p></li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">tags</code> (map<!-- -->[string]<!-- -->string) - Key/value pair tags to apply to the volume. These are retained after the builder
completes. This is a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/legacy_json_templates/engine">template engine</a>, see
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-template-data">Build template data</a> for more information.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">tag</code> ([]{key string, value string}) - Same as <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#tags"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">tags</code></a> but defined as a singular repeatable block
containing a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">key</code> and a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">value</code> field. In HCL2 mode the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/hcl_templates/expressions#dynamic-blocks"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">dynamic_block</code></a>
will allow you to create those programatically.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_volume</code> (bool) - Create a Snapshot of this Volume.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_description</code> (string) - The description for the snapshot.</p></li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_tags</code> (map<!-- -->[string]<!-- -->string) - Key/value pair tags to apply to snapshot. They will override AMI tags if
already applied to snapshot. This is a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/legacy_json_templates/engine">template
engine</a>, see <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-template-data">Build template
data</a> for more information.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_tag</code> ([]{key string, value string}) - Same as <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#snapshot_tags"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_tags</code></a> but defined as a singular
repeatable block containing a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">key</code> and a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">value</code> field. In HCL2 mode the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/hcl_templates/expressions#dynamic-blocks"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">dynamic_block</code></a>
will allow you to create those programatically.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_users</code> ([]string) - A list of account IDs that have
access to create volumes from the snapshot(s). By default no additional
users other than the user creating the AMI has permissions to create
volumes from the backing snapshot(s).</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_groups</code> ([]string) - A list of groups that have access to
create volumes from the snapshot(s). By default no groups have permission
to create volumes from the snapshot(s). all will make the snapshot
publicly accessible.</p></li></ul><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-run-configuration"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Run Configuration permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#run-configuration"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Run Configuration</h3><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-required:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Required permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#required:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Required:</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">instance_type</code> (string) - The EC2 instance type to use while building the
AMI, such as t2.small.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami</code> (string) - The source AMI whose root volume will be copied and
provisioned on the currently running instance. This must be an EBS-backed
AMI with a root volume snapshot that you have access to.</p></li></ul><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-optional:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Optional permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Optional:</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">associate_public_ip_address</code> (confighelper.Trilean) - If using a non-default VPC,
public IP addresses are not provided by default. If this is true, your
new instance will get a Public IP. default: unset</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Note: when specifying this attribute without a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">subnet_[id|filter]</code> or
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vpc_[id|filter]</code>, we will attempt to infer this information from the
default VPC/Subnet.
This operation may require some extra permissions to the IAM role that
runs the build:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg">ec2:DescribeVpcs</li><li class="mdx-lists_listItem__nkqhg">ec2:DescribeSubnets</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Additionally, since we filter subnets/AZs by their capability to host
an instance of the selected type, you may also want to define the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ec2:DescribeInstanceTypeOfferings</code> action to the role running the build.
Otherwise, Packer will pick the most available subnet in the VPC selected,
which may not be able to host the instance type you provided.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">availability_zone</code> (string) - Destination availability zone to launch
instance in. Leave this empty to allow Amazon to auto-assign.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">block_duration_minutes</code> (int64) - Requires spot_price to be set. The
required duration for the Spot Instances (also known as Spot blocks). This
value must be a multiple of 60 (60, 120, 180, 240, 300, or 360). You can&#x27;t
specify an Availability Zone group or a launch group if you specify a
duration. Note: This parameter is no longer available to new customers
from July 1, 2021. <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-requests.html#fixed-duration-spot-instances">See Amazon&#x27;s
documentation</a>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">capacity_reservation_preference</code> (string) - Set the preference for using a capacity reservation if one exists.
Either will be <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">open</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">none</code>. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">none</code></p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">capacity_reservation_id</code> (string) - Provide the specific EC2 Capacity Reservation ID that will be used
by Packer.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">capacity_reservation_group_arn</code> (string) - Provide the EC2 Capacity Reservation Group ARN that will be used by
Packer.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">disable_stop_instance</code> (bool) - Packer normally stops the build instance after all provisioners have
run. For Windows instances, it is sometimes desirable to <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/Creating_EBSbacked_WinAMI.html">run
Sysprep</a>
which will stop the instance for you. If this is set to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">true</code>, Packer
<em>will not</em> stop the instance but will assume that you will send the stop
signal yourself through your final provisioner. You can do this with a
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/windows-shell">windows-shell provisioner</a>. Note that
Packer will still wait for the instance to be stopped, and failing to
send the stop signal yourself, when you have set this flag to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">true</code>,
will cause a timeout.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">An example of a valid windows shutdown command in a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">windows-shell</code>
provisioner is :</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R33mahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ec2config.exe -sysprep</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R33mahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7b3mahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">or</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R53mahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  &quot;%programfiles%\amazon\ec2configservice\&quot;ec2config.exe -sysprep&quot;&quot;</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R53mahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7d3mahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Note: The double quotation marks in the command are not required if
your CMD shell is already in the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">C:\Program Files\Amazon\EC2ConfigService\</code> directory.</p></div></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ebs_optimized</code> (bool) - Mark instance as <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html">EBS
Optimized</a>.
Default <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">enable_nitro_enclave</code> (bool) - Enable support for Nitro Enclaves on the instance.  Note that the instance type must
be able to <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://aws.amazon.com/ec2/nitro/nitro-enclaves/faqs/">support Nitro Enclaves</a>.
This option is not supported for spot instances.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">enable_t2_unlimited</code> (bool) - Deprecated argument - please use &quot;enable_unlimited_credits&quot;.
Enabling T2 Unlimited allows the source instance to burst additional CPU
beyond its available <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-credits-baseline-concepts.html">CPU
Credits</a>
for as long as the demand exists. This is in contrast to the standard
configuration that only allows an instance to consume up to its
available CPU Credits. See the AWS documentation for <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-unlimited.html">T2
Unlimited</a>
and the <strong>T2 Unlimited Pricing</strong> section of the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://aws.amazon.com/ec2/pricing/on-demand/">Amazon EC2 On-Demand
Pricing</a> document for
more information. By default this option is disabled and Packer will set
up a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-std.html">T2
Standard</a>
instance instead.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">To use T2 Unlimited you must use a T2 instance type, e.g. <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">t2.micro</code>.
Additionally, T2 Unlimited cannot be used in conjunction with Spot
Instances, e.g. when the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">spot_price</code> option has been configured.
Attempting to do so will cause an error.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">!<!-- -->&gt;<!-- --> <strong>Warning!</strong> Additional costs may be incurred by enabling T2
Unlimited - even for instances that would usually qualify for the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://aws.amazon.com/free/">AWS Free Tier</a>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">enable_unlimited_credits</code> (bool) - Enabling Unlimited credits allows the source instance to burst additional CPU
beyond its available <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html#unlimited-mode-surplus-credits">CPU
Credits</a>
for as long as the demand exists. This is in contrast to the standard
configuration that only allows an instance to consume up to its
available CPU Credits. See the AWS documentation for <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html">T2
Unlimited</a>
and the <strong>Unlimited Pricing</strong> section of the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://aws.amazon.com/ec2/pricing/on-demand/">Amazon EC2 On-Demand
Pricing</a> document for
more information. By default this option is disabled and Packer will set
up a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-standard-mode.html">Standard</a>
instance instead.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">To use Unlimited you must use a T2/T3/T3a/T4g instance type, e.g. (<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">t2.micro</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">t3.micro</code>).
Additionally, Unlimited cannot be used in conjunction with Spot
Instances for T2 type instances, e.g. when the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">spot_price</code> option has been configured.
Attempting to do so will cause an error if the underlying instance type is a T2 type instance.
By default the supported burstable instance types (including t3/t3a/t4g) will be provisioned with its cpu credits set to standard,
only when <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">enable_unlimited_credits</code> is true will the instance be provisioned with unlimited cpu credits.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">iam_instance_profile</code> (string) - The name of an <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/instance-profiles.html">IAM instance
profile</a>
to launch the EC2 instance with.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">fleet_tags</code> (map<!-- -->[string]<!-- -->string) - Key/value pair tags to apply tags to the fleet that is issued.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">fleet_tag</code> ([]{key string, value string}) - Same as <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#fleet_tags"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">fleet_tags</code></a> but defined as a singular repeatable block
containing a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">key</code> and a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">value</code> field. In HCL2 mode the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/hcl_templates/expressions#dynamic-blocks"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">dynamic_block</code></a>
will allow you to create those programatically.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">skip_profile_validation</code> (bool) - Whether or not to check if the IAM instance profile exists. Defaults to false</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_iam_instance_profile_policy_document</code> (<!-- -->*<!-- -->PolicyDocument) - Temporary IAM instance profile policy document
If IamInstanceProfile is specified it will be used instead.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R386ahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">temporary_iam_instance_profile_policy_document</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">    Statement</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        Action   </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;logs:*&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        Effect   </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;Allow&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        Resource </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;*&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    Version </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;2012-10-17&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R386ahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7b86ahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R586ahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;Version&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;2012-10-17&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;Statement&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;Action&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">            &quot;logs:*&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">            ]</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;Effect&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;Allow&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;Resource&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;*&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    ]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R586ahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7d86ahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">shutdown_behavior</code> (string) - Automatically terminate instances on
shutdown in case Packer exits ungracefully. Possible values are stop and
terminate. Defaults to stop.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_filter</code> (SecurityGroupFilterOptions) - Filters used to populate the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_ids</code> field.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 Example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R396ahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  security_group_filter</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    filters </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">      &quot;tag:Class&quot;</span><span style="color:var(--hds-code-block-color-keyword)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;packer&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R396ahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Rej96ahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON Example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R596ahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">  &quot;security_group_filter&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;filters&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;tag:Class&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;packer&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R596ahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Rel96ahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This selects the SG&#x27;s with tag <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Class</code> with the value <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">packer</code>.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">filters</code> (map<!-- -->[string,string]<!-- --> | multiple filters are allowed when seperated by commas) - filters used to select a
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_ids</code>. Any filter described in the docs for
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSecurityGroups.html">DescribeSecurityGroups</a>
is valid.</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_ids</code> take precedence over this.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run_tags</code> (map<!-- -->[string]<!-- -->string) - Key/value pair tags to apply to the generated key-pair, security group, iam profile and role, snapshot, network interfaces and instance
that is <em>launched</em> to create the EBS volumes. The resulting AMI will also inherit these tags.
This is a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/legacy_json_templates/engine">template
engine</a>, see <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-template-data">Build template
data</a> for more information.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run_tag</code> ([]{key string, value string}) - Same as <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#run_tags"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run_tags</code></a> but defined as a singular repeatable
block containing a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">key</code> and a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">value</code> field. In HCL2 mode the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/hcl_templates/expressions#dynamic-blocks"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">dynamic_block</code></a>
will allow you to create those programatically.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_id</code> (string) - The ID (not the name) of the security
group to assign to the instance. By default this is not set and Packer will
automatically create a new temporary security group to allow SSH access.
Note that if this is specified, you must be sure the security group allows
access to the ssh_port given below.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_ids</code> ([]string) - A list of security groups as
described above. Note that if this is specified, you must omit the
security_group_id.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami_filter</code> (AmiFilterOptions) - Filters used to populate the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami</code>
field.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R3bmahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">source</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;basic-example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  source_ami_filter</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    filters </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">       virtualization-type </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;hvm&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">       name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">       root-device-type </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;ebs&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    owners </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;099720109477&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    most_recent </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> true</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R3bmahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7bbmahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON Example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R5bmahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">&quot;builders&quot;</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;source_ami_filter&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">       &quot;filters&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">       &quot;virtualization-type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;hvm&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">       &quot;name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">       &quot;root-device-type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ebs&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">       }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">       &quot;owners&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;099720109477&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">       &quot;most_recent&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> true</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R5bmahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7dbmahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">  This selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. NOTE:
This will fail unless <em>exactly</em> one AMI is returned. In the above example,
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">most_recent</code> will cause this to succeed by selecting the newest image.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">filters</code> (map<!-- -->[string,string]<!-- --> | multiple filters are allowed when seperated by commas) - filters used to select a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami</code>.
NOTE: This will fail unless <em>exactly</em> one AMI is returned. Any filter
described in the docs for
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html">DescribeImages</a>
is valid.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">owners</code> (array of strings) - Filters the images by their owner. You
may specify one or more AWS account IDs, &quot;self&quot; (which will use the
account whose credentials you are using to run Packer), or an AWS owner
alias: for example, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">amazon</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-marketplace</code>, or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">microsoft</code>. This
option is required for security reasons.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">most_recent</code> (boolean) - Selects the newest created image when true.
This is most useful for selecting a daily distro build.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">You may set this in place of <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami</code> or in conjunction with it. If you
set this in conjunction with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami</code>, the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami</code> will be added
to the filter. The provided <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami</code> must meet all of the filtering
criteria provided in <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami_filter</code>; this pins the AMI returned by the
filter, but will cause Packer to fail if the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source_ami</code> does not exist.</p></li></ul></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">spot_instance_types</code> ([]string) - a list of acceptable instance
types to run your build on. We will request a spot instance using the max
price of spot_price and the allocation strategy of &quot;lowest price&quot;.
Your instance will be launched on an instance type of the lowest available
price that you have in your list.  This is used in place of instance_type.
You may only set either spot_instance_types or instance_type, not both.
This feature exists to help prevent situations where a Packer build fails
because a particular availability zone does not have capacity for the
specific instance_type requested in instance_type.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">spot_price</code> (string) - With Spot Instances, you pay the Spot price that&#x27;s in effect for the
time period your instances are running. Spot Instance prices are set by
Amazon EC2 and adjust gradually based on long-term trends in supply and
demand for Spot Instance capacity.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">When this field is set, it represents the maximum hourly price you are
willing to pay for a spot instance. If you do not set this value, it
defaults to a maximum price equal to the on demand price of the
instance. In the situation where the current Amazon-set spot price
exceeds the value set in this field, Packer will not launch an instance
and the build will error. In the situation where the Amazon-set spot
price is less than the value set in this field, Packer will launch and
you will pay the Amazon-set spot price, not this maximum value.
For more information, see the Amazon docs on
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://aws.amazon.com/ec2/spot/pricing/">spot pricing</a>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">spot_tags</code> (map<!-- -->[string]<!-- -->string) - Requires spot_price to be set. Key/value pair tags to apply tags to the
spot request that is issued.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">spot_tag</code> ([]{key string, value string}) - Same as <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#spot_tags"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">spot_tags</code></a> but defined as a singular repeatable block
containing a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">key</code> and a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">value</code> field. In HCL2 mode the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/hcl_templates/expressions#dynamic-blocks"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">dynamic_block</code></a>
will allow you to create those programatically.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">subnet_filter</code> (SubnetFilterOptions) - Filters used to populate the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">subnet_id</code> field.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R3e6ahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">source</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;basic-example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  subnet_filter</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    filters </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">          &quot;tag:Class&quot;</span><span style="color:var(--hds-code-block-color-keyword)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;build&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    most_free </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> true</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    random </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> false</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R3e6ahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7be6ahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON Example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R5e6ahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">&quot;builders&quot;</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;subnet_filter&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;filters&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;tag:Class&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;build&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;most_free&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> true</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;random&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> false</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R5e6ahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7de6ahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">  This selects the Subnet with tag <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Class</code> with the value <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">build</code>, which has
the most free IP addresses. NOTE: This will fail unless <em>exactly</em> one
Subnet is returned. By using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">most_free</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">random</code> one will be selected
from those matching the filter.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">filters</code> (map<!-- -->[string,string]<!-- --> | multiple filters are allowed when seperated by commas) - filters used to select a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">subnet_id</code>.
NOTE: This will fail unless <em>exactly</em> one Subnet is returned. Any
filter described in the docs for
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSubnets.html">DescribeSubnets</a>
is valid.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">most_free</code> (boolean) - The Subnet with the most free IPv4 addresses
will be used if multiple Subnets matches the filter.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">random</code> (boolean) - A random Subnet will be used if multiple Subnets
matches the filter. <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">most_free</code> have precendence over this.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">subnet_id</code> take precedence over this.</p></li></ul></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">subnet_id</code> (string) - If using VPC, the ID of the subnet, such as
subnet-12345def, where Packer will launch the EC2 instance. This field is
required if you are using an non-default VPC.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">license_specifications</code> ([]LicenseSpecification) - The license configurations.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R3f6ahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">source</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;basic-example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  license_specifications</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    license_configuration_request </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      license_configuration_arn </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;</span><span style="color:var(--hds-code-block-color-keyword)">${</span><span style="color:var(--hds-code-block-color-string)">var</span><span style="color:var(--hds-code-block-color-token)">.</span><span style="color:var(--hds-code-block-color-string)">license_configuration_arn</span><span style="color:var(--hds-code-block-color-keyword)">}</span><span style="color:var(--hds-code-block-color-string)">&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R3f6ahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7bf6ahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R5f6ahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">&quot;builders&quot;</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;license_specifications&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;license_configuration_request&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;license_configuration_arn&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{user `license_configuration_arn`}}&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    ]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R5f6ahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7df6ahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">  Each <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">license_configuration_request</code> describes a license configuration,
the properties of which are:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">license_configuration_arn</code> (string) - The Amazon Resource Name (ARN)
of the license configuration.</li></ul></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">placement</code> (Placement) - Describes the placement of an instance.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R3fmahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">source</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;basic-example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  placement </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    host_resource_group_arn </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;</span><span style="color:var(--hds-code-block-color-keyword)">${</span><span style="color:var(--hds-code-block-color-string)">var</span><span style="color:var(--hds-code-block-color-token)">.</span><span style="color:var(--hds-code-block-color-string)">host_resource_group_arn</span><span style="color:var(--hds-code-block-color-keyword)">}</span><span style="color:var(--hds-code-block-color-string)">&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    tenancy                 </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;</span><span style="color:var(--hds-code-block-color-keyword)">${</span><span style="color:var(--hds-code-block-color-string)">var</span><span style="color:var(--hds-code-block-color-token)">.</span><span style="color:var(--hds-code-block-color-string)">placement_tenancy</span><span style="color:var(--hds-code-block-color-keyword)">}</span><span style="color:var(--hds-code-block-color-string)">&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R3fmahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7bfmahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R5fmahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">&quot;builders&quot;</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;placement&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;host_resource_group_arn&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{user `host_resource_group_arn`}}&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;tenancy&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{user `placement_tenancy`}}&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R5fmahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R7dfmahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">host_resource_group_arn</code> (string) - The ARN of the host resource
group in which to launch the instances. If you specify a host
resource group ARN, omit the Tenancy parameter or set it to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">host</code>.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">tenancy</code> (string) - The tenancy of the instance (if the instance is
running in a VPC). An instance with a tenancy of <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">dedicated</code> runs on
single-tenant hardware. The default is <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">default</code>, meaning shared
tenancy. Allowed values are <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">default</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">dedicated</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">host</code>.</li></ul></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">tenancy</code> (string) - Deprecated: Use Placement Tenancy instead.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_security_group_source_cidrs</code> ([]string) - A list of IPv4 CIDR blocks to be authorized access to the instance, when
packer is creating a temporary security group.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The default is <!-- -->[<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">0.0.0.0/0</code>]<!-- --> (i.e., allow any IPv4 source).
Use <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_security_group_source_public_ip</code> to allow current host&#x27;s
public IP instead of any IPv4 source.
This is only used when <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_id</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_ids</code> is not
specified.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_security_group_source_public_ip</code> (bool) - When enabled, use public IP of the host (obtained from <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://checkip.amazonaws.com">https://checkip.amazonaws.com</a>)
as CIDR block to be authorized access to the instance, when packer
is creating a temporary security group. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This is only used when <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_id</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">security_group_ids</code>,
and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_security_group_source_cidrs</code> are not specified.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">user_data</code> (string) - User data to apply when launching the instance. Note
that you need to be careful about escaping characters due to the templates
being JSON. It is often more convenient to use user_data_file, instead.
Packer will not automatically wait for a user script to finish before
shutting down the instance this must be handled in a provisioner.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">user_data_file</code> (string) - Path to a file that will be used for the user
data when launching the instance.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vpc_filter</code> (VpcFilterOptions) - Filters used to populate the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vpc_id</code> field.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R3imahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">source</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;basic-example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  vpc_filter</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    filters </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">      &quot;tag:Class&quot;</span><span style="color:var(--hds-code-block-color-keyword)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;build&quot;</span><span style="color:var(--hds-code-block-color-token)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">      &quot;isDefault&quot;</span><span style="color:var(--hds-code-block-color-keyword)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;false&quot;</span><span style="color:var(--hds-code-block-color-token)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">      &quot;cidr&quot;</span><span style="color:var(--hds-code-block-color-keyword)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;/24&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R3imahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Rejimahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON Example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R5imahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">&quot;builders&quot;</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;vpc_filter&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;filters&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;tag:Class&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;build&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;isDefault&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;false&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;cidr&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;/24&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R5imahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Relimahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This selects the VPC with tag <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Class</code> with the value <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">build</code>, which is not
the default VPC, and have a IPv4 CIDR block of <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/24</code>. NOTE: This will fail
unless <em>exactly</em> one VPC is returned.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">filters</code> (map<!-- -->[string,string]<!-- --> | multiple filters are allowed when seperated by commas) - filters used to select a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vpc_id</code>. NOTE:
This will fail unless <em>exactly</em> one VPC is returned. Any filter
described in the docs for
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeVpcs.html">DescribeVpcs</a>
is valid.</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vpc_id</code> take precedence over this.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vpc_id</code> (string) - If launching into a VPC subnet, Packer needs the VPC ID
in order to create a temporary security group within the VPC. Requires
subnet_id to be set. If this field is left blank, Packer will try to get
the VPC ID from the subnet_id.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">windows_password_timeout</code> (duration string | ex: &quot;1h5m2s&quot;) - The timeout for waiting for a Windows
password for Windows instances. Defaults to 20 minutes. Example value:
10m</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">metadata_options</code> (MetadataOptions) - <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#metadata-settings">Metadata Settings</a></p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_interface</code> (string) - One of <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">public_ip</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">private_ip</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">public_dns</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">private_dns</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session_manager</code>.
If set, either the public IP address, private IP address, public DNS name
or private DNS name will be used as the host for SSH. The default behaviour
if inside a VPC is to use the public IP address if available, otherwise
the private IP address will be used. If not in a VPC the public DNS name
will be used. Also works for WinRM.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">   Where Packer is configured for an outbound proxy but WinRM traffic
should be direct, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_interface</code> must be set to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">private_dns</code> and
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;region&gt;.compute.internal</code> included in the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">NO_PROXY</code> environment
variable.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">   When using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session_manager</code> the machine running Packer must have
the AWS Session Manager Plugin installed and within the users&#x27; system path.
Connectivity via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session_manager</code> interface establishes a secure tunnel
between the local host and the remote host on an available local port to the specified <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_port</code>.
See <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#session-manager-connections">Session Manager Connections</a> for more information.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg">Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM communicator.</li><li class="mdx-lists_listItem__nkqhg">Upon termination the secure tunnel will be terminated automatically, if however there is a failure in
terminating the tunnel it will automatically terminate itself after 20 minutes of inactivity.</li></ul></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">pause_before_ssm</code> (duration string | ex: &quot;1h5m2s&quot;) - The time to wait before establishing the Session Manager session.
The value of this should be a duration. Examples are
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">5s</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">1m30s</code> which will cause Packer to wait five seconds and one
minute 30 seconds, respectively. If no set, defaults to 10 seconds.
This option is useful when the remote port takes longer to become available.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session_manager_port</code> (int) - Which port to connect the local end of the session tunnel to. If
left blank, Packer will choose a port for you from available ports.
This option is only used when <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_interface</code> is set <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session_manager</code>.</p></li></ul><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-metadata-settings"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Metadata Settings permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#metadata-settings"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Metadata Settings</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Configures the metadata options.
See <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html">Configure IMDS</a> for details.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">http_endpoint</code> (string) - A string to enable or disable the IMDS endpoint for an instance. Defaults to enabled.
Accepts either &quot;enabled&quot; or &quot;disabled&quot;</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">http_tokens</code> (string) - A string to either set the use of IMDSv2 for the instance to optional or required. Defaults to &quot;optional&quot;.
Accepts either &quot;optional&quot; or &quot;required&quot;</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">http_put_response_hop_limit</code> (int64) - A numerical value to set an upper limit for the amount of hops allowed when communicating with IMDS endpoints.
Defaults to 1.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">instance_metadata_tags</code> (string) - A string to enable or disable access to instance tags from the instance metadata. Defaults to disabled.
Access to instance metadata tags is available for commercial regions. For non-commercial regions please check availability before enabling.
Accepts either &quot;enabled&quot; or &quot;disabled&quot;</p></li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Usage Example</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R72hdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">source</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;basic-example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  region        </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)">  &quot;us-east-1&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  source_ami    </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)">  &quot;ami-fce3c696&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  instance_type </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)">  &quot;t2.micro&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ssh_username  </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)">  &quot;ubuntu&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ami_name      </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)">  &quot;packer_AWS_example_{{timestamp}}&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  metadata_options</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    http_endpoint </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;enabled&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    http_tokens </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;required&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    http_put_response_hop_limit </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> 1</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R72hdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Ren2hdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R7ahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">  &quot;variables&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;aws_access_key&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{env `AWS_ACCESS_KEY_ID`}}&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;aws_secret_key&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{env `AWS_SECRET_ACCESS_KEY`}}&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">  &quot;builders&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;access_key&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{user `aws_access_key`}}&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;secret_key&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{user `aws_secret_key`}}&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;region&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;us-east-1&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;source_ami&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ami-fce3c696&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;instance_type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;t2.micro&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;ssh_username&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ubuntu&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;ami_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;packer_AWS {{timestamp}}&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;metadata_options&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;http_endpoint&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;enabled&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;http_tokens&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;required&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;http_put_response_hop_limit&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> 1</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R7ahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Renahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-session-manager-connections"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Session Manager Connections permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#session-manager-connections"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Session Manager Connections</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Support for the AWS Systems Manager session manager lets users manage EC2 instances without the need to open inbound ports, or maintain bastion hosts. Session manager connectivity relies on the use of the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#session-manager-plugin">session manager plugin</a> to open a secure tunnel between the local machine and the remote instance. Once the tunnel has been created all SSH communication will be tunneled through SSM to the remote instance.</p><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Note: Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM Communicator.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">To use the session manager as the connection interface for the SSH communicator you need to add the following configuration options to the Amazon builder options:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_interface</code>: The ssh interface must be set to &quot;session_manager&quot;. When using this option the builder will create an SSM tunnel to the configured <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_port</code> (defaults to 22) on the remote host.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">iam_instance_profile</code>: A valid instance profile granting Systems Manager permissions to manage the remote instance is required in order for the aws ssm-agent to start and stop session connections.
See below for more details on <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#iam-instance-profile-for-systems-manager">IAM instance profile for Systems Manager</a>.</li></ul><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-optional"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Optional permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Optional</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session_manager_port</code>: A local port on the host machine that should be used as the local end of the session tunnel to the remote host. If not specified Packer will find an available port to use.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_iam_instance_profile_policy_document</code>: Creates a temporary instance profile policy document to grant Systems Manager permissions to the Ec2 instance. This is an alternative to using an existing <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">iam_instance_profile</code>.</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">HCL2 example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R8ehdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)"># file: example.pkr.hcl</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)"># In order to get these variables to read from the environment,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)"># set the environment variables to have the same name as the declared</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)"># variables, with the prefix PKR_VAR_.</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)"># You could also hardcode them into the file, but we do not recommend that.</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">data</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ami&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  filters </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    virtualization-type </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;hvm&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    name                </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    root-device-type    </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;ebs&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  owners      </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;099720109477&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  most_recent </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> true</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  region      </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;us-east-1&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">source</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;ssm-example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ami_name             </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;packer_AWS {{timestamp}}&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  instance_type        </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;t2.micro&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  region               </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;us-east-1&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  source_ami           </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> data.amazon-ami.example.id</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ssh_username         </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;ubuntu&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ssh_interface        </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;session_manager&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  communicator         </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;ssh&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  iam_instance_profile </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;myinstanceprofile&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">build</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  sources </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;source.amazon-ebs.ssm-example&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  provisioner</span><span style="color:var(--hds-code-block-color-constant)"> &quot;shell&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    inline </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;echo Connected via SSM at &#x27;</span><span style="color:var(--hds-code-block-color-keyword)">${</span><span style="color:var(--hds-code-block-color-string)">build</span><span style="color:var(--hds-code-block-color-token)">.</span><span style="color:var(--hds-code-block-color-string)">User</span><span style="color:var(--hds-code-block-color-keyword)">}</span><span style="color:var(--hds-code-block-color-string)">@</span><span style="color:var(--hds-code-block-color-keyword)">${</span><span style="color:var(--hds-code-block-color-string)">build</span><span style="color:var(--hds-code-block-color-token)">.</span><span style="color:var(--hds-code-block-color-string)">Host</span><span style="color:var(--hds-code-block-color-keyword)">}</span><span style="color:var(--hds-code-block-color-string)">:</span><span style="color:var(--hds-code-block-color-keyword)">${</span><span style="color:var(--hds-code-block-color-string)">build</span><span style="color:var(--hds-code-block-color-token)">.</span><span style="color:var(--hds-code-block-color-string)">Port</span><span style="color:var(--hds-code-block-color-keyword)">}</span><span style="color:var(--hds-code-block-color-string)">&#x27;&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R8ehdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Reoehdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">JSON example:</p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R8mhdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">  &quot;builders&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;ami_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;packer-ami-{{timestamp}}&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;instance_type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;t2.micro&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;source_ami_filter&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;filters&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;virtualization-type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;hvm&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;root-device-type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ebs&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;owners&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;099720109477&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">        &quot;most_recent&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> true</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;ssh_username&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ubuntu&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;ssh_interface&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;session_manager&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;communicator&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ssh&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;iam_instance_profile&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{user `iam_instance_profile`}}&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ]</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">  &quot;provisioners&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;shell&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;inline&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">        &quot;echo Connected via SSM at &#x27;{{build `User`}}@{{build `Host`}}:{{build `Port`}}&#x27;&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      ]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R8mhdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Reomhdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-session-manager-plugin"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Session Manager Plugin permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#session-manager-plugin"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Session Manager Plugin</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Connectivity via the session manager requires the use of a session-manger-plugin, which needs to be installed alongside Packer, and an instance AMI that is capable of running the AWS ssm-agent - see <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/systems-manager/latest/userguide/prereqs-ssm-agent.html">About SSM Agent</a> for details on supported AMIs.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">In order for Packer to start and end sessions that connect you to your managed instances, you must first install the Session Manager plugin on your local machine. The plugin can be installed on supported versions of Microsoft Windows, macOS, Linux, and Ubuntu Server.
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html">Installation instructions for the session-manager-plugin</a></p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-iam-instance-profile-for-systems-manager"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="IAM instance profile for Systems Manager permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#iam-instance-profile-for-systems-manager"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>IAM instance profile for Systems Manager</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">By default Systems Manager doesn&#x27;t have permission to perform actions on created instances so SSM access must be granted by creating an instance profile with the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AmazonSSMManagedInstanceCore</code> policy. The instance profile can then be attached to any instance you wish to manage via the session-manager-plugin. See <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html#instance-profile-add-permissions">Adding System Manager instance profile</a> for details on creating the required instance profile.</p><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-permissions-for-closing-the-tunnel"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Permissions for Closing the Tunnel permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#permissions-for-closing-the-tunnel"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Permissions for Closing the Tunnel</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">To close the SSM tunnels created, this plugin relies on being able to call
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstanceStatus.html">DescribeInstanceStatus</a>.
In case this is not possible you might see a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Bad exit status</code> message in the logs.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The absence of this permission won&#x27;t prevent you from building the AMI, and the error only means that packer is not able to close the tunnel gracefully.</p><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-communicator-configuration"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Communicator Configuration permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#communicator-configuration"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Communicator Configuration</h3><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-optional:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Optional permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Optional:</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">communicator</code> (string) - Packer currently supports three kinds of communicators:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">none</code> - No communicator will be used. If this is set, most
provisioners also can&#x27;t be used.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh</code> - An SSH connection will be established to the machine. This
is usually the default.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">winrm</code> - A WinRM connection will be established.</p></li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">In addition to the above, some builders have custom communicators they
can use. For example, the Docker builder has a &quot;docker&quot; communicator
that uses <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">docker exec</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">docker cp</code> to execute scripts and copy
files.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">pause_before_connecting</code> (duration string | ex: &quot;1h5m2s&quot;) - We recommend that you enable SSH or WinRM as the very last step in your
guest&#x27;s bootstrap script, but sometimes you may have a race condition
where you need Packer to wait before attempting to connect to your
guest.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If you end up in this situation, you can use the template option
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">pause_before_connecting</code>. By default, there is no pause. For example if
you set <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">pause_before_connecting</code> to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">10m</code> Packer will check whether it
can connect, as normal. But once a connection attempt is successful, it
will disconnect and then wait 10 minutes before connecting to the guest
and beginning provisioning.</p></li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_host</code> (string) - The address to SSH to. This usually is automatically configured by the
builder.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_port</code> (int) - The port to connect to SSH. This defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">22</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_username</code> (string) - The username to connect to SSH with. Required if using SSH.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_password</code> (string) - A plaintext password to use to authenticate with SSH.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_ciphers</code> ([]string) - This overrides the value of ciphers supported by default by Golang.
The default value is <!-- -->[
&quot;aes128-gcm@openssh.com&quot;,
&quot;chacha20-poly1305@openssh.com&quot;,
&quot;aes128-ctr&quot;, &quot;aes192-ctr&quot;, &quot;aes256-ctr&quot;,
]</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Valid options for ciphers include:
&quot;aes128-ctr&quot;, &quot;aes192-ctr&quot;, &quot;aes256-ctr&quot;, &quot;<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="mailto:aes128-gcm@openssh.com">aes128-gcm@openssh.com</a>&quot;,
&quot;<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="mailto:chacha20-poly1305@openssh.com">chacha20-poly1305@openssh.com</a>&quot;,
&quot;arcfour256&quot;, &quot;arcfour128&quot;, &quot;arcfour&quot;, &quot;aes128-cbc&quot;, &quot;3des-cbc&quot;,</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_clear_authorized_keys</code> (bool) - If true, Packer will attempt to remove its temporary key from
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">~/.ssh/authorized_keys</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/root/.ssh/authorized_keys</code>. This is a
mostly cosmetic option, since Packer will delete the temporary private
key from the host system regardless of whether this is set to true
(unless the user has set the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-debug</code> flag). Defaults to &quot;false&quot;;
currently only works on guests with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">sed</code> installed.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_key_exchange_algorithms</code> ([]string) - If set, Packer will override the value of key exchange (kex) algorithms
supported by default by Golang. Acceptable values include:
&quot;<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="mailto:curve25519-sha256@libssh.org">curve25519-sha256@libssh.org</a>&quot;, &quot;ecdh-sha2-nistp256&quot;,
&quot;ecdh-sha2-nistp384&quot;, &quot;ecdh-sha2-nistp521&quot;,
&quot;diffie-hellman-group14-sha1&quot;, and &quot;diffie-hellman-group1-sha1&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_certificate_file</code> (string) - Path to user certificate used to authenticate with SSH.
The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">~</code> can be used in path and will be expanded to the
home directory of current user.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_pty</code> (bool) - If <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">true</code>, a PTY will be requested for the SSH connection. This defaults
to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_timeout</code> (duration string | ex: &quot;1h5m2s&quot;) - The time to wait for SSH to become available. Packer uses this to
determine when the machine has booted so this is usually quite long.
Example value: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">10m</code>.
This defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">5m</code>, unless <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_handshake_attempts</code> is set.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_disable_agent_forwarding</code> (bool) - If true, SSH agent forwarding will be disabled. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_handshake_attempts</code> (int) - The number of handshakes to attempt with SSH once it can connect.
This defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">10</code>, unless a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_timeout</code> is set.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_bastion_host</code> (string) - A bastion host to use for the actual SSH connection.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_bastion_port</code> (int) - The port of the bastion host. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">22</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_bastion_agent_auth</code> (bool) - If <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">true</code>, the local SSH agent will be used to authenticate with the
bastion host. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_bastion_username</code> (string) - The username to connect to the bastion host.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_bastion_password</code> (string) - The password to use to authenticate with the bastion host.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_bastion_interactive</code> (bool) - If <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">true</code>, the keyboard-interactive used to authenticate with bastion host.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_bastion_private_key_file</code> (string) - Path to a PEM encoded private key file to use to authenticate with the
bastion host. The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">~</code> can be used in path and will be expanded to the
home directory of current user.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_bastion_certificate_file</code> (string) - Path to user certificate used to authenticate with bastion host.
The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">~</code> can be used in path and will be expanded to the
home directory of current user.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_file_transfer_method</code> (string) - <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">scp</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">sftp</code> - How to transfer files, Secure copy (default) or SSH
File Transfer Protocol.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>NOTE</strong>: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp
(the default protocol for copying data) returns a a non-zero error code since the MOTW
cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol
with SFTP instead <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_file_transfer_protocol = &quot;sftp&quot;</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_proxy_host</code> (string) - A SOCKS proxy host to use for SSH connection</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_proxy_port</code> (int) - A port of the SOCKS proxy. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">1080</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_proxy_username</code> (string) - The optional username to authenticate with the proxy server.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_proxy_password</code> (string) - The optional password to use to authenticate with the proxy server.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_keep_alive_interval</code> (duration string | ex: &quot;1h5m2s&quot;) - How often to send &quot;keep alive&quot; messages to the server. Set to a negative
value (<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-1s</code>) to disable. Example value: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">10s</code>. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">5s</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_read_write_timeout</code> (duration string | ex: &quot;1h5m2s&quot;) - The amount of time to wait for a remote command to end. This might be
useful if, for example, packer hangs on a connection after a reboot.
Example: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">5m</code>. Disabled by default.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_remote_tunnels</code> ([]string) - </p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_local_tunnels</code> ([]string) - </p></li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_key_pair_type</code> (string) - <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">dsa</code> | <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ecdsa</code> | <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ed25519</code> | <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">rsa</code> ( the default )</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Specifies the type of key to create. The possible values are &#x27;dsa&#x27;,
&#x27;ecdsa&#x27;, &#x27;ed25519&#x27;, or &#x27;rsa&#x27;.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">NOTE: DSA is deprecated and no longer recognized as secure, please
consider other alternatives like RSA or ED25519.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_key_pair_bits</code> (int) - Specifies the number of bits in the key to create. For RSA keys, the
minimum size is 1024 bits and the default is 4096 bits. Generally, 3072
bits is considered sufficient. DSA keys must be exactly 1024 bits as
specified by FIPS 186-2. For ECDSA keys, bits determines the key length
by selecting from one of three elliptic curve sizes: 256, 384 or 521
bits. Attempting to use bit lengths other than these three values for
ECDSA keys will fail. Ed25519 keys have a fixed length and bits will be
ignored.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">NOTE: DSA is deprecated and no longer recognized as secure as specified
by FIPS 186-5, please consider other alternatives like RSA or ED25519.</p></li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_keypair_name</code> (string) - If specified, this is the key that will be used for SSH with the
machine. The key must match a key pair name loaded up into the remote.
By default, this is blank, and Packer will generate a temporary keypair
unless <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#ssh_password"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_password</code></a> is used.
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#ssh_private_key_file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_private_key_file</code></a> or
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#ssh_agent_auth"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_agent_auth</code></a> must be specified when
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#ssh_keypair_name"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_keypair_name</code></a> is utilized.</li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_private_key_file</code> (string) - Path to a PEM encoded private key file to use to authenticate with SSH.
The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">~</code> can be used in path and will be expanded to the home directory
of current user.</li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_agent_auth</code> (bool) - If true, the local SSH agent will be used to authenticate connections to
the source instance. No temporary keypair will be created, and the
values of <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#ssh_password"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_password</code></a> and
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#ssh_private_key_file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ssh_private_key_file</code></a> will be ignored. The
environment variable <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SSH_AUTH_SOCK</code> must be set for this option to work
properly.</li></ul><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-basic-example"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Basic Example permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#basic-example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Basic Example</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":Rb2hdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">source</span><span style="color:var(--hds-code-block-color-constant)"> &quot;amazon-ebsvolume&quot;</span><span style="color:var(--hds-code-block-color-constant)"> &quot;basic-example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  region </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;us-east-1&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ssh_username </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;ubuntu&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  instance_type </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;t2.medium&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  source_ami </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;ami-40d28157&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  ebs_volumes</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      volume_type </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;gp2&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      device_name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;/dev/xvdf&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      delete_on_termination </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> false</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      tags </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        zpool </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;data&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        Name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;Data1&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      volume_size </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> 10</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  ebs_volumes</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      volume_type </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;gp2&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      device_name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;/dev/xvdg&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      tags </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        zpool </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;data&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        Name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;Data2&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      delete_on_termination </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> false</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      volume_size </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> 10</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">  ebs_volumes</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      volume_size </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> 10</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      tags </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        zpool </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;data&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        Name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;Data3&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      delete_on_termination </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> false</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      device_name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;/dev/xvdh&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      volume_type </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;gp2&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-function)">build</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  sources </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;sources.amazon-ebsvolume.basic-example&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":Rb2hdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Rer2hdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":Rbahdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">  &quot;builders&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;amazon-ebsvolume&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;region&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;us-east-1&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;ssh_username&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ubuntu&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;instance_type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;t2.medium&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;source_ami&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;ami-40d28157&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;ebs_volumes&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;volume_type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;gp2&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;device_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;/dev/xvdf&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;delete_on_termination&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> false</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;tags&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;zpool&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;data&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;Name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;Data1&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">          }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;volume_size&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> 10</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;volume_type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;gp2&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;device_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;/dev/xvdg&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;tags&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;zpool&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;data&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;Name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;Data2&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">          }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;delete_on_termination&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> false</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;volume_size&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> 10</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;volume_size&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> 10</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;tags&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;Name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;Data3&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">            &quot;zpool&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;data&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">          }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;delete_on_termination&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> false</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;device_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;/dev/xvdh&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">          &quot;volume_type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;gp2&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">      ]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  ]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":Rbahdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Rerahdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Note:</strong> Packer can also read the access key and secret access key from
environmental variables. See the configuration reference in the section above
for more information on what environmental variables Packer will look for.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Further information on locating AMI IDs and their relationship to instance
types and regions can be found in the AWS EC2 Documentation <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/finding-an-ami.html">for
Linux</a>
or <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="http://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/finding-an-ami.html">for
Windows</a>.</p><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-accessing-the-instance-to-debug"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Accessing the Instance to Debug permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#accessing-the-instance-to-debug"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Accessing the Instance to Debug</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If you need to access the instance to debug for some reason, run the builder
with the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-debug</code> flag. In debug mode, the Amazon builder will save the private
key in the current directory and will output the DNS or IP information as well.
You can use this information to access the instance as it is running.</p><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-build-template-data"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Build template data permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-template-data"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Build template data</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">In configuration directives marked as a template engine above, the following
variables are available:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">BuildRegion</code> - The region (for example <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">eu-central-1</code>) where Packer is
building the AMI.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMI</code> - The source AMI ID (for example <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ami-a2412fcd</code>) used to build
the AMI.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMICreationDate</code> - The source AMI creation date (for example <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&quot;2020-05-14T19:26:34.000Z&quot;</code>).</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMIName</code> - The source AMI Name (for example
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306</code>) used to
build the AMI.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMIOwner</code> - The source AMI owner ID.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMIOwnerName</code> - The source AMI owner alias/name (for example <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">amazon</code>).</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMITags</code> - The source AMI Tags, as a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">map[string]string</code> object.</li></ul><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-build-shared-information-variables"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Build Shared Information Variables permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-shared-information-variables"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Build Shared Information Variables</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This builder generates data that are shared with provisioner and post-processor via build function of <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/legacy_json_templates/engine">template engine</a> for JSON and <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/hcl_templates/contextual-variables">contextual variables</a> for HCL2.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The generated variables available for this builder are:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">BuildRegion</code> - The region (for example <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">eu-central-1</code>) where Packer is
building the AMI.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMI</code> - The source AMI ID (for example <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ami-a2412fcd</code>) used to build
the AMI.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMICreationDate</code> - The source AMI creation date (for example <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&quot;2020-05-14T19:26:34.000Z&quot;</code>).</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMIName</code> - The source AMI Name (for example
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306</code>) used to
build the AMI.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMIOwner</code> - The source AMI owner ID.</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMIOwnerName</code> - The source AMI owner alias/name (for example <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">amazon</code>).</li></ul><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Note:</strong> Packer uses pre-built AMIs as the source for building images.
These source AMIs may include volumes that are not flagged to be destroyed on
termination of the instance building the new image. In addition to those
volumes created by this builder, any volumes in the source AMI which are not
marked for deletion on termination will remain in your account.</p></div><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-build-shared-information-variables"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Build Shared Information Variables permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-shared-information-variables"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Build Shared Information Variables</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This builder generates data that are shared with provisioner and post-processor via build function of <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/legacy_json_templates/engine">template engine</a> for JSON and <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/packer/docs/templates/hcl_templates/contextual-variables">contextual variables</a> for HCL2.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The generated variables available for this builder are:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceAMIName</code> - The source AMI Name (for example
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306</code>) used to
build the AMI.</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Usage example:</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":Rdmhdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)">// When accessing one of these variables from inside the builder, you need to</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)">// use the golang templating syntax. This is due to an architectural quirk that</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)">// won&#x27;t be easily resolvable until legacy json templates are deprecated:</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">source </span><span style="color:var(--hds-code-block-color-string)">&quot;amazon-ebs&quot;</span><span style="color:var(--hds-code-block-color-string)"> &quot;basic-example&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  tags </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        OS_Version </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;Ubuntu&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        Release </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;Latest&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        Base_AMI_ID </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{ .SourceAMI }}&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        Base_AMI_Name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{ .SourceAMIName }}&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last">
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)">// when accessing one of the variables from a provisioner or post-processor, use</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-comment)">// hcl-syntax</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">post</span><span style="color:var(--hds-code-block-color-keyword)">-</span><span style="color:var(--hds-code-block-color-token)">processor </span><span style="color:var(--hds-code-block-color-string)">&quot;manifest&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    output </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;manifest.json&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    strip_path </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-constant)"> true</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    custom_data </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">        source_ami_name </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;</span><span style="color:var(--hds-code-block-color-keyword)">${</span><span style="color:var(--hds-code-block-color-string)">build</span><span style="color:var(--hds-code-block-color-token)">.</span><span style="color:var(--hds-code-block-color-string)">SourceAMIName</span><span style="color:var(--hds-code-block-color-keyword)">}</span><span style="color:var(--hds-code-block-color-string)">&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":Rdmhdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Retmhdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="hds-code-block hds-code-block--theme-dark hds-code-block--is-standalone mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":Rduhdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-string)">&quot;post-processors&quot;</span><span style="color:var(--hds-code-block-color-token)">: [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;type&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;manifest&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;output&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;manifest.json&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;strip_path&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> true</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">    &quot;custom_data&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-keyword)">      &quot;source_ami_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;{{ build `SourceAMIName` }}&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span><span style="color:var(--hds-code-block-color-token)">]</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":Rduhdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":Retuhdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.9d24babe.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-which-ssh-options-to-use:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Which SSH Options to use permalink" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#which-ssh-options-to-use:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Which SSH Options to use:</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This chart breaks down what Packer does if you set any of the below SSH options:</p><div class="mdx-table_root__adKqa"><div class="mdx-table_tableWrapper__81O9J"><table><thead><tr><th>ssh_password</th><th>ssh_private_key_file</th><th>ssh_keypair_name</th><th>temporary_key_pair_name</th><th>Packer will...</th></tr></thead><tbody><tr><td>X</td><td>-</td><td>-</td><td>-</td><td>ssh authenticating with username and given password</td></tr><tr><td>-</td><td>X</td><td>-</td><td>-</td><td>ssh authenticating with private key file</td></tr><tr><td>-</td><td>X</td><td>X</td><td>-</td><td>ssh authenticating with given private key file and &quot;attaching&quot; the keypair to the instance</td></tr><tr><td>-</td><td>-</td><td>-</td><td>X</td><td>Create a temporary ssh keypair with a particular name, clean it up</td></tr><tr><td>-</td><td>-</td><td>-</td><td>-</td><td>Create a temporary ssh keypair with a default name, clean it up</td></tr></tbody></table></div><div class="mdx-table_tableFocusRing__qNrYf"></div><div><div class="mdx-table_leftScrim__mYsmq mdx-table_scrim__VtktE"></div><div class="mdx-table_rightScrim__Ikt63 mdx-table_scrim__VtktE"></div></div></div></div></div></div></main><div class="sidebar-sidecar-layout_sidecarPosition__WtTq0"><div class="sidebar-sidecar-layout_sidecarTopSlot__qRAEI"></div><div class="sidecar-scroll-container_root__a8nIj"><div class="sidecar-scroll-container_scrollContainer__Dw9id"><div><nav aria-labelledby="react-aria-145"><p id="react-aria-145" class="outline-nav_navLabel__HrjQb hds-typography-body-100">On this page:</p><ol class="outline-nav_listRoot__Sm1fr"><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#configuration-reference">Configuration Reference</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:">Optional:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#access-configuration">Access Configuration</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#required:">Required:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:">Optional:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#assume-role-configuration">Assume Role Configuration</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#polling-configuration">Polling Configuration</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#block-devices-configuration">Block Devices Configuration</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:">Optional:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#run-configuration">Run Configuration</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#required:">Required:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:">Optional:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#metadata-settings">Metadata Settings</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#session-manager-connections">Session Manager Connections</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional">Optional</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#session-manager-plugin">Session Manager Plugin</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#iam-instance-profile-for-systems-manager">IAM instance profile for Systems Manager</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#permissions-for-closing-the-tunnel">Permissions for Closing the Tunnel</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#communicator-configuration">Communicator Configuration</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#optional:">Optional:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#basic-example">Basic Example</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#accessing-the-instance-to-debug">Accessing the Instance to Debug</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-template-data">Build template data</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-shared-information-variables">Build Shared Information Variables</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#build-shared-information-variables">Build Shared Information Variables</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume#which-ssh-options-to-use:">Which SSH Options to use:</a></li></ol></nav></div></div></div></div></div></div></div></div></div><div class="base-layout_footer__HGqK8 base-layout_showFooterTopBorder__4_CwH"><footer class="footer_root__qJO_k"><span class="footer_logoAndSwitcher__CJkN3"><a href="https://www.hashicorp.com/" aria-label="Go to HashiCorp home page" class="footer_logo__pe9i3 g-focus-ring-from-box-shadow"><div><svg xmlns="http://www.w3.org/2000/svg" width="254" height="53" fill="none" viewBox="0 0 254 53"><g fill="#000" clip-path="url(#clip0_1743_1384)"><g><path d="M63.01 12.22h5.32v11.43h12.19V12.22h5.36V40.2h-5.36V28.45H68.33V40.2h-5.32zM89.28 34.77c0-4.2 2.96-5.6 6.56-6.44l6.079-1.4v-.48c0-2.04-1.32-3.32-3.44-3.32s-3.36 1.16-3.76 3.08l-4.56-.52c.68-3.84 3.92-6.32 8.52-6.32 5.08 0 8.4 3.2 8.4 7.88v8.2c0 .52.16.68.52.68h1.12v4.08h-3.12c-1.96 0-2.84-.64-2.84-2.24 0-.48.08-1.04.28-1.76l-.44-.16c-1.44 3.12-3.56 4.48-6.56 4.48-4.12 0-6.76-2.28-6.76-5.76m8.12 2c2.639 0 4.519-1.92 4.519-4.96v-1.6l-4.36 1.04c-2.2.52-3.12 1.28-3.12 2.96s1.16 2.56 2.96 2.56M110.59 34.69l4.88-.96c.52 2.16 2.24 3.24 4.52 3.24 2.28 0 3.56-.92 3.56-2.48s-1.52-1.88-4.4-2.4c-3.64-.56-8.35-1.24-8.35-6.28 0-3.8 3.24-6.44 8.52-6.44 4.68 0 8.32 1.96 9.15 5.92l-4.92.8c-.44-2-2.08-3.04-4.24-3.04-2.36 0-3.48 1-3.48 2.36 0 1.56 1.56 1.88 4.44 2.4 3.6.56 8.32 1.24 8.32 6.28 0 3.96-3.2 6.6-8.6 6.6-4.88 0-8.52-2-9.4-6M136.94 40.21h-5.2V11.42h5.2v8.96c0 1.04-.2 2.04-.48 3.52l.48.16c1.24-2.96 3.12-4.68 6.6-4.68 4.44 0 6.8 2.8 6.8 7.56v13.27h-5.2V27.1c0-2.32-1.16-3.6-3.48-3.6-2.64 0-4.72 2-4.72 5.52zM161.01 35.05c0 .8.28 1.04.88 1.04h2.28v4.12h-4.72c-2.36 0-3.64-1.32-3.64-3.76V23.98h-2.88v-4.12h8.08zm-5.92-20.63c0-1.76 1.44-3.2 3.16-3.2 1.72 0 3.16 1.44 3.16 3.2 0 1.76-1.4 3.16-3.16 3.16-1.76 0-3.16-1.4-3.16-3.16M165.89 26.22c0-8.4 5.52-14.47 13.51-14.47 6.72 0 11.31 3.88 12.55 9.15l-5.28 1.28c-1-3.68-3.44-5.76-7.28-5.76-4.88 0-7.96 4.04-7.96 9.79 0 5.75 3.2 9.79 8.16 9.79 3.92 0 6.32-2.12 7.32-6.04l5 .56c-1.2 6.28-5.84 10.15-12.39 10.15-8.08 0-13.63-6.08-13.63-14.47zM194.08 30.01c0-6.2 4.36-10.63 10.39-10.63s10.39 4.44 10.39 10.63-4.36 10.67-10.39 10.67-10.39-4.48-10.39-10.67m15.59 0c0-3.84-2.04-6.4-5.2-6.4s-5.2 2.56-5.2 6.4c0 3.84 2.08 6.44 5.2 6.44s5.2-2.56 5.2-6.44M218.149 19.86h4.8v.8c0 1.08-.04 1.96-.36 3.6l.48.12c.76-2.68 2.16-4.52 5.44-4.52h1.48v5.04h-2.12c-2.92 0-4.52 1.76-4.52 5v10.31h-5.2zM232.43 19.86h5.12v.92c0 .92-.08 1.64-.36 3.28l.48.12c1.24-3.24 3.56-4.8 6.56-4.8 4.96 0 8.88 4.08 8.88 10.63 0 6.55-3.92 10.67-8.88 10.67-3 0-5.2-1.56-6.48-4.84l-.44.16c.24 1.6.32 2.36.32 3.24v9.15h-5.2V19.85zm15.51 10.15c0-3.96-2.16-6.4-5.2-6.4s-5.2 2.44-5.2 6.4c0 3.96 2.16 6.44 5.2 6.44s5.2-2.44 5.2-6.44"/></g><g><path d="M20.79.01.07 11.97v28.71l7.78 4.5V16.46l12.94-7.47z"/><path d="M29.06.01v22.87h-8.27v-8.54L13 18.84v29.3l7.79 4.5v-22.8h8.27v8.48l7.79-4.49V4.51z"/><path d="M29.06 52.65 49.78 40.7V11.99L42 7.49V36.2l-12.94 7.47z"/></g></g><defs><clipPath id="clip0_1743_1384"><path fill="#fff" d="M0 0h254v53H0z"/></clipPath></defs></svg></div></a><span class="footer_themeSwitcher__CPJxw hds-font-weight-regular"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-172">Theme</label></span></span><ul class="footer_links__t81SU"><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="/certifications"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Certifications</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://status.hashicorp.com"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">System Status</span></a></li><li><button class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Cookie Manager</span></button></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/terms-of-service"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Terms of Use</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trust/security"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Security</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/privacy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Privacy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trademark-policy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trademark Policy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trade-controls"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trade Controls</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trust/accessibility"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Accessibility</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="opens-in-new-tab-label-react-aria-181" target="_blank" href="https://forms.gle/fnHLuNahLEhjuKvE6"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Give Feedback</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-181">(opens in new tab)</span></li></ul></footer></div></div></div><div class="style_root__owpNH"></div><div style="position:fixed;z-index:99;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none;inset:24px"></div><!--$--><!--/$--></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"metadata":{"title":"Amazon Builder | Integrations"},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://docs.hashicorp.com/sentinel-public/img/og-image.png","icon":[{"href":"/sentinel-public/favicon.svg","sizes":"16x16"},{"href":"/sentinel-public/favicon.svg","sizes":"32x32"},{"href":"/sentinel-public/favicon.svg","sizes":"96x96"},{"href":"/sentinel-public/favicon.svg","sizes":"192x192"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiDays","url":"https://hashicorp.com/conferences/hashidays","text":"One conference. Three cities.","linkText":"Find a city near you","expirationDate":"2024-06-14T00:00:00-08:00"},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."}},"integration":{"id":"0ee4b8e7-8e99-483a-a01e-2dc98b0fdc31","slug":"amazon","name":"Amazon","description":"The Amazon plugin can be used with HashiCorp Packer to create custom images on AWS.","license_type":null,"license_url":null,"external_only":false,"external_url":null,"tier":"official","repo_url":"https://github.com/hashicorp/packer-plugin-amazon","subdirectory":"/.web-docs","created_at":"2023-04-20T18:16:20.002Z","updated_at":"2023-08-08T17:01:02.885Z","hide_versions":false,"organization":{"id":"a4a0551a-1451-4d89-9f56-8031c8350c77","slug":"hashicorp","created_at":"2022-11-09T22:56:32.391Z","updated_at":"2022-11-09T22:56:32.391Z"},"product":{"id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","slug":"packer","name":"Packer","created_at":"2022-11-09T22:56:29.896Z","updated_at":"2022-11-09T22:56:29.896Z"},"versions":["1.3.2","1.3.1","1.3.0","1.2.9","1.2.8","1.2.6","1.0.1","1.0.0"],"components":[{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources"},{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors"},{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources"},{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources"}],"flags":[{"id":"3709e036-b45f-4be8-9043-f7c8cc2af00f","slug":"hcp-ready","name":"HCP Ready","description":"This integration has been tested to work with HashiCorp Cloud Platform (HCP)","created_at":"2022-11-09T22:56:30.673Z","updated_at":"2022-11-09T22:56:30.673Z"}],"integration_type":null},"activeRelease":{"id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","integration_id":"0ee4b8e7-8e99-483a-a01e-2dc98b0fdc31","version":"1.3.2","readme":"The Amazon plugin can be used with HashiCorp Packer to create custom images on AWS. To achieve this, the plugin comes with\nmultiple builders, data sources, and a post-processor to build the AMI depending on the strategy you want to use.\n\n### Installation\n\nTo install this plugin, copy and paste this code into your Packer configuration, then run [`packer init`](https://www.packer.io/docs/commands/init).\n\n```hcl\npacker {\n  required_plugins {\n    amazon = {\n      source  = \"github.com/hashicorp/amazon\"\n      version = \"~\u003e 1\"\n    }\n  }\n}\n```\n\nAlternatively, you can use `packer plugins install` to manage installation of this plugin.\n\n```sh\n$ packer plugins install github.com/hashicorp/amazon\n```\n\n### Components\n\n**Don't know which builder to use?** If in doubt, use the [amazon-ebs builder](/packer/plugins/builders/amazon/ebs).\nIt is much easier to use and Amazon generally recommends EBS-backed images nowadays.\n\n#### Builders\n- [amazon-ebs](/packer/integrations/hashicorp/amazon/latest/components/builder/ebs) - Create EBS-backed AMIs by\n  launching a source AMI and re-packaging it into a new AMI after\n  provisioning. If in doubt, use this builder, which is the easiest to get\n  started with.\n- [amazon-instance](/packer/integrations/hashicorp/amazon/latest/components/builder/instance) - Create\n  instance-store AMIs by launching and provisioning a source instance, then\n  rebundling it and uploading it to S3.\n- [amazon-chroot](/packer/integrations/hashicorp/amazon/latest/components/builder/chroot) - Create EBS-backed AMIs\n  from an existing EC2 instance by mounting the root device and using a\n  [Chroot](https://en.wikipedia.org/wiki/Chroot) environment to provision\n  that device. This is an **advanced builder and should not be used by\n  newcomers**. However, it is also the fastest way to build an EBS-backed AMI\n  since no new EC2 instance needs to be launched.\n- [amazon-ebssurrogate](/packer/integrations/hashicorp/amazon/latest/components/builder/ebssurrogate) - Create EBS\n  -backed AMIs from scratch. Works similarly to the `chroot` builder but does\n  not require running in AWS. This is an **advanced builder and should not be\n  used by newcomers**.\n- [amazon-ebs-volume](/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume) - Create prepopulated\n  EBS volumes by launching an instance and provisioning attached volumes.\n  This is an **advanced builder and should not be used by newcomers**.\n\n#### Data sources\n- [amazon-ami](/packer/integrations/hashicorp/amazon/latest/components/data-source/ami) - Filter and fetch an Amazon AMI to output all the AMI information.\n- [amazon-secretsmanager](/packer/integrations/hashicorp/amazon/latest/components/data-source/secretsmanager) - Retrieve information\n  about a Secrets Manager secret version, including its secret value.\n- [amazon-parameterstore](/packer/integrations/hashicorp/amazon/latest/components/data-source/parameterstore) - Retrieve information about a parameter in SSM.\n\n#### Post-Processors\n- [amazon-import](/packer/integrations/hashicorp/amazon/latest/components/post-processor/import) -  The Amazon Import post-processor takes an OVA artifact \n  from various builders and imports it to an AMI available to Amazon Web Services EC2.\n\n### Authentication\n\nThe AWS provider offers a flexible means of providing credentials for\nauthentication. The following methods are supported, in this order, and\nexplained below:\n\n- Static credentials\n- Environment variables\n- Shared credentials file\n- EC2 Role\n\n#### Static Credentials\n\nStatic credentials can be provided in the form of an access key id and secret.\nThese look like:\n\n```json\n\"builders\": {\n  \"type\": \"amazon-ebs\",\n  \"access_key\": \"AKIAIOSFODNN7EXAMPLE\",\n  \"secret_key\": \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\",\n  \"region\": \"us-east-1\",\n}\n```\n\n```hcl\nsource \"amazon-ebs\" \"basic-example\" {\n  access_key = \"AKIAIOSFODNN7EXAMPLE\"\n  secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n  region     = \"us-east-1\"\n}\n```\n\nIf you would like, you may also assume a role using the assume_role\nconfiguration option. You must still have one of the valid credential resources\nexplained above, and your user must have permission to assume the role in\nquestion. This is a way of running Packer with a more restrictive set of\npermissions than your user.\n\nAssumeRoleConfig lets users set configuration options for assuming a special\nrole when executing Packer.\n\nUsage example:\n\nHCL config example:\n\n```HCL\nsource \"amazon-ebs\" \"example\" {\n\tassume_role {\n\t\trole_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n\t\tsession_name = \"SESSION_NAME\"\n\t\texternal_id  = \"EXTERNAL_ID\"\n\t}\n}\n```\n\nJSON config example:\n\n```json\n\"builders\": [{\n\t\"type\": \"amazon-ebs\",\n\t\"assume_role\": {\n\t\t\"role_arn\"    :  \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\",\n\t\t\"session_name\":  \"SESSION_NAME\",\n\t\t\"external_id\" :  \"EXTERNAL_ID\"\n\t}\n}]\n```\n\n- `role_arn` (string) - Amazon Resource Name (ARN) of the IAM Role to assume.\n\n- `duration_seconds` (int) - Number of seconds to restrict the assume role session duration.\n\n- `external_id` (string) - The external ID to use when assuming the role. If omitted, no external\n  ID is passed to the AssumeRole call.\n\n- `policy` (string) - IAM Policy JSON describing further restricting permissions for the IAM\n  Role being assumed.\n\n- `policy_arns` ([]string) - Set of Amazon Resource Names (ARNs) of IAM Policies describing further\n  restricting permissions for the IAM Role being\n\n- `session_name` (string) - Session name to use when assuming the role.\n\n- `tags` (map[string]string) - Map of assume role session tags.\n\n- `transitive_tag_keys` ([]string) - Set of assume role session tag keys to pass to any subsequent sessions.\n\n#### Environment variables\n\nYou can provide your credentials via the `AWS_ACCESS_KEY_ID` and\n`AWS_SECRET_ACCESS_KEY`, environment variables, representing your AWS Access\nKey and AWS Secret Key, respectively. Note that setting your AWS credentials\nusing either these environment variables will override the use of\n`AWS_SHARED_CREDENTIALS_FILE` and `AWS_PROFILE`. The `AWS_DEFAULT_REGION` and\n`AWS_SESSION_TOKEN` environment variables are also used, if applicable:\n\nUsage:\n\n    $ export AWS_ACCESS_KEY_ID=\"anaccesskey\"\n    $ export AWS_SECRET_ACCESS_KEY=\"asecretkey\"\n    $ export AWS_DEFAULT_REGION=\"us-west-2\"\n    $ packer build template.pkr.hcl\n\n#### Shared Credentials file\n\nYou can use an AWS credentials file to specify your credentials. The default\nlocation is `$HOME/.aws/credentials` on Linux and OS X, or\n`%USERPROFILE%.aws\\credentials` for Windows users. If we fail to detect\ncredentials inline, or in the environment, the Amazon Plugin will check this location. You\ncan optionally specify a different location in the configuration by setting the\nenvironment with the `AWS_SHARED_CREDENTIALS_FILE` variable.\n\nThe format for the credentials file is like so\n\n    [default]\n    aws_access_key_id=\u003cyour access key id\u003e\n    aws_secret_access_key=\u003cyour secret access key\u003e\n\nYou may also configure the profile to use by setting the `profile`\nconfiguration option, or setting the `AWS_PROFILE` environment variable:\n\n```json\n\"builders\": {\n  \"type\": \"amazon-ebs\"\n  \"profile\": \"customprofile\",\n  \"region\": \"us-east-1\",\n}\n```\n\n```hcl\nsource \"amazon-ebs\" \"basic-example\" {\n  profile = \"customprofile\"\n  region = \"us-east-1\"\n}\n```\n\n#### IAM Task or Instance Role\n\nFinally, the plugin will use credentials provided by the task's or instance's IAM\nrole, if it has one.\n\nThis is a preferred approach over any other when running in EC2 as you can\navoid hard coding credentials. Instead these are leased on-the-fly by the plugin,\nwhich reduces the chance of leakage.\n\nThe following policy document provides the minimal set permissions necessary\nfor the Amazon plugin to work:\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AttachVolume\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:CopyImage\",\n        \"ec2:CreateImage\",\n        \"ec2:CreateKeyPair\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:CreateSnapshot\",\n        \"ec2:CreateTags\",\n        \"ec2:CreateVolume\",\n        \"ec2:DeleteKeyPair\",\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:DeleteSnapshot\",\n        \"ec2:DeleteVolume\",\n        \"ec2:DeregisterImage\",\n        \"ec2:DescribeImageAttribute\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:DescribeRegions\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeTags\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DetachVolume\",\n        \"ec2:GetPasswordData\",\n        \"ec2:ModifyImageAttribute\",\n        \"ec2:ModifyInstanceAttribute\",\n        \"ec2:ModifySnapshotAttribute\",\n        \"ec2:RegisterImage\",\n        \"ec2:RunInstances\",\n        \"ec2:StopInstances\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\nNote that if you'd like to create a spot instance, you must also add:\n\n    ec2:CreateLaunchTemplate,\n    ec2:DeleteLaunchTemplate,\n    ec2:CreateFleet\n\nIf you have the `spot_price` parameter set to `auto`, you must also add:\n\n    ec2:DescribeSpotPriceHistory\n\nIf you are using the `vpc_filter` option, you must also add:\n\n    ec2:DescribeVpcs\n\nThis permission may also be needed by the `associate_public_ip_address` option, if specified without a subnet.\nIn this case the plugin will invoke `DescribeVpcs` to find information about the default VPC.\n\nWhen using `associate_public_ip_address` without a subnet, you will also benefit from having:\n\n    ec2:DescribeInstanceTypeOfferings\n\nThis will ensure that the plugin will pick a subnet/AZ that can host the type of instance\nyou're requesting in your template.\n\nIf you are using the `deprecate_at` attribute in your templates, you will also need:\n\n    ec2:EnableImageDeprecation\n\nIf you are using SSM to connect to the instance, and are specifying a private key file, you must also add:\n\n    ec2-instance-connect:SendSSHPublicKey\n\nIf you are building a Windows AMI, and want to enable fast-launch, you will also need:\n\n    ec2:EnableFastLaunch\n    ec2:DescribeLaunchTemplates\n    ec2:DescribeFastLaunchImages\n\n### Troubleshooting\n\n#### Attaching IAM Policies to Roles\n\nIAM policies can be associated with users or roles. If you use the plugin with IAM\nroles, you may encounter an error like this one:\n\n    ==\u003e amazon-ebs: Error launching source instance: You are not authorized to perform this operation.\n\nYou can read more about why this happens on the [Amazon Security\nBlog](https://blogs.aws.amazon.com/security/post/Tx3M0IFB5XBOCQX/Granting-Permission-to-Launch-EC2-Instances-with-IAM-Roles-PassRole-Permission).\nThe example policy below may help the plugin work with IAM roles. Note that this\nexample provides more than the minimal set of permissions needed for the Amazon plugin to\nwork, but specifics will depend on your use-case.\n\n```json\n{\n  \"Sid\": \"PackerIAMPassRole\",\n  \"Effect\": \"Allow\",\n  \"Action\": [\"iam:PassRole\", \"iam:GetInstanceProfile\"],\n  \"Resource\": [\"*\"]\n}\n```\n\nIf using an existing instance profile with spot instances/spot pricing, the `iam:CreateServiceLinkedRole` action is also required:\n\n```json\n{\n  \"Sid\": \"PackerIAMPassRole\",\n  \"Effect\": \"Allow\",\n  \"Action\": [\"iam:PassRole\", \"iam:GetInstanceProfile\", \"iam:CreateServiceLinkedRole\"],\n  \"Resource\": [\"*\"]\n}\n```\n\nIn case when you're creating a temporary instance profile you will require to have following\nIAM policies.\n\n```json\n{\n  \"Sid\": \"PackerIAMCreateRole\",\n  \"Effect\": \"Allow\",\n  \"Action\": [\n    \"iam:PassRole\",\n    \"iam:CreateInstanceProfile\",\n    \"iam:DeleteInstanceProfile\",\n    \"iam:GetRole\",\n    \"iam:GetInstanceProfile\",\n    \"iam:DeleteRolePolicy\",\n    \"iam:RemoveRoleFromInstanceProfile\",\n    \"iam:CreateRole\",\n    \"iam:DeleteRole\",\n    \"iam:PutRolePolicy\",\n    \"iam:AddRoleToInstanceProfile\"\n  ],\n  \"Resource\": \"*\"\n}\n```\n\nIn cases where you are using a KMS key for encryption, your key will need the\nfollowing policies at a minimum:\n\n```json\n{\n  \"Sid\": \"Allow use of the key\",\n  \"Effect\": \"Allow\",\n  \"Action\": [\"kms:ReEncrypt*\", \"kms:GenerateDataKey*\"],\n  \"Resource\": \"*\"\n}\n```\n\nIf you are using a key provided by a different account than the one you are\nusing to run the Packer build, your key will also need\n\n```json\n(\"kms:CreateGrant\", \"kms:DescribeKey\")\n```\n\n#### Check System Time\n\nAmazon uses the current time as part of the [request signing process](http://docs.aws.amazon.com/general/latest/gr/sigv4_signing.html). If\nyour system clock is too skewed from the current time, your requests might\nfail. If that's the case, you might see an error like this:\n\n    ==\u003e amazon-ebs: Error querying AMI: AuthFailure: AWS was not able to validate the provided access credentials\n\nIf you suspect your system's date is wrong, you can compare it against\n`http://www.time.gov/`. On Linux/OS X, you can run the `date` command to get the current time. If you're\non Linux, you can try setting the time with ntp by running `sudo ntpd -q`.\n\n#### ResourceNotReady Error\n\nThis error generally appears as either `ResourceNotReady: exceeded wait attempts` or `ResourceNotReady: failed waiting for successful resource state`.\n\nThis opaque error gets returned from AWS's API for a number of reasons,\ngenerally during image copy/encryption. Possible reasons for the error include:\n\n- You aren't waiting long enough. This is where you'll see the `exceeded wait attempts` variety of this error message:\n  We use the AWS SDK's built-in waiters to wait for longer-running tasks to\n  complete. These waiters have default delays between queries and maximum\n  number of queries that don't always work for our users.\n\n  If you find that you are being rate-limited or have exceeded your max wait\n  attempts, you can override the defaults by setting the following packer\n  environment variables (note that these will apply to all AWS tasks that we\n  have to wait for):\n\n  - `AWS_MAX_ATTEMPTS` - This is how many times to re-send a status update\n    request. Excepting tasks that we know can take an extremely long time, this\n    defaults to 40 tries.\n\n  - `AWS_POLL_DELAY_SECONDS` - How many seconds to wait in between status update\n    requests. Generally defaults to 2 or 5 seconds, depending on the task.\n\n  Alternatively, you can configure these settings in source section of the packer\n  configuration file, for example:\n  ```\n  aws_polling {\n    delay_seconds = 40\n    max_attempts  = 5\n  }\n  ```\n\n- You are using short-lived credentials that expired during the build. If this\n  is the problem, you may also see `RequestExpired: Request has expired.`\n  errors displayed in the Packer output:\n\n  - If you are using STS credentials, make sure that they expire only after the\n    build has completed\n\n  - If you are chaining roles, make sure your build doesn't last more than an\n    hour, since when you chain roles the maximum length of time your credentials\n    will last is an hour:\n    https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use.html\n\n- Something is wrong with your KMS key. This is where you'll see the\n  `ResourceNotReady: failed waiting for successful resource state` variety of\n  this error message. Issues we've seen include:\n  - Your KMS key is invalid, possibly because of a typo\n  - Your KMS key is valid but does not have the necessary permissions (see\n    above for the necessary key permissions)\n  - Your KMS key is valid, but not in the region you've told us to use it in.\n","created_at":"2024-04-17T16:47:52.455Z","updated_at":"2024-04-17T16:47:52.455Z","components":[{"id":"e5751035-4875-4eec-af18-bb693f9dd753","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","readme":"The Parameter Store data source provides information about a parameter in SSM.\n\n-\u003e **Note:** Data sources is a feature exclusively available to HCL2 templates.\n\nBasic examples of usage:\n\n```hcl\ndata \"amazon-parameterstore\" \"basic-example\" {\n  name = \"packer_test_parameter\"\n  with_decryption = false\n}\n\n# usage example of the data source output\nlocals {\n  value   = data.amazon-parameterstore.basic-example.value\n  version = data.amazon-parameterstore.basic-example.version\n  arn     = data.amazon-parameterstore.basic-example.arn\n}\n```\n\n## Configuration Reference\n\n### Required\n\n\u003c!-- Code generated from the comments of the Config struct in datasource/parameterstore/data.go; DO NOT EDIT MANUALLY --\u003e\n\n- `name` (string) - The name of the parameter you want to query.\n\n\u003c!-- End of code generated from the comments of the Config struct in datasource/parameterstore/data.go; --\u003e\n\n\n### Optional\n\n\u003c!-- Code generated from the comments of the Config struct in datasource/parameterstore/data.go; DO NOT EDIT MANUALLY --\u003e\n\n- `with_decryption` (bool) - Return decrypted values for secure string parameters.\n  This flag is ignored for String and StringList parameter types.\n\n\u003c!-- End of code generated from the comments of the Config struct in datasource/parameterstore/data.go; --\u003e\n\n\n## Output Data\n\n\u003c!-- Code generated from the comments of the DatasourceOutput struct in datasource/parameterstore/data.go; DO NOT EDIT MANUALLY --\u003e\n\n- `value` (string) - The parameter value.\n\n- `version` (string) - The parameter version.\n\n- `arn` (string) - The Amazon Resource Name (ARN) of the parameter.\n\n\u003c!-- End of code generated from the comments of the DatasourceOutput struct in datasource/parameterstore/data.go; --\u003e\n\n\n## Authentication\n\nThe Amazon Data Sources authentication works just like for the [Amazon Builders](/packer/plugins/builders). Both\nhave the same authentication options, and you can refer to the [Amazon Builders authentication](/packer/integrations/hashicorp/index.mdx#authentication)\nto learn the options to authenticate for data sources.\n\n-\u003e **Note:** A data source will start and execute in your own authentication session. The authentication in the data source\ndoesn't relate with the authentication on Amazon Builders.\n\nBasic example of an Amazon data source authentication using `assume_role`:\n\n```hcl\ndata \"amazon-parameterstore\" \"basic-example\" {\n  name = \"packer_test_parameter\"\n  with_decryption = false\n\n  assume_role {\n      role_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n      session_name = \"SESSION_NAME\"\n      external_id  = \"EXTERNAL_ID\"\n  }\n}\n```\n","created_at":"2024-04-17T16:47:53.688Z","updated_at":"2024-04-17T16:47:53.688Z","name":"Parameter Store","slug":"parameterstore","component":{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.255Z","updated_at":"2022-11-09T22:56:31.255Z"},"variable_groups":[]},{"id":"91f22909-f33c-4d87-b72c-3dd9971c22c0","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","readme":"The Secrets Manager data source provides information about a Secrets Manager secret version,\nincluding its secret value.\n\n-\u003e **Note:** Data sources is a feature exclusively available to HCL2 templates.\n\nBasic examples of usage:\n\n```hcl\ndata \"amazon-secretsmanager\" \"basic-example\" {\n  name = \"packer_test_secret\"\n  key  = \"packer_test_key\"\n  version_stage = \"example\"\n}\n\n# usage example of the data source output\nlocals {\n  value         = data.amazon-secretsmanager.basic-example.value\n  secret_string = data.amazon-secretsmanager.basic-example.secret_string\n  version_id    = data.amazon-secretsmanager.basic-example.version_id\n  secret_value  = jsondecode(data.amazon-secretsmanager.basic-example.secret_string)[\"packer_test_key\"]\n}\n```\n\nReading key-value pairs from JSON back into a native Packer map can be accomplished\nwith the [jsondecode() function](/packer/docs/templates/hcl_templates/functions/encoding/jsondecode).\n\n## Configuration Reference\n\n### Required\n\n\u003c!-- Code generated from the comments of the Config struct in datasource/secretsmanager/data.go; DO NOT EDIT MANUALLY --\u003e\n\n- `name` (string) - Specifies the secret containing the version that you want to retrieve.\n  You can specify either the Amazon Resource Name (ARN) or the friendly name of the secret.\n\n\u003c!-- End of code generated from the comments of the Config struct in datasource/secretsmanager/data.go; --\u003e\n\n\n### Optional\n\n\u003c!-- Code generated from the comments of the Config struct in datasource/secretsmanager/data.go; DO NOT EDIT MANUALLY --\u003e\n\n- `key` (string) - Optional key for JSON secrets that contain more than one value. When set, the `value` output will\n  contain the value for the provided key.\n\n- `version_id` (string) - Specifies the unique identifier of the version of the secret that you want to retrieve.\n  Overrides version_stage.\n\n- `version_stage` (string) - Specifies the secret version that you want to retrieve by the staging label attached to the version.\n  Defaults to AWSCURRENT.\n\n\u003c!-- End of code generated from the comments of the Config struct in datasource/secretsmanager/data.go; --\u003e\n\n\n## Output Data\n\n\u003c!-- Code generated from the comments of the DatasourceOutput struct in datasource/secretsmanager/data.go; DO NOT EDIT MANUALLY --\u003e\n\n- `value` (string) - When a [key](#key) is provided, this will be the value for that key. If a key is not provided,\n  `value` will contain the first value found in the secret string.\n\n- `secret_string` (string) - The decrypted part of the protected secret information that\n  was originally provided as a string.\n\n- `secret_binary` (string) - The decrypted part of the protected secret information that\n  was originally provided as a binary. Base64 encoded.\n\n- `version_id` (string) - The unique identifier of this version of the secret.\n\n\u003c!-- End of code generated from the comments of the DatasourceOutput struct in datasource/secretsmanager/data.go; --\u003e\n\n\n## Authentication\n\nThe Amazon Data Sources authentication works just like for the [Amazon Builders](/packer/integrations/hashicorp/amazon). Both\nhave the same authentication options, and you can refer to the [Amazon Builders authentication](/packer/integrations/hashicorp/amazon#authentication)\nto learn the options to authenticate for data sources.\n\n-\u003e **Note:** A data source will start and execute in your own authentication session. The authentication in the data source\ndoesn't relate with the authentication on Amazon Builders.\n\nBasic example of an Amazon data source authentication using `assume_role`:\n\n```hcl\ndata \"amazon-secretsmanager\" \"basic-example\" {\n  name = \"packer_test_secret\"\n  key  = \"packer_test_key\"\n\n  assume_role {\n      role_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n      session_name = \"SESSION_NAME\"\n      external_id  = \"EXTERNAL_ID\"\n  }\n}\n```\n","created_at":"2024-04-17T16:47:54.091Z","updated_at":"2024-04-17T16:47:54.091Z","name":"Secrets Manager","slug":"secretsmanager","component":{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.255Z","updated_at":"2022-11-09T22:56:31.255Z"},"variable_groups":[]},{"id":"b9597f5c-f9a3-4848-9a3e-e5bae0c489d2","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","readme":"Type: `amazon-ami`\n\nThe Amazon AMI data source will filter and fetch an Amazon AMI, and output all the AMI information that will\nbe then available to use in the [Amazon builders](/packer/integrations/hashicorp/amazon).\n\n-\u003e **Note:** Data sources is a feature exclusively available to HCL2 templates.\n\nBasic example of usage:\n\n```hcl\ndata \"amazon-ami\" \"basic-example\" {\n    filters = {\n        virtualization-type = \"hvm\"\n        name = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n        root-device-type = \"ebs\"\n    }\n    owners = [\"099720109477\"]\n    most_recent = true\n}\n```\nThis selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. Note that the data source will fail unless\n*exactly* one AMI is returned. In the above example, `most_recent` will cause this to succeed by selecting the newest image.\n\n## Configuration Reference\n\n\u003c!-- Code generated from the comments of the AmiFilterOptions struct in builder/common/ami_filter.go; DO NOT EDIT MANUALLY --\u003e\n\n- `filters` (map[string]string) - Filters used to select an AMI. Any filter described in the docs for\n  [DescribeImages](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html)\n  is valid.\n\n- `owners` ([]string) - Filters the images by their owner. You\n  may specify one or more AWS account IDs, \"self\" (which will use the\n  account whose credentials you are using to run Packer), or an AWS owner\n  alias: for example, `amazon`, `aws-marketplace`, or `microsoft`. This\n  option is required for security reasons.\n\n- `most_recent` (bool) - Selects the newest created image when true.\n  This is most useful for selecting a daily distro build.\n\n- `include_deprecated` (bool) - Include deprecated AMIs in the filtered response. Defaults to false.\n  If you are the AMI owner, deprecated AMIs appear in the response\n  regardless of what is specified for `include_deprecated`.\n\n\u003c!-- End of code generated from the comments of the AmiFilterOptions struct in builder/common/ami_filter.go; --\u003e\n\n\n## Output Data\n\n\u003c!-- Code generated from the comments of the DatasourceOutput struct in datasource/ami/data.go; DO NOT EDIT MANUALLY --\u003e\n\n- `id` (string) - The ID of the AMI.\n\n- `name` (string) - The name of the AMI.\n\n- `creation_date` (string) - The date of creation of the AMI.\n\n- `owner` (string) - The AWS account ID of the owner.\n\n- `owner_name` (string) - The owner alias.\n\n- `tags` (map[string]string) - The key/value combination of the tags assigned to the AMI.\n\n\u003c!-- End of code generated from the comments of the DatasourceOutput struct in datasource/ami/data.go; --\u003e\n\n\n## Authentication\n\nThe authentication for Amazon Data Sources uses the same configuration options as [Amazon Builders](/packer/integrations/hashicorp/amazon). To learn more about all of the available authentication options please see [Amazon Builders authentication](/packer/integrations/hashicorp/amazon#authentication).\n\n-\u003e **Note:** The authentication session started by a data source is separate from any authentication sessions started by an Amazon builder. Users are encouraged to use `variables` for defining and sharing configuration values between datasources and builders.\n\nBasic example of an Amazon data source authentication using `assume_role`:\n\n```hcl\ndata \"amazon-secretsmanager\" \"basic-example\" {\n  name = \"packer_test_secret\"\n  key  = \"packer_test_key\"\n\n  assume_role {\n      role_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n      session_name = \"SESSION_NAME\"\n      external_id  = \"EXTERNAL_ID\"\n  }\n}\n```\n","created_at":"2024-04-17T16:47:54.420Z","updated_at":"2024-04-17T16:47:54.420Z","name":"Amazon AMI","slug":"ami","component":{"id":"4d1ac7a7-f708-453c-9663-16fa8b3e2e11","slug":"data-source","name":"Data Source","plural_name":"Data Sources","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.255Z","updated_at":"2022-11-09T22:56:31.255Z"},"variable_groups":[]},{"id":"9f195981-08af-4b1a-9932-95055eda4aa1","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `amazon-chroot`\nArtifact BuilderId: `mitchellh.amazon.chroot`\n\nThe `amazon-chroot` Packer builder is able to create Amazon AMIs backed by an\nEBS volume as the root device. For more information on the difference between\ninstance storage and EBS-backed instances, see the [\"storage for the root\ndevice\" section in the EC2\ndocumentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ComponentsAMIs.html#storage-for-the-root-device).\n\nThe difference between this builder and the `amazon-ebs` builder is that this\nbuilder is able to build an EBS-backed AMI without launching a new EC2\ninstance. This can dramatically speed up AMI builds for organizations who need\nthe extra fast build.\n\n~\u003e **This is an advanced builder** If you're just getting started with\nPacker, we recommend starting with the [amazon-ebs\nbuilder](/packer/integrations/hashicorp/amazon/latest/components/builder/ebs), which is much easier to use.\n\nThe builder does _not_ manage AMIs. Once it creates an AMI and stores it in\nyour account, it is up to you to use, delete, etc., the AMI.\n\n## How Does it Work?\n\nThis builder works by creating a new EBS volume from an existing source AMI and\nattaching it into an already-running EC2 instance. Once attached, a\n[chroot](https://en.wikipedia.org/wiki/Chroot) is used to provision the system\nwithin that volume. After provisioning, the volume is detached, snapshotted,\nand an AMI is made.\n\nUsing this process, minutes can be shaved off the AMI creation process because\na new EC2 instance doesn't need to be launched.\n\nThere are some restrictions, however. The host EC2 instance where the volume is\nattached to must be a similar system (generally the same OS version, kernel\nversions, etc.) as the AMI being built. Additionally, this process is much more\nexpensive because the EC2 instance must be kept running persistently in order\nto build AMIs, whereas the other AMI builders start instances on-demand to\nbuild AMIs as needed.\n\n## Chroot Specific Configuration Reference\n\nThere are many configuration options available for the builder. In addition to\nthe items listed here, you will want to look at the general configuration\nreferences for [AMI](#ami-configuration),\n[BlockDevices](#block-devices-configuration) and\n[Access](#access-config-configuration) configuration references, which are\nnecessary for this build to succeed and can be found further down the page.\n\n### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/chroot/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `source_ami` (string) - The source AMI whose root volume will be copied and provisioned on the\n  currently running instance. This must be an EBS-backed AMI with a root\n  volume snapshot that you have access to. Note: this is not used when\n  from_scratch is set to true.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/chroot/builder.go; --\u003e\n\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/chroot/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_block_device_mappings` (awscommon.BlockDevices) - Add one or more [block device\n  mappings](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html)\n  to the AMI. If this field is populated, and you are building from an\n  existing source image, the block device mappings in the source image\n  will be overwritten. This means you must have a block device mapping\n  entry for your root volume, `root_volume_size` and `root_device_name`.\n  See the [BlockDevices](#block-devices-configuration) documentation for\n  fields.\n\n- `chroot_mounts` ([][]string) - This is a list of devices to mount into the chroot environment. This\n  configuration parameter requires some additional documentation which is\n  in the Chroot Mounts section. Please read that section for more\n  information on how to use this.\n\n- `command_wrapper` (string) - How to run shell commands. This defaults to `{{.Command}}`. This may be\n  useful to set if you want to set environmental variables or perhaps run\n  it with sudo or so on. This is a configuration template where the\n  .Command variable is replaced with the command to be run. Defaults to\n  `{{.Command}}`.\n\n- `copy_files` ([]string) - Paths to files on the running EC2 instance that will be copied into the\n  chroot environment prior to provisioning. Defaults to /etc/resolv.conf\n  so that DNS lookups work. Pass an empty list to skip copying\n  /etc/resolv.conf. You may need to do this if you're building an image\n  that uses systemd.\n\n- `device_path` (string) - The path to the device where the root volume of the source AMI will be\n  attached. This defaults to \"\" (empty string), which forces Packer to\n  find an open device automatically.\n\n- `nvme_device_path` (string) - When we call the mount command (by default mount -o device dir), the\n  string provided in nvme_mount_path will replace device in that command.\n  When this option is not set, device in that command will be something\n  like /dev/sdf1, mirroring the attached device name. This assumption\n  works for most instances but will fail with c5 and m5 instances. In\n  order to use the chroot builder with c5 and m5 instances, you must\n  manually set nvme_device_path and device_path.\n\n- `from_scratch` (bool) - Build a new volume instead of starting from an existing AMI root volume\n  snapshot. Default false. If true, source_ami/source_ami_filter are no\n  longer used and the following options become required:\n  ami_virtualization_type, pre_mount_commands and root_volume_size.\n\n- `mount_options` ([]string) - Options to supply the mount command when mounting devices. Each option\n  will be prefixed with -o and supplied to the mount command ran by\n  Packer. Because this command is ran in a shell, user discretion is\n  advised. See this manual page for the mount command for valid file\n  system specific options.\n\n- `mount_partition` (string) - The partition number containing the / partition. By default this is the\n  first partition of the volume, (for example, xvda1) but you can\n  designate the entire block device by setting \"mount_partition\": \"0\" in\n  your config, which will mount xvda instead.\n\n- `mount_path` (string) - The path where the volume will be mounted. This is where the chroot\n  environment will be. This defaults to\n  `/mnt/packer-amazon-chroot-volumes/{{.Device}}`. This is a configuration\n  template where the .Device variable is replaced with the name of the\n  device where the volume is attached.\n\n- `post_mount_commands` ([]string) - As pre_mount_commands, but the commands are executed after mounting the\n  root device and before the extra mount and copy steps. The device and\n  mount path are provided by `{{.Device}}` and `{{.MountPath}}`.\n\n- `pre_mount_commands` ([]string) - A series of commands to execute after attaching the root volume and\n  before mounting the chroot. This is not required unless using\n  from_scratch. If so, this should include any partitioning and filesystem\n  creation commands. The path to the device is provided by `{{.Device}}`.\n\n- `root_device_name` (string) - The root device name. For example, xvda.\n\n- `root_volume_size` (int64) - The size of the root volume in GB for the chroot environment and the\n  resulting AMI. Default size is the snapshot size of the source_ami\n  unless from_scratch is true, in which case this field must be defined.\n\n- `root_volume_type` (string) - The type of EBS volume for the chroot environment and resulting AMI. The\n  default value is the type of the source_ami, unless from_scratch is\n  true, in which case the default value is gp2. You can only specify io1\n  if building based on top of a source_ami which is also io1.\n\n- `source_ami_filter` (awscommon.AmiFilterOptions) - Filters used to populate the source_ami field. Example:\n  \n  ```json\n  {\n  \t \"source_ami_filter\": {\n  \t \"filters\": {\n  \t  \"virtualization-type\": \"hvm\",\n  \t  \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n  \t  \"root-device-type\": \"ebs\"\n  \t},\n  \t\"owners\": [\"099720109477\"],\n  \t\"most_recent\": true\n  \t }\n  }\n  ```\n  \n  This selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. NOTE:\n  This will fail unless *exactly* one AMI is returned. In the above example,\n  `most_recent` will cause this to succeed by selecting the newest image.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) -\n   filters used to select a `source_ami`.\n  \tNOTE: This will fail unless *exactly* one AMI is returned. Any filter\n  \tdescribed in the docs for\n  \t[DescribeImages](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html)\n  \tis valid.\n  \n  -   `owners` (array of strings) - Filters the images by their owner. You\n  \tmay specify one or more AWS account IDs, \"self\" (which will use the\n  \taccount whose credentials you are using to run Packer), or an AWS owner\n  \talias: for example, \"amazon\", \"aws-marketplace\", or \"microsoft\". This\n  \toption is required for security reasons.\n  \n  -   `most_recent` (boolean) - Selects the newest created image when true.\n  \tThis is most useful for selecting a daily distro build.\n  \n  You may set this in place of `source_ami` or in conjunction with it. If you\n  set this in conjunction with `source_ami`, the `source_ami` will be added\n  to the filter. The provided `source_ami` must meet all of the filtering\n  criteria provided in `source_ami_filter`; this pins the AMI returned by the\n  filter, but will cause Packer to fail if the `source_ami` does not exist.\n\n- `root_volume_tags` (map[string]string) - Key/value pair tags to apply to the volumes that are *launched*. This is\n  a [template engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `root_volume_tag` ([]{key string, value string}) - Same as [`root_volume_tags`](#root_volume_tags) but defined as a\n  singular block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `root_volume_encrypt_boot` (boolean) - Whether or not to encrypt the volumes that are *launched*. By default, Packer will keep\n  the encryption setting to what it was in the source image when set to `false`. Setting true will\n  always result in an encrypted one.\n\n- `root_volume_kms_key_id` (string) - ID, alias or ARN of the KMS key to use for *launched* volumes encryption.\n  \n  Set this value if you select `root_volume_encrypt_boot`, but don't want to use the\n  region's default KMS key.\n  \n  If you have a custom kms key you'd like to apply to the launch volume,\n  and are only building in one region, it is more efficient to set this\n  and `root_volume_encrypt_boot` to `true` and not use `encrypt_boot` and `kms_key_id`. This saves\n  potentially many minutes at the end of the build by preventing Packer\n  from having to copy and re-encrypt the image at the end of the build.\n  \n  For valid formats see *KmsKeyId* in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html).\n  This field is validated by Packer, when using an alias, you will have to\n  prefix `kms_key_id` with `alias/`.\n\n- `ami_architecture` (string) - what architecture to use when registering the final AMI; valid options\n  are \"arm64\", \"i386\", \"x86_64\", or \"x86_64_mac\". Defaults to \"x86_64\".\n\n- `boot_mode` (string) - The boot mode. Valid options are `legacy-bios` and `uefi`. See the documentation on\n  [boot modes](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ami-boot.html) for\n  more information. Defaults to `legacy-bios` when `ami_architecture` is `x86_64` and\n  `uefi` when `ami_architecture` is `arm64`.\n\n- `uefi_data` (string) - Base64 representation of the non-volatile UEFI variable store. For more information\n  see [AWS documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/uefi-secure-boot-optionB.html).\n\n- `tpm_support` (string) - NitroTPM Support. Valid options are `v2.0`. See the documentation on\n  [NitroTPM Support](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enable-nitrotpm-support-on-ami.html) for\n  more information. Only enabled if a valid option is provided, otherwise ignored.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/chroot/builder.go; --\u003e\n\n\n## General Common Configuration Reference\n\nFollowing will be a set of fields that are also settable for other aws\nbuilders.\n\n### AMI Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_name` (string) - The name of the resulting AMI that will appear when managing AMIs in the\n  AWS console or via APIs. This must be unique. To help make this unique,\n  use a function like timestamp (see [template\n  engine](/packer/docs/templates/legacy_json_templates/engine) for more info).\n\n\u003c!-- End of code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_description` (string) - The description to set for the resulting\n  AMI(s). By default this description is empty.  This is a\n  [template engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `ami_virtualization_type` (string) - The type of virtualization for the AMI\n  you are building. This option is required to register HVM images. Can be\n  paravirtual (default) or hvm.\n\n- `ami_users` ([]string) - A list of account IDs that have access to\n  launch the resulting AMI(s). By default no additional users other than the\n  user creating the AMI has permissions to launch it.\n\n- `ami_groups` ([]string) - A list of groups that have access to\n  launch the resulting AMI(s). By default no groups have permission to launch\n  the AMI. `all` will make the AMI publicly accessible.\n  AWS currently doesn't accept any value other than \"all\"\n\n- `ami_org_arns` ([]string) - A list of Amazon Resource Names (ARN) of AWS Organizations that have access to\n  launch the resulting AMI(s). By default no organizations have permission to launch\n  the AMI.\n\n- `ami_ou_arns` ([]string) - A list of Amazon Resource Names (ARN) of AWS Organizations organizational units (OU) that have access to\n  launch the resulting AMI(s). By default no organizational units have permission to launch\n  the AMI.\n\n- `ami_product_codes` ([]string) - A list of product codes to\n  associate with the AMI. By default no product codes are associated with the\n  AMI.\n\n- `ami_regions` ([]string) - A list of regions to copy the AMI to.\n  Tags and attributes are copied along with the AMI. AMI copying takes time\n  depending on the size of the AMI, but will generally take many minutes.\n\n- `skip_region_validation` (bool) - Set to true if you want to skip\n  validation of the ami_regions configuration option. Default false.\n\n- `tags` (map[string]string) - Key/value pair tags applied to the AMI. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n  \n  The builder no longer adds a \"Name\": \"Packer Builder\" entry to the tags.\n\n- `tag` ([]{key string, value string}) - Same as [`tags`](#tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `ena_support` (boolean) - Enable enhanced networking (ENA but not SriovNetSupport) on\n  HVM-compatible AMIs. If set, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy.\n  \n  Note: you must make sure enhanced networking is enabled on your\n  instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n\n- `sriov_support` (bool) - Enable enhanced networking (SriovNetSupport but not ENA) on\n  HVM-compatible AMIs. If true, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy. Note: you must make sure enhanced networking is enabled\n  on your instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n  Default `false`.\n\n- `force_deregister` (bool) - Force Packer to first deregister an existing\n  AMI if one with the same name already exists. Default false.\n\n- `force_delete_snapshot` (bool) - Force Packer to delete snapshots\n  associated with AMIs, which have been deregistered by force_deregister.\n  Default false.\n\n- `encrypt_boot` (boolean) - Whether or not to encrypt the resulting AMI when\n  copying a provisioned instance to an AMI. By default, Packer will keep\n  the encryption setting to what it was in the source image. Setting false\n  will result in an unencrypted image, and true will result in an encrypted\n  one.\n  \n  If you have used the `launch_block_device_mappings` to set an encryption\n  key and that key is the same as the one you want the image encrypted with\n  at the end, then you don't need to set this field; leaving it empty will\n  prevent an unnecessary extra copy step and save you some time.\n  \n  Please note that if you are using an account with the global \"Always\n  encrypt new EBS volumes\" option set to `true`, Packer will be unable to\n  override this setting, and the final image will be encrypted whether\n  you set this value or not.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for AMI encryption. This\n  only applies to the main `region` -- any regions the AMI gets copied to\n  will be encrypted by the default EBS KMS key for that region,\n  unless you set region-specific keys in `region_kms_key_ids`.\n  \n  Set this value if you select `encrypt_boot`, but don't want to use the\n  region's default KMS key.\n  \n  If you have a custom kms key you'd like to apply to the launch volume,\n  and are only building in one region, it is more efficient to leave this\n  and `encrypt_boot` empty and to instead set the key id in the\n  launch_block_device_mappings (you can find an example below). This saves\n  potentially many minutes at the end of the build by preventing Packer\n  from having to copy and re-encrypt the image at the end of the build.\n  \n  For valid formats see *KmsKeyId* in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html).\n  This field is validated by Packer, when using an alias, you will have to\n  prefix `kms_key_id` with `alias/`.\n\n- `region_kms_key_ids` (map[string]string) - regions to copy the ami to, along with the custom kms key id (alias or\n  arn) to use for encryption for that region. Keys must match the regions\n  provided in `ami_regions`. If you just want to encrypt using a default\n  ID, you can stick with `kms_key_id` and `ami_regions`. If you want a\n  region to be encrypted with that region's default key ID, you can use an\n  empty string `\"\"` instead of a key id in this map. (e.g. `\"us-east-1\":\n  \"\"`) However, you cannot use default key IDs if you are using this in\n  conjunction with `snapshot_users` -- in that situation you must use\n  custom keys. For valid formats see *KmsKeyId* in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html).\n  \n  This option supercedes the `kms_key_id` option -- if you set both, and\n  they are different, Packer will respect the value in\n  `region_kms_key_ids` for your build region and silently disregard the\n  value provided in `kms_key_id`.\n\n- `skip_save_build_region` (bool) - If true, Packer will not check whether an AMI with the `ami_name` exists\n  in the region it is building in. It will use an intermediary AMI name,\n  which it will not convert to an AMI in the build region. It will copy\n  the intermediary AMI into any regions provided in `ami_regions`, then\n  delete the intermediary AMI. Default `false`.\n\n- `imds_support` (string) - Enforce version of the Instance Metadata Service on the built AMI.\n  Valid options are unset (legacy) and `v2.0`. See the documentation on\n  [IMDS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html)\n  for more information. Defaults to legacy.\n\n\u003c!-- End of code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `snapshot_tags` (map[string]string) - Key/value pair tags to apply to snapshot. They will override AMI tags if\n  already applied to snapshot. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `snapshot_tag` ([]{key string, value string}) - Same as [`snapshot_tags`](#snapshot_tags) but defined as a singular\n  repeatable block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `snapshot_users` ([]string) - A list of account IDs that have\n  access to create volumes from the snapshot(s). By default no additional\n  users other than the user creating the AMI has permissions to create\n  volumes from the backing snapshot(s).\n\n- `snapshot_groups` ([]string) - A list of groups that have access to\n  create volumes from the snapshot(s). By default no groups have permission\n  to create volumes from the snapshot(s). all will make the snapshot\n  publicly accessible.\n\n\u003c!-- End of code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; --\u003e\n\n\n### Block Devices Configuration\n\nBlock devices can be nested in the\n[ami_block_device_mappings](#ami_block_device_mappings) array.\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\nThese will be attached when launching your instance. Your\noptions here may vary depending on the type of VM you use.\n\nExample use case:\n\nThe following mapping will tell Packer to encrypt the root volume of the\nbuild instance at launch using a specific non-default kms key:\n\nHCL2 example:\n\n```hcl\n\n\tlaunch_block_device_mappings {\n\t    device_name = \"/dev/sda1\"\n\t    encrypted = true\n\t    kms_key_id = \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n```\n\nJSON example:\n```json\n\"launch_block_device_mappings\": [\n\n\t{\n\t   \"device_name\": \"/dev/sda1\",\n\t   \"encrypted\": true,\n\t   \"kms_key_id\": \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n]\n```\n\nPlease note that the kms_key_id option in this example exists for\nlaunch_block_device_mappings but not ami_block_device_mappings.\n\nDocumentation for Block Devices Mappings can be found here:\nhttps://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `delete_on_termination` (bool) - Indicates whether the EBS volume is deleted on instance termination.\n  Default false. NOTE: If this value is not explicitly set to true and\n  volumes are not cleaned up by an alternative method, additional volumes\n  will accumulate after every build.\n\n- `device_name` (string) - The device name exposed to the instance (for example, /dev/sdh or xvdh).\n  Required for every device in the block device mapping.\n\n- `encrypted` (boolean) - Indicates whether or not to encrypt the volume. By default, Packer will\n  keep the encryption setting to what it was in the source image. Setting\n  false will result in an unencrypted device, and true will result in an\n  encrypted one.\n\n- `iops` (\\*int64) - The number of I/O operations per second (IOPS) that the volume supports.\n  See the documentation on\n  [IOPs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `no_device` (bool) - Suppresses the specified device included in the block device mapping of\n  the AMI.\n\n- `snapshot_id` (string) - The ID of the snapshot.\n\n- `throughput` (\\*int64) - The throughput for gp3 volumes, only valid for gp3 types\n  See the documentation on\n  [Throughput](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `virtual_name` (string) - The virtual device name. See the documentation on Block Device Mapping\n  for more information.\n\n- `volume_type` (string) - The volume type. gp2 \u0026 gp3 for General Purpose (SSD) volumes, io1 \u0026 io2\n  for Provisioned IOPS (SSD) volumes, st1 for Throughput Optimized HDD,\n  sc1 for Cold HDD, and standard for Magnetic volumes.\n\n- `volume_size` (int64) - The size of the volume, in GiB. Required if not specifying a\n  snapshot_id.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for boot volume encryption.\n  This option exists for launch_block_device_mappings but not\n  ami_block_device_mappings. The kms key id defined here only applies to\n  the original build region; if the AMI gets copied to other regions, the\n  volume in those regions will be encrypted by the default EBS KMS key.\n  For valid formats see KmsKeyId in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html)\n  This field is validated by Packer. When using an alias, you will have to\n  prefix kms_key_id with alias/.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n### Access Config Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_key` (string) - The access key used to communicate with AWS. [Learn how  to set this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials).\n  On EBS, this is not required if you are using `use_vault_aws_engine`\n  for authentication instead.\n\n- `region` (string) - The name of the region, such as `us-east-1`, in which\n  to launch the EC2 instance to create the AMI.\n  When chroot building, this value is guessed from environment.\n\n- `secret_key` (string) - The secret key used to communicate with AWS. [Learn how to set\n  this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials). This is not required\n  if you are using `use_vault_aws_engine` for authentication instead.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `assume_role` (AssumeRoleConfig) - If provided with a role ARN, Packer will attempt to assume this role\n  using the supplied credentials. See\n  [AssumeRoleConfig](#assume-role-configuration) below for more\n  details on all of the options available, and for a usage example.\n\n- `custom_endpoint_ec2` (string) - This option is useful if you use a cloud\n  provider whose API is compatible with aws EC2. Specify another endpoint\n  like this https://ec2.custom.endpoint.com.\n\n- `shared_credentials_file` (string) - Path to a credentials file to load credentials from\n\n- `decode_authorization_messages` (bool) - Enable automatic decoding of any encoded authorization (error) messages\n  using the `sts:DecodeAuthorizationMessage` API. Note: requires that the\n  effective user/role have permissions to `sts:DecodeAuthorizationMessage`\n  on resource `*`. Default `false`.\n\n- `insecure_skip_tls_verify` (bool) - This allows skipping TLS\n  verification of the AWS EC2 endpoint. The default is false.\n\n- `max_retries` (int) - This is the maximum number of times an API call is retried, in the case\n  where requests are being throttled or experiencing transient failures.\n  The delay between the subsequent API calls increases exponentially.\n\n- `mfa_code` (string) - The MFA\n  [TOTP](https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm)\n  code. This should probably be a user variable since it changes all the\n  time.\n\n- `profile` (string) - The profile to use in the shared credentials file for\n  AWS. See Amazon's documentation on [specifying\n  profiles](https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles)\n  for more details.\n\n- `skip_metadata_api_check` (bool) - Skip Metadata Api Check\n\n- `skip_credential_validation` (bool) - Set to true if you want to skip validating AWS credentials before runtime.\n\n- `token` (string) - The access token to use. This is different from the\n  access key and secret key. If you're not sure what this is, then you\n  probably don't need it. This will also be read from the AWS_SESSION_TOKEN\n  environmental variable.\n\n- `vault_aws_engine` (VaultAWSEngineOptions) - Get credentials from HashiCorp Vault's aws secrets engine. You must\n  already have created a role to use. For more information about\n  generating credentials via the Vault engine, see the [Vault\n  docs.](https://www.vaultproject.io/api/secret/aws#generate-credentials)\n  If you set this flag, you must also set the below options:\n  -   `name` (string) - Required. Specifies the name of the role to generate\n      credentials against. This is part of the request URL.\n  -   `engine_name` (string) - The name of the aws secrets engine. In the\n      Vault docs, this is normally referred to as \"aws\", and Packer will\n      default to \"aws\" if `engine_name` is not set.\n  -   `role_arn` (string)- The ARN of the role to assume if credential\\_type\n      on the Vault role is assumed\\_role. Must match one of the allowed role\n      ARNs in the Vault role. Optional if the Vault role only allows a single\n      AWS role ARN; required otherwise.\n  -   `ttl` (string) - Specifies the TTL for the use of the STS token. This\n      is specified as a string with a duration suffix. Valid only when\n      credential\\_type is assumed\\_role or federation\\_token. When not\n      specified, the default\\_sts\\_ttl set for the role will be used. If that\n      is also not set, then the default value of 3600s will be used. AWS\n      places limits on the maximum TTL allowed. See the AWS documentation on\n      the DurationSeconds parameter for AssumeRole (for assumed\\_role\n      credential types) and GetFederationToken (for federation\\_token\n      credential types) for more details.\n  \n  HCL2 example:\n  \n  ```hcl\n  vault_aws_engine {\n      name = \"myrole\"\n      role_arn = \"myarn\"\n      ttl = \"3600s\"\n  }\n  ```\n  \n  JSON example:\n  \n  ```json\n  {\n      \"vault_aws_engine\": {\n          \"name\": \"myrole\",\n          \"role_arn\": \"myarn\",\n          \"ttl\": \"3600s\"\n      }\n  }\n  ```\n\n- `aws_polling` (\\*AWSPollingConfig) - [Polling configuration](#polling-configuration) for the AWS waiter. Configures the waiter that checks\n  resource state.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Assume Role Configuration\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\nAssumeRoleConfig lets users set configuration options for assuming a special\nrole when executing Packer.\n\nUsage example:\n\nHCL config example:\n\n```HCL\n\n\tsource \"amazon-ebs\" \"example\" {\n\t\tassume_role {\n\t\t\trole_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n\t\t\tsession_name = \"SESSION_NAME\"\n\t\t\texternal_id  = \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\nJSON config example:\n\n```json\n\n\tbuilder{\n\t\t\"type\": \"amazon-ebs\",\n\t\t\"assume_role\": {\n\t\t\t\"role_arn\"    :  \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\",\n\t\t\t\"session_name\":  \"SESSION_NAME\",\n\t\t\t\"external_id\" :  \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `role_arn` (string) - Amazon Resource Name (ARN) of the IAM Role to assume.\n\n- `duration_seconds` (int) - Number of seconds to restrict the assume role session duration.\n\n- `external_id` (string) - The external ID to use when assuming the role. If omitted, no external\n  ID is passed to the AssumeRole call.\n\n- `policy` (string) - IAM Policy JSON describing further restricting permissions for the IAM\n  Role being assumed.\n\n- `policy_arns` ([]string) - Set of Amazon Resource Names (ARNs) of IAM Policies describing further\n  restricting permissions for the IAM Role being\n\n- `session_name` (string) - Session name to use when assuming the role.\n\n- `tags` (map[string]string) - Map of assume role session tags.\n\n- `transitive_tag_keys` ([]string) - Set of assume role session tag keys to pass to any subsequent sessions.\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Polling Configuration\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\nPolling configuration for the AWS waiter. Configures the waiter for resources creation or actions like attaching\nvolumes or importing image.\n\nHCL2 example:\n```hcl\n\n\taws_polling {\n\t\t delay_seconds = 30\n\t\t max_attempts = 50\n\t}\n\n```\n\nJSON example:\n```json\n\n\t\"aws_polling\" : {\n\t\t \"delay_seconds\": 30,\n\t\t \"max_attempts\": 50\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\n- `max_attempts` (int) - Specifies the maximum number of attempts the waiter will check for resource state.\n  This value can also be set via the AWS_MAX_ATTEMPTS.\n  If both option and environment variable are set, the max_attempts will be considered over the AWS_MAX_ATTEMPTS.\n  If none is set, defaults to AWS waiter default which is 40 max_attempts.\n\n- `delay_seconds` (int) - Specifies the delay in seconds between attempts to check the resource state.\n  This value can also be set via the AWS_POLL_DELAY_SECONDS.\n  If both option and environment variable are set, the delay_seconds will be considered over the AWS_POLL_DELAY_SECONDS.\n  If none is set, defaults to AWS waiter default which is 15 seconds.\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n## Basic Example\n\nHere is a basic example. It is completely valid except for the access keys:\n\n**HCL2**\n\n```hcl\n// To make Packer read these variables from the environment into the var object,\n// set the environment variables to have the same name as the declared\n// variables, with the prefix PKR_VAR_.\n\n// There are other ways to [set variables](/packer/docs/templates/hcl_templates/variables#assigning-values-to-build-variables), including from a var\n// file or as a command argument.\n\n// export PKR_VAR_aws_access_key=$YOURKEY\nvariable \"aws_access_key\" {\n  type = string\n  // default = \"hardcoded_key\" // Not recommended !\n}\n\n// export PKR_VAR_aws_secret_key=$YOURSECRETKEY\nvariable \"aws_secret_key\" {\n  type = string\n  // default = \"hardcoded_secret_key\" // Not recommended !\n}\n\nsource \"amazon-chroot\" \"basic-example\" {\n  access_key = var.aws_access_key\n  secret_key =  var.aws_secret_key\n  ami_name = \"example-chroot\"\n  source_ami = \"ami-e81d5881\"\n}\n\nbuild {\n  sources = [\n    \"source.amazon-chroot.basic-example\"\n  ]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"type\": \"amazon-chroot\",\n  \"access_key\": \"YOUR KEY HERE\",\n  \"secret_key\": \"YOUR SECRET KEY HERE\",\n  \"source_ami\": \"ami-e81d5881\",\n  \"ami_name\": \"packer-amazon-chroot {{timestamp}}\"\n}\n```\n\n\n## Chroot Mounts\n\nThe `chroot_mounts` configuration can be used to mount specific devices within\nthe chroot. By default, the following additional mounts are added into the\nchroot by Packer:\n\n- `/proc` (proc)\n- `/sys` (sysfs)\n- `/dev` (bind to real `/dev`)\n- `/dev/pts` (devpts)\n- `/proc/sys/fs/binfmt_misc` (binfmt_misc)\n\nThese default mounts are usually good enough for anyone and are reasonable\ndefaults. However, if you want to change or add the mount points, you may using\nthe `chroot_mounts` configuration. Here is an example configuration which only\nmounts `/proc` and `/dev`:\n\n**HCL2**\n\n```hcl\nsource \"amazon-chroot\" \"basic-example\" {\n  // ... other builder options\n  chroot_mounts = [\n    [\"proc\", \"proc\", \"/proc\"],\n    [\"bind\", \"/dev\", \"/dev\"]\n  ]\n}\n```\n\n**JSON**\n\n```json\n...\n\"builders\": [{\n  \"type\": \"amazon-chroot\"\n  ...\n  \"chroot_mounts\": [\n    [\"proc\", \"proc\", \"/proc\"],\n    [\"bind\", \"/dev\", \"/dev\"]\n  ]\n}]\n```\n\n\n`chroot_mounts` is a list of a 3-tuples of strings. The three components of the\n3-tuple, in order, are:\n\n- The filesystem type. If this is \"bind\", then Packer will properly bind the\n  filesystem to another mount point.\n\n- The source device.\n\n- The mount directory.\n\n## Parallelism\n\nA quick note on parallelism: it is perfectly safe to run multiple _separate_\nPacker processes with the `amazon-chroot` builder on the same EC2 instance. In\nfact, this is recommended as a way to push the most performance out of your AMI\nbuilds.\n\nPacker properly obtains a process lock for the parallelism-sensitive parts of\nits internals such as finding an available device.\n\n## Gotchas\n\n### Unmounting the Filesystem\n\nOne of the difficulties with using the chroot builder is that your provisioning\nscripts must not leave any processes running or packer will be unable to\nunmount the filesystem.\n\nFor debian based distributions you can setup a\n[policy-rc.d](http://people.debian.org/~hmh/invokerc.d-policyrc.d-specification.txt)\nfile which will prevent packages installed by your provisioners from starting\nservices:\n\n**HCL2**\n\n```hcl\n// ...\nbuild {\n  sources = [\n    \"source.amazon-chroot.basic-example\"\n  ]\n\n  // Set policy\n  provisioner \"shell\" {\n    inline = [\n        \"echo '#!/bin/sh' \u003e /usr/sbin/policy-rc.d\",\n        \"echo 'exit 101' \u003e\u003e /usr/sbin/policy-rc.d\",\n        \"chmod a+x /usr/sbin/policy-rc.d\"\n    ]\n  }\n\n  // Un-set policy\n  provisioner \"shell\" {\n    inline = [\"rm -f /usr/sbin/policy-rc.d\"]\n  }\n}\n```\n\n**JSON**\n\n```json\n\"provisioners\": [\n  {\n    \"type\": \"shell\",\n    \"inline\": [\n      \"echo '#!/bin/sh' \u003e /usr/sbin/policy-rc.d\",\n      \"echo 'exit 101' \u003e\u003e /usr/sbin/policy-rc.d\",\n      \"chmod a+x /usr/sbin/policy-rc.d\"\n    ]\n  },\n  {\n    \"type\": \"shell\",\n    \"inline\": [\"rm -f /usr/sbin/policy-rc.d\"]\n  }\n]\n```\n\n\n### Ansible provisioner\n\nRunning ansible against `amazon-chroot` requires changing the Ansible\nconnection to chroot and running Ansible as root/sudo.\n\n### Using Instances with NVMe block devices.\n\nIn C5, C5d, M5, and i3.metal instances, EBS volumes are exposed as NVMe block\ndevices\n[reference](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/nvme-ebs-volumes.html).\nIn order to correctly mount these devices, you have to do some extra legwork,\ninvolving the `nvme_device_path` option above. Read that for more information.\n\nA working example for mounting an NVMe device is below:\n\n**HCL2**\n\n```hcl\n// export PKR_VAR_aws_access_key=$YOURKEY\nvariable \"aws_access_key\" {\n  type = string\n}\n\n// export PKR_VAR_aws_secret_key=$YOURSECRETKEY\nvariable \"aws_secret_key\" {\n  type = string\n}\n\ndata \"amazon-ami\" \"example\" {\n  filters = {\n    virtualization-type = \"hvm\"\n    name                = \"amzn-ami-hvm-*\"\n    root-device-type    = \"ebs\"\n  }\n  owners      = [\"137112412989\"]\n  most_recent = true\n\n  # Access Configuration\n  region      = \"us-east-1\"\n  access_key = var.aws_access_key\n  secret_key = var.aws_secret_key\n}\n\nsource \"amazon-chroot\" \"basic-example\" {\n  access_key = var.aws_access_key\n  secret_key = var.aws_secret_key\n  region     = \"us-east-1\"\n  source_ami = data.amazon-ami.example.id\n  ena_support = true\n  ami_name = \"amazon-chroot-test-{{timestamp}}\"\n  nvme_device_path = \"/dev/nvme1n1p\"\n  device_path = \"/dev/sdf\"\n}\n\nbuild {\n  sources = [\n    \"source.amazon-chroot.basic-example\"\n  ]\n\n  provisioner \"shell\" {\n    inline = [\"echo Test \u003e /tmp/test.txt\"]\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"region\": \"us-east-2\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"amazon-chroot\",\n      \"region\": \"{{user `region`}}\",\n      \"source_ami_filter\": {\n        \"filters\": {\n          \"virtualization-type\": \"hvm\",\n          \"name\": \"amzn-ami-hvm-*\",\n          \"root-device-type\": \"ebs\"\n        },\n        \"owners\": [\"137112412989\"],\n        \"most_recent\": true\n      },\n      \"ena_support\": true,\n      \"ami_name\": \"amazon-chroot-test-{{timestamp}}\",\n      \"nvme_device_path\": \"/dev/nvme1n1p\",\n      \"device_path\": \"/dev/sdf\"\n    }\n  ],\n\n  \"provisioners\": [\n    {\n      \"type\": \"shell\",\n      \"inline\": [\"echo Test \u003e /tmp/test.txt\"]\n    }\n  ]\n}\n```\n\n\nNote that in the `nvme_device_path` you must end with the `p`; if you try to\ndefine the partition in this path (e.g. `nvme_device_path`: `/dev/nvme1n1p1`)\nand haven't also set the `\"mount_partition\": 0`, a `1` will be appended to the\n`nvme_device_path` and Packer will fail.\n\n## Building From Scratch\n\nThis example demonstrates the essentials of building an image from scratch. A\n15G gp2 (SSD) device is created (overriding the default of standard/magnetic).\nThe device setup commands partition the device with one partition for use as an\nHVM image and format it ext4. This builder block should be followed by\nprovisioning commands to install the os and bootloader.\n\n**HCL2**\n\n```hcl\n// This example assumes that AWS_SECRET_ACCESS_KEY and AWS_ACCESS_KEY_ID are\n// set in your environment, or a ~/.aws/credentials file is configured.\nsource \"amazon-chroot\" \"basic-example\" {\n  region = \"us-east-1\"\n  ami_name = \"packer-from-scratch {{timestamp}}\"\n  from_scratch = true\n  ami_virtualization_type = \"hvm\"\n  pre_mount_commands = [\n    \"parted {{.Device}} mklabel msdos mkpart primary 1M 100% set 1 boot on print\",\n    \"mkfs.ext4 {{.Device}}1\"\n  ]\n  root_volume_size = 15\n  root_device_name = \"xvda\"\n  ami_block_device_mappings {\n    device_name = \"xvda\"\n    delete_on_termination = true\n    volume_type = \"gp2\"\n  }\n\n}\n\nbuild {\n  sources = [\n    \"source.amazon-chroot.basic-example\"\n  ]\n\n  provisioner \"shell\" {\n    inline = [\n        \"echo '#!/bin/sh' \u003e /usr/sbin/policy-rc.d\",\n        \"echo 'exit 101' \u003e\u003e /usr/sbin/policy-rc.d\",\n        \"chmod a+x /usr/sbin/policy-rc.d\"\n    ]\n  }\n\n  provisioner \"shell\" {\n    inline = [\"rm -f /usr/sbin/policy-rc.d\"]\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"type\": \"amazon-chroot\",\n  \"ami_name\": \"packer-from-scratch {{timestamp}}\",\n  \"from_scratch\": true,\n  \"ami_virtualization_type\": \"hvm\",\n  \"pre_mount_commands\": [\n    \"parted {{.Device}} mklabel msdos mkpart primary 1M 100% set 1 boot on print\",\n    \"mkfs.ext4 {{.Device}}1\"\n  ],\n  \"root_volume_size\": 15,\n  \"root_device_name\": \"xvda\",\n  \"ami_block_device_mappings\": [\n    {\n      \"device_name\": \"xvda\",\n      \"delete_on_termination\": true,\n      \"volume_type\": \"gp2\"\n    }\n  ]\n}\n```\n\n\n## Build template data\n\nIn configuration directives marked as a template engine above, the following\nvariables are available:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n- `SourceAMITags` - The source AMI Tags, as a `map[string]string` object.\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](/packer/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](/packer/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n- `Device` - Root device path.\n- `MountPath` - Device mounting path.\n\nUsage example:\n\n**HCL2**\n\n```hcl\n// When accessing one of these variables from inside the builder, you need to\n// use the golang templating syntax. This is due to an architectural quirk that\n// won't be easily resolvable until legacy json templates are deprecated:\n\n{\nsource \"amazon-ebs\" \"basic-example\" {\n  tags = {\n        OS_Version = \"Ubuntu\"\n        Release = \"Latest\"\n        Base_AMI_ID = \"{{ .SourceAMI }}\"\n        Base_AMI_Name = \"{{ .SourceAMIName }}\"\n    }\n}\n\n// when accessing one of the variables from a provisioner or post-processor, use\n// hcl-syntax\npost-processor \"manifest\" {\n    output = \"manifest.json\"\n    strip_path = true\n    custom_data = {\n        source_ami_name = \"${build.SourceAMIName}\"\n        device = \"${build.Device}\"\n        mount_path = \"${build.MountPath}\"\n    }\n}\n```\n\n**JSON**\n\n```json\n\"post-processors\": [\n  {\n    \"type\": \"manifest\",\n    \"output\": \"manifest.json\",\n    \"strip_path\": true,\n    \"custom_data\": {\n      \"source_ami_name\": \"{{ build `SourceAMIName` }}\",\n      \"device\": \"{{ build `Device` }}\",\n      \"mount_path\": \"{{ build `MountPath` }}\"\n    }\n  }\n]\n```\n","created_at":"2024-04-17T16:47:55.049Z","updated_at":"2024-04-17T16:47:55.049Z","name":"Amazon chroot","slug":"chroot","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"5280e533-5e21-41d6-99d7-02a4de2beeb1","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `amazon-ebs`\nArtifact BuilderId: `mitchellh.amazonebs`\n\nThe `amazon-ebs` Packer builder is able to create Amazon AMIs backed by EBS\nvolumes for use in [EC2](https://aws.amazon.com/ec2/). For more information on\nthe difference between EBS-backed instances and instance-store backed\ninstances, see the [\"storage for the root device\" section in the EC2\ndocumentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ComponentsAMIs.html#storage-for-the-root-device).\n\nThis builder builds an AMI by launching an EC2 instance from a source AMI,\nprovisioning that running machine, and then creating an AMI from that machine.\nThis is all done in your own AWS account. The builder will create temporary\nkeypairs, security group rules, etc. that provide it temporary access to the\ninstance while the image is being created. This simplifies configuration quite\na bit.\n\nThe builder does _not_ manage AMIs. Once it creates an AMI and stores it in\nyour account, it is up to you to use, delete, etc. the AMI.\n\n-\u003e **Note:** Temporary resources are, by default, all created with the\nprefix `packer`. This can be useful if you want to restrict the security groups\nand key pairs Packer is able to operate on.\n\n## EBS Specific Configuration Reference\n\nThere are many configuration options available for the builder. In addition to\nthe items listed here, you will want to look at the general configuration\nreferences for [AMI](#ami-configuration),\n[BlockDevices](#block-devices-configuration),\n[Access](#access-configuration),\n[Run](#run-configuration) and\n[Communicator](#communicator-configuration)\nconfiguration references, which are\nnecessary for this build to succeed and can be found further down the page.\n\n**Optional:**\n\n\u003c!-- Code generated from the comments of the Config struct in builder/ebs/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `skip_create_ami` (bool) - If true, Packer will not create the AMI. Useful for setting to `true`\n  during a build test stage. Default `false`.\n\n- `ami_block_device_mappings` (awscommon.BlockDevices) - Add one or more block device mappings to the AMI. These will be attached\n  when booting a new instance from your AMI. To add a block device during\n  the Packer build see `launch_block_device_mappings` below. Your options\n  here may vary depending on the type of VM you use. See the\n  [BlockDevices](#block-devices-configuration) documentation for fields.\n\n- `launch_block_device_mappings` (awscommon.BlockDevices) - Add one or more block devices before the Packer build starts. If you add\n  instance store volumes or EBS volumes in addition to the root device\n  volume, the created AMI will contain block device mapping information\n  for those volumes. Amazon creates snapshots of the source instance's\n  root volume and any other EBS volumes described here. When you launch an\n  instance from this new AMI, the instance automatically launches with\n  these additional volumes, and will restore them from snapshots taken\n  from the source instance. See the\n  [BlockDevices](#block-devices-configuration) documentation for fields.\n\n- `run_volume_tags` (map[string]string) - Tags to apply to the volumes that are *launched* to create the AMI.\n  These tags are *not* applied to the resulting AMI unless they're\n  duplicated in `tags`. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `run_volume_tag` ([]{name string, value string}) - Same as [`run_volume_tags`](#run_volume_tags) but defined as a singular\n  block containing a `name` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](https://packer.io/docs/templates/hcl_templates/expressions.html#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `no_ephemeral` (bool) - Relevant only to Windows guests: If you set this flag, we'll add clauses\n  to the launch_block_device_mappings that make sure ephemeral drives\n  don't show up in the EC2 console. If you launched from the EC2 console,\n  you'd get this automatically, but the SDK does not provide this service.\n  For more information, see\n  https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/InstanceStorage.html.\n  Because we don't validate the OS type of your guest, it is up to you to\n  make sure you don't set this for *nix guests; behavior may be\n  unpredictable.\n\n- `deprecate_at` (string) - The date and time to deprecate the AMI, in UTC, in the following format: YYYY-MM-DDTHH:MM:SSZ.\n  If you specify a value for seconds, Amazon EC2 rounds the seconds to the nearest minute.\n  You cant specify a date in the past. The upper limit for DeprecateAt is 10 years from now.\n\n- `fast_launch` (FastLaunchConfig) - The configuration for fast launch support.\n  \n  Fast launch is only relevant for Windows AMIs, and should not be used\n  for other OSes.\n  See the [Fast Launch Configuration](#fast-launch-config) section for\n  information on the attributes supported for this block.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/ebs/builder.go; --\u003e\n\n\n### AMI Configuration\n\n**Required:**\n\n\u003c!-- Code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_name` (string) - The name of the resulting AMI that will appear when managing AMIs in the\n  AWS console or via APIs. This must be unique. To help make this unique,\n  use a function like timestamp (see [template\n  engine](/packer/docs/templates/legacy_json_templates/engine) for more info).\n\n\u003c!-- End of code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; --\u003e\n\n\n**Optional:**\n\n\u003c!-- Code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_description` (string) - The description to set for the resulting\n  AMI(s). By default this description is empty.  This is a\n  [template engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `ami_virtualization_type` (string) - The type of virtualization for the AMI\n  you are building. This option is required to register HVM images. Can be\n  paravirtual (default) or hvm.\n\n- `ami_users` ([]string) - A list of account IDs that have access to\n  launch the resulting AMI(s). By default no additional users other than the\n  user creating the AMI has permissions to launch it.\n\n- `ami_groups` ([]string) - A list of groups that have access to\n  launch the resulting AMI(s). By default no groups have permission to launch\n  the AMI. `all` will make the AMI publicly accessible.\n  AWS currently doesn't accept any value other than \"all\"\n\n- `ami_org_arns` ([]string) - A list of Amazon Resource Names (ARN) of AWS Organizations that have access to\n  launch the resulting AMI(s). By default no organizations have permission to launch\n  the AMI.\n\n- `ami_ou_arns` ([]string) - A list of Amazon Resource Names (ARN) of AWS Organizations organizational units (OU) that have access to\n  launch the resulting AMI(s). By default no organizational units have permission to launch\n  the AMI.\n\n- `ami_product_codes` ([]string) - A list of product codes to\n  associate with the AMI. By default no product codes are associated with the\n  AMI.\n\n- `ami_regions` ([]string) - A list of regions to copy the AMI to.\n  Tags and attributes are copied along with the AMI. AMI copying takes time\n  depending on the size of the AMI, but will generally take many minutes.\n\n- `skip_region_validation` (bool) - Set to true if you want to skip\n  validation of the ami_regions configuration option. Default false.\n\n- `tags` (map[string]string) - Key/value pair tags applied to the AMI. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n  \n  The builder no longer adds a \"Name\": \"Packer Builder\" entry to the tags.\n\n- `tag` ([]{key string, value string}) - Same as [`tags`](#tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `ena_support` (boolean) - Enable enhanced networking (ENA but not SriovNetSupport) on\n  HVM-compatible AMIs. If set, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy.\n  \n  Note: you must make sure enhanced networking is enabled on your\n  instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n\n- `sriov_support` (bool) - Enable enhanced networking (SriovNetSupport but not ENA) on\n  HVM-compatible AMIs. If true, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy. Note: you must make sure enhanced networking is enabled\n  on your instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n  Default `false`.\n\n- `force_deregister` (bool) - Force Packer to first deregister an existing\n  AMI if one with the same name already exists. Default false.\n\n- `force_delete_snapshot` (bool) - Force Packer to delete snapshots\n  associated with AMIs, which have been deregistered by force_deregister.\n  Default false.\n\n- `encrypt_boot` (boolean) - Whether or not to encrypt the resulting AMI when\n  copying a provisioned instance to an AMI. By default, Packer will keep\n  the encryption setting to what it was in the source image. Setting false\n  will result in an unencrypted image, and true will result in an encrypted\n  one.\n  \n  If you have used the `launch_block_device_mappings` to set an encryption\n  key and that key is the same as the one you want the image encrypted with\n  at the end, then you don't need to set this field; leaving it empty will\n  prevent an unnecessary extra copy step and save you some time.\n  \n  Please note that if you are using an account with the global \"Always\n  encrypt new EBS volumes\" option set to `true`, Packer will be unable to\n  override this setting, and the final image will be encrypted whether\n  you set this value or not.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for AMI encryption. This\n  only applies to the main `region` -- any regions the AMI gets copied to\n  will be encrypted by the default EBS KMS key for that region,\n  unless you set region-specific keys in `region_kms_key_ids`.\n  \n  Set this value if you select `encrypt_boot`, but don't want to use the\n  region's default KMS key.\n  \n  If you have a custom kms key you'd like to apply to the launch volume,\n  and are only building in one region, it is more efficient to leave this\n  and `encrypt_boot` empty and to instead set the key id in the\n  launch_block_device_mappings (you can find an example below). This saves\n  potentially many minutes at the end of the build by preventing Packer\n  from having to copy and re-encrypt the image at the end of the build.\n  \n  For valid formats see *KmsKeyId* in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html).\n  This field is validated by Packer, when using an alias, you will have to\n  prefix `kms_key_id` with `alias/`.\n\n- `region_kms_key_ids` (map[string]string) - regions to copy the ami to, along with the custom kms key id (alias or\n  arn) to use for encryption for that region. Keys must match the regions\n  provided in `ami_regions`. If you just want to encrypt using a default\n  ID, you can stick with `kms_key_id` and `ami_regions`. If you want a\n  region to be encrypted with that region's default key ID, you can use an\n  empty string `\"\"` instead of a key id in this map. (e.g. `\"us-east-1\":\n  \"\"`) However, you cannot use default key IDs if you are using this in\n  conjunction with `snapshot_users` -- in that situation you must use\n  custom keys. For valid formats see *KmsKeyId* in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html).\n  \n  This option supercedes the `kms_key_id` option -- if you set both, and\n  they are different, Packer will respect the value in\n  `region_kms_key_ids` for your build region and silently disregard the\n  value provided in `kms_key_id`.\n\n- `skip_save_build_region` (bool) - If true, Packer will not check whether an AMI with the `ami_name` exists\n  in the region it is building in. It will use an intermediary AMI name,\n  which it will not convert to an AMI in the build region. It will copy\n  the intermediary AMI into any regions provided in `ami_regions`, then\n  delete the intermediary AMI. Default `false`.\n\n- `imds_support` (string) - Enforce version of the Instance Metadata Service on the built AMI.\n  Valid options are unset (legacy) and `v2.0`. See the documentation on\n  [IMDS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html)\n  for more information. Defaults to legacy.\n\n\u003c!-- End of code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `snapshot_tags` (map[string]string) - Key/value pair tags to apply to snapshot. They will override AMI tags if\n  already applied to snapshot. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `snapshot_tag` ([]{key string, value string}) - Same as [`snapshot_tags`](#snapshot_tags) but defined as a singular\n  repeatable block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `snapshot_users` ([]string) - A list of account IDs that have\n  access to create volumes from the snapshot(s). By default no additional\n  users other than the user creating the AMI has permissions to create\n  volumes from the backing snapshot(s).\n\n- `snapshot_groups` ([]string) - A list of groups that have access to\n  create volumes from the snapshot(s). By default no groups have permission\n  to create volumes from the snapshot(s). all will make the snapshot\n  publicly accessible.\n\n\u003c!-- End of code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; --\u003e\n\n\n### Access Configuration\n\n**Required:**\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_key` (string) - The access key used to communicate with AWS. [Learn how  to set this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials).\n  On EBS, this is not required if you are using `use_vault_aws_engine`\n  for authentication instead.\n\n- `region` (string) - The name of the region, such as `us-east-1`, in which\n  to launch the EC2 instance to create the AMI.\n  When chroot building, this value is guessed from environment.\n\n- `secret_key` (string) - The secret key used to communicate with AWS. [Learn how to set\n  this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials). This is not required\n  if you are using `use_vault_aws_engine` for authentication instead.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n**Optional:**\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `assume_role` (AssumeRoleConfig) - If provided with a role ARN, Packer will attempt to assume this role\n  using the supplied credentials. See\n  [AssumeRoleConfig](#assume-role-configuration) below for more\n  details on all of the options available, and for a usage example.\n\n- `custom_endpoint_ec2` (string) - This option is useful if you use a cloud\n  provider whose API is compatible with aws EC2. Specify another endpoint\n  like this https://ec2.custom.endpoint.com.\n\n- `shared_credentials_file` (string) - Path to a credentials file to load credentials from\n\n- `decode_authorization_messages` (bool) - Enable automatic decoding of any encoded authorization (error) messages\n  using the `sts:DecodeAuthorizationMessage` API. Note: requires that the\n  effective user/role have permissions to `sts:DecodeAuthorizationMessage`\n  on resource `*`. Default `false`.\n\n- `insecure_skip_tls_verify` (bool) - This allows skipping TLS\n  verification of the AWS EC2 endpoint. The default is false.\n\n- `max_retries` (int) - This is the maximum number of times an API call is retried, in the case\n  where requests are being throttled or experiencing transient failures.\n  The delay between the subsequent API calls increases exponentially.\n\n- `mfa_code` (string) - The MFA\n  [TOTP](https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm)\n  code. This should probably be a user variable since it changes all the\n  time.\n\n- `profile` (string) - The profile to use in the shared credentials file for\n  AWS. See Amazon's documentation on [specifying\n  profiles](https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles)\n  for more details.\n\n- `skip_metadata_api_check` (bool) - Skip Metadata Api Check\n\n- `skip_credential_validation` (bool) - Set to true if you want to skip validating AWS credentials before runtime.\n\n- `token` (string) - The access token to use. This is different from the\n  access key and secret key. If you're not sure what this is, then you\n  probably don't need it. This will also be read from the AWS_SESSION_TOKEN\n  environmental variable.\n\n- `vault_aws_engine` (VaultAWSEngineOptions) - Get credentials from HashiCorp Vault's aws secrets engine. You must\n  already have created a role to use. For more information about\n  generating credentials via the Vault engine, see the [Vault\n  docs.](https://www.vaultproject.io/api/secret/aws#generate-credentials)\n  If you set this flag, you must also set the below options:\n  -   `name` (string) - Required. Specifies the name of the role to generate\n      credentials against. This is part of the request URL.\n  -   `engine_name` (string) - The name of the aws secrets engine. In the\n      Vault docs, this is normally referred to as \"aws\", and Packer will\n      default to \"aws\" if `engine_name` is not set.\n  -   `role_arn` (string)- The ARN of the role to assume if credential\\_type\n      on the Vault role is assumed\\_role. Must match one of the allowed role\n      ARNs in the Vault role. Optional if the Vault role only allows a single\n      AWS role ARN; required otherwise.\n  -   `ttl` (string) - Specifies the TTL for the use of the STS token. This\n      is specified as a string with a duration suffix. Valid only when\n      credential\\_type is assumed\\_role or federation\\_token. When not\n      specified, the default\\_sts\\_ttl set for the role will be used. If that\n      is also not set, then the default value of 3600s will be used. AWS\n      places limits on the maximum TTL allowed. See the AWS documentation on\n      the DurationSeconds parameter for AssumeRole (for assumed\\_role\n      credential types) and GetFederationToken (for federation\\_token\n      credential types) for more details.\n  \n  HCL2 example:\n  \n  ```hcl\n  vault_aws_engine {\n      name = \"myrole\"\n      role_arn = \"myarn\"\n      ttl = \"3600s\"\n  }\n  ```\n  \n  JSON example:\n  \n  ```json\n  {\n      \"vault_aws_engine\": {\n          \"name\": \"myrole\",\n          \"role_arn\": \"myarn\",\n          \"ttl\": \"3600s\"\n      }\n  }\n  ```\n\n- `aws_polling` (\\*AWSPollingConfig) - [Polling configuration](#polling-configuration) for the AWS waiter. Configures the waiter that checks\n  resource state.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Assume Role Configuration\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\nAssumeRoleConfig lets users set configuration options for assuming a special\nrole when executing Packer.\n\nUsage example:\n\nHCL config example:\n\n```HCL\n\n\tsource \"amazon-ebs\" \"example\" {\n\t\tassume_role {\n\t\t\trole_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n\t\t\tsession_name = \"SESSION_NAME\"\n\t\t\texternal_id  = \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\nJSON config example:\n\n```json\n\n\tbuilder{\n\t\t\"type\": \"amazon-ebs\",\n\t\t\"assume_role\": {\n\t\t\t\"role_arn\"    :  \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\",\n\t\t\t\"session_name\":  \"SESSION_NAME\",\n\t\t\t\"external_id\" :  \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `role_arn` (string) - Amazon Resource Name (ARN) of the IAM Role to assume.\n\n- `duration_seconds` (int) - Number of seconds to restrict the assume role session duration.\n\n- `external_id` (string) - The external ID to use when assuming the role. If omitted, no external\n  ID is passed to the AssumeRole call.\n\n- `policy` (string) - IAM Policy JSON describing further restricting permissions for the IAM\n  Role being assumed.\n\n- `policy_arns` ([]string) - Set of Amazon Resource Names (ARNs) of IAM Policies describing further\n  restricting permissions for the IAM Role being\n\n- `session_name` (string) - Session name to use when assuming the role.\n\n- `tags` (map[string]string) - Map of assume role session tags.\n\n- `transitive_tag_keys` ([]string) - Set of assume role session tag keys to pass to any subsequent sessions.\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Polling Configuration\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\nPolling configuration for the AWS waiter. Configures the waiter for resources creation or actions like attaching\nvolumes or importing image.\n\nHCL2 example:\n```hcl\n\n\taws_polling {\n\t\t delay_seconds = 30\n\t\t max_attempts = 50\n\t}\n\n```\n\nJSON example:\n```json\n\n\t\"aws_polling\" : {\n\t\t \"delay_seconds\": 30,\n\t\t \"max_attempts\": 50\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\n- `max_attempts` (int) - Specifies the maximum number of attempts the waiter will check for resource state.\n  This value can also be set via the AWS_MAX_ATTEMPTS.\n  If both option and environment variable are set, the max_attempts will be considered over the AWS_MAX_ATTEMPTS.\n  If none is set, defaults to AWS waiter default which is 40 max_attempts.\n\n- `delay_seconds` (int) - Specifies the delay in seconds between attempts to check the resource state.\n  This value can also be set via the AWS_POLL_DELAY_SECONDS.\n  If both option and environment variable are set, the delay_seconds will be considered over the AWS_POLL_DELAY_SECONDS.\n  If none is set, defaults to AWS waiter default which is 15 seconds.\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n### Run Configuration\n\n**Required:**\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `instance_type` (string) - The EC2 instance type to use while building the\n  AMI, such as t2.small.\n\n- `source_ami` (string) - The source AMI whose root volume will be copied and\n  provisioned on the currently running instance. This must be an EBS-backed\n  AMI with a root volume snapshot that you have access to.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n**Optional:**\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `associate_public_ip_address` (confighelper.Trilean) - If using a non-default VPC,\n  public IP addresses are not provided by default. If this is true, your\n  new instance will get a Public IP. default: unset\n  \n  Note: when specifying this attribute without a `subnet_[id|filter]` or\n  `vpc_[id|filter]`, we will attempt to infer this information from the\n  default VPC/Subnet.\n  This operation may require some extra permissions to the IAM role that\n  runs the build:\n  \n  * ec2:DescribeVpcs\n  * ec2:DescribeSubnets\n  \n  Additionally, since we filter subnets/AZs by their capability to host\n  an instance of the selected type, you may also want to define the\n  `ec2:DescribeInstanceTypeOfferings` action to the role running the build.\n  Otherwise, Packer will pick the most available subnet in the VPC selected,\n  which may not be able to host the instance type you provided.\n\n- `availability_zone` (string) - Destination availability zone to launch\n  instance in. Leave this empty to allow Amazon to auto-assign.\n\n- `block_duration_minutes` (int64) - Requires spot_price to be set. The\n  required duration for the Spot Instances (also known as Spot blocks). This\n  value must be a multiple of 60 (60, 120, 180, 240, 300, or 360). You can't\n  specify an Availability Zone group or a launch group if you specify a\n  duration. Note: This parameter is no longer available to new customers\n  from July 1, 2021. [See Amazon's\n  documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-requests.html#fixed-duration-spot-instances).\n\n- `capacity_reservation_preference` (string) - Set the preference for using a capacity reservation if one exists.\n  Either will be `open` or `none`. Defaults to `none`\n\n- `capacity_reservation_id` (string) - Provide the specific EC2 Capacity Reservation ID that will be used\n  by Packer.\n\n- `capacity_reservation_group_arn` (string) - Provide the EC2 Capacity Reservation Group ARN that will be used by\n  Packer.\n\n- `disable_stop_instance` (bool) - Packer normally stops the build instance after all provisioners have\n  run. For Windows instances, it is sometimes desirable to [run\n  Sysprep](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/Creating_EBSbacked_WinAMI.html)\n  which will stop the instance for you. If this is set to `true`, Packer\n  *will not* stop the instance but will assume that you will send the stop\n  signal yourself through your final provisioner. You can do this with a\n  [windows-shell provisioner](/packer/integrations/hashicorp/windows-shell). Note that\n  Packer will still wait for the instance to be stopped, and failing to\n  send the stop signal yourself, when you have set this flag to `true`,\n  will cause a timeout.\n  \n  An example of a valid windows shutdown command in a `windows-shell`\n  provisioner is :\n  ```shell-session\n    ec2config.exe -sysprep\n  ```\n  or\n  ```sell-session\n    \"%programfiles%\\amazon\\ec2configservice\\\"ec2config.exe -sysprep\"\"\n  ```\n  -\u003e Note: The double quotation marks in the command are not required if\n  your CMD shell is already in the\n  `C:\\Program Files\\Amazon\\EC2ConfigService\\` directory.\n\n- `ebs_optimized` (bool) - Mark instance as [EBS\n  Optimized](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html).\n  Default `false`.\n\n- `enable_nitro_enclave` (bool) - Enable support for Nitro Enclaves on the instance.  Note that the instance type must\n  be able to [support Nitro Enclaves](https://aws.amazon.com/ec2/nitro/nitro-enclaves/faqs/).\n  This option is not supported for spot instances.\n\n- `enable_t2_unlimited` (bool) - Deprecated argument - please use \"enable_unlimited_credits\".\n  Enabling T2 Unlimited allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-credits-baseline-concepts.html)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-unlimited.html)\n  and the **T2 Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [T2\n  Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-std.html)\n  instance instead.\n  \n  To use T2 Unlimited you must use a T2 instance type, e.g. `t2.micro`.\n  Additionally, T2 Unlimited cannot be used in conjunction with Spot\n  Instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error.\n  \n  !\u0026gt; **Warning!** Additional costs may be incurred by enabling T2\n  Unlimited - even for instances that would usually qualify for the\n  [AWS Free Tier](https://aws.amazon.com/free/).\n\n- `enable_unlimited_credits` (bool) - Enabling Unlimited credits allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html#unlimited-mode-surplus-credits)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html)\n  and the **Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-standard-mode.html)\n  instance instead.\n  \n  To use Unlimited you must use a T2/T3/T3a/T4g instance type, e.g. (`t2.micro`, `t3.micro`).\n  Additionally, Unlimited cannot be used in conjunction with Spot\n  Instances for T2 type instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error if the underlying instance type is a T2 type instance.\n  By default the supported burstable instance types (including t3/t3a/t4g) will be provisioned with its cpu credits set to standard,\n  only when `enable_unlimited_credits` is true will the instance be provisioned with unlimited cpu credits.\n\n- `iam_instance_profile` (string) - The name of an [IAM instance\n  profile](https://docs.aws.amazon.com/IAM/latest/UserGuide/instance-profiles.html)\n  to launch the EC2 instance with.\n\n- `fleet_tags` (map[string]string) - Key/value pair tags to apply tags to the fleet that is issued.\n\n- `fleet_tag` ([]{key string, value string}) - Same as [`fleet_tags`](#fleet_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `skip_profile_validation` (bool) - Whether or not to check if the IAM instance profile exists. Defaults to false\n\n- `temporary_iam_instance_profile_policy_document` (\\*PolicyDocument) - Temporary IAM instance profile policy document\n  If IamInstanceProfile is specified it will be used instead.\n  \n  HCL2 example:\n  ```hcl\n  temporary_iam_instance_profile_policy_document {\n  \tStatement {\n  \t\tAction   = [\"logs:*\"]\n  \t\tEffect   = \"Allow\"\n  \t\tResource = [\"*\"]\n  \t}\n  \tVersion = \"2012-10-17\"\n  }\n  ```\n  \n  JSON example:\n  ```json\n  {\n  \t\"Version\": \"2012-10-17\",\n  \t\"Statement\": [\n  \t\t{\n  \t\t\t\"Action\": [\n  \t\t\t\"logs:*\"\n  \t\t\t],\n  \t\t\t\"Effect\": \"Allow\",\n  \t\t\t\"Resource\": [\"*\"]\n  \t\t}\n  \t]\n  }\n  ```\n\n- `shutdown_behavior` (string) - Automatically terminate instances on\n  shutdown in case Packer exits ungracefully. Possible values are stop and\n  terminate. Defaults to stop.\n\n- `security_group_filter` (SecurityGroupFilterOptions) - Filters used to populate the `security_group_ids` field.\n  \n  HCL2 Example:\n  \n  ```hcl\n    security_group_filter {\n      filters = {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  ```\n  \n  JSON Example:\n  ```json\n  {\n    \"security_group_filter\": {\n      \"filters\": {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  }\n  ```\n  \n  This selects the SG's with tag `Class` with the value `packer`.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a\n      `security_group_ids`. Any filter described in the docs for\n      [DescribeSecurityGroups](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSecurityGroups.html)\n      is valid.\n  \n  `security_group_ids` take precedence over this.\n\n- `run_tags` (map[string]string) - Key/value pair tags to apply to the generated key-pair, security group, iam profile and role, snapshot, network interfaces and instance\n  that is *launched* to create the EBS volumes. The resulting AMI will also inherit these tags.\n  This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `run_tag` ([]{key string, value string}) - Same as [`run_tags`](#run_tags) but defined as a singular repeatable\n  block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `security_group_id` (string) - The ID (not the name) of the security\n  group to assign to the instance. By default this is not set and Packer will\n  automatically create a new temporary security group to allow SSH access.\n  Note that if this is specified, you must be sure the security group allows\n  access to the ssh_port given below.\n\n- `security_group_ids` ([]string) - A list of security groups as\n  described above. Note that if this is specified, you must omit the\n  security_group_id.\n\n- `source_ami_filter` (AmiFilterOptions) - Filters used to populate the `source_ami`\n  field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    source_ami_filter {\n      filters = {\n         virtualization-type = \"hvm\"\n         name = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n         root-device-type = \"ebs\"\n      }\n      owners = [\"099720109477\"]\n      most_recent = true\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"source_ami_filter\": {\n         \"filters\": {\n         \"virtualization-type\": \"hvm\",\n         \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n         \"root-device-type\": \"ebs\"\n         },\n         \"owners\": [\"099720109477\"],\n         \"most_recent\": true\n      }\n    }\n  ]\n  ```\n  \n    This selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. NOTE:\n    This will fail unless *exactly* one AMI is returned. In the above example,\n    `most_recent` will cause this to succeed by selecting the newest image.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `source_ami`.\n        NOTE: This will fail unless *exactly* one AMI is returned. Any filter\n        described in the docs for\n        [DescribeImages](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html)\n        is valid.\n  \n    -   `owners` (array of strings) - Filters the images by their owner. You\n        may specify one or more AWS account IDs, \"self\" (which will use the\n        account whose credentials you are using to run Packer), or an AWS owner\n        alias: for example, `amazon`, `aws-marketplace`, or `microsoft`. This\n        option is required for security reasons.\n  \n    -   `most_recent` (boolean) - Selects the newest created image when true.\n        This is most useful for selecting a daily distro build.\n  \n    You may set this in place of `source_ami` or in conjunction with it. If you\n    set this in conjunction with `source_ami`, the `source_ami` will be added\n    to the filter. The provided `source_ami` must meet all of the filtering\n    criteria provided in `source_ami_filter`; this pins the AMI returned by the\n    filter, but will cause Packer to fail if the `source_ami` does not exist.\n\n- `spot_instance_types` ([]string) - a list of acceptable instance\n  types to run your build on. We will request a spot instance using the max\n  price of spot_price and the allocation strategy of \"lowest price\".\n  Your instance will be launched on an instance type of the lowest available\n  price that you have in your list.  This is used in place of instance_type.\n  You may only set either spot_instance_types or instance_type, not both.\n  This feature exists to help prevent situations where a Packer build fails\n  because a particular availability zone does not have capacity for the\n  specific instance_type requested in instance_type.\n\n- `spot_price` (string) - With Spot Instances, you pay the Spot price that's in effect for the\n  time period your instances are running. Spot Instance prices are set by\n  Amazon EC2 and adjust gradually based on long-term trends in supply and\n  demand for Spot Instance capacity.\n  \n  When this field is set, it represents the maximum hourly price you are\n  willing to pay for a spot instance. If you do not set this value, it\n  defaults to a maximum price equal to the on demand price of the\n  instance. In the situation where the current Amazon-set spot price\n  exceeds the value set in this field, Packer will not launch an instance\n  and the build will error. In the situation where the Amazon-set spot\n  price is less than the value set in this field, Packer will launch and\n  you will pay the Amazon-set spot price, not this maximum value.\n  For more information, see the Amazon docs on\n  [spot pricing](https://aws.amazon.com/ec2/spot/pricing/).\n\n- `spot_tags` (map[string]string) - Requires spot_price to be set. Key/value pair tags to apply tags to the\n  spot request that is issued.\n\n- `spot_tag` ([]{key string, value string}) - Same as [`spot_tags`](#spot_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `subnet_filter` (SubnetFilterOptions) - Filters used to populate the `subnet_id` field.\n  \n  HCL2 example:\n  \n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    subnet_filter {\n      filters = {\n            \"tag:Class\": \"build\"\n      }\n      most_free = true\n      random = false\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"subnet_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\"\n        },\n        \"most_free\": true,\n        \"random\": false\n      }\n    }\n  ]\n  ```\n  \n    This selects the Subnet with tag `Class` with the value `build`, which has\n    the most free IP addresses. NOTE: This will fail unless *exactly* one\n    Subnet is returned. By using `most_free` or `random` one will be selected\n    from those matching the filter.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `subnet_id`.\n        NOTE: This will fail unless *exactly* one Subnet is returned. Any\n        filter described in the docs for\n        [DescribeSubnets](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSubnets.html)\n        is valid.\n  \n    -   `most_free` (boolean) - The Subnet with the most free IPv4 addresses\n        will be used if multiple Subnets matches the filter.\n  \n    -   `random` (boolean) - A random Subnet will be used if multiple Subnets\n        matches the filter. `most_free` have precendence over this.\n  \n    `subnet_id` take precedence over this.\n\n- `subnet_id` (string) - If using VPC, the ID of the subnet, such as\n  subnet-12345def, where Packer will launch the EC2 instance. This field is\n  required if you are using an non-default VPC.\n\n- `license_specifications` ([]LicenseSpecification) - The license configurations.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    license_specifications {\n      license_configuration_request = {\n        license_configuration_arn = \"${var.license_configuration_arn}\"\n      }\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"license_specifications\": [\n        {\n          \"license_configuration_request\": {\n            \"license_configuration_arn\": \"{{user `license_configuration_arn`}}\"\n          }\n        }\n      ]\n    }\n  ]\n  ```\n  \n    Each `license_configuration_request` describes a license configuration,\n    the properties of which are:\n  \n    - `license_configuration_arn` (string) - The Amazon Resource Name (ARN)\n      of the license configuration.\n\n- `placement` (Placement) - Describes the placement of an instance.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    placement = {\n      host_resource_group_arn = \"${var.host_resource_group_arn}\"\n      tenancy                 = \"${var.placement_tenancy}\"\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"placement\": {\n        \"host_resource_group_arn\": \"{{user `host_resource_group_arn`}}\",\n        \"tenancy\": \"{{user `placement_tenancy`}}\"\n      }\n    }\n  ]\n  ```\n  \n    - `host_resource_group_arn` (string) - The ARN of the host resource\n      group in which to launch the instances. If you specify a host\n      resource group ARN, omit the Tenancy parameter or set it to `host`.\n    - `tenancy` (string) - The tenancy of the instance (if the instance is\n      running in a VPC). An instance with a tenancy of `dedicated` runs on\n      single-tenant hardware. The default is `default`, meaning shared\n      tenancy. Allowed values are `default`, `dedicated` and `host`.\n\n- `tenancy` (string) - Deprecated: Use Placement Tenancy instead.\n\n- `temporary_security_group_source_cidrs` ([]string) - A list of IPv4 CIDR blocks to be authorized access to the instance, when\n  packer is creating a temporary security group.\n  \n  The default is [`0.0.0.0/0`] (i.e., allow any IPv4 source).\n  Use `temporary_security_group_source_public_ip` to allow current host's\n  public IP instead of any IPv4 source.\n  This is only used when `security_group_id` or `security_group_ids` is not\n  specified.\n\n- `temporary_security_group_source_public_ip` (bool) - When enabled, use public IP of the host (obtained from https://checkip.amazonaws.com)\n  as CIDR block to be authorized access to the instance, when packer\n  is creating a temporary security group. Defaults to `false`.\n  \n  This is only used when `security_group_id`, `security_group_ids`,\n  and `temporary_security_group_source_cidrs` are not specified.\n\n- `user_data` (string) - User data to apply when launching the instance. Note\n  that you need to be careful about escaping characters due to the templates\n  being JSON. It is often more convenient to use user_data_file, instead.\n  Packer will not automatically wait for a user script to finish before\n  shutting down the instance this must be handled in a provisioner.\n\n- `user_data_file` (string) - Path to a file that will be used for the user\n  data when launching the instance.\n\n- `vpc_filter` (VpcFilterOptions) - Filters used to populate the `vpc_id` field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    vpc_filter {\n      filters = {\n        \"tag:Class\": \"build\",\n        \"isDefault\": \"false\",\n        \"cidr\": \"/24\"\n      }\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"vpc_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\",\n          \"isDefault\": \"false\",\n          \"cidr\": \"/24\"\n        }\n      }\n    }\n  ]\n  ```\n  \n  This selects the VPC with tag `Class` with the value `build`, which is not\n  the default VPC, and have a IPv4 CIDR block of `/24`. NOTE: This will fail\n  unless *exactly* one VPC is returned.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `vpc_id`. NOTE:\n      This will fail unless *exactly* one VPC is returned. Any filter\n      described in the docs for\n      [DescribeVpcs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeVpcs.html)\n      is valid.\n  \n  `vpc_id` take precedence over this.\n\n- `vpc_id` (string) - If launching into a VPC subnet, Packer needs the VPC ID\n  in order to create a temporary security group within the VPC. Requires\n  subnet_id to be set. If this field is left blank, Packer will try to get\n  the VPC ID from the subnet_id.\n\n- `windows_password_timeout` (duration string | ex: \"1h5m2s\") - The timeout for waiting for a Windows\n  password for Windows instances. Defaults to 20 minutes. Example value:\n  10m\n\n- `metadata_options` (MetadataOptions) - [Metadata Settings](#metadata-settings)\n\n- `ssh_interface` (string) - One of `public_ip`, `private_ip`, `public_dns`, `private_dns` or `session_manager`.\n     If set, either the public IP address, private IP address, public DNS name\n     or private DNS name will be used as the host for SSH. The default behaviour\n     if inside a VPC is to use the public IP address if available, otherwise\n     the private IP address will be used. If not in a VPC the public DNS name\n     will be used. Also works for WinRM.\n  \n     Where Packer is configured for an outbound proxy but WinRM traffic\n     should be direct, `ssh_interface` must be set to `private_dns` and\n     `\u003cregion\u003e.compute.internal` included in the `NO_PROXY` environment\n     variable.\n  \n     When using `session_manager` the machine running Packer must have\n  \t  the AWS Session Manager Plugin installed and within the users' system path.\n     Connectivity via the `session_manager` interface establishes a secure tunnel\n     between the local host and the remote host on an available local port to the specified `ssh_port`.\n     See [Session Manager Connections](#session-manager-connections) for more information.\n     - Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM communicator.\n     - Upon termination the secure tunnel will be terminated automatically, if however there is a failure in\n     terminating the tunnel it will automatically terminate itself after 20 minutes of inactivity.\n\n- `pause_before_ssm` (duration string | ex: \"1h5m2s\") - The time to wait before establishing the Session Manager session.\n  The value of this should be a duration. Examples are\n  `5s` and `1m30s` which will cause Packer to wait five seconds and one\n  minute 30 seconds, respectively. If no set, defaults to 10 seconds.\n  This option is useful when the remote port takes longer to become available.\n\n- `session_manager_port` (int) - Which port to connect the local end of the session tunnel to. If\n  left blank, Packer will choose a port for you from available ports.\n  This option is only used when `ssh_interface` is set `session_manager`.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n#### Metadata Settings\n\n\u003c!-- Code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\nConfigures the metadata options.\nSee [Configure IMDS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html) for details.\n\n\u003c!-- End of code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `http_endpoint` (string) - A string to enable or disable the IMDS endpoint for an instance. Defaults to enabled.\n  Accepts either \"enabled\" or \"disabled\"\n\n- `http_tokens` (string) - A string to either set the use of IMDSv2 for the instance to optional or required. Defaults to \"optional\".\n  Accepts either \"optional\" or \"required\"\n\n- `http_put_response_hop_limit` (int64) - A numerical value to set an upper limit for the amount of hops allowed when communicating with IMDS endpoints.\n  Defaults to 1.\n\n- `instance_metadata_tags` (string) - A string to enable or disable access to instance tags from the instance metadata. Defaults to disabled.\n  Access to instance metadata tags is available for commercial regions. For non-commercial regions please check availability before enabling.\n  Accepts either \"enabled\" or \"disabled\"\n\n\u003c!-- End of code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; --\u003e\n\n\nUsage Example\n\n**HCL2**\n\n```hcl\nsource \"amazon-ebs\" \"basic-example\" {\n  region        =  \"us-east-1\"\n  source_ami    =  \"ami-fce3c696\"\n  instance_type =  \"t2.micro\"\n  ssh_username  =  \"ubuntu\"\n  ami_name      =  \"packer_AWS_example_{{timestamp}}\"\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens = \"required\"\n    http_put_response_hop_limit = 1\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"aws_access_key\": \"{{env `AWS_ACCESS_KEY_ID`}}\",\n    \"aws_secret_key\": \"{{env `AWS_SECRET_ACCESS_KEY`}}\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"access_key\": \"{{user `aws_access_key`}}\",\n      \"secret_key\": \"{{user `aws_secret_key`}}\",\n      \"region\": \"us-east-1\",\n      \"source_ami\": \"ami-fce3c696\",\n      \"instance_type\": \"t2.micro\",\n      \"ssh_username\": \"ubuntu\",\n      \"ami_name\": \"packer_AWS {{timestamp}}\",\n      \"metadata_options\": {\n        \"http_endpoint\": \"enabled\",\n        \"http_tokens\": \"required\",\n        \"http_put_response_hop_limit\": 1\n      }\n    }\n  ]\n}\n```\n\n##### Enforce Instance Metadata Service v2\n\nThe Amazon builder has support for enforcing metadata service v2 (imdsv2) on a running instance and on the resulting AMI generated from a Packer build. \nTo enable support for both there are two key attributes that must be defined. \n\n**HCL2**\n\n```hcl\nsource \"amazon-ebs\" \"basic-example\" {\n  region        =  \"us-east-1\"\n  source_ami    =  \"ami-fce3c696\"\n  instance_type =  \"t2.micro\"\n  ssh_username  =  \"ubuntu\"\n  ami_name      =  \"packer_AWS_example_{{timestamp}}\"\n  # enforces imdsv2 support on the running instance being provisioned by Packer\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens = \"required\"\n    http_put_response_hop_limit = 1\n  }\n  imds_support  = \"v2.0\" # enforces imdsv2 support on the resulting AMI\n}\n```\n\n### Session Manager Connections\n\nSupport for the AWS Systems Manager session manager lets users manage EC2 instances without the need to open inbound ports, or maintain bastion hosts. Session manager connectivity relies on the use of the [session manager plugin](#session-manager-plugin) to open a secure tunnel between the local machine and the remote instance. Once the tunnel has been created all SSH communication will be tunneled through SSM to the remote instance.\n\n-\u003e Note: Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM Communicator.\n\nTo use the session manager as the connection interface for the SSH communicator you need to add the following configuration options to the Amazon builder options:\n\n- `ssh_interface`: The ssh interface must be set to \"session_manager\". When using this option the builder will create an SSM tunnel to the configured `ssh_port` (defaults to 22) on the remote host.\n- `iam_instance_profile`: A valid instance profile granting Systems Manager permissions to manage the remote instance is required in order for the aws ssm-agent to start and stop session connections.\n  See below for more details on [IAM instance profile for Systems Manager](#iam-instance-profile-for-systems-manager).\n\n#### Optional\n\n- `session_manager_port`: A local port on the host machine that should be used as the local end of the session tunnel to the remote host. If not specified Packer will find an available port to use.\n- `temporary_iam_instance_profile_policy_document`: Creates a temporary instance profile policy document to grant Systems Manager permissions to the Ec2 instance. This is an alternative to using an existing `iam_instance_profile`.\n\nHCL2 example:\n\n```hcl\n# file: example.pkr.hcl\n\n# In order to get these variables to read from the environment,\n# set the environment variables to have the same name as the declared\n# variables, with the prefix PKR_VAR_.\n# You could also hardcode them into the file, but we do not recommend that.\n\ndata \"amazon-ami\" \"example\" {\n  filters = {\n    virtualization-type = \"hvm\"\n    name                = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n    root-device-type    = \"ebs\"\n  }\n  owners      = [\"099720109477\"]\n  most_recent = true\n  region      = \"us-east-1\"\n}\n\nsource \"amazon-ebs\" \"ssm-example\" {\n  ami_name             = \"packer_AWS {{timestamp}}\"\n  instance_type        = \"t2.micro\"\n  region               = \"us-east-1\"\n  source_ami           = data.amazon-ami.example.id\n  ssh_username         = \"ubuntu\"\n  ssh_interface        = \"session_manager\"\n  communicator         = \"ssh\"\n  iam_instance_profile = \"myinstanceprofile\"\n}\n\nbuild {\n  sources = [\"source.amazon-ebs.ssm-example\"]\n\n  provisioner \"shell\" {\n    inline = [\"echo Connected via SSM at '${build.User}@${build.Host}:${build.Port}'\"]\n  }\n}\n```\n\nJSON example:\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"ami_name\": \"packer-ami-{{timestamp}}\",\n      \"instance_type\": \"t2.micro\",\n      \"source_ami_filter\": {\n        \"filters\": {\n          \"virtualization-type\": \"hvm\",\n          \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n          \"root-device-type\": \"ebs\"\n        },\n        \"owners\": [\"099720109477\"],\n        \"most_recent\": true\n      },\n      \"ssh_username\": \"ubuntu\",\n      \"ssh_interface\": \"session_manager\",\n      \"communicator\": \"ssh\",\n      \"iam_instance_profile\": \"{{user `iam_instance_profile`}}\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"type\": \"shell\",\n      \"inline\": [\n        \"echo Connected via SSM at '{{build `User`}}@{{build `Host`}}:{{build `Port`}}'\"\n      ]\n    }\n  ]\n}\n```\n\n#### Session Manager Plugin\n\nConnectivity via the session manager requires the use of a session-manger-plugin, which needs to be installed alongside Packer, and an instance AMI that is capable of running the AWS ssm-agent - see [About SSM Agent](https://docs.aws.amazon.com/systems-manager/latest/userguide/prereqs-ssm-agent.html) for details on supported AMIs.\n\nIn order for Packer to start and end sessions that connect you to your managed instances, you must first install the Session Manager plugin on your local machine. The plugin can be installed on supported versions of Microsoft Windows, macOS, Linux, and Ubuntu Server.\n[Installation instructions for the session-manager-plugin](https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html)\n\n#### IAM instance profile for Systems Manager\n\nBy default Systems Manager doesn't have permission to perform actions on created instances so SSM access must be granted by creating an instance profile with the `AmazonSSMManagedInstanceCore` policy. The instance profile can then be attached to any instance you wish to manage via the session-manager-plugin. See [Adding System Manager instance profile](https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html#instance-profile-add-permissions) for details on creating the required instance profile.\n\n#### Permissions for Closing the Tunnel\n\nTo close the SSM tunnels created, this plugin relies on being able to call\n[DescribeInstanceStatus](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstanceStatus.html).\nIn case this is not possible you might see a `Bad exit status` message in the logs.\n\nThe absence of this permission won't prevent you from building the AMI, and the error only means that packer is not able to close the tunnel gracefully.\n\n\n### Block Devices Configuration\n\nBlock devices can be nested in the\n[ami_block_device_mappings](#ami_block_device_mappings) or the\n[launch_block_device_mappings](#launch_block_device_mappings) array.\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\nThese will be attached when launching your instance. Your\noptions here may vary depending on the type of VM you use.\n\nExample use case:\n\nThe following mapping will tell Packer to encrypt the root volume of the\nbuild instance at launch using a specific non-default kms key:\n\nHCL2 example:\n\n```hcl\n\n\tlaunch_block_device_mappings {\n\t    device_name = \"/dev/sda1\"\n\t    encrypted = true\n\t    kms_key_id = \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n```\n\nJSON example:\n```json\n\"launch_block_device_mappings\": [\n\n\t{\n\t   \"device_name\": \"/dev/sda1\",\n\t   \"encrypted\": true,\n\t   \"kms_key_id\": \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n]\n```\n\nPlease note that the kms_key_id option in this example exists for\nlaunch_block_device_mappings but not ami_block_device_mappings.\n\nDocumentation for Block Devices Mappings can be found here:\nhttps://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n**Optional:**\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `delete_on_termination` (bool) - Indicates whether the EBS volume is deleted on instance termination.\n  Default false. NOTE: If this value is not explicitly set to true and\n  volumes are not cleaned up by an alternative method, additional volumes\n  will accumulate after every build.\n\n- `device_name` (string) - The device name exposed to the instance (for example, /dev/sdh or xvdh).\n  Required for every device in the block device mapping.\n\n- `encrypted` (boolean) - Indicates whether or not to encrypt the volume. By default, Packer will\n  keep the encryption setting to what it was in the source image. Setting\n  false will result in an unencrypted device, and true will result in an\n  encrypted one.\n\n- `iops` (\\*int64) - The number of I/O operations per second (IOPS) that the volume supports.\n  See the documentation on\n  [IOPs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `no_device` (bool) - Suppresses the specified device included in the block device mapping of\n  the AMI.\n\n- `snapshot_id` (string) - The ID of the snapshot.\n\n- `throughput` (\\*int64) - The throughput for gp3 volumes, only valid for gp3 types\n  See the documentation on\n  [Throughput](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `virtual_name` (string) - The virtual device name. See the documentation on Block Device Mapping\n  for more information.\n\n- `volume_type` (string) - The volume type. gp2 \u0026 gp3 for General Purpose (SSD) volumes, io1 \u0026 io2\n  for Provisioned IOPS (SSD) volumes, st1 for Throughput Optimized HDD,\n  sc1 for Cold HDD, and standard for Magnetic volumes.\n\n- `volume_size` (int64) - The size of the volume, in GiB. Required if not specifying a\n  snapshot_id.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for boot volume encryption.\n  This option exists for launch_block_device_mappings but not\n  ami_block_device_mappings. The kms key id defined here only applies to\n  the original build region; if the AMI gets copied to other regions, the\n  volume in those regions will be encrypted by the default EBS KMS key.\n  For valid formats see KmsKeyId in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html)\n  This field is validated by Packer. When using an alias, you will have to\n  prefix kms_key_id with alias/.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n### Communicator Configuration\n\n**Optional:**\n\n\u003c!-- Code generated from the comments of the Config struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `communicator` (string) - Packer currently supports three kinds of communicators:\n  \n  -   `none` - No communicator will be used. If this is set, most\n      provisioners also can't be used.\n  \n  -   `ssh` - An SSH connection will be established to the machine. This\n      is usually the default.\n  \n  -   `winrm` - A WinRM connection will be established.\n  \n  In addition to the above, some builders have custom communicators they\n  can use. For example, the Docker builder has a \"docker\" communicator\n  that uses `docker exec` and `docker cp` to execute scripts and copy\n  files.\n\n- `pause_before_connecting` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\n  guest's bootstrap script, but sometimes you may have a race condition\n  where you need Packer to wait before attempting to connect to your\n  guest.\n  \n  If you end up in this situation, you can use the template option\n  `pause_before_connecting`. By default, there is no pause. For example if\n  you set `pause_before_connecting` to `10m` Packer will check whether it\n  can connect, as normal. But once a connection attempt is successful, it\n  will disconnect and then wait 10 minutes before connecting to the guest\n  and beginning provisioning.\n\n\u003c!-- End of code generated from the comments of the Config struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSH struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ssh_host` (string) - The address to SSH to. This usually is automatically configured by the\n  builder.\n\n- `ssh_port` (int) - The port to connect to SSH. This defaults to `22`.\n\n- `ssh_username` (string) - The username to connect to SSH with. Required if using SSH.\n\n- `ssh_password` (string) - A plaintext password to use to authenticate with SSH.\n\n- `ssh_ciphers` ([]string) - This overrides the value of ciphers supported by default by Golang.\n  The default value is [\n    \"aes128-gcm@openssh.com\",\n    \"chacha20-poly1305@openssh.com\",\n    \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n  ]\n  \n  Valid options for ciphers include:\n  \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\",\n  \"chacha20-poly1305@openssh.com\",\n  \"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",\n\n- `ssh_clear_authorized_keys` (bool) - If true, Packer will attempt to remove its temporary key from\n  `~/.ssh/authorized_keys` and `/root/.ssh/authorized_keys`. This is a\n  mostly cosmetic option, since Packer will delete the temporary private\n  key from the host system regardless of whether this is set to true\n  (unless the user has set the `-debug` flag). Defaults to \"false\";\n  currently only works on guests with `sed` installed.\n\n- `ssh_key_exchange_algorithms` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\n  supported by default by Golang. Acceptable values include:\n  \"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\",\n  \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n  \"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".\n\n- `ssh_certificate_file` (string) - Path to user certificate used to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_pty` (bool) - If `true`, a PTY will be requested for the SSH connection. This defaults\n  to `false`.\n\n- `ssh_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\n  determine when the machine has booted so this is usually quite long.\n  Example value: `10m`.\n  This defaults to `5m`, unless `ssh_handshake_attempts` is set.\n\n- `ssh_disable_agent_forwarding` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `false`.\n\n- `ssh_handshake_attempts` (int) - The number of handshakes to attempt with SSH once it can connect.\n  This defaults to `10`, unless a `ssh_timeout` is set.\n\n- `ssh_bastion_host` (string) - A bastion host to use for the actual SSH connection.\n\n- `ssh_bastion_port` (int) - The port of the bastion host. Defaults to `22`.\n\n- `ssh_bastion_agent_auth` (bool) - If `true`, the local SSH agent will be used to authenticate with the\n  bastion host. Defaults to `false`.\n\n- `ssh_bastion_username` (string) - The username to connect to the bastion host.\n\n- `ssh_bastion_password` (string) - The password to use to authenticate with the bastion host.\n\n- `ssh_bastion_interactive` (bool) - If `true`, the keyboard-interactive used to authenticate with bastion host.\n\n- `ssh_bastion_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with the\n  bastion host. The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_bastion_certificate_file` (string) - Path to user certificate used to authenticate with bastion host.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_file_transfer_method` (string) - `scp` or `sftp` - How to transfer files, Secure copy (default) or SSH\n  File Transfer Protocol.\n  \n  **NOTE**: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n  (the default protocol for copying data) returns a a non-zero error code since the MOTW\n  cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\n  with SFTP instead `ssh_file_transfer_protocol = \"sftp\"`.\n\n- `ssh_proxy_host` (string) - A SOCKS proxy host to use for SSH connection\n\n- `ssh_proxy_port` (int) - A port of the SOCKS proxy. Defaults to `1080`.\n\n- `ssh_proxy_username` (string) - The optional username to authenticate with the proxy server.\n\n- `ssh_proxy_password` (string) - The optional password to use to authenticate with the proxy server.\n\n- `ssh_keep_alive_interval` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\n  value (`-1s`) to disable. Example value: `10s`. Defaults to `5s`.\n\n- `ssh_read_write_timeout` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\n  useful if, for example, packer hangs on a connection after a reboot.\n  Example: `5m`. Disabled by default.\n\n- `ssh_remote_tunnels` ([]string) - \n\n- `ssh_local_tunnels` ([]string) - \n\n\u003c!-- End of code generated from the comments of the SSH struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `temporary_key_pair_type` (string) - `dsa` | `ecdsa` | `ed25519` | `rsa` ( the default )\n  \n  Specifies the type of key to create. The possible values are 'dsa',\n  'ecdsa', 'ed25519', or 'rsa'.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure, please\n  consider other alternatives like RSA or ED25519.\n\n- `temporary_key_pair_bits` (int) - Specifies the number of bits in the key to create. For RSA keys, the\n  minimum size is 1024 bits and the default is 4096 bits. Generally, 3072\n  bits is considered sufficient. DSA keys must be exactly 1024 bits as\n  specified by FIPS 186-2. For ECDSA keys, bits determines the key length\n  by selecting from one of three elliptic curve sizes: 256, 384 or 521\n  bits. Attempting to use bit lengths other than these three values for\n  ECDSA keys will fail. Ed25519 keys have a fixed length and bits will be\n  ignored.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure as specified\n  by FIPS 186-5, please consider other alternatives like RSA or ED25519.\n\n\u003c!-- End of code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; --\u003e\n\n\n- `ssh_keypair_name` (string) - If specified, this is the key that will be used for SSH with the\n  machine. The key must match a key pair name loaded up into the remote.\n  By default, this is blank, and Packer will generate a temporary keypair\n  unless [`ssh_password`](#ssh_password) is used.\n  [`ssh_private_key_file`](#ssh_private_key_file) or\n  [`ssh_agent_auth`](#ssh_agent_auth) must be specified when\n  [`ssh_keypair_name`](#ssh_keypair_name) is utilized.\n\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n- `ssh_agent_auth` (bool) - If true, the local SSH agent will be used to authenticate connections to\n  the source instance. No temporary keypair will be created, and the\n  values of [`ssh_password`](#ssh_password) and\n  [`ssh_private_key_file`](#ssh_private_key_file) will be ignored. The\n  environment variable `SSH_AUTH_SOCK` must be set for this option to work\n  properly.\n\n\n## Basic Example\n\nHere is a basic example. You will need to provide access keys, and may need to\nchange the AMI IDs according to what images exist at the time the template is\nrun:\n\n**HCL2**\n\n```hcl\n// To make Packer read these variables from the environment into the var object,\n// set the environment variables to have the same name as the declared\n// variables, with the prefix PKR_VAR_.\n\n// There are other ways to [set variables](/packer/docs/templates/hcl_templates/variables#assigning-values-to-build-variables)\n// including from a var file or as a command argument.\n\n// export PKR_VAR_aws_access_key=$YOURKEY\nvariable \"aws_access_key\" {\n  type = string\n  // default = \"hardcoded_key\"\n}\n\n// export PKR_VAR_aws_secret_key=$YOURSECRETKEY\nvariable \"aws_secret_key\" {\n  type = string\n  // default = \"hardcoded_secret_key\"\n}\n\nsource \"amazon-ebs\" \"basic-example\" {\n  access_key = var.aws_access_key\n  secret_key =  var.aws_secret_key\n  region =  \"us-east-1\"\n  source_ami =  \"ami-fce3c696\"\n  instance_type =  \"t2.micro\"\n  ssh_username =  \"ubuntu\"\n  ami_name =  \"packer_AWS {{timestamp}}\"\n}\n\nbuild {\n  sources = [\n    \"source.amazon-ebs.basic-example\"\n  ]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n  \"aws_access_key\": \"{{env `AWS_ACCESS_KEY_ID`}}\",\n  \"aws_secret_key\": \"{{env `AWS_SECRET_ACCESS_KEY`}}\"\n},\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"access_key\": \"{{user `aws_access_key`}}\",\n      \"secret_key\": \"{{user `aws_secret_key`}}\",\n      \"region\": \"us-east-1\",\n      \"source_ami\": \"ami-fce3c696\",\n      \"instance_type\": \"t2.micro\",\n      \"ssh_username\": \"ubuntu\",\n      \"ami_name\": \"packer_AWS {{timestamp}}\"\n    }\n  ]\n}\n```\n\n\n-\u003e **Note:** Packer can also read the access key and secret access key directly\nfrom environmental variables instead of being set as user variables. See the\nconfiguration reference in the section above for more information on what\nenvironmental variables Packer will look for.\n\nFurther information on locating AMI IDs and their relationship to instance\ntypes and regions can be found in the AWS EC2 Documentation [for\nLinux](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/finding-an-ami.html)\nor [for\nWindows](http://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/finding-an-ami.html).\n\n### Fast Launch Config\n\n\u003c!-- Code generated from the comments of the FastLaunchConfig struct in builder/ebs/fast_launch_setup.go; DO NOT EDIT MANUALLY --\u003e\n\nFastLaunchConfig is the configuration for setting up fast-launch for Windows AMIs\n\nNOTE: requires the Windows image to be sysprep'd to enable fast-launch. See the\nAWS docs for more information:\nhttps://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/win-ami-config-fast-launch.html\n\n\u003c!-- End of code generated from the comments of the FastLaunchConfig struct in builder/ebs/fast_launch_setup.go; --\u003e\n\n\n**Optional:**\n\n\u003c!-- Code generated from the comments of the FastLaunchConfig struct in builder/ebs/fast_launch_setup.go; DO NOT EDIT MANUALLY --\u003e\n\n- `enable_fast_launch` (bool) - Configure fast-launch for Windows AMIs\n\n- `template_id` (string) - The ID of the launch template to use for fast launch for the main AMI.\n  \n  This cannot be specified in conjunction with the template name.\n  \n  If no template is specified, the default launch template will be used,\n  as specified in the AWS docs.\n  \n  If you copy the AMI to other regions, this option should not\n  be used, use instead the `fast_launch_template_config` option.\n\n- `template_name` (string) - The name of the launch template to use for fast launch for the main AMI.\n  \n  This cannot be specified in conjunction with the template ID.\n  \n  If no template is specified, the default launch template will be used,\n  as specified in the AWS docs.\n  \n  If you copy the AMI to other regions, this option should not\n  be used, use instead the `fast_launch_template_config` option.\n\n- `template_version` (int) - The version of the launch template to use for fast launch for the main AMI.\n  \n  If unspecified, and a template is referenced, this will default to\n  the latest version available for the template.\n  \n  If you copy the AMI to other regions, this option should not\n  be used, use instead the `fast_launch_template_config` option.\n\n- `region_launch_templates` ([]FastLaunchTemplateConfig) - RegionLaunchTemplates is the list of launch templates per region.\n  \n  This should be specified if you want to use a custom launch\n  template for your fast-launched images, and you are copying\n  the image to other regions.\n  \n  All regions don't need a launch template configuration, but for\n  each that don't have a launch template specified, AWS will pick\n  a default one for that purpose.\n  \n  For information about each entry, refer to the\n  [Fast Launch Template Config](#fast-launch-template-config) documentation.\n\n- `max_parallel_launches` (int) - Maximum number of instances to launch for creating pre-provisioned snapshots\n  \n  If specified, must be a minimum of `6`\n\n- `target_resource_count` (int) - The number of snapshots to pre-provision for later launching windows instances\n  from the resulting fast-launch AMI.\n  \n  If unspecified, this will create the default number of snapshots (as of\n  march 2023, this defaults to 5 on AWS)\n\n\u003c!-- End of code generated from the comments of the FastLaunchConfig struct in builder/ebs/fast_launch_setup.go; --\u003e\n\n\n#### Fast Launch Template Config\n\n\u003c!-- Code generated from the comments of the FastLaunchTemplateConfig struct in builder/ebs/fast_launch_setup.go; DO NOT EDIT MANUALLY --\u003e\n\n- `region` (string) - The region in which to find the launch template to use\n\n\u003c!-- End of code generated from the comments of the FastLaunchTemplateConfig struct in builder/ebs/fast_launch_setup.go; --\u003e\n\n\n**Optional:**\n\n\u003c!-- Code generated from the comments of the FastLaunchTemplateConfig struct in builder/ebs/fast_launch_setup.go; DO NOT EDIT MANUALLY --\u003e\n\n- `template_id` (string) - The ID of the launch template to use for the fast launch\n  \n  This cannot be specified in conjunction with the template name.\n  \n  If no template is specified, the default launch template will be used,\n  as specified in the AWS docs.\n\n- `template_name` (string) - The name of the launch template to use for fast launch\n  \n  This cannot be specified in conjunction with the template ID.\n  \n  If no template is specified, the default launch template will be used,\n  as specified in the AWS docs.\n\n- `template_version` (int) - The version of the launch template to use\n  \n  If unspecified, and a template is referenced, this will default to\n  the latest version available for the template.\n\n\u003c!-- End of code generated from the comments of the FastLaunchTemplateConfig struct in builder/ebs/fast_launch_setup.go; --\u003e\n\n\n## Accessing the Instance to Debug\n\nIf you need to access the instance to debug for some reason, run the builder\nwith the `-debug` flag. In debug mode, the Amazon builder will save the private\nkey in the current directory and will output the DNS or IP information as well.\nYou can use this information to access the instance as it is running.\n\n## AMI Block Device Mappings Example\n\nHere is an example using the optional AMI block device mappings. Our\nconfiguration of `launch_block_device_mappings` will expand the root volume\n(`/dev/sda`) to 40gb during the build (up from the default of 8gb). With\n`ami_block_device_mappings` AWS will attach additional volumes `/dev/sdb` and\n`/dev/sdc` when we boot a new instance of our AMI.\n\n**HCL2**\n\n```hcl\nsource \"amazon-ebs\" \"basic-example\" {\n  region        =  \"us-east-1\"\n  source_ami    =  \"ami-fce3c696\"\n  instance_type =  \"t2.micro\"\n  ssh_username  =  \"ubuntu\"\n  ami_name      =  \"packer_AWS_example_{{timestamp}}\"\n  launch_block_device_mappings {\n    device_name = \"/dev/sda1\"\n    volume_size = 40\n    volume_type = \"gp2\"\n    delete_on_termination = true\n  }\n  // Notice that instead of providing a list of mappings, you are just providing\n  // multiple mappings in a row. This diverges from the JSON template format.\n  ami_block_device_mappings {\n    device_name  = \"/dev/sdb\"\n    virtual_name = \"ephemeral0\"\n  }\n  ami_block_device_mappings {\n    device_name  = \"/dev/sdc\"\n    virtual_name = \"ephemeral1\"\n  }\n}\n\nbuild {\n  sources = [\n    \"source.amazon-ebs.basic-example\"\n  ]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"region\": \"us-east-1\",\n      \"source_ami\": \"ami-fce3c696\",\n      \"instance_type\": \"t2.micro\",\n      \"ssh_username\": \"ubuntu\",\n      \"ami_name\": \"packer-quick-start {{timestamp}}\",\n      \"launch_block_device_mappings\": [\n        {\n          \"device_name\": \"/dev/sda1\",\n          \"volume_size\": 40,\n          \"volume_type\": \"gp2\",\n          \"delete_on_termination\": true\n        }\n      ],\n      \"ami_block_device_mappings\": [\n        {\n          \"device_name\": \"/dev/sdb\",\n          \"virtual_name\": \"ephemeral0\"\n        },\n        {\n          \"device_name\": \"/dev/sdc\",\n          \"virtual_name\": \"ephemeral1\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n\nThe above build template is functional assuming you have set the environment\nvariables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY.\n\n-\u003e **Note:** Packer uses pre-built AMIs as the source for building images.\nThese source AMIs may include volumes that are not flagged to be destroyed on\ntermination of the instance building the new image. Packer will attempt to\nclean up all residual volumes that are not designated by the user to remain\nafter termination. If you need to preserve those source volumes, you can\noverwrite the termination setting by setting `delete_on_termination` to `false`\nin the `launch_block_device_mappings` block for the device.\n\n## Build template data\n\nIn configuration directives marked as a template engine above, the following\nvariables are available:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n- `SourceAMITags` - The source AMI Tags, as a `map[string]string` object.\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](/packer/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](/packer/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n\nUsage example:\n\n**HCL2**\n\n```hcl\n# When accessing one of these variables from inside the builder, you need to\n# use the golang templating syntax. This is due to an architectural quirk that\n# won't be easily resolvable until legacy json templates are deprecated:\nbuild {\n  source \"amazon-ebs\" \"basic-example\" {\n    tags = {\n    OS_Version = \"Ubuntu\"\n    Release = \"Latest\"\n    Base_AMI_ID = \"{{ .SourceAMI }}\"\n    Base_AMI_Name = \"{{ .SourceAMIName }}\"\n    }\n  }\n\n  // when accessing one of the variables from a provisioner or post-processor, use\n  // hcl-syntax\n  post-processor \"manifest\" {\n    output = \"manifest.json\"\n    strip_path = true\n    custom_data = {\n    source_ami_name = \"${build.SourceAMIName}\"\n  }\n}\n```\n\n**JSON**\n\n```json\n\"post-processors\": [\n    {\n      \"type\": \"manifest\",\n      \"output\": \"manifest.json\",\n      \"strip_path\": true,\n      \"custom_data\": {\n        \"source_ami_name\": \"{{ build `SourceAMIName` }}\"\n      }\n    }\n]\n```\n\n\n## Tag Example\n\nHere is an example using the optional AMI tags. This will add the tags\n`OS_Version` and `Release` to the finished AMI. As before, you will need to\nprovide your access keys, and may need to change the source AMI ID based on\nwhat images exist when this template is run:\n\n**HCL2**\n\n```hcl\nsource \"amazon-ebs\" \"basic-example\" {\n  region =  \"us-east-1\"\n  source_ami =  \"ami-fce3c696\"\n  instance_type =  \"t2.micro\"\n  ssh_username =  \"ubuntu\"\n  ami_name =  \"packer_tag_example {{timestamp}}\"\n  tags = {\n      OS_Version = \"Ubuntu\"\n      Release = \"Latest\"\n      Base_AMI_Name = \"{{ .SourceAMIName }}\"\n      Extra = \"{{ .SourceAMITags.TagName }}\"\n  }\n}\n\nbuild {\n  sources = [\n    \"source.amazon-ebs.basic-example\"\n  ]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n      {\n      \"type\": \"amazon-ebs\",\n      \"region\": \"us-east-1\",\n      \"source_ami\": \"ami-fce3c696\",\n      \"instance_type\": \"t2.micro\",\n      \"ssh_username\": \"ubuntu\",\n      \"ami_name\": \"packer-tag-example {{timestamp}}\",\n      \"tags\": {\n        \"OS_Version\": \"Ubuntu\",\n        \"Release\": \"Latest\",\n        \"Base_AMI_Name\": \"{{ .SourceAMIName }}\",\n        \"Extra\": \"{{ .SourceAMITags.TagName }}\"\n      }\n    }\n  ]\n}\n```\n\n\n## Connecting to Windows instances using WinRM\n\nIf you want to launch a Windows instance and connect using WinRM, you will need\nto configure WinRM on that instance. The following is a basic powershell script\nthat can be supplied to AWS using the \"user_data_file\" option. It enables\nWinRM via HTTPS on port 5986, and creates a self-signed certificate to use to\nconnect. If you are using a certificate from a CA, rather than creating a\nself-signed certificate, you can omit the \"winrm_insecure\" option mentioned\nbelow.\n\nautogenerated_password_https_bootstrap.txt\n\n```powershell\n\u003cpowershell\u003e\n\n# MAKE SURE IN YOUR PACKER CONFIG TO SET:\n#\n#\n#    \"winrm_username\": \"Administrator\",\n#    \"winrm_insecure\": true,\n#    \"winrm_use_ssl\": true,\n#\n#\n\n\nwrite-output \"Running User Data Script\"\nwrite-host \"(host) Running User Data Script\"\n\nSet-ExecutionPolicy Unrestricted -Scope LocalMachine -Force -ErrorAction Ignore\n\n# Don't set this before Set-ExecutionPolicy as it throws an error\n$ErrorActionPreference = \"stop\"\n\n# Remove HTTP listener\nRemove-Item -Path WSMan:\\Localhost\\listener\\listener* -Recurse\n\n# Create a self-signed certificate to let ssl work\n$Cert = New-SelfSignedCertificate -CertstoreLocation Cert:\\LocalMachine\\My -DnsName \"packer\"\nNew-Item -Path WSMan:\\LocalHost\\Listener -Transport HTTPS -Address * -CertificateThumbPrint $Cert.Thumbprint -Force\n\n# WinRM\nwrite-output \"Setting up WinRM\"\nwrite-host \"(host) setting up WinRM\"\n\ncmd.exe /c winrm quickconfig -q\ncmd.exe /c winrm set \"winrm/config\" '@{MaxTimeoutms=\"1800000\"}'\ncmd.exe /c winrm set \"winrm/config/winrs\" '@{MaxMemoryPerShellMB=\"1024\"}'\ncmd.exe /c winrm set \"winrm/config/service\" '@{AllowUnencrypted=\"true\"}'\ncmd.exe /c winrm set \"winrm/config/client\" '@{AllowUnencrypted=\"true\"}'\ncmd.exe /c winrm set \"winrm/config/service/auth\" '@{Basic=\"true\"}'\ncmd.exe /c winrm set \"winrm/config/client/auth\" '@{Basic=\"true\"}'\ncmd.exe /c winrm set \"winrm/config/service/auth\" '@{CredSSP=\"true\"}'\ncmd.exe /c winrm set \"winrm/config/listener?Address=*+Transport=HTTPS\" \"@{Port=`\"5986`\";Hostname=`\"packer`\";CertificateThumbprint=`\"$($Cert.Thumbprint)`\"}\"\ncmd.exe /c netsh advfirewall firewall set rule group=\"remote administration\" new enable=yes\ncmd.exe /c netsh firewall add portopening TCP 5986 \"Port 5986\"\ncmd.exe /c net stop winrm\ncmd.exe /c sc config winrm start= auto\ncmd.exe /c net start winrm\n\n\u003c/powershell\u003e\n```\n\nYou'll notice that this config does not define a user or password; instead,\nPacker will ask AWS to provide a random password that it generates\nautomatically. The following config will work with the above template:\n\n**HCL2**\n\n```hcl\n# This example uses a amazon-ami data source rather than a specific AMI.\n# this allows us to use the same filter regardless of what region we're in,\n# among other benefits.\ndata \"amazon-ami\" \"example\" {\n  filters = {\n    virtualization-type = \"hvm\"\n    name                = \"*Windows_Server-2012*English-64Bit-Base*\"\n    root-device-type    = \"ebs\"\n  }\n  owners      = [\"amazon\"]\n  most_recent = true\n  # Access Region Configuration\n  region      = \"us-east-1\"\n}\n\nsource \"amazon-ebs\" \"winrm-example\" {\n  region =  \"us-east-1\"\n  source_ami = data.amazon-ami.example.id\n  instance_type =  \"t2.micro\"\n  ami_name =  \"packer_winrm_example {{timestamp}}\"\n  # This user data file sets up winrm and configures it so that the connection\n  # from Packer is allowed. Without this file being set, Packer will not\n  # connect to the instance.\n  user_data_file = \"../boot_config/winrm_bootstrap.txt\"\n  communicator = \"winrm\"\n  force_deregister = true\n  winrm_insecure = true\n  winrm_username = \"Administrator\"\n  winrm_use_ssl = true\n}\n\nbuild {\n  sources = [\n    \"source.amazon-ebs.winrm-example\"\n  ]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"region\": \"us-east-1\",\n      \"instance_type\": \"t2.micro\",\n      \"source_ami_filter\": {\n        \"filters\": {\n          \"virtualization-type\": \"hvm\",\n          \"name\": \"*Windows_Server-2012*English-64Bit-Base*\",\n          \"root-device-type\": \"ebs\"\n        },\n        \"most_recent\": true,\n        \"owners\": \"amazon\"\n      },\n      \"ami_name\": \"default-packer\",\n      \"user_data_file\": \"./boot_config/winrm_bootstrap.txt\",\n      \"communicator\": \"winrm\",\n      \"force_deregister\": true,\n      \"winrm_insecure\": true,\n      \"winrm_username\": \"Administrator\",\n      \"winrm_use_ssl\": true\n    }\n  ]\n}\n```\n\n\n## Windows 2016 Sysprep Commands - For Amazon Windows AMIs Only\n\nFor Amazon Windows 2016 AMIs it is necessary to run Sysprep commands which can\nbe easily added to the provisioner section.\n\n**HCL2**\n\n```hcl\nprovisioner \"powershell\" {\n  inline = [\n    \"C:/ProgramData/Amazon/EC2-Windows/Launch/Scripts/InitializeInstance.ps1 -Schedule\",\n    \"C:/ProgramData/Amazon/EC2-Windows/Launch/Scripts/SysprepInstance.ps1 -NoShutdown\"\n  ]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"type\": \"powershell\",\n  \"inline\": [\n    \"C:/ProgramData/Amazon/EC2-Windows/Launch/Scripts/InitializeInstance.ps1 -Schedule\",\n    \"C:/ProgramData/Amazon/EC2-Windows/Launch/Scripts/SysprepInstance.ps1 -NoShutdown\"\n  ]\n}\n```\n\n\n## Which SSH Options to use:\n\nThis chart breaks down what Packer does if you set any of the below SSH options:\n\n| ssh_password | ssh_private_key_file | ssh_keypair_name | temporary_key_pair_name | Packer will...                                                                             |\n| ------------ | -------------------- | ---------------- | ----------------------- | ------------------------------------------------------------------------------------------ |\n| X            | -                    | -                | -                       | ssh authenticating with username and given password                                        |\n| -            | X                    | -                | -                       | ssh authenticating with private key file                                                   |\n| -            | X                    | X                | -                       | ssh authenticating with given private key file and \"attaching\" the keypair to the instance |\n| -            | -                    | -                | X                       | Create a temporary ssh keypair with a particular name, clean it up                         |\n| -            | -                    | -                | -                       | Create a temporary ssh keypair with a default name, clean it up                            |\n","created_at":"2024-04-17T16:47:56.529Z","updated_at":"2024-04-17T16:47:56.529Z","name":"Amazon EBS","slug":"ebs","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"56791af7-0293-43f5-9381-22ae43e541af","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `amazon-ebssurrogate`\nArtifact BuilderId: `mitchellh.amazon.ebssurrogate`\n\nThe `amazon-ebssurrogate` Packer builder is able to create Amazon AMIs by\nrunning a source instance with an attached volume, provisioning the attached\nvolume in such a way that it can be used as the root volume for the AMI, and\nthen snapshotting and creating the AMI from that volume.\n\nThis builder can therefore be used to bootstrap scratch-build images - for\nexample FreeBSD or Ubuntu using ZFS as the root file system.\n\nThis is all done in your own AWS account. This builder will create temporary\nkey pairs, security group rules, etc., that provide it temporary access to the\ninstance while the image is being created.\n\n## Configuration Reference\n\nThere are many configuration options available for the builder. In addition to\nthe items listed here, you will want to look at the general configuration\nreferences for [AMI](#ami-configuration),\n[BlockDevices](#block-devices-configuration),\n[Access](#access-configuration),\n[Run](#run-configuration) and\n[Communicator](#communicator-configuration)\nconfiguration references, which are\nnecessary for this build to succeed and can be found further down the page.\n\n### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/ebssurrogate/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_root_device` (RootBlockDevice) - A block device mapping describing the root device of the AMI. This looks\n  like the mappings in `ami_block_device_mapping`, except with an\n  additional field:\n  \n  -   `source_device_name` (string) - The device name of the block device on\n      the source instance to be used as the root device for the AMI. This\n      must correspond to a block device in `launch_block_device_mapping`.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/ebssurrogate/builder.go; --\u003e\n\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/ebssurrogate/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_block_device_mappings` (awscommon.BlockDevices) - Add one or more block device mappings to the AMI. These will be attached\n  when booting a new instance from your AMI. To add a block device during\n  the Packer build see `launch_block_device_mappings` below. Your options\n  here may vary depending on the type of VM you use. See the\n  [BlockDevices](#block-devices-configuration) documentation for fields.\n\n- `launch_block_device_mappings` (BlockDevices) - Add one or more block devices before the Packer build starts. If you add\n  instance store volumes or EBS volumes in addition to the root device\n  volume, the created AMI will contain block device mapping information\n  for those volumes. Amazon creates snapshots of the source instance's\n  root volume and any other EBS volumes described here. When you launch an\n  instance from this new AMI, the instance automatically launches with\n  these additional volumes, and will restore them from snapshots taken\n  from the source instance. See the\n  [BlockDevices](#block-devices-configuration) documentation for fields.\n\n- `run_volume_tags` (map[string]string) - Tags to apply to the volumes that are *launched* to create the AMI.\n  These tags are *not* applied to the resulting AMI unless they're\n  duplicated in `tags`. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `run_volume_tag` ([]{name string, value string}) - Same as [`run_volume_tags`](#run_volume_tags) but defined as a singular\n  block containing a `name` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](https://packer.io/docs/templates/hcl_templates/expressions.html#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `ami_architecture` (string) - what architecture to use when registering the final AMI; valid options\n  are \"arm64\", \"i386\", \"x86_64\", or \"x86_64_mac\". Defaults to \"x86_64\".\n\n- `boot_mode` (string) - The boot mode. Valid options are `legacy-bios` and `uefi`. See the documentation on\n  [boot modes](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ami-boot.html) for\n  more information. Defaults to `legacy-bios` when `ami_architecture` is `x86_64` and\n  `uefi` when `ami_architecture` is `arm64`.\n\n- `uefi_data` (string) - Base64 representation of the non-volatile UEFI variable store. For more information\n  see [AWS documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/uefi-secure-boot-optionB.html).\n\n- `tpm_support` (string) - NitroTPM Support. Valid options are `v2.0`. See the documentation on\n  [NitroTPM Support](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enable-nitrotpm-support-on-ami.html) for\n  more information. Only enabled if a valid option is provided, otherwise ignored.\n\n- `use_create_image` (bool) - Whether to use the CreateImage or RegisterImage API when creating the AMI.\n  When set to `true`, the CreateImage API is used and will create the image\n  from the instance itself, and inherit properties from the instance.\n  When set to `false`, the RegisterImage API is used and the image is created using\n  a snapshot of the specified EBS volume, and no properties are inherited from the instance.\n  Defaults to `false`.\n  Ref: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateImage.html\n      https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_RegisterImage.html\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/ebssurrogate/builder.go; --\u003e\n\n\n### AMI Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_name` (string) - The name of the resulting AMI that will appear when managing AMIs in the\n  AWS console or via APIs. This must be unique. To help make this unique,\n  use a function like timestamp (see [template\n  engine](/packer/docs/templates/legacy_json_templates/engine) for more info).\n\n\u003c!-- End of code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_description` (string) - The description to set for the resulting\n  AMI(s). By default this description is empty.  This is a\n  [template engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `ami_virtualization_type` (string) - The type of virtualization for the AMI\n  you are building. This option is required to register HVM images. Can be\n  paravirtual (default) or hvm.\n\n- `ami_users` ([]string) - A list of account IDs that have access to\n  launch the resulting AMI(s). By default no additional users other than the\n  user creating the AMI has permissions to launch it.\n\n- `ami_groups` ([]string) - A list of groups that have access to\n  launch the resulting AMI(s). By default no groups have permission to launch\n  the AMI. `all` will make the AMI publicly accessible.\n  AWS currently doesn't accept any value other than \"all\"\n\n- `ami_org_arns` ([]string) - A list of Amazon Resource Names (ARN) of AWS Organizations that have access to\n  launch the resulting AMI(s). By default no organizations have permission to launch\n  the AMI.\n\n- `ami_ou_arns` ([]string) - A list of Amazon Resource Names (ARN) of AWS Organizations organizational units (OU) that have access to\n  launch the resulting AMI(s). By default no organizational units have permission to launch\n  the AMI.\n\n- `ami_product_codes` ([]string) - A list of product codes to\n  associate with the AMI. By default no product codes are associated with the\n  AMI.\n\n- `ami_regions` ([]string) - A list of regions to copy the AMI to.\n  Tags and attributes are copied along with the AMI. AMI copying takes time\n  depending on the size of the AMI, but will generally take many minutes.\n\n- `skip_region_validation` (bool) - Set to true if you want to skip\n  validation of the ami_regions configuration option. Default false.\n\n- `tags` (map[string]string) - Key/value pair tags applied to the AMI. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n  \n  The builder no longer adds a \"Name\": \"Packer Builder\" entry to the tags.\n\n- `tag` ([]{key string, value string}) - Same as [`tags`](#tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `ena_support` (boolean) - Enable enhanced networking (ENA but not SriovNetSupport) on\n  HVM-compatible AMIs. If set, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy.\n  \n  Note: you must make sure enhanced networking is enabled on your\n  instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n\n- `sriov_support` (bool) - Enable enhanced networking (SriovNetSupport but not ENA) on\n  HVM-compatible AMIs. If true, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy. Note: you must make sure enhanced networking is enabled\n  on your instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n  Default `false`.\n\n- `force_deregister` (bool) - Force Packer to first deregister an existing\n  AMI if one with the same name already exists. Default false.\n\n- `force_delete_snapshot` (bool) - Force Packer to delete snapshots\n  associated with AMIs, which have been deregistered by force_deregister.\n  Default false.\n\n- `encrypt_boot` (boolean) - Whether or not to encrypt the resulting AMI when\n  copying a provisioned instance to an AMI. By default, Packer will keep\n  the encryption setting to what it was in the source image. Setting false\n  will result in an unencrypted image, and true will result in an encrypted\n  one.\n  \n  If you have used the `launch_block_device_mappings` to set an encryption\n  key and that key is the same as the one you want the image encrypted with\n  at the end, then you don't need to set this field; leaving it empty will\n  prevent an unnecessary extra copy step and save you some time.\n  \n  Please note that if you are using an account with the global \"Always\n  encrypt new EBS volumes\" option set to `true`, Packer will be unable to\n  override this setting, and the final image will be encrypted whether\n  you set this value or not.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for AMI encryption. This\n  only applies to the main `region` -- any regions the AMI gets copied to\n  will be encrypted by the default EBS KMS key for that region,\n  unless you set region-specific keys in `region_kms_key_ids`.\n  \n  Set this value if you select `encrypt_boot`, but don't want to use the\n  region's default KMS key.\n  \n  If you have a custom kms key you'd like to apply to the launch volume,\n  and are only building in one region, it is more efficient to leave this\n  and `encrypt_boot` empty and to instead set the key id in the\n  launch_block_device_mappings (you can find an example below). This saves\n  potentially many minutes at the end of the build by preventing Packer\n  from having to copy and re-encrypt the image at the end of the build.\n  \n  For valid formats see *KmsKeyId* in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html).\n  This field is validated by Packer, when using an alias, you will have to\n  prefix `kms_key_id` with `alias/`.\n\n- `region_kms_key_ids` (map[string]string) - regions to copy the ami to, along with the custom kms key id (alias or\n  arn) to use for encryption for that region. Keys must match the regions\n  provided in `ami_regions`. If you just want to encrypt using a default\n  ID, you can stick with `kms_key_id` and `ami_regions`. If you want a\n  region to be encrypted with that region's default key ID, you can use an\n  empty string `\"\"` instead of a key id in this map. (e.g. `\"us-east-1\":\n  \"\"`) However, you cannot use default key IDs if you are using this in\n  conjunction with `snapshot_users` -- in that situation you must use\n  custom keys. For valid formats see *KmsKeyId* in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html).\n  \n  This option supercedes the `kms_key_id` option -- if you set both, and\n  they are different, Packer will respect the value in\n  `region_kms_key_ids` for your build region and silently disregard the\n  value provided in `kms_key_id`.\n\n- `skip_save_build_region` (bool) - If true, Packer will not check whether an AMI with the `ami_name` exists\n  in the region it is building in. It will use an intermediary AMI name,\n  which it will not convert to an AMI in the build region. It will copy\n  the intermediary AMI into any regions provided in `ami_regions`, then\n  delete the intermediary AMI. Default `false`.\n\n- `imds_support` (string) - Enforce version of the Instance Metadata Service on the built AMI.\n  Valid options are unset (legacy) and `v2.0`. See the documentation on\n  [IMDS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html)\n  for more information. Defaults to legacy.\n\n\u003c!-- End of code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `snapshot_tags` (map[string]string) - Key/value pair tags to apply to snapshot. They will override AMI tags if\n  already applied to snapshot. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `snapshot_tag` ([]{key string, value string}) - Same as [`snapshot_tags`](#snapshot_tags) but defined as a singular\n  repeatable block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `snapshot_users` ([]string) - A list of account IDs that have\n  access to create volumes from the snapshot(s). By default no additional\n  users other than the user creating the AMI has permissions to create\n  volumes from the backing snapshot(s).\n\n- `snapshot_groups` ([]string) - A list of groups that have access to\n  create volumes from the snapshot(s). By default no groups have permission\n  to create volumes from the snapshot(s). all will make the snapshot\n  publicly accessible.\n\n\u003c!-- End of code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; --\u003e\n\n\n### Access Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_key` (string) - The access key used to communicate with AWS. [Learn how  to set this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials).\n  On EBS, this is not required if you are using `use_vault_aws_engine`\n  for authentication instead.\n\n- `region` (string) - The name of the region, such as `us-east-1`, in which\n  to launch the EC2 instance to create the AMI.\n  When chroot building, this value is guessed from environment.\n\n- `secret_key` (string) - The secret key used to communicate with AWS. [Learn how to set\n  this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials). This is not required\n  if you are using `use_vault_aws_engine` for authentication instead.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `assume_role` (AssumeRoleConfig) - If provided with a role ARN, Packer will attempt to assume this role\n  using the supplied credentials. See\n  [AssumeRoleConfig](#assume-role-configuration) below for more\n  details on all of the options available, and for a usage example.\n\n- `custom_endpoint_ec2` (string) - This option is useful if you use a cloud\n  provider whose API is compatible with aws EC2. Specify another endpoint\n  like this https://ec2.custom.endpoint.com.\n\n- `shared_credentials_file` (string) - Path to a credentials file to load credentials from\n\n- `decode_authorization_messages` (bool) - Enable automatic decoding of any encoded authorization (error) messages\n  using the `sts:DecodeAuthorizationMessage` API. Note: requires that the\n  effective user/role have permissions to `sts:DecodeAuthorizationMessage`\n  on resource `*`. Default `false`.\n\n- `insecure_skip_tls_verify` (bool) - This allows skipping TLS\n  verification of the AWS EC2 endpoint. The default is false.\n\n- `max_retries` (int) - This is the maximum number of times an API call is retried, in the case\n  where requests are being throttled or experiencing transient failures.\n  The delay between the subsequent API calls increases exponentially.\n\n- `mfa_code` (string) - The MFA\n  [TOTP](https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm)\n  code. This should probably be a user variable since it changes all the\n  time.\n\n- `profile` (string) - The profile to use in the shared credentials file for\n  AWS. See Amazon's documentation on [specifying\n  profiles](https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles)\n  for more details.\n\n- `skip_metadata_api_check` (bool) - Skip Metadata Api Check\n\n- `skip_credential_validation` (bool) - Set to true if you want to skip validating AWS credentials before runtime.\n\n- `token` (string) - The access token to use. This is different from the\n  access key and secret key. If you're not sure what this is, then you\n  probably don't need it. This will also be read from the AWS_SESSION_TOKEN\n  environmental variable.\n\n- `vault_aws_engine` (VaultAWSEngineOptions) - Get credentials from HashiCorp Vault's aws secrets engine. You must\n  already have created a role to use. For more information about\n  generating credentials via the Vault engine, see the [Vault\n  docs.](https://www.vaultproject.io/api/secret/aws#generate-credentials)\n  If you set this flag, you must also set the below options:\n  -   `name` (string) - Required. Specifies the name of the role to generate\n      credentials against. This is part of the request URL.\n  -   `engine_name` (string) - The name of the aws secrets engine. In the\n      Vault docs, this is normally referred to as \"aws\", and Packer will\n      default to \"aws\" if `engine_name` is not set.\n  -   `role_arn` (string)- The ARN of the role to assume if credential\\_type\n      on the Vault role is assumed\\_role. Must match one of the allowed role\n      ARNs in the Vault role. Optional if the Vault role only allows a single\n      AWS role ARN; required otherwise.\n  -   `ttl` (string) - Specifies the TTL for the use of the STS token. This\n      is specified as a string with a duration suffix. Valid only when\n      credential\\_type is assumed\\_role or federation\\_token. When not\n      specified, the default\\_sts\\_ttl set for the role will be used. If that\n      is also not set, then the default value of 3600s will be used. AWS\n      places limits on the maximum TTL allowed. See the AWS documentation on\n      the DurationSeconds parameter for AssumeRole (for assumed\\_role\n      credential types) and GetFederationToken (for federation\\_token\n      credential types) for more details.\n  \n  HCL2 example:\n  \n  ```hcl\n  vault_aws_engine {\n      name = \"myrole\"\n      role_arn = \"myarn\"\n      ttl = \"3600s\"\n  }\n  ```\n  \n  JSON example:\n  \n  ```json\n  {\n      \"vault_aws_engine\": {\n          \"name\": \"myrole\",\n          \"role_arn\": \"myarn\",\n          \"ttl\": \"3600s\"\n      }\n  }\n  ```\n\n- `aws_polling` (\\*AWSPollingConfig) - [Polling configuration](#polling-configuration) for the AWS waiter. Configures the waiter that checks\n  resource state.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Assume Role Configuration\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\nAssumeRoleConfig lets users set configuration options for assuming a special\nrole when executing Packer.\n\nUsage example:\n\nHCL config example:\n\n```HCL\n\n\tsource \"amazon-ebs\" \"example\" {\n\t\tassume_role {\n\t\t\trole_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n\t\t\tsession_name = \"SESSION_NAME\"\n\t\t\texternal_id  = \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\nJSON config example:\n\n```json\n\n\tbuilder{\n\t\t\"type\": \"amazon-ebs\",\n\t\t\"assume_role\": {\n\t\t\t\"role_arn\"    :  \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\",\n\t\t\t\"session_name\":  \"SESSION_NAME\",\n\t\t\t\"external_id\" :  \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `role_arn` (string) - Amazon Resource Name (ARN) of the IAM Role to assume.\n\n- `duration_seconds` (int) - Number of seconds to restrict the assume role session duration.\n\n- `external_id` (string) - The external ID to use when assuming the role. If omitted, no external\n  ID is passed to the AssumeRole call.\n\n- `policy` (string) - IAM Policy JSON describing further restricting permissions for the IAM\n  Role being assumed.\n\n- `policy_arns` ([]string) - Set of Amazon Resource Names (ARNs) of IAM Policies describing further\n  restricting permissions for the IAM Role being\n\n- `session_name` (string) - Session name to use when assuming the role.\n\n- `tags` (map[string]string) - Map of assume role session tags.\n\n- `transitive_tag_keys` ([]string) - Set of assume role session tag keys to pass to any subsequent sessions.\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Polling Configuration\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\nPolling configuration for the AWS waiter. Configures the waiter for resources creation or actions like attaching\nvolumes or importing image.\n\nHCL2 example:\n```hcl\n\n\taws_polling {\n\t\t delay_seconds = 30\n\t\t max_attempts = 50\n\t}\n\n```\n\nJSON example:\n```json\n\n\t\"aws_polling\" : {\n\t\t \"delay_seconds\": 30,\n\t\t \"max_attempts\": 50\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\n- `max_attempts` (int) - Specifies the maximum number of attempts the waiter will check for resource state.\n  This value can also be set via the AWS_MAX_ATTEMPTS.\n  If both option and environment variable are set, the max_attempts will be considered over the AWS_MAX_ATTEMPTS.\n  If none is set, defaults to AWS waiter default which is 40 max_attempts.\n\n- `delay_seconds` (int) - Specifies the delay in seconds between attempts to check the resource state.\n  This value can also be set via the AWS_POLL_DELAY_SECONDS.\n  If both option and environment variable are set, the delay_seconds will be considered over the AWS_POLL_DELAY_SECONDS.\n  If none is set, defaults to AWS waiter default which is 15 seconds.\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n### Run Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `instance_type` (string) - The EC2 instance type to use while building the\n  AMI, such as t2.small.\n\n- `source_ami` (string) - The source AMI whose root volume will be copied and\n  provisioned on the currently running instance. This must be an EBS-backed\n  AMI with a root volume snapshot that you have access to.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `associate_public_ip_address` (confighelper.Trilean) - If using a non-default VPC,\n  public IP addresses are not provided by default. If this is true, your\n  new instance will get a Public IP. default: unset\n  \n  Note: when specifying this attribute without a `subnet_[id|filter]` or\n  `vpc_[id|filter]`, we will attempt to infer this information from the\n  default VPC/Subnet.\n  This operation may require some extra permissions to the IAM role that\n  runs the build:\n  \n  * ec2:DescribeVpcs\n  * ec2:DescribeSubnets\n  \n  Additionally, since we filter subnets/AZs by their capability to host\n  an instance of the selected type, you may also want to define the\n  `ec2:DescribeInstanceTypeOfferings` action to the role running the build.\n  Otherwise, Packer will pick the most available subnet in the VPC selected,\n  which may not be able to host the instance type you provided.\n\n- `availability_zone` (string) - Destination availability zone to launch\n  instance in. Leave this empty to allow Amazon to auto-assign.\n\n- `block_duration_minutes` (int64) - Requires spot_price to be set. The\n  required duration for the Spot Instances (also known as Spot blocks). This\n  value must be a multiple of 60 (60, 120, 180, 240, 300, or 360). You can't\n  specify an Availability Zone group or a launch group if you specify a\n  duration. Note: This parameter is no longer available to new customers\n  from July 1, 2021. [See Amazon's\n  documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-requests.html#fixed-duration-spot-instances).\n\n- `capacity_reservation_preference` (string) - Set the preference for using a capacity reservation if one exists.\n  Either will be `open` or `none`. Defaults to `none`\n\n- `capacity_reservation_id` (string) - Provide the specific EC2 Capacity Reservation ID that will be used\n  by Packer.\n\n- `capacity_reservation_group_arn` (string) - Provide the EC2 Capacity Reservation Group ARN that will be used by\n  Packer.\n\n- `disable_stop_instance` (bool) - Packer normally stops the build instance after all provisioners have\n  run. For Windows instances, it is sometimes desirable to [run\n  Sysprep](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/Creating_EBSbacked_WinAMI.html)\n  which will stop the instance for you. If this is set to `true`, Packer\n  *will not* stop the instance but will assume that you will send the stop\n  signal yourself through your final provisioner. You can do this with a\n  [windows-shell provisioner](/packer/integrations/hashicorp/windows-shell). Note that\n  Packer will still wait for the instance to be stopped, and failing to\n  send the stop signal yourself, when you have set this flag to `true`,\n  will cause a timeout.\n  \n  An example of a valid windows shutdown command in a `windows-shell`\n  provisioner is :\n  ```shell-session\n    ec2config.exe -sysprep\n  ```\n  or\n  ```sell-session\n    \"%programfiles%\\amazon\\ec2configservice\\\"ec2config.exe -sysprep\"\"\n  ```\n  -\u003e Note: The double quotation marks in the command are not required if\n  your CMD shell is already in the\n  `C:\\Program Files\\Amazon\\EC2ConfigService\\` directory.\n\n- `ebs_optimized` (bool) - Mark instance as [EBS\n  Optimized](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html).\n  Default `false`.\n\n- `enable_nitro_enclave` (bool) - Enable support for Nitro Enclaves on the instance.  Note that the instance type must\n  be able to [support Nitro Enclaves](https://aws.amazon.com/ec2/nitro/nitro-enclaves/faqs/).\n  This option is not supported for spot instances.\n\n- `enable_t2_unlimited` (bool) - Deprecated argument - please use \"enable_unlimited_credits\".\n  Enabling T2 Unlimited allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-credits-baseline-concepts.html)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-unlimited.html)\n  and the **T2 Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [T2\n  Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-std.html)\n  instance instead.\n  \n  To use T2 Unlimited you must use a T2 instance type, e.g. `t2.micro`.\n  Additionally, T2 Unlimited cannot be used in conjunction with Spot\n  Instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error.\n  \n  !\u0026gt; **Warning!** Additional costs may be incurred by enabling T2\n  Unlimited - even for instances that would usually qualify for the\n  [AWS Free Tier](https://aws.amazon.com/free/).\n\n- `enable_unlimited_credits` (bool) - Enabling Unlimited credits allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html#unlimited-mode-surplus-credits)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html)\n  and the **Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-standard-mode.html)\n  instance instead.\n  \n  To use Unlimited you must use a T2/T3/T3a/T4g instance type, e.g. (`t2.micro`, `t3.micro`).\n  Additionally, Unlimited cannot be used in conjunction with Spot\n  Instances for T2 type instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error if the underlying instance type is a T2 type instance.\n  By default the supported burstable instance types (including t3/t3a/t4g) will be provisioned with its cpu credits set to standard,\n  only when `enable_unlimited_credits` is true will the instance be provisioned with unlimited cpu credits.\n\n- `iam_instance_profile` (string) - The name of an [IAM instance\n  profile](https://docs.aws.amazon.com/IAM/latest/UserGuide/instance-profiles.html)\n  to launch the EC2 instance with.\n\n- `fleet_tags` (map[string]string) - Key/value pair tags to apply tags to the fleet that is issued.\n\n- `fleet_tag` ([]{key string, value string}) - Same as [`fleet_tags`](#fleet_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `skip_profile_validation` (bool) - Whether or not to check if the IAM instance profile exists. Defaults to false\n\n- `temporary_iam_instance_profile_policy_document` (\\*PolicyDocument) - Temporary IAM instance profile policy document\n  If IamInstanceProfile is specified it will be used instead.\n  \n  HCL2 example:\n  ```hcl\n  temporary_iam_instance_profile_policy_document {\n  \tStatement {\n  \t\tAction   = [\"logs:*\"]\n  \t\tEffect   = \"Allow\"\n  \t\tResource = [\"*\"]\n  \t}\n  \tVersion = \"2012-10-17\"\n  }\n  ```\n  \n  JSON example:\n  ```json\n  {\n  \t\"Version\": \"2012-10-17\",\n  \t\"Statement\": [\n  \t\t{\n  \t\t\t\"Action\": [\n  \t\t\t\"logs:*\"\n  \t\t\t],\n  \t\t\t\"Effect\": \"Allow\",\n  \t\t\t\"Resource\": [\"*\"]\n  \t\t}\n  \t]\n  }\n  ```\n\n- `shutdown_behavior` (string) - Automatically terminate instances on\n  shutdown in case Packer exits ungracefully. Possible values are stop and\n  terminate. Defaults to stop.\n\n- `security_group_filter` (SecurityGroupFilterOptions) - Filters used to populate the `security_group_ids` field.\n  \n  HCL2 Example:\n  \n  ```hcl\n    security_group_filter {\n      filters = {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  ```\n  \n  JSON Example:\n  ```json\n  {\n    \"security_group_filter\": {\n      \"filters\": {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  }\n  ```\n  \n  This selects the SG's with tag `Class` with the value `packer`.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a\n      `security_group_ids`. Any filter described in the docs for\n      [DescribeSecurityGroups](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSecurityGroups.html)\n      is valid.\n  \n  `security_group_ids` take precedence over this.\n\n- `run_tags` (map[string]string) - Key/value pair tags to apply to the generated key-pair, security group, iam profile and role, snapshot, network interfaces and instance\n  that is *launched* to create the EBS volumes. The resulting AMI will also inherit these tags.\n  This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `run_tag` ([]{key string, value string}) - Same as [`run_tags`](#run_tags) but defined as a singular repeatable\n  block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `security_group_id` (string) - The ID (not the name) of the security\n  group to assign to the instance. By default this is not set and Packer will\n  automatically create a new temporary security group to allow SSH access.\n  Note that if this is specified, you must be sure the security group allows\n  access to the ssh_port given below.\n\n- `security_group_ids` ([]string) - A list of security groups as\n  described above. Note that if this is specified, you must omit the\n  security_group_id.\n\n- `source_ami_filter` (AmiFilterOptions) - Filters used to populate the `source_ami`\n  field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    source_ami_filter {\n      filters = {\n         virtualization-type = \"hvm\"\n         name = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n         root-device-type = \"ebs\"\n      }\n      owners = [\"099720109477\"]\n      most_recent = true\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"source_ami_filter\": {\n         \"filters\": {\n         \"virtualization-type\": \"hvm\",\n         \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n         \"root-device-type\": \"ebs\"\n         },\n         \"owners\": [\"099720109477\"],\n         \"most_recent\": true\n      }\n    }\n  ]\n  ```\n  \n    This selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. NOTE:\n    This will fail unless *exactly* one AMI is returned. In the above example,\n    `most_recent` will cause this to succeed by selecting the newest image.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `source_ami`.\n        NOTE: This will fail unless *exactly* one AMI is returned. Any filter\n        described in the docs for\n        [DescribeImages](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html)\n        is valid.\n  \n    -   `owners` (array of strings) - Filters the images by their owner. You\n        may specify one or more AWS account IDs, \"self\" (which will use the\n        account whose credentials you are using to run Packer), or an AWS owner\n        alias: for example, `amazon`, `aws-marketplace`, or `microsoft`. This\n        option is required for security reasons.\n  \n    -   `most_recent` (boolean) - Selects the newest created image when true.\n        This is most useful for selecting a daily distro build.\n  \n    You may set this in place of `source_ami` or in conjunction with it. If you\n    set this in conjunction with `source_ami`, the `source_ami` will be added\n    to the filter. The provided `source_ami` must meet all of the filtering\n    criteria provided in `source_ami_filter`; this pins the AMI returned by the\n    filter, but will cause Packer to fail if the `source_ami` does not exist.\n\n- `spot_instance_types` ([]string) - a list of acceptable instance\n  types to run your build on. We will request a spot instance using the max\n  price of spot_price and the allocation strategy of \"lowest price\".\n  Your instance will be launched on an instance type of the lowest available\n  price that you have in your list.  This is used in place of instance_type.\n  You may only set either spot_instance_types or instance_type, not both.\n  This feature exists to help prevent situations where a Packer build fails\n  because a particular availability zone does not have capacity for the\n  specific instance_type requested in instance_type.\n\n- `spot_price` (string) - With Spot Instances, you pay the Spot price that's in effect for the\n  time period your instances are running. Spot Instance prices are set by\n  Amazon EC2 and adjust gradually based on long-term trends in supply and\n  demand for Spot Instance capacity.\n  \n  When this field is set, it represents the maximum hourly price you are\n  willing to pay for a spot instance. If you do not set this value, it\n  defaults to a maximum price equal to the on demand price of the\n  instance. In the situation where the current Amazon-set spot price\n  exceeds the value set in this field, Packer will not launch an instance\n  and the build will error. In the situation where the Amazon-set spot\n  price is less than the value set in this field, Packer will launch and\n  you will pay the Amazon-set spot price, not this maximum value.\n  For more information, see the Amazon docs on\n  [spot pricing](https://aws.amazon.com/ec2/spot/pricing/).\n\n- `spot_tags` (map[string]string) - Requires spot_price to be set. Key/value pair tags to apply tags to the\n  spot request that is issued.\n\n- `spot_tag` ([]{key string, value string}) - Same as [`spot_tags`](#spot_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `subnet_filter` (SubnetFilterOptions) - Filters used to populate the `subnet_id` field.\n  \n  HCL2 example:\n  \n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    subnet_filter {\n      filters = {\n            \"tag:Class\": \"build\"\n      }\n      most_free = true\n      random = false\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"subnet_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\"\n        },\n        \"most_free\": true,\n        \"random\": false\n      }\n    }\n  ]\n  ```\n  \n    This selects the Subnet with tag `Class` with the value `build`, which has\n    the most free IP addresses. NOTE: This will fail unless *exactly* one\n    Subnet is returned. By using `most_free` or `random` one will be selected\n    from those matching the filter.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `subnet_id`.\n        NOTE: This will fail unless *exactly* one Subnet is returned. Any\n        filter described in the docs for\n        [DescribeSubnets](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSubnets.html)\n        is valid.\n  \n    -   `most_free` (boolean) - The Subnet with the most free IPv4 addresses\n        will be used if multiple Subnets matches the filter.\n  \n    -   `random` (boolean) - A random Subnet will be used if multiple Subnets\n        matches the filter. `most_free` have precendence over this.\n  \n    `subnet_id` take precedence over this.\n\n- `subnet_id` (string) - If using VPC, the ID of the subnet, such as\n  subnet-12345def, where Packer will launch the EC2 instance. This field is\n  required if you are using an non-default VPC.\n\n- `license_specifications` ([]LicenseSpecification) - The license configurations.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    license_specifications {\n      license_configuration_request = {\n        license_configuration_arn = \"${var.license_configuration_arn}\"\n      }\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"license_specifications\": [\n        {\n          \"license_configuration_request\": {\n            \"license_configuration_arn\": \"{{user `license_configuration_arn`}}\"\n          }\n        }\n      ]\n    }\n  ]\n  ```\n  \n    Each `license_configuration_request` describes a license configuration,\n    the properties of which are:\n  \n    - `license_configuration_arn` (string) - The Amazon Resource Name (ARN)\n      of the license configuration.\n\n- `placement` (Placement) - Describes the placement of an instance.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    placement = {\n      host_resource_group_arn = \"${var.host_resource_group_arn}\"\n      tenancy                 = \"${var.placement_tenancy}\"\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"placement\": {\n        \"host_resource_group_arn\": \"{{user `host_resource_group_arn`}}\",\n        \"tenancy\": \"{{user `placement_tenancy`}}\"\n      }\n    }\n  ]\n  ```\n  \n    - `host_resource_group_arn` (string) - The ARN of the host resource\n      group in which to launch the instances. If you specify a host\n      resource group ARN, omit the Tenancy parameter or set it to `host`.\n    - `tenancy` (string) - The tenancy of the instance (if the instance is\n      running in a VPC). An instance with a tenancy of `dedicated` runs on\n      single-tenant hardware. The default is `default`, meaning shared\n      tenancy. Allowed values are `default`, `dedicated` and `host`.\n\n- `tenancy` (string) - Deprecated: Use Placement Tenancy instead.\n\n- `temporary_security_group_source_cidrs` ([]string) - A list of IPv4 CIDR blocks to be authorized access to the instance, when\n  packer is creating a temporary security group.\n  \n  The default is [`0.0.0.0/0`] (i.e., allow any IPv4 source).\n  Use `temporary_security_group_source_public_ip` to allow current host's\n  public IP instead of any IPv4 source.\n  This is only used when `security_group_id` or `security_group_ids` is not\n  specified.\n\n- `temporary_security_group_source_public_ip` (bool) - When enabled, use public IP of the host (obtained from https://checkip.amazonaws.com)\n  as CIDR block to be authorized access to the instance, when packer\n  is creating a temporary security group. Defaults to `false`.\n  \n  This is only used when `security_group_id`, `security_group_ids`,\n  and `temporary_security_group_source_cidrs` are not specified.\n\n- `user_data` (string) - User data to apply when launching the instance. Note\n  that you need to be careful about escaping characters due to the templates\n  being JSON. It is often more convenient to use user_data_file, instead.\n  Packer will not automatically wait for a user script to finish before\n  shutting down the instance this must be handled in a provisioner.\n\n- `user_data_file` (string) - Path to a file that will be used for the user\n  data when launching the instance.\n\n- `vpc_filter` (VpcFilterOptions) - Filters used to populate the `vpc_id` field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    vpc_filter {\n      filters = {\n        \"tag:Class\": \"build\",\n        \"isDefault\": \"false\",\n        \"cidr\": \"/24\"\n      }\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"vpc_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\",\n          \"isDefault\": \"false\",\n          \"cidr\": \"/24\"\n        }\n      }\n    }\n  ]\n  ```\n  \n  This selects the VPC with tag `Class` with the value `build`, which is not\n  the default VPC, and have a IPv4 CIDR block of `/24`. NOTE: This will fail\n  unless *exactly* one VPC is returned.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `vpc_id`. NOTE:\n      This will fail unless *exactly* one VPC is returned. Any filter\n      described in the docs for\n      [DescribeVpcs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeVpcs.html)\n      is valid.\n  \n  `vpc_id` take precedence over this.\n\n- `vpc_id` (string) - If launching into a VPC subnet, Packer needs the VPC ID\n  in order to create a temporary security group within the VPC. Requires\n  subnet_id to be set. If this field is left blank, Packer will try to get\n  the VPC ID from the subnet_id.\n\n- `windows_password_timeout` (duration string | ex: \"1h5m2s\") - The timeout for waiting for a Windows\n  password for Windows instances. Defaults to 20 minutes. Example value:\n  10m\n\n- `metadata_options` (MetadataOptions) - [Metadata Settings](#metadata-settings)\n\n- `ssh_interface` (string) - One of `public_ip`, `private_ip`, `public_dns`, `private_dns` or `session_manager`.\n     If set, either the public IP address, private IP address, public DNS name\n     or private DNS name will be used as the host for SSH. The default behaviour\n     if inside a VPC is to use the public IP address if available, otherwise\n     the private IP address will be used. If not in a VPC the public DNS name\n     will be used. Also works for WinRM.\n  \n     Where Packer is configured for an outbound proxy but WinRM traffic\n     should be direct, `ssh_interface` must be set to `private_dns` and\n     `\u003cregion\u003e.compute.internal` included in the `NO_PROXY` environment\n     variable.\n  \n     When using `session_manager` the machine running Packer must have\n  \t  the AWS Session Manager Plugin installed and within the users' system path.\n     Connectivity via the `session_manager` interface establishes a secure tunnel\n     between the local host and the remote host on an available local port to the specified `ssh_port`.\n     See [Session Manager Connections](#session-manager-connections) for more information.\n     - Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM communicator.\n     - Upon termination the secure tunnel will be terminated automatically, if however there is a failure in\n     terminating the tunnel it will automatically terminate itself after 20 minutes of inactivity.\n\n- `pause_before_ssm` (duration string | ex: \"1h5m2s\") - The time to wait before establishing the Session Manager session.\n  The value of this should be a duration. Examples are\n  `5s` and `1m30s` which will cause Packer to wait five seconds and one\n  minute 30 seconds, respectively. If no set, defaults to 10 seconds.\n  This option is useful when the remote port takes longer to become available.\n\n- `session_manager_port` (int) - Which port to connect the local end of the session tunnel to. If\n  left blank, Packer will choose a port for you from available ports.\n  This option is only used when `ssh_interface` is set `session_manager`.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n#### Metadata Settings\n\n\u003c!-- Code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\nConfigures the metadata options.\nSee [Configure IMDS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html) for details.\n\n\u003c!-- End of code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `http_endpoint` (string) - A string to enable or disable the IMDS endpoint for an instance. Defaults to enabled.\n  Accepts either \"enabled\" or \"disabled\"\n\n- `http_tokens` (string) - A string to either set the use of IMDSv2 for the instance to optional or required. Defaults to \"optional\".\n  Accepts either \"optional\" or \"required\"\n\n- `http_put_response_hop_limit` (int64) - A numerical value to set an upper limit for the amount of hops allowed when communicating with IMDS endpoints.\n  Defaults to 1.\n\n- `instance_metadata_tags` (string) - A string to enable or disable access to instance tags from the instance metadata. Defaults to disabled.\n  Access to instance metadata tags is available for commercial regions. For non-commercial regions please check availability before enabling.\n  Accepts either \"enabled\" or \"disabled\"\n\n\u003c!-- End of code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; --\u003e\n\n\nUsage Example\n\n**HCL2**\n\n```hcl\nsource \"amazon-ebs\" \"basic-example\" {\n  region        =  \"us-east-1\"\n  source_ami    =  \"ami-fce3c696\"\n  instance_type =  \"t2.micro\"\n  ssh_username  =  \"ubuntu\"\n  ami_name      =  \"packer_AWS_example_{{timestamp}}\"\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens = \"required\"\n    http_put_response_hop_limit = 1\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"aws_access_key\": \"{{env `AWS_ACCESS_KEY_ID`}}\",\n    \"aws_secret_key\": \"{{env `AWS_SECRET_ACCESS_KEY`}}\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"access_key\": \"{{user `aws_access_key`}}\",\n      \"secret_key\": \"{{user `aws_secret_key`}}\",\n      \"region\": \"us-east-1\",\n      \"source_ami\": \"ami-fce3c696\",\n      \"instance_type\": \"t2.micro\",\n      \"ssh_username\": \"ubuntu\",\n      \"ami_name\": \"packer_AWS {{timestamp}}\",\n      \"metadata_options\": {\n        \"http_endpoint\": \"enabled\",\n        \"http_tokens\": \"required\",\n        \"http_put_response_hop_limit\": 1\n      }\n    }\n  ]\n}\n```\n\n\n### Session Manager Connections\n\nSupport for the AWS Systems Manager session manager lets users manage EC2 instances without the need to open inbound ports, or maintain bastion hosts. Session manager connectivity relies on the use of the [session manager plugin](#session-manager-plugin) to open a secure tunnel between the local machine and the remote instance. Once the tunnel has been created all SSH communication will be tunneled through SSM to the remote instance.\n\n-\u003e Note: Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM Communicator.\n\nTo use the session manager as the connection interface for the SSH communicator you need to add the following configuration options to the Amazon builder options:\n\n- `ssh_interface`: The ssh interface must be set to \"session_manager\". When using this option the builder will create an SSM tunnel to the configured `ssh_port` (defaults to 22) on the remote host.\n- `iam_instance_profile`: A valid instance profile granting Systems Manager permissions to manage the remote instance is required in order for the aws ssm-agent to start and stop session connections.\n  See below for more details on [IAM instance profile for Systems Manager](#iam-instance-profile-for-systems-manager).\n\n#### Optional\n\n- `session_manager_port`: A local port on the host machine that should be used as the local end of the session tunnel to the remote host. If not specified Packer will find an available port to use.\n- `temporary_iam_instance_profile_policy_document`: Creates a temporary instance profile policy document to grant Systems Manager permissions to the Ec2 instance. This is an alternative to using an existing `iam_instance_profile`.\n\nHCL2 example:\n\n```hcl\n# file: example.pkr.hcl\n\n# In order to get these variables to read from the environment,\n# set the environment variables to have the same name as the declared\n# variables, with the prefix PKR_VAR_.\n# You could also hardcode them into the file, but we do not recommend that.\n\ndata \"amazon-ami\" \"example\" {\n  filters = {\n    virtualization-type = \"hvm\"\n    name                = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n    root-device-type    = \"ebs\"\n  }\n  owners      = [\"099720109477\"]\n  most_recent = true\n  region      = \"us-east-1\"\n}\n\nsource \"amazon-ebs\" \"ssm-example\" {\n  ami_name             = \"packer_AWS {{timestamp}}\"\n  instance_type        = \"t2.micro\"\n  region               = \"us-east-1\"\n  source_ami           = data.amazon-ami.example.id\n  ssh_username         = \"ubuntu\"\n  ssh_interface        = \"session_manager\"\n  communicator         = \"ssh\"\n  iam_instance_profile = \"myinstanceprofile\"\n}\n\nbuild {\n  sources = [\"source.amazon-ebs.ssm-example\"]\n\n  provisioner \"shell\" {\n    inline = [\"echo Connected via SSM at '${build.User}@${build.Host}:${build.Port}'\"]\n  }\n}\n```\n\nJSON example:\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"ami_name\": \"packer-ami-{{timestamp}}\",\n      \"instance_type\": \"t2.micro\",\n      \"source_ami_filter\": {\n        \"filters\": {\n          \"virtualization-type\": \"hvm\",\n          \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n          \"root-device-type\": \"ebs\"\n        },\n        \"owners\": [\"099720109477\"],\n        \"most_recent\": true\n      },\n      \"ssh_username\": \"ubuntu\",\n      \"ssh_interface\": \"session_manager\",\n      \"communicator\": \"ssh\",\n      \"iam_instance_profile\": \"{{user `iam_instance_profile`}}\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"type\": \"shell\",\n      \"inline\": [\n        \"echo Connected via SSM at '{{build `User`}}@{{build `Host`}}:{{build `Port`}}'\"\n      ]\n    }\n  ]\n}\n```\n\n#### Session Manager Plugin\n\nConnectivity via the session manager requires the use of a session-manger-plugin, which needs to be installed alongside Packer, and an instance AMI that is capable of running the AWS ssm-agent - see [About SSM Agent](https://docs.aws.amazon.com/systems-manager/latest/userguide/prereqs-ssm-agent.html) for details on supported AMIs.\n\nIn order for Packer to start and end sessions that connect you to your managed instances, you must first install the Session Manager plugin on your local machine. The plugin can be installed on supported versions of Microsoft Windows, macOS, Linux, and Ubuntu Server.\n[Installation instructions for the session-manager-plugin](https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html)\n\n#### IAM instance profile for Systems Manager\n\nBy default Systems Manager doesn't have permission to perform actions on created instances so SSM access must be granted by creating an instance profile with the `AmazonSSMManagedInstanceCore` policy. The instance profile can then be attached to any instance you wish to manage via the session-manager-plugin. See [Adding System Manager instance profile](https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html#instance-profile-add-permissions) for details on creating the required instance profile.\n\n#### Permissions for Closing the Tunnel\n\nTo close the SSM tunnels created, this plugin relies on being able to call\n[DescribeInstanceStatus](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstanceStatus.html).\nIn case this is not possible you might see a `Bad exit status` message in the logs.\n\nThe absence of this permission won't prevent you from building the AMI, and the error only means that packer is not able to close the tunnel gracefully.\n\n\n### Block Devices Configuration\n\nBlock devices can be nested in the\n[ami_block_device_mappings](#ami_block_device_mappings) array.\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\nThese will be attached when launching your instance. Your\noptions here may vary depending on the type of VM you use.\n\nExample use case:\n\nThe following mapping will tell Packer to encrypt the root volume of the\nbuild instance at launch using a specific non-default kms key:\n\nHCL2 example:\n\n```hcl\n\n\tlaunch_block_device_mappings {\n\t    device_name = \"/dev/sda1\"\n\t    encrypted = true\n\t    kms_key_id = \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n```\n\nJSON example:\n```json\n\"launch_block_device_mappings\": [\n\n\t{\n\t   \"device_name\": \"/dev/sda1\",\n\t   \"encrypted\": true,\n\t   \"kms_key_id\": \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n]\n```\n\nPlease note that the kms_key_id option in this example exists for\nlaunch_block_device_mappings but not ami_block_device_mappings.\n\nDocumentation for Block Devices Mappings can be found here:\nhttps://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n#### Optional only for [launch_block_device_mappings](#launch_block_device_mappings)\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/ebssurrogate/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `omit_from_artifact` (bool) - If true, this block device will not be snapshotted and the created AMI\n  will not contain block device mapping information for this volume. If\n  false, the block device will be mapped into the final created AMI. Set\n  this option to true if you need a block device mounted in the surrogate\n  AMI but not in the final created AMI.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/ebssurrogate/block_device.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `delete_on_termination` (bool) - Indicates whether the EBS volume is deleted on instance termination.\n  Default false. NOTE: If this value is not explicitly set to true and\n  volumes are not cleaned up by an alternative method, additional volumes\n  will accumulate after every build.\n\n- `device_name` (string) - The device name exposed to the instance (for example, /dev/sdh or xvdh).\n  Required for every device in the block device mapping.\n\n- `encrypted` (boolean) - Indicates whether or not to encrypt the volume. By default, Packer will\n  keep the encryption setting to what it was in the source image. Setting\n  false will result in an unencrypted device, and true will result in an\n  encrypted one.\n\n- `iops` (\\*int64) - The number of I/O operations per second (IOPS) that the volume supports.\n  See the documentation on\n  [IOPs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `no_device` (bool) - Suppresses the specified device included in the block device mapping of\n  the AMI.\n\n- `snapshot_id` (string) - The ID of the snapshot.\n\n- `throughput` (\\*int64) - The throughput for gp3 volumes, only valid for gp3 types\n  See the documentation on\n  [Throughput](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `virtual_name` (string) - The virtual device name. See the documentation on Block Device Mapping\n  for more information.\n\n- `volume_type` (string) - The volume type. gp2 \u0026 gp3 for General Purpose (SSD) volumes, io1 \u0026 io2\n  for Provisioned IOPS (SSD) volumes, st1 for Throughput Optimized HDD,\n  sc1 for Cold HDD, and standard for Magnetic volumes.\n\n- `volume_size` (int64) - The size of the volume, in GiB. Required if not specifying a\n  snapshot_id.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for boot volume encryption.\n  This option exists for launch_block_device_mappings but not\n  ami_block_device_mappings. The kms key id defined here only applies to\n  the original build region; if the AMI gets copied to other regions, the\n  volume in those regions will be encrypted by the default EBS KMS key.\n  For valid formats see KmsKeyId in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html)\n  This field is validated by Packer. When using an alias, you will have to\n  prefix kms_key_id with alias/.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n### Communicator Configuration\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `communicator` (string) - Packer currently supports three kinds of communicators:\n  \n  -   `none` - No communicator will be used. If this is set, most\n      provisioners also can't be used.\n  \n  -   `ssh` - An SSH connection will be established to the machine. This\n      is usually the default.\n  \n  -   `winrm` - A WinRM connection will be established.\n  \n  In addition to the above, some builders have custom communicators they\n  can use. For example, the Docker builder has a \"docker\" communicator\n  that uses `docker exec` and `docker cp` to execute scripts and copy\n  files.\n\n- `pause_before_connecting` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\n  guest's bootstrap script, but sometimes you may have a race condition\n  where you need Packer to wait before attempting to connect to your\n  guest.\n  \n  If you end up in this situation, you can use the template option\n  `pause_before_connecting`. By default, there is no pause. For example if\n  you set `pause_before_connecting` to `10m` Packer will check whether it\n  can connect, as normal. But once a connection attempt is successful, it\n  will disconnect and then wait 10 minutes before connecting to the guest\n  and beginning provisioning.\n\n\u003c!-- End of code generated from the comments of the Config struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSH struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ssh_host` (string) - The address to SSH to. This usually is automatically configured by the\n  builder.\n\n- `ssh_port` (int) - The port to connect to SSH. This defaults to `22`.\n\n- `ssh_username` (string) - The username to connect to SSH with. Required if using SSH.\n\n- `ssh_password` (string) - A plaintext password to use to authenticate with SSH.\n\n- `ssh_ciphers` ([]string) - This overrides the value of ciphers supported by default by Golang.\n  The default value is [\n    \"aes128-gcm@openssh.com\",\n    \"chacha20-poly1305@openssh.com\",\n    \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n  ]\n  \n  Valid options for ciphers include:\n  \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\",\n  \"chacha20-poly1305@openssh.com\",\n  \"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",\n\n- `ssh_clear_authorized_keys` (bool) - If true, Packer will attempt to remove its temporary key from\n  `~/.ssh/authorized_keys` and `/root/.ssh/authorized_keys`. This is a\n  mostly cosmetic option, since Packer will delete the temporary private\n  key from the host system regardless of whether this is set to true\n  (unless the user has set the `-debug` flag). Defaults to \"false\";\n  currently only works on guests with `sed` installed.\n\n- `ssh_key_exchange_algorithms` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\n  supported by default by Golang. Acceptable values include:\n  \"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\",\n  \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n  \"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".\n\n- `ssh_certificate_file` (string) - Path to user certificate used to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_pty` (bool) - If `true`, a PTY will be requested for the SSH connection. This defaults\n  to `false`.\n\n- `ssh_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\n  determine when the machine has booted so this is usually quite long.\n  Example value: `10m`.\n  This defaults to `5m`, unless `ssh_handshake_attempts` is set.\n\n- `ssh_disable_agent_forwarding` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `false`.\n\n- `ssh_handshake_attempts` (int) - The number of handshakes to attempt with SSH once it can connect.\n  This defaults to `10`, unless a `ssh_timeout` is set.\n\n- `ssh_bastion_host` (string) - A bastion host to use for the actual SSH connection.\n\n- `ssh_bastion_port` (int) - The port of the bastion host. Defaults to `22`.\n\n- `ssh_bastion_agent_auth` (bool) - If `true`, the local SSH agent will be used to authenticate with the\n  bastion host. Defaults to `false`.\n\n- `ssh_bastion_username` (string) - The username to connect to the bastion host.\n\n- `ssh_bastion_password` (string) - The password to use to authenticate with the bastion host.\n\n- `ssh_bastion_interactive` (bool) - If `true`, the keyboard-interactive used to authenticate with bastion host.\n\n- `ssh_bastion_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with the\n  bastion host. The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_bastion_certificate_file` (string) - Path to user certificate used to authenticate with bastion host.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_file_transfer_method` (string) - `scp` or `sftp` - How to transfer files, Secure copy (default) or SSH\n  File Transfer Protocol.\n  \n  **NOTE**: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n  (the default protocol for copying data) returns a a non-zero error code since the MOTW\n  cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\n  with SFTP instead `ssh_file_transfer_protocol = \"sftp\"`.\n\n- `ssh_proxy_host` (string) - A SOCKS proxy host to use for SSH connection\n\n- `ssh_proxy_port` (int) - A port of the SOCKS proxy. Defaults to `1080`.\n\n- `ssh_proxy_username` (string) - The optional username to authenticate with the proxy server.\n\n- `ssh_proxy_password` (string) - The optional password to use to authenticate with the proxy server.\n\n- `ssh_keep_alive_interval` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\n  value (`-1s`) to disable. Example value: `10s`. Defaults to `5s`.\n\n- `ssh_read_write_timeout` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\n  useful if, for example, packer hangs on a connection after a reboot.\n  Example: `5m`. Disabled by default.\n\n- `ssh_remote_tunnels` ([]string) - \n\n- `ssh_local_tunnels` ([]string) - \n\n\u003c!-- End of code generated from the comments of the SSH struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `temporary_key_pair_type` (string) - `dsa` | `ecdsa` | `ed25519` | `rsa` ( the default )\n  \n  Specifies the type of key to create. The possible values are 'dsa',\n  'ecdsa', 'ed25519', or 'rsa'.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure, please\n  consider other alternatives like RSA or ED25519.\n\n- `temporary_key_pair_bits` (int) - Specifies the number of bits in the key to create. For RSA keys, the\n  minimum size is 1024 bits and the default is 4096 bits. Generally, 3072\n  bits is considered sufficient. DSA keys must be exactly 1024 bits as\n  specified by FIPS 186-2. For ECDSA keys, bits determines the key length\n  by selecting from one of three elliptic curve sizes: 256, 384 or 521\n  bits. Attempting to use bit lengths other than these three values for\n  ECDSA keys will fail. Ed25519 keys have a fixed length and bits will be\n  ignored.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure as specified\n  by FIPS 186-5, please consider other alternatives like RSA or ED25519.\n\n\u003c!-- End of code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; --\u003e\n\n\n- `ssh_keypair_name` (string) - If specified, this is the key that will be used for SSH with the\n  machine. The key must match a key pair name loaded up into the remote.\n  By default, this is blank, and Packer will generate a temporary keypair\n  unless [`ssh_password`](#ssh_password) is used.\n  [`ssh_private_key_file`](#ssh_private_key_file) or\n  [`ssh_agent_auth`](#ssh_agent_auth) must be specified when\n  [`ssh_keypair_name`](#ssh_keypair_name) is utilized.\n\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n- `ssh_agent_auth` (bool) - If true, the local SSH agent will be used to authenticate connections to\n  the source instance. No temporary keypair will be created, and the\n  values of [`ssh_password`](#ssh_password) and\n  [`ssh_private_key_file`](#ssh_private_key_file) will be ignored. The\n  environment variable `SSH_AUTH_SOCK` must be set for this option to work\n  properly.\n\n\n## Basic Example\n\n**HCL2**\n\n```hcl\nsource \"amazon-ebssurrogate\" \"basic-example\" {\n  region = \"us-east-1\"\n  ssh_username = \"ubuntu\"\n  instance_type = \"t2.medium\"\n  source_ami = \"ami-40d28157\"\n  ami_name = \"packer-test-ami\"\n  ami_virtualization_type = \"paravirtual\"\n\n  launch_block_device_mappings {\n      volume_type = \"gp2\"\n      device_name = \"/dev/xvdf\"\n      delete_on_termination = false\n      volume_size = 10\n  }\n\n  ami_root_device {\n    source_device_name = \"/dev/xvdf\"\n    device_name = \"/dev/xvda\"\n    delete_on_termination = true\n    volume_size = 16\n    volume_type = \"gp2\"\n  }\n}\n\nbuild {\n  sources = [\"sources.amazon-ebssurrogate.basic-example\"]\n\n  provisioner \"shell\" {\n      inline = [\"...\"]\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n        \"type\": \"amazon-ebssurrogate\",\n        \"secret_key\": \"YOUR SECRET KEY HERE\",\n        \"access_key\": \"YOUR KEY HERE\",\n        \"ami_name\": \"packer-test-ami\",\n        \"ami_virtualization_type\": \"paravirtual\",\n        \"region\": \"us-east-1\",\n        \"ssh_username\": \"ubuntu\",\n        \"instance_type\": \"t2.medium\",\n        \"source_ami\": \"ami-40d28157\",\n        \"launch_block_device_mappings\": [\n            {\n              \"volume_type\": \"gp2\",\n              \"device_name\": \"/dev/xvdf\",\n              \"delete_on_termination\": false,\n              \"volume_size\": 10\n            }\n        ],\n        \"ami_root_device\": {\n          \"source_device_name\": \"/dev/xvdf\",\n          \"device_name\": \"/dev/xvda\",\n          \"delete_on_termination\": true,\n          \"volume_size\": 16,\n          \"volume_type\": \"gp2\"\n        }\n    }\n  ]\n}\n```\n\n\n  -\u003e **Note:** Packer can also read the access key and secret access key from\n  environmental variables. See the configuration reference in the section above\n  for more information on what environmental variables Packer will look for.\n\n  Further information on locating AMI IDs and their relationship to instance\n  types and regions can be found in the AWS EC2 Documentation [for\n  Linux](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/finding-an-ami.html)\n  or [for\n  Windows](http://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/finding-an-ami.html).\n\n  ## Accessing the Instance to Debug\n\n  If you need to access the instance to debug for some reason, run this builder\n  with the `-debug` flag. In debug mode, the Amazon builder will save the private\n  key in the current directory and will output the DNS or IP information as well.\n  You can use this information to access the instance as it is running.\n\n  ## Build template data\n\n  In configuration directives marked as a template engine above, the following\n  variables are available:\n\n  - `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n  - `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n  - `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n  - `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n  - `SourceAMIOwner` - The source AMI owner ID.\n  - `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n  - `SourceAMITags` - The source AMI Tags, as a `map[string]string` object.\n\n  ## Build Shared Information Variables\n\n  This builder generates data that are shared with provisioner and post-processor via build function of [template engine](/packer/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](/packer/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\n  The generated variables available for this builder are:\n\n  - `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n  - `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n  - `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n  - `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n  - `SourceAMIOwner` - The source AMI owner ID.\n  - `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n\n  Usage example:\n\n**HCL2**\n\n```hcl\n// When accessing one of these variables from inside the builder, you need to\n// use the golang templating syntax. This is due to an architectural quirk that\n// won't be easily resolvable until legacy json templates are deprecated:\n\nbuild {\n  source \"amazon-ebs\" \"basic-example\" {\n    tags = {\n      OS_Version = \"Ubuntu\"\n      Release = \"Latest\"\n      Base_AMI_ID = \"{{ .SourceAMI }}\"\n      Base_AMI_Name = \"{{ .SourceAMIName }}\"\n    }\n  }\n\n  // when accessing one of the variables from a provisioner or post-processor, use\n  // hcl-syntax\n  post-processor \"manifest\" {\n    output = \"manifest.json\"\n    strip_path = true\n    custom_data = {\n    source_ami_name = \"${build.SourceAMIName}\"\n  }\n}\n```\n\n**JSON**\n\n```json\n\"post-processors\": [\n    {\n      \"type\": \"manifest\",\n      \"output\": \"manifest.json\",\n      \"strip_path\": true,\n      \"custom_data\": {\n        \"source_ami_name\": \"{{ build `SourceAMIName` }}\"\n      }\n    }\n]\n```\n\n\n-\u003e **Note:** Packer uses pre-built AMIs as the source for building images.\nThese source AMIs may include volumes that are not flagged to be destroyed on\ntermination of the instance building the new image. In addition to those\nvolumes created by this builder, any volumes in the source AMI which are not\nmarked for deletion on termination will remain in your account.\n\n## Which SSH Options to use:\n\nThis chart breaks down what Packer does if you set any of the below SSH options:\n\n| ssh_password | ssh_private_key_file | ssh_keypair_name | temporary_key_pair_name | Packer will...                                                                             |\n| ------------ | -------------------- | ---------------- | ----------------------- | ------------------------------------------------------------------------------------------ |\n| X            | -                    | -                | -                       | ssh authenticating with username and given password                                        |\n| -            | X                    | -                | -                       | ssh authenticating with private key file                                                   |\n| -            | X                    | X                | -                       | ssh authenticating with given private key file and \"attaching\" the keypair to the instance |\n| -            | -                    | -                | X                       | Create a temporary ssh keypair with a particular name, clean it up                         |\n| -            | -                    | -                | -                       | Create a temporary ssh keypair with a default name, clean it up                            |\n","created_at":"2024-04-17T16:47:57.337Z","updated_at":"2024-04-17T16:47:57.337Z","name":"Amazon EBS Surrogate","slug":"ebssurrogate","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"17c2a430-563e-47c0-a2b3-389efb3a1b7a","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `amazon-instance`\nArtifact BuilderId: `mitchellh.amazon.instance`\n\nThe `amazon-instance` Packer builder is able to create Amazon AMIs backed by\ninstance storage as the root device. For more information on the difference\nbetween instance storage and EBS-backed instances, see the [\"storage for the\nroot device\" section in the EC2\ndocumentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ComponentsAMIs.html#storage-for-the-root-device).\n\nThis builder builds an AMI by launching an EC2 instance from an existing\ninstance-storage backed AMI, provisioning that running machine, and then\nbundling and creating a new AMI from that machine. This is all done in your own\nAWS account. This builder will create temporary key pairs, security group\nrules, etc. that provide it temporary access to the instance while the image is\nbeing created. This simplifies configuration quite a bit.\n\nThis builder does _not_ manage AMIs. Once it creates an AMI and stores it in\nyour account, it is up to you to use, delete, etc. the AMI.\n\n-\u003e **Note:** Temporary resources are, by default, all created with the\nprefix `packer`. This can be useful if you want to restrict the security groups\nand key pairs packer is able to operate on.\n\n-\u003e **Note:** This builder requires that the [Amazon EC2 AMI\nTools](https://aws.amazon.com/developertools/368) are installed onto the\nmachine. This can be done within a provisioner, but must be done before the\nbuilder finishes running.\n\n~\u003e Instance builds are not supported for Windows. Use\n[`amazon-ebs`](/packer/integrations/hashicorp/amazon/latest/components/builder/ebs) instead.\n\n## Configuration Reference\n\nThere are many configuration options available for the builder. In addition to\nthe items listed here, you will want to look at the general configuration\nreferences for [AMI](#ami-configuration),\n[BlockDevices](#block-devices-configuration),\n[Access](#access-configuration),\n[Run](#run-configuration) and\n[Communicator](#communicator-configuration)\nconfiguration references, which are\nnecessary for this build to succeed and can be found further down the page.\n\n### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/instance/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `account_id` (string) - Your AWS account ID. This is required for bundling the AMI. This is not\n  the same as the access key. You can find your account ID in the security\n  credentials page of your AWS account.\n\n- `s3_bucket` (string) - The name of the S3 bucket to upload the AMI. This bucket will be created\n  if it doesn't exist.\n\n- `x509_cert_path` (string) - The local path to a valid X509 certificate for your AWS account. This is\n  used for bundling the AMI. This X509 certificate must be registered with\n  your account from the security credentials page in the AWS console.\n\n- `x509_key_path` (string) - The local path to the private key for the X509 certificate specified by\n  x509_cert_path. This is used for bundling the AMI.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/instance/builder.go; --\u003e\n\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/instance/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_block_device_mappings` (awscommon.BlockDevices) - Add one or more block device mappings to the AMI. These will be attached\n  when booting a new instance from your AMI. To add a block device during\n  the Packer build see `launch_block_device_mappings` below. Your options\n  here may vary depending on the type of VM you use. See the\n  [BlockDevices](#block-devices-configuration) documentation for fields.\n\n- `launch_block_device_mappings` (awscommon.BlockDevices) - Add one or more block devices before the Packer build starts. If you add\n  instance store volumes or EBS volumes in addition to the root device\n  volume, the created AMI will contain block device mapping information\n  for those volumes. Amazon creates snapshots of the source instance's\n  root volume and any other EBS volumes described here. When you launch an\n  instance from this new AMI, the instance automatically launches with\n  these additional volumes, and will restore them from snapshots taken\n  from the source instance. See the\n  [BlockDevices](#block-devices-configuration) documentation for fields.\n\n- `bundle_destination` (string) - The directory on the running instance where the bundled AMI will be\n  saved prior to uploading. By default this is /tmp. This directory must\n  exist and be writable.\n\n- `bundle_prefix` (string) - The prefix for files created from bundling the root volume. By default\n  this is `image-{{timestamp}}`. The timestamp variable should be used to\n  make sure this is unique, otherwise it can collide with other created\n  AMIs by Packer in your account.\n\n- `bundle_upload_command` (string) - The command to use to upload the bundled volume. See the \"custom bundle\n  commands\" section below for more information.\n\n- `bundle_vol_command` (string) - The command to use to bundle the volume. See the \"custom bundle\n  commands\" section below for more information.\n\n- `x509_upload_path` (string) - The path on the remote machine where the X509 certificate will be\n  uploaded. This path must already exist and be writable. X509\n  certificates are uploaded after provisioning is run, so it is perfectly\n  okay to create this directory as part of the provisioning process.\n  Defaults to /tmp.\n\n- `tpm_support` (string) - NitroTPM Support. Valid options are `v2.0`. See the documentation on\n  [NitroTPM Support](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enable-nitrotpm-support-on-ami.html) for\n  more information. Only enabled if a valid option is provided, otherwise ignored.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/instance/builder.go; --\u003e\n\n\n### AMI Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_name` (string) - The name of the resulting AMI that will appear when managing AMIs in the\n  AWS console or via APIs. This must be unique. To help make this unique,\n  use a function like timestamp (see [template\n  engine](/packer/docs/templates/legacy_json_templates/engine) for more info).\n\n\u003c!-- End of code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ami_description` (string) - The description to set for the resulting\n  AMI(s). By default this description is empty.  This is a\n  [template engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `ami_virtualization_type` (string) - The type of virtualization for the AMI\n  you are building. This option is required to register HVM images. Can be\n  paravirtual (default) or hvm.\n\n- `ami_users` ([]string) - A list of account IDs that have access to\n  launch the resulting AMI(s). By default no additional users other than the\n  user creating the AMI has permissions to launch it.\n\n- `ami_groups` ([]string) - A list of groups that have access to\n  launch the resulting AMI(s). By default no groups have permission to launch\n  the AMI. `all` will make the AMI publicly accessible.\n  AWS currently doesn't accept any value other than \"all\"\n\n- `ami_org_arns` ([]string) - A list of Amazon Resource Names (ARN) of AWS Organizations that have access to\n  launch the resulting AMI(s). By default no organizations have permission to launch\n  the AMI.\n\n- `ami_ou_arns` ([]string) - A list of Amazon Resource Names (ARN) of AWS Organizations organizational units (OU) that have access to\n  launch the resulting AMI(s). By default no organizational units have permission to launch\n  the AMI.\n\n- `ami_product_codes` ([]string) - A list of product codes to\n  associate with the AMI. By default no product codes are associated with the\n  AMI.\n\n- `ami_regions` ([]string) - A list of regions to copy the AMI to.\n  Tags and attributes are copied along with the AMI. AMI copying takes time\n  depending on the size of the AMI, but will generally take many minutes.\n\n- `skip_region_validation` (bool) - Set to true if you want to skip\n  validation of the ami_regions configuration option. Default false.\n\n- `tags` (map[string]string) - Key/value pair tags applied to the AMI. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n  \n  The builder no longer adds a \"Name\": \"Packer Builder\" entry to the tags.\n\n- `tag` ([]{key string, value string}) - Same as [`tags`](#tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `ena_support` (boolean) - Enable enhanced networking (ENA but not SriovNetSupport) on\n  HVM-compatible AMIs. If set, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy.\n  \n  Note: you must make sure enhanced networking is enabled on your\n  instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n\n- `sriov_support` (bool) - Enable enhanced networking (SriovNetSupport but not ENA) on\n  HVM-compatible AMIs. If true, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy. Note: you must make sure enhanced networking is enabled\n  on your instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n  Default `false`.\n\n- `force_deregister` (bool) - Force Packer to first deregister an existing\n  AMI if one with the same name already exists. Default false.\n\n- `force_delete_snapshot` (bool) - Force Packer to delete snapshots\n  associated with AMIs, which have been deregistered by force_deregister.\n  Default false.\n\n- `encrypt_boot` (boolean) - Whether or not to encrypt the resulting AMI when\n  copying a provisioned instance to an AMI. By default, Packer will keep\n  the encryption setting to what it was in the source image. Setting false\n  will result in an unencrypted image, and true will result in an encrypted\n  one.\n  \n  If you have used the `launch_block_device_mappings` to set an encryption\n  key and that key is the same as the one you want the image encrypted with\n  at the end, then you don't need to set this field; leaving it empty will\n  prevent an unnecessary extra copy step and save you some time.\n  \n  Please note that if you are using an account with the global \"Always\n  encrypt new EBS volumes\" option set to `true`, Packer will be unable to\n  override this setting, and the final image will be encrypted whether\n  you set this value or not.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for AMI encryption. This\n  only applies to the main `region` -- any regions the AMI gets copied to\n  will be encrypted by the default EBS KMS key for that region,\n  unless you set region-specific keys in `region_kms_key_ids`.\n  \n  Set this value if you select `encrypt_boot`, but don't want to use the\n  region's default KMS key.\n  \n  If you have a custom kms key you'd like to apply to the launch volume,\n  and are only building in one region, it is more efficient to leave this\n  and `encrypt_boot` empty and to instead set the key id in the\n  launch_block_device_mappings (you can find an example below). This saves\n  potentially many minutes at the end of the build by preventing Packer\n  from having to copy and re-encrypt the image at the end of the build.\n  \n  For valid formats see *KmsKeyId* in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html).\n  This field is validated by Packer, when using an alias, you will have to\n  prefix `kms_key_id` with `alias/`.\n\n- `region_kms_key_ids` (map[string]string) - regions to copy the ami to, along with the custom kms key id (alias or\n  arn) to use for encryption for that region. Keys must match the regions\n  provided in `ami_regions`. If you just want to encrypt using a default\n  ID, you can stick with `kms_key_id` and `ami_regions`. If you want a\n  region to be encrypted with that region's default key ID, you can use an\n  empty string `\"\"` instead of a key id in this map. (e.g. `\"us-east-1\":\n  \"\"`) However, you cannot use default key IDs if you are using this in\n  conjunction with `snapshot_users` -- in that situation you must use\n  custom keys. For valid formats see *KmsKeyId* in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html).\n  \n  This option supercedes the `kms_key_id` option -- if you set both, and\n  they are different, Packer will respect the value in\n  `region_kms_key_ids` for your build region and silently disregard the\n  value provided in `kms_key_id`.\n\n- `skip_save_build_region` (bool) - If true, Packer will not check whether an AMI with the `ami_name` exists\n  in the region it is building in. It will use an intermediary AMI name,\n  which it will not convert to an AMI in the build region. It will copy\n  the intermediary AMI into any regions provided in `ami_regions`, then\n  delete the intermediary AMI. Default `false`.\n\n- `imds_support` (string) - Enforce version of the Instance Metadata Service on the built AMI.\n  Valid options are unset (legacy) and `v2.0`. See the documentation on\n  [IMDS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html)\n  for more information. Defaults to legacy.\n\n\u003c!-- End of code generated from the comments of the AMIConfig struct in builder/common/ami_config.go; --\u003e\n\n\n### Access Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_key` (string) - The access key used to communicate with AWS. [Learn how  to set this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials).\n  On EBS, this is not required if you are using `use_vault_aws_engine`\n  for authentication instead.\n\n- `region` (string) - The name of the region, such as `us-east-1`, in which\n  to launch the EC2 instance to create the AMI.\n  When chroot building, this value is guessed from environment.\n\n- `secret_key` (string) - The secret key used to communicate with AWS. [Learn how to set\n  this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials). This is not required\n  if you are using `use_vault_aws_engine` for authentication instead.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `assume_role` (AssumeRoleConfig) - If provided with a role ARN, Packer will attempt to assume this role\n  using the supplied credentials. See\n  [AssumeRoleConfig](#assume-role-configuration) below for more\n  details on all of the options available, and for a usage example.\n\n- `custom_endpoint_ec2` (string) - This option is useful if you use a cloud\n  provider whose API is compatible with aws EC2. Specify another endpoint\n  like this https://ec2.custom.endpoint.com.\n\n- `shared_credentials_file` (string) - Path to a credentials file to load credentials from\n\n- `decode_authorization_messages` (bool) - Enable automatic decoding of any encoded authorization (error) messages\n  using the `sts:DecodeAuthorizationMessage` API. Note: requires that the\n  effective user/role have permissions to `sts:DecodeAuthorizationMessage`\n  on resource `*`. Default `false`.\n\n- `insecure_skip_tls_verify` (bool) - This allows skipping TLS\n  verification of the AWS EC2 endpoint. The default is false.\n\n- `max_retries` (int) - This is the maximum number of times an API call is retried, in the case\n  where requests are being throttled or experiencing transient failures.\n  The delay between the subsequent API calls increases exponentially.\n\n- `mfa_code` (string) - The MFA\n  [TOTP](https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm)\n  code. This should probably be a user variable since it changes all the\n  time.\n\n- `profile` (string) - The profile to use in the shared credentials file for\n  AWS. See Amazon's documentation on [specifying\n  profiles](https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles)\n  for more details.\n\n- `skip_metadata_api_check` (bool) - Skip Metadata Api Check\n\n- `skip_credential_validation` (bool) - Set to true if you want to skip validating AWS credentials before runtime.\n\n- `token` (string) - The access token to use. This is different from the\n  access key and secret key. If you're not sure what this is, then you\n  probably don't need it. This will also be read from the AWS_SESSION_TOKEN\n  environmental variable.\n\n- `vault_aws_engine` (VaultAWSEngineOptions) - Get credentials from HashiCorp Vault's aws secrets engine. You must\n  already have created a role to use. For more information about\n  generating credentials via the Vault engine, see the [Vault\n  docs.](https://www.vaultproject.io/api/secret/aws#generate-credentials)\n  If you set this flag, you must also set the below options:\n  -   `name` (string) - Required. Specifies the name of the role to generate\n      credentials against. This is part of the request URL.\n  -   `engine_name` (string) - The name of the aws secrets engine. In the\n      Vault docs, this is normally referred to as \"aws\", and Packer will\n      default to \"aws\" if `engine_name` is not set.\n  -   `role_arn` (string)- The ARN of the role to assume if credential\\_type\n      on the Vault role is assumed\\_role. Must match one of the allowed role\n      ARNs in the Vault role. Optional if the Vault role only allows a single\n      AWS role ARN; required otherwise.\n  -   `ttl` (string) - Specifies the TTL for the use of the STS token. This\n      is specified as a string with a duration suffix. Valid only when\n      credential\\_type is assumed\\_role or federation\\_token. When not\n      specified, the default\\_sts\\_ttl set for the role will be used. If that\n      is also not set, then the default value of 3600s will be used. AWS\n      places limits on the maximum TTL allowed. See the AWS documentation on\n      the DurationSeconds parameter for AssumeRole (for assumed\\_role\n      credential types) and GetFederationToken (for federation\\_token\n      credential types) for more details.\n  \n  HCL2 example:\n  \n  ```hcl\n  vault_aws_engine {\n      name = \"myrole\"\n      role_arn = \"myarn\"\n      ttl = \"3600s\"\n  }\n  ```\n  \n  JSON example:\n  \n  ```json\n  {\n      \"vault_aws_engine\": {\n          \"name\": \"myrole\",\n          \"role_arn\": \"myarn\",\n          \"ttl\": \"3600s\"\n      }\n  }\n  ```\n\n- `aws_polling` (\\*AWSPollingConfig) - [Polling configuration](#polling-configuration) for the AWS waiter. Configures the waiter that checks\n  resource state.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Assume Role Configuration\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\nAssumeRoleConfig lets users set configuration options for assuming a special\nrole when executing Packer.\n\nUsage example:\n\nHCL config example:\n\n```HCL\n\n\tsource \"amazon-ebs\" \"example\" {\n\t\tassume_role {\n\t\t\trole_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n\t\t\tsession_name = \"SESSION_NAME\"\n\t\t\texternal_id  = \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\nJSON config example:\n\n```json\n\n\tbuilder{\n\t\t\"type\": \"amazon-ebs\",\n\t\t\"assume_role\": {\n\t\t\t\"role_arn\"    :  \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\",\n\t\t\t\"session_name\":  \"SESSION_NAME\",\n\t\t\t\"external_id\" :  \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `role_arn` (string) - Amazon Resource Name (ARN) of the IAM Role to assume.\n\n- `duration_seconds` (int) - Number of seconds to restrict the assume role session duration.\n\n- `external_id` (string) - The external ID to use when assuming the role. If omitted, no external\n  ID is passed to the AssumeRole call.\n\n- `policy` (string) - IAM Policy JSON describing further restricting permissions for the IAM\n  Role being assumed.\n\n- `policy_arns` ([]string) - Set of Amazon Resource Names (ARNs) of IAM Policies describing further\n  restricting permissions for the IAM Role being\n\n- `session_name` (string) - Session name to use when assuming the role.\n\n- `tags` (map[string]string) - Map of assume role session tags.\n\n- `transitive_tag_keys` ([]string) - Set of assume role session tag keys to pass to any subsequent sessions.\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Polling Configuration\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\nPolling configuration for the AWS waiter. Configures the waiter for resources creation or actions like attaching\nvolumes or importing image.\n\nHCL2 example:\n```hcl\n\n\taws_polling {\n\t\t delay_seconds = 30\n\t\t max_attempts = 50\n\t}\n\n```\n\nJSON example:\n```json\n\n\t\"aws_polling\" : {\n\t\t \"delay_seconds\": 30,\n\t\t \"max_attempts\": 50\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\n- `max_attempts` (int) - Specifies the maximum number of attempts the waiter will check for resource state.\n  This value can also be set via the AWS_MAX_ATTEMPTS.\n  If both option and environment variable are set, the max_attempts will be considered over the AWS_MAX_ATTEMPTS.\n  If none is set, defaults to AWS waiter default which is 40 max_attempts.\n\n- `delay_seconds` (int) - Specifies the delay in seconds between attempts to check the resource state.\n  This value can also be set via the AWS_POLL_DELAY_SECONDS.\n  If both option and environment variable are set, the delay_seconds will be considered over the AWS_POLL_DELAY_SECONDS.\n  If none is set, defaults to AWS waiter default which is 15 seconds.\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n### Run Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `instance_type` (string) - The EC2 instance type to use while building the\n  AMI, such as t2.small.\n\n- `source_ami` (string) - The source AMI whose root volume will be copied and\n  provisioned on the currently running instance. This must be an EBS-backed\n  AMI with a root volume snapshot that you have access to.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `associate_public_ip_address` (confighelper.Trilean) - If using a non-default VPC,\n  public IP addresses are not provided by default. If this is true, your\n  new instance will get a Public IP. default: unset\n  \n  Note: when specifying this attribute without a `subnet_[id|filter]` or\n  `vpc_[id|filter]`, we will attempt to infer this information from the\n  default VPC/Subnet.\n  This operation may require some extra permissions to the IAM role that\n  runs the build:\n  \n  * ec2:DescribeVpcs\n  * ec2:DescribeSubnets\n  \n  Additionally, since we filter subnets/AZs by their capability to host\n  an instance of the selected type, you may also want to define the\n  `ec2:DescribeInstanceTypeOfferings` action to the role running the build.\n  Otherwise, Packer will pick the most available subnet in the VPC selected,\n  which may not be able to host the instance type you provided.\n\n- `availability_zone` (string) - Destination availability zone to launch\n  instance in. Leave this empty to allow Amazon to auto-assign.\n\n- `block_duration_minutes` (int64) - Requires spot_price to be set. The\n  required duration for the Spot Instances (also known as Spot blocks). This\n  value must be a multiple of 60 (60, 120, 180, 240, 300, or 360). You can't\n  specify an Availability Zone group or a launch group if you specify a\n  duration. Note: This parameter is no longer available to new customers\n  from July 1, 2021. [See Amazon's\n  documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-requests.html#fixed-duration-spot-instances).\n\n- `capacity_reservation_preference` (string) - Set the preference for using a capacity reservation if one exists.\n  Either will be `open` or `none`. Defaults to `none`\n\n- `capacity_reservation_id` (string) - Provide the specific EC2 Capacity Reservation ID that will be used\n  by Packer.\n\n- `capacity_reservation_group_arn` (string) - Provide the EC2 Capacity Reservation Group ARN that will be used by\n  Packer.\n\n- `disable_stop_instance` (bool) - Packer normally stops the build instance after all provisioners have\n  run. For Windows instances, it is sometimes desirable to [run\n  Sysprep](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/Creating_EBSbacked_WinAMI.html)\n  which will stop the instance for you. If this is set to `true`, Packer\n  *will not* stop the instance but will assume that you will send the stop\n  signal yourself through your final provisioner. You can do this with a\n  [windows-shell provisioner](/packer/integrations/hashicorp/windows-shell). Note that\n  Packer will still wait for the instance to be stopped, and failing to\n  send the stop signal yourself, when you have set this flag to `true`,\n  will cause a timeout.\n  \n  An example of a valid windows shutdown command in a `windows-shell`\n  provisioner is :\n  ```shell-session\n    ec2config.exe -sysprep\n  ```\n  or\n  ```sell-session\n    \"%programfiles%\\amazon\\ec2configservice\\\"ec2config.exe -sysprep\"\"\n  ```\n  -\u003e Note: The double quotation marks in the command are not required if\n  your CMD shell is already in the\n  `C:\\Program Files\\Amazon\\EC2ConfigService\\` directory.\n\n- `ebs_optimized` (bool) - Mark instance as [EBS\n  Optimized](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html).\n  Default `false`.\n\n- `enable_nitro_enclave` (bool) - Enable support for Nitro Enclaves on the instance.  Note that the instance type must\n  be able to [support Nitro Enclaves](https://aws.amazon.com/ec2/nitro/nitro-enclaves/faqs/).\n  This option is not supported for spot instances.\n\n- `enable_t2_unlimited` (bool) - Deprecated argument - please use \"enable_unlimited_credits\".\n  Enabling T2 Unlimited allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-credits-baseline-concepts.html)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-unlimited.html)\n  and the **T2 Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [T2\n  Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-std.html)\n  instance instead.\n  \n  To use T2 Unlimited you must use a T2 instance type, e.g. `t2.micro`.\n  Additionally, T2 Unlimited cannot be used in conjunction with Spot\n  Instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error.\n  \n  !\u0026gt; **Warning!** Additional costs may be incurred by enabling T2\n  Unlimited - even for instances that would usually qualify for the\n  [AWS Free Tier](https://aws.amazon.com/free/).\n\n- `enable_unlimited_credits` (bool) - Enabling Unlimited credits allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html#unlimited-mode-surplus-credits)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html)\n  and the **Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-standard-mode.html)\n  instance instead.\n  \n  To use Unlimited you must use a T2/T3/T3a/T4g instance type, e.g. (`t2.micro`, `t3.micro`).\n  Additionally, Unlimited cannot be used in conjunction with Spot\n  Instances for T2 type instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error if the underlying instance type is a T2 type instance.\n  By default the supported burstable instance types (including t3/t3a/t4g) will be provisioned with its cpu credits set to standard,\n  only when `enable_unlimited_credits` is true will the instance be provisioned with unlimited cpu credits.\n\n- `iam_instance_profile` (string) - The name of an [IAM instance\n  profile](https://docs.aws.amazon.com/IAM/latest/UserGuide/instance-profiles.html)\n  to launch the EC2 instance with.\n\n- `fleet_tags` (map[string]string) - Key/value pair tags to apply tags to the fleet that is issued.\n\n- `fleet_tag` ([]{key string, value string}) - Same as [`fleet_tags`](#fleet_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `skip_profile_validation` (bool) - Whether or not to check if the IAM instance profile exists. Defaults to false\n\n- `temporary_iam_instance_profile_policy_document` (\\*PolicyDocument) - Temporary IAM instance profile policy document\n  If IamInstanceProfile is specified it will be used instead.\n  \n  HCL2 example:\n  ```hcl\n  temporary_iam_instance_profile_policy_document {\n  \tStatement {\n  \t\tAction   = [\"logs:*\"]\n  \t\tEffect   = \"Allow\"\n  \t\tResource = [\"*\"]\n  \t}\n  \tVersion = \"2012-10-17\"\n  }\n  ```\n  \n  JSON example:\n  ```json\n  {\n  \t\"Version\": \"2012-10-17\",\n  \t\"Statement\": [\n  \t\t{\n  \t\t\t\"Action\": [\n  \t\t\t\"logs:*\"\n  \t\t\t],\n  \t\t\t\"Effect\": \"Allow\",\n  \t\t\t\"Resource\": [\"*\"]\n  \t\t}\n  \t]\n  }\n  ```\n\n- `shutdown_behavior` (string) - Automatically terminate instances on\n  shutdown in case Packer exits ungracefully. Possible values are stop and\n  terminate. Defaults to stop.\n\n- `security_group_filter` (SecurityGroupFilterOptions) - Filters used to populate the `security_group_ids` field.\n  \n  HCL2 Example:\n  \n  ```hcl\n    security_group_filter {\n      filters = {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  ```\n  \n  JSON Example:\n  ```json\n  {\n    \"security_group_filter\": {\n      \"filters\": {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  }\n  ```\n  \n  This selects the SG's with tag `Class` with the value `packer`.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a\n      `security_group_ids`. Any filter described in the docs for\n      [DescribeSecurityGroups](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSecurityGroups.html)\n      is valid.\n  \n  `security_group_ids` take precedence over this.\n\n- `run_tags` (map[string]string) - Key/value pair tags to apply to the generated key-pair, security group, iam profile and role, snapshot, network interfaces and instance\n  that is *launched* to create the EBS volumes. The resulting AMI will also inherit these tags.\n  This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `run_tag` ([]{key string, value string}) - Same as [`run_tags`](#run_tags) but defined as a singular repeatable\n  block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `security_group_id` (string) - The ID (not the name) of the security\n  group to assign to the instance. By default this is not set and Packer will\n  automatically create a new temporary security group to allow SSH access.\n  Note that if this is specified, you must be sure the security group allows\n  access to the ssh_port given below.\n\n- `security_group_ids` ([]string) - A list of security groups as\n  described above. Note that if this is specified, you must omit the\n  security_group_id.\n\n- `source_ami_filter` (AmiFilterOptions) - Filters used to populate the `source_ami`\n  field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    source_ami_filter {\n      filters = {\n         virtualization-type = \"hvm\"\n         name = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n         root-device-type = \"ebs\"\n      }\n      owners = [\"099720109477\"]\n      most_recent = true\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"source_ami_filter\": {\n         \"filters\": {\n         \"virtualization-type\": \"hvm\",\n         \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n         \"root-device-type\": \"ebs\"\n         },\n         \"owners\": [\"099720109477\"],\n         \"most_recent\": true\n      }\n    }\n  ]\n  ```\n  \n    This selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. NOTE:\n    This will fail unless *exactly* one AMI is returned. In the above example,\n    `most_recent` will cause this to succeed by selecting the newest image.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `source_ami`.\n        NOTE: This will fail unless *exactly* one AMI is returned. Any filter\n        described in the docs for\n        [DescribeImages](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html)\n        is valid.\n  \n    -   `owners` (array of strings) - Filters the images by their owner. You\n        may specify one or more AWS account IDs, \"self\" (which will use the\n        account whose credentials you are using to run Packer), or an AWS owner\n        alias: for example, `amazon`, `aws-marketplace`, or `microsoft`. This\n        option is required for security reasons.\n  \n    -   `most_recent` (boolean) - Selects the newest created image when true.\n        This is most useful for selecting a daily distro build.\n  \n    You may set this in place of `source_ami` or in conjunction with it. If you\n    set this in conjunction with `source_ami`, the `source_ami` will be added\n    to the filter. The provided `source_ami` must meet all of the filtering\n    criteria provided in `source_ami_filter`; this pins the AMI returned by the\n    filter, but will cause Packer to fail if the `source_ami` does not exist.\n\n- `spot_instance_types` ([]string) - a list of acceptable instance\n  types to run your build on. We will request a spot instance using the max\n  price of spot_price and the allocation strategy of \"lowest price\".\n  Your instance will be launched on an instance type of the lowest available\n  price that you have in your list.  This is used in place of instance_type.\n  You may only set either spot_instance_types or instance_type, not both.\n  This feature exists to help prevent situations where a Packer build fails\n  because a particular availability zone does not have capacity for the\n  specific instance_type requested in instance_type.\n\n- `spot_price` (string) - With Spot Instances, you pay the Spot price that's in effect for the\n  time period your instances are running. Spot Instance prices are set by\n  Amazon EC2 and adjust gradually based on long-term trends in supply and\n  demand for Spot Instance capacity.\n  \n  When this field is set, it represents the maximum hourly price you are\n  willing to pay for a spot instance. If you do not set this value, it\n  defaults to a maximum price equal to the on demand price of the\n  instance. In the situation where the current Amazon-set spot price\n  exceeds the value set in this field, Packer will not launch an instance\n  and the build will error. In the situation where the Amazon-set spot\n  price is less than the value set in this field, Packer will launch and\n  you will pay the Amazon-set spot price, not this maximum value.\n  For more information, see the Amazon docs on\n  [spot pricing](https://aws.amazon.com/ec2/spot/pricing/).\n\n- `spot_tags` (map[string]string) - Requires spot_price to be set. Key/value pair tags to apply tags to the\n  spot request that is issued.\n\n- `spot_tag` ([]{key string, value string}) - Same as [`spot_tags`](#spot_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `subnet_filter` (SubnetFilterOptions) - Filters used to populate the `subnet_id` field.\n  \n  HCL2 example:\n  \n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    subnet_filter {\n      filters = {\n            \"tag:Class\": \"build\"\n      }\n      most_free = true\n      random = false\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"subnet_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\"\n        },\n        \"most_free\": true,\n        \"random\": false\n      }\n    }\n  ]\n  ```\n  \n    This selects the Subnet with tag `Class` with the value `build`, which has\n    the most free IP addresses. NOTE: This will fail unless *exactly* one\n    Subnet is returned. By using `most_free` or `random` one will be selected\n    from those matching the filter.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `subnet_id`.\n        NOTE: This will fail unless *exactly* one Subnet is returned. Any\n        filter described in the docs for\n        [DescribeSubnets](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSubnets.html)\n        is valid.\n  \n    -   `most_free` (boolean) - The Subnet with the most free IPv4 addresses\n        will be used if multiple Subnets matches the filter.\n  \n    -   `random` (boolean) - A random Subnet will be used if multiple Subnets\n        matches the filter. `most_free` have precendence over this.\n  \n    `subnet_id` take precedence over this.\n\n- `subnet_id` (string) - If using VPC, the ID of the subnet, such as\n  subnet-12345def, where Packer will launch the EC2 instance. This field is\n  required if you are using an non-default VPC.\n\n- `license_specifications` ([]LicenseSpecification) - The license configurations.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    license_specifications {\n      license_configuration_request = {\n        license_configuration_arn = \"${var.license_configuration_arn}\"\n      }\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"license_specifications\": [\n        {\n          \"license_configuration_request\": {\n            \"license_configuration_arn\": \"{{user `license_configuration_arn`}}\"\n          }\n        }\n      ]\n    }\n  ]\n  ```\n  \n    Each `license_configuration_request` describes a license configuration,\n    the properties of which are:\n  \n    - `license_configuration_arn` (string) - The Amazon Resource Name (ARN)\n      of the license configuration.\n\n- `placement` (Placement) - Describes the placement of an instance.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    placement = {\n      host_resource_group_arn = \"${var.host_resource_group_arn}\"\n      tenancy                 = \"${var.placement_tenancy}\"\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"placement\": {\n        \"host_resource_group_arn\": \"{{user `host_resource_group_arn`}}\",\n        \"tenancy\": \"{{user `placement_tenancy`}}\"\n      }\n    }\n  ]\n  ```\n  \n    - `host_resource_group_arn` (string) - The ARN of the host resource\n      group in which to launch the instances. If you specify a host\n      resource group ARN, omit the Tenancy parameter or set it to `host`.\n    - `tenancy` (string) - The tenancy of the instance (if the instance is\n      running in a VPC). An instance with a tenancy of `dedicated` runs on\n      single-tenant hardware. The default is `default`, meaning shared\n      tenancy. Allowed values are `default`, `dedicated` and `host`.\n\n- `tenancy` (string) - Deprecated: Use Placement Tenancy instead.\n\n- `temporary_security_group_source_cidrs` ([]string) - A list of IPv4 CIDR blocks to be authorized access to the instance, when\n  packer is creating a temporary security group.\n  \n  The default is [`0.0.0.0/0`] (i.e., allow any IPv4 source).\n  Use `temporary_security_group_source_public_ip` to allow current host's\n  public IP instead of any IPv4 source.\n  This is only used when `security_group_id` or `security_group_ids` is not\n  specified.\n\n- `temporary_security_group_source_public_ip` (bool) - When enabled, use public IP of the host (obtained from https://checkip.amazonaws.com)\n  as CIDR block to be authorized access to the instance, when packer\n  is creating a temporary security group. Defaults to `false`.\n  \n  This is only used when `security_group_id`, `security_group_ids`,\n  and `temporary_security_group_source_cidrs` are not specified.\n\n- `user_data` (string) - User data to apply when launching the instance. Note\n  that you need to be careful about escaping characters due to the templates\n  being JSON. It is often more convenient to use user_data_file, instead.\n  Packer will not automatically wait for a user script to finish before\n  shutting down the instance this must be handled in a provisioner.\n\n- `user_data_file` (string) - Path to a file that will be used for the user\n  data when launching the instance.\n\n- `vpc_filter` (VpcFilterOptions) - Filters used to populate the `vpc_id` field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    vpc_filter {\n      filters = {\n        \"tag:Class\": \"build\",\n        \"isDefault\": \"false\",\n        \"cidr\": \"/24\"\n      }\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"vpc_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\",\n          \"isDefault\": \"false\",\n          \"cidr\": \"/24\"\n        }\n      }\n    }\n  ]\n  ```\n  \n  This selects the VPC with tag `Class` with the value `build`, which is not\n  the default VPC, and have a IPv4 CIDR block of `/24`. NOTE: This will fail\n  unless *exactly* one VPC is returned.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `vpc_id`. NOTE:\n      This will fail unless *exactly* one VPC is returned. Any filter\n      described in the docs for\n      [DescribeVpcs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeVpcs.html)\n      is valid.\n  \n  `vpc_id` take precedence over this.\n\n- `vpc_id` (string) - If launching into a VPC subnet, Packer needs the VPC ID\n  in order to create a temporary security group within the VPC. Requires\n  subnet_id to be set. If this field is left blank, Packer will try to get\n  the VPC ID from the subnet_id.\n\n- `windows_password_timeout` (duration string | ex: \"1h5m2s\") - The timeout for waiting for a Windows\n  password for Windows instances. Defaults to 20 minutes. Example value:\n  10m\n\n- `metadata_options` (MetadataOptions) - [Metadata Settings](#metadata-settings)\n\n- `ssh_interface` (string) - One of `public_ip`, `private_ip`, `public_dns`, `private_dns` or `session_manager`.\n     If set, either the public IP address, private IP address, public DNS name\n     or private DNS name will be used as the host for SSH. The default behaviour\n     if inside a VPC is to use the public IP address if available, otherwise\n     the private IP address will be used. If not in a VPC the public DNS name\n     will be used. Also works for WinRM.\n  \n     Where Packer is configured for an outbound proxy but WinRM traffic\n     should be direct, `ssh_interface` must be set to `private_dns` and\n     `\u003cregion\u003e.compute.internal` included in the `NO_PROXY` environment\n     variable.\n  \n     When using `session_manager` the machine running Packer must have\n  \t  the AWS Session Manager Plugin installed and within the users' system path.\n     Connectivity via the `session_manager` interface establishes a secure tunnel\n     between the local host and the remote host on an available local port to the specified `ssh_port`.\n     See [Session Manager Connections](#session-manager-connections) for more information.\n     - Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM communicator.\n     - Upon termination the secure tunnel will be terminated automatically, if however there is a failure in\n     terminating the tunnel it will automatically terminate itself after 20 minutes of inactivity.\n\n- `pause_before_ssm` (duration string | ex: \"1h5m2s\") - The time to wait before establishing the Session Manager session.\n  The value of this should be a duration. Examples are\n  `5s` and `1m30s` which will cause Packer to wait five seconds and one\n  minute 30 seconds, respectively. If no set, defaults to 10 seconds.\n  This option is useful when the remote port takes longer to become available.\n\n- `session_manager_port` (int) - Which port to connect the local end of the session tunnel to. If\n  left blank, Packer will choose a port for you from available ports.\n  This option is only used when `ssh_interface` is set `session_manager`.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n### Session Manager Connections\n\nSupport for the AWS Systems Manager session manager lets users manage EC2 instances without the need to open inbound ports, or maintain bastion hosts. Session manager connectivity relies on the use of the [session manager plugin](#session-manager-plugin) to open a secure tunnel between the local machine and the remote instance. Once the tunnel has been created all SSH communication will be tunneled through SSM to the remote instance.\n\n-\u003e Note: Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM Communicator.\n\nTo use the session manager as the connection interface for the SSH communicator you need to add the following configuration options to the Amazon builder options:\n\n- `ssh_interface`: The ssh interface must be set to \"session_manager\". When using this option the builder will create an SSM tunnel to the configured `ssh_port` (defaults to 22) on the remote host.\n- `iam_instance_profile`: A valid instance profile granting Systems Manager permissions to manage the remote instance is required in order for the aws ssm-agent to start and stop session connections.\n  See below for more details on [IAM instance profile for Systems Manager](#iam-instance-profile-for-systems-manager).\n\n#### Optional\n\n- `session_manager_port`: A local port on the host machine that should be used as the local end of the session tunnel to the remote host. If not specified Packer will find an available port to use.\n- `temporary_iam_instance_profile_policy_document`: Creates a temporary instance profile policy document to grant Systems Manager permissions to the Ec2 instance. This is an alternative to using an existing `iam_instance_profile`.\n\nHCL2 example:\n\n```hcl\n# file: example.pkr.hcl\n\n# In order to get these variables to read from the environment,\n# set the environment variables to have the same name as the declared\n# variables, with the prefix PKR_VAR_.\n# You could also hardcode them into the file, but we do not recommend that.\n\ndata \"amazon-ami\" \"example\" {\n  filters = {\n    virtualization-type = \"hvm\"\n    name                = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n    root-device-type    = \"ebs\"\n  }\n  owners      = [\"099720109477\"]\n  most_recent = true\n  region      = \"us-east-1\"\n}\n\nsource \"amazon-ebs\" \"ssm-example\" {\n  ami_name             = \"packer_AWS {{timestamp}}\"\n  instance_type        = \"t2.micro\"\n  region               = \"us-east-1\"\n  source_ami           = data.amazon-ami.example.id\n  ssh_username         = \"ubuntu\"\n  ssh_interface        = \"session_manager\"\n  communicator         = \"ssh\"\n  iam_instance_profile = \"myinstanceprofile\"\n}\n\nbuild {\n  sources = [\"source.amazon-ebs.ssm-example\"]\n\n  provisioner \"shell\" {\n    inline = [\"echo Connected via SSM at '${build.User}@${build.Host}:${build.Port}'\"]\n  }\n}\n```\n\nJSON example:\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"ami_name\": \"packer-ami-{{timestamp}}\",\n      \"instance_type\": \"t2.micro\",\n      \"source_ami_filter\": {\n        \"filters\": {\n          \"virtualization-type\": \"hvm\",\n          \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n          \"root-device-type\": \"ebs\"\n        },\n        \"owners\": [\"099720109477\"],\n        \"most_recent\": true\n      },\n      \"ssh_username\": \"ubuntu\",\n      \"ssh_interface\": \"session_manager\",\n      \"communicator\": \"ssh\",\n      \"iam_instance_profile\": \"{{user `iam_instance_profile`}}\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"type\": \"shell\",\n      \"inline\": [\n        \"echo Connected via SSM at '{{build `User`}}@{{build `Host`}}:{{build `Port`}}'\"\n      ]\n    }\n  ]\n}\n```\n\n#### Session Manager Plugin\n\nConnectivity via the session manager requires the use of a session-manger-plugin, which needs to be installed alongside Packer, and an instance AMI that is capable of running the AWS ssm-agent - see [About SSM Agent](https://docs.aws.amazon.com/systems-manager/latest/userguide/prereqs-ssm-agent.html) for details on supported AMIs.\n\nIn order for Packer to start and end sessions that connect you to your managed instances, you must first install the Session Manager plugin on your local machine. The plugin can be installed on supported versions of Microsoft Windows, macOS, Linux, and Ubuntu Server.\n[Installation instructions for the session-manager-plugin](https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html)\n\n#### IAM instance profile for Systems Manager\n\nBy default Systems Manager doesn't have permission to perform actions on created instances so SSM access must be granted by creating an instance profile with the `AmazonSSMManagedInstanceCore` policy. The instance profile can then be attached to any instance you wish to manage via the session-manager-plugin. See [Adding System Manager instance profile](https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html#instance-profile-add-permissions) for details on creating the required instance profile.\n\n#### Permissions for Closing the Tunnel\n\nTo close the SSM tunnels created, this plugin relies on being able to call\n[DescribeInstanceStatus](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstanceStatus.html).\nIn case this is not possible you might see a `Bad exit status` message in the logs.\n\nThe absence of this permission won't prevent you from building the AMI, and the error only means that packer is not able to close the tunnel gracefully.\n\n\n### Block Devices Configuration\n\nBlock devices can be nested in the\n[ami_block_device_mappings](#ami_block_device_mappings) or the\n[launch_block_device_mappings](#launch_block_device_mappings) array.\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\nThese will be attached when launching your instance. Your\noptions here may vary depending on the type of VM you use.\n\nExample use case:\n\nThe following mapping will tell Packer to encrypt the root volume of the\nbuild instance at launch using a specific non-default kms key:\n\nHCL2 example:\n\n```hcl\n\n\tlaunch_block_device_mappings {\n\t    device_name = \"/dev/sda1\"\n\t    encrypted = true\n\t    kms_key_id = \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n```\n\nJSON example:\n```json\n\"launch_block_device_mappings\": [\n\n\t{\n\t   \"device_name\": \"/dev/sda1\",\n\t   \"encrypted\": true,\n\t   \"kms_key_id\": \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n]\n```\n\nPlease note that the kms_key_id option in this example exists for\nlaunch_block_device_mappings but not ami_block_device_mappings.\n\nDocumentation for Block Devices Mappings can be found here:\nhttps://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `delete_on_termination` (bool) - Indicates whether the EBS volume is deleted on instance termination.\n  Default false. NOTE: If this value is not explicitly set to true and\n  volumes are not cleaned up by an alternative method, additional volumes\n  will accumulate after every build.\n\n- `device_name` (string) - The device name exposed to the instance (for example, /dev/sdh or xvdh).\n  Required for every device in the block device mapping.\n\n- `encrypted` (boolean) - Indicates whether or not to encrypt the volume. By default, Packer will\n  keep the encryption setting to what it was in the source image. Setting\n  false will result in an unencrypted device, and true will result in an\n  encrypted one.\n\n- `iops` (\\*int64) - The number of I/O operations per second (IOPS) that the volume supports.\n  See the documentation on\n  [IOPs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `no_device` (bool) - Suppresses the specified device included in the block device mapping of\n  the AMI.\n\n- `snapshot_id` (string) - The ID of the snapshot.\n\n- `throughput` (\\*int64) - The throughput for gp3 volumes, only valid for gp3 types\n  See the documentation on\n  [Throughput](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `virtual_name` (string) - The virtual device name. See the documentation on Block Device Mapping\n  for more information.\n\n- `volume_type` (string) - The volume type. gp2 \u0026 gp3 for General Purpose (SSD) volumes, io1 \u0026 io2\n  for Provisioned IOPS (SSD) volumes, st1 for Throughput Optimized HDD,\n  sc1 for Cold HDD, and standard for Magnetic volumes.\n\n- `volume_size` (int64) - The size of the volume, in GiB. Required if not specifying a\n  snapshot_id.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for boot volume encryption.\n  This option exists for launch_block_device_mappings but not\n  ami_block_device_mappings. The kms key id defined here only applies to\n  the original build region; if the AMI gets copied to other regions, the\n  volume in those regions will be encrypted by the default EBS KMS key.\n  For valid formats see KmsKeyId in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html)\n  This field is validated by Packer. When using an alias, you will have to\n  prefix kms_key_id with alias/.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n### Communicator Configuration\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `communicator` (string) - Packer currently supports three kinds of communicators:\n  \n  -   `none` - No communicator will be used. If this is set, most\n      provisioners also can't be used.\n  \n  -   `ssh` - An SSH connection will be established to the machine. This\n      is usually the default.\n  \n  -   `winrm` - A WinRM connection will be established.\n  \n  In addition to the above, some builders have custom communicators they\n  can use. For example, the Docker builder has a \"docker\" communicator\n  that uses `docker exec` and `docker cp` to execute scripts and copy\n  files.\n\n- `pause_before_connecting` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\n  guest's bootstrap script, but sometimes you may have a race condition\n  where you need Packer to wait before attempting to connect to your\n  guest.\n  \n  If you end up in this situation, you can use the template option\n  `pause_before_connecting`. By default, there is no pause. For example if\n  you set `pause_before_connecting` to `10m` Packer will check whether it\n  can connect, as normal. But once a connection attempt is successful, it\n  will disconnect and then wait 10 minutes before connecting to the guest\n  and beginning provisioning.\n\n\u003c!-- End of code generated from the comments of the Config struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSH struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ssh_host` (string) - The address to SSH to. This usually is automatically configured by the\n  builder.\n\n- `ssh_port` (int) - The port to connect to SSH. This defaults to `22`.\n\n- `ssh_username` (string) - The username to connect to SSH with. Required if using SSH.\n\n- `ssh_password` (string) - A plaintext password to use to authenticate with SSH.\n\n- `ssh_ciphers` ([]string) - This overrides the value of ciphers supported by default by Golang.\n  The default value is [\n    \"aes128-gcm@openssh.com\",\n    \"chacha20-poly1305@openssh.com\",\n    \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n  ]\n  \n  Valid options for ciphers include:\n  \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\",\n  \"chacha20-poly1305@openssh.com\",\n  \"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",\n\n- `ssh_clear_authorized_keys` (bool) - If true, Packer will attempt to remove its temporary key from\n  `~/.ssh/authorized_keys` and `/root/.ssh/authorized_keys`. This is a\n  mostly cosmetic option, since Packer will delete the temporary private\n  key from the host system regardless of whether this is set to true\n  (unless the user has set the `-debug` flag). Defaults to \"false\";\n  currently only works on guests with `sed` installed.\n\n- `ssh_key_exchange_algorithms` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\n  supported by default by Golang. Acceptable values include:\n  \"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\",\n  \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n  \"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".\n\n- `ssh_certificate_file` (string) - Path to user certificate used to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_pty` (bool) - If `true`, a PTY will be requested for the SSH connection. This defaults\n  to `false`.\n\n- `ssh_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\n  determine when the machine has booted so this is usually quite long.\n  Example value: `10m`.\n  This defaults to `5m`, unless `ssh_handshake_attempts` is set.\n\n- `ssh_disable_agent_forwarding` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `false`.\n\n- `ssh_handshake_attempts` (int) - The number of handshakes to attempt with SSH once it can connect.\n  This defaults to `10`, unless a `ssh_timeout` is set.\n\n- `ssh_bastion_host` (string) - A bastion host to use for the actual SSH connection.\n\n- `ssh_bastion_port` (int) - The port of the bastion host. Defaults to `22`.\n\n- `ssh_bastion_agent_auth` (bool) - If `true`, the local SSH agent will be used to authenticate with the\n  bastion host. Defaults to `false`.\n\n- `ssh_bastion_username` (string) - The username to connect to the bastion host.\n\n- `ssh_bastion_password` (string) - The password to use to authenticate with the bastion host.\n\n- `ssh_bastion_interactive` (bool) - If `true`, the keyboard-interactive used to authenticate with bastion host.\n\n- `ssh_bastion_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with the\n  bastion host. The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_bastion_certificate_file` (string) - Path to user certificate used to authenticate with bastion host.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_file_transfer_method` (string) - `scp` or `sftp` - How to transfer files, Secure copy (default) or SSH\n  File Transfer Protocol.\n  \n  **NOTE**: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n  (the default protocol for copying data) returns a a non-zero error code since the MOTW\n  cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\n  with SFTP instead `ssh_file_transfer_protocol = \"sftp\"`.\n\n- `ssh_proxy_host` (string) - A SOCKS proxy host to use for SSH connection\n\n- `ssh_proxy_port` (int) - A port of the SOCKS proxy. Defaults to `1080`.\n\n- `ssh_proxy_username` (string) - The optional username to authenticate with the proxy server.\n\n- `ssh_proxy_password` (string) - The optional password to use to authenticate with the proxy server.\n\n- `ssh_keep_alive_interval` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\n  value (`-1s`) to disable. Example value: `10s`. Defaults to `5s`.\n\n- `ssh_read_write_timeout` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\n  useful if, for example, packer hangs on a connection after a reboot.\n  Example: `5m`. Disabled by default.\n\n- `ssh_remote_tunnels` ([]string) - \n\n- `ssh_local_tunnels` ([]string) - \n\n\u003c!-- End of code generated from the comments of the SSH struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `temporary_key_pair_type` (string) - `dsa` | `ecdsa` | `ed25519` | `rsa` ( the default )\n  \n  Specifies the type of key to create. The possible values are 'dsa',\n  'ecdsa', 'ed25519', or 'rsa'.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure, please\n  consider other alternatives like RSA or ED25519.\n\n- `temporary_key_pair_bits` (int) - Specifies the number of bits in the key to create. For RSA keys, the\n  minimum size is 1024 bits and the default is 4096 bits. Generally, 3072\n  bits is considered sufficient. DSA keys must be exactly 1024 bits as\n  specified by FIPS 186-2. For ECDSA keys, bits determines the key length\n  by selecting from one of three elliptic curve sizes: 256, 384 or 521\n  bits. Attempting to use bit lengths other than these three values for\n  ECDSA keys will fail. Ed25519 keys have a fixed length and bits will be\n  ignored.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure as specified\n  by FIPS 186-5, please consider other alternatives like RSA or ED25519.\n\n\u003c!-- End of code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; --\u003e\n\n\n- `ssh_keypair_name` (string) - If specified, this is the key that will be used for SSH with the\n  machine. The key must match a key pair name loaded up into the remote.\n  By default, this is blank, and Packer will generate a temporary keypair\n  unless [`ssh_password`](#ssh_password) is used.\n  [`ssh_private_key_file`](#ssh_private_key_file) or\n  [`ssh_agent_auth`](#ssh_agent_auth) must be specified when\n  [`ssh_keypair_name`](#ssh_keypair_name) is utilized.\n\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n- `ssh_agent_auth` (bool) - If true, the local SSH agent will be used to authenticate connections to\n  the source instance. No temporary keypair will be created, and the\n  values of [`ssh_password`](#ssh_password) and\n  [`ssh_private_key_file`](#ssh_private_key_file) will be ignored. The\n  environment variable `SSH_AUTH_SOCK` must be set for this option to work\n  properly.\n\n\n## Basic Example\n\nHere is a basic example. It is completely valid except for the access keys:\n\n**HCL2**\n\n```hcl\nsource \"amazon-instance\" \"basic-example\" {\n  region = \"us-east-1\"\n  source_ami = \"ami-d9d6a6b0\"\n  instance_type = \"m1.small\"\n  ssh_username = \"ubuntu\"\n\n  account_id = \"0123-4567-0890\"\n  s3_bucket = \"packer-images\"\n  x509_cert_path = \"x509.cert\"\n  x509_key_path = \"x509.key\"\n  x509_upload_path = \"/tmp\"\n}\n\nbuild {\n  source \"sources.amazon-instance.basic-example\" {\n    ami_name = \"packer-quick-start {{timestamp}}\"\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"type\": \"amazon-instance\",\n  \"access_key\": \"YOUR KEY HERE\",\n  \"secret_key\": \"YOUR SECRET KEY HERE\",\n  \"region\": \"us-east-1\",\n  \"source_ami\": \"ami-d9d6a6b0\",\n  \"instance_type\": \"m1.small\",\n  \"ssh_username\": \"ubuntu\",\n\n  \"account_id\": \"0123-4567-0890\",\n  \"s3_bucket\": \"packer-images\",\n  \"x509_cert_path\": \"x509.cert\",\n  \"x509_key_path\": \"x509.key\",\n  \"x509_upload_path\": \"/tmp\",\n\n  \"ami_name\": \"packer-quick-start {{timestamp}}\"\n}\n```\n\n\n-\u003e **Note:** Packer can also read the access key and secret access key from\nenvironmental variables. See the configuration reference in the section above\nfor more information on what environmental variables Packer will look for.\n\n## Accessing the Instance to Debug\n\nIf you need to access the instance to debug for some reason, run this builder\nwith the `-debug` flag. In debug mode, the Amazon builder will save the private\nkey in the current directory and will output the DNS or IP information as well.\nYou can use this information to access the instance as it is running.\n\n## Build template data\n\nIn configuration directives marked as a template engine above, the following\nvariables are available:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n- `SourceAMITags` - The source AMI Tags, as a `map[string]string` object.\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](/packer/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](/packer/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n\nUsage example:\n\n**HCL2**\n\n```hcl\n// When accessing one of these variables from inside the builder, you need to\n// use the golang templating syntax. This is due to an architectural quirk that\n// won't be easily resolvable until legacy json templates are deprecated:\n\n{\nsource \"amazon-ebs\" \"basic-example\" {\n  tags = {\n        OS_Version = \"Ubuntu\"\n        Release = \"Latest\"\n        Base_AMI_ID = \"{{ .SourceAMI }}\"\n        Base_AMI_Name = \"{{ .SourceAMIName }}\"\n    }\n}\n\n// when accessing one of the variables from a provisioner or post-processor, use\n// hcl-syntax\npost-processor \"manifest\" {\n    output = \"manifest.json\"\n    strip_path = true\n    custom_data = {\n        source_ami_name = \"${build.SourceAMIName}\"\n    }\n}\n```\n\n**JSON**\n\n```json\n\"post-processors\": [\n  {\n    \"type\": \"manifest\",\n    \"output\": \"manifest.json\",\n    \"strip_path\": true,\n    \"custom_data\": {\n      \"source_ami_name\": \"{{ build `SourceAMIName` }}\"\n    }\n  }\n]\n```\n\n\n## Custom Bundle Commands\n\nA lot of the process required for creating an instance-store backed AMI\ninvolves commands being run on the actual source instance. Specifically, the\n`ec2-bundle-vol` and `ec2-upload-bundle` commands must be used to bundle the\nroot filesystem and upload it, respectively.\n\nEach of these commands have a lot of available flags. Instead of exposing each\npossible flag as a template configuration option, the instance-store AMI\nbuilder for Packer lets you customize the entire command used to bundle and\nupload the AMI.\n\nThese are configured with `bundle_vol_command` and `bundle_upload_command`.\nBoth of these configurations are [configuration\ntemplates](/packer/docs/templates/legacy_json_templates/engine) and have support for their own set of\ntemplate variables.\n\n### Bundle Volume Command\n\nThe default value for `bundle_vol_command` is shown below. It is split across\nmultiple lines for convenience of reading. The bundle volume command is\nresponsible for executing `ec2-bundle-vol` in order to store and image of the\nroot filesystem to use to create the AMI.\n\n```shell-session\n$ sudo -i -n ec2-bundle-vol \\\n  -k {{.KeyPath}}  \\\n  -u {{.AccountId}} \\\n  -c {{.CertPath}} \\\n  -r {{.Architecture}} \\\n  -e {{.PrivatePath}}/* \\\n  -d {{.Destination}} \\\n  -p {{.Prefix}} \\\n  --batch \\\n  --no-filter\n```\n\nThe available template variables should be self-explanatory based on the\nparameters they're used to satisfy the `ec2-bundle-vol` command.\n\n~\u003e **Warning!** Some versions of ec2-bundle-vol silently ignore all .pem\nand .gpg files during the bundling of the AMI, which can cause problems on some\nsystems, such as Ubuntu. You may want to customize the bundle volume command to\ninclude those files (see the `--no-filter` option of `ec2-bundle-vol`).\n\n### Bundle Upload Command\n\nThe default value for `bundle_upload_command` is shown below. It is split\nacross multiple lines for convenience of reading. Access key and secret key are\nomitted if using instance profile. The bundle upload command is responsible for\ntaking the bundled volume and uploading it to S3.\n\n```shell-session\n$ sudo -i -n ec2-upload-bundle \\\n  -b {{.BucketName}} \\\n  -m {{.ManifestPath}} \\\n  -a {{.AccessKey}} \\\n  -s {{.SecretKey}} \\\n  -d {{.BundleDirectory}} \\\n  --batch \\\n  --region {{.Region}} \\\n  --retry\n```\n\nThe available template variables should be self-explanatory based on the\nparameters they're used to satisfy the `ec2-upload-bundle` command.\nAdditionally, `{{.Token}}` is available when overriding this command. You must\ncreate your own bundle command with the addition of `-t {{.Token}}` if you are\nassuming a role.\n\n#### Bundle Upload Permissions\n\nThe `ec2-upload-bundle` requires a policy document that looks something like\nthis:\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\",\n        \"s3:GetObject\",\n        \"s3:ListBucket\",\n        \"s3:GetBucketLocation\",\n        \"s3:PutObjectAcl\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\nYou may wish to constrain the resource to a specific bucket.\n\n## Which SSH Options to use:\n\nThis chart breaks down what Packer does if you set any of the below SSH options:\n\n| ssh_password | ssh_private_key_file | ssh_keypair_name | temporary_key_pair_name | Packer will...                                                                             |\n| ------------ | -------------------- | ---------------- | ----------------------- | ------------------------------------------------------------------------------------------ |\n| X            | -                    | -                | -                       | ssh authenticating with username and given password                                        |\n| -            | X                    | -                | -                       | ssh authenticating with private key file                                                   |\n| -            | X                    | X                | -                       | ssh authenticating with given private key file and \"attaching\" the keypair to the instance |\n| -            | -                    | -                | X                       | Create a temporary ssh keypair with a particular name, clean it up                         |\n| -            | -                    | -                | -                       | Create a temporary ssh keypair with a default name, clean it up                            |\n","created_at":"2024-04-17T16:47:57.968Z","updated_at":"2024-04-17T16:47:57.968Z","name":"Amazon instance-store","slug":"instance","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"3e31583f-0061-4c0f-8a29-99ea925ed0a3","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `amazon-ebsvolume`\nArtifact BuilderId: `mitchellh.amazon.ebsvolume`\n\nThe `amazon-ebsvolume` Packer builder is able to create Amazon Elastic Block\nStore volumes which are prepopulated with filesystems or data.\n\nThis builder creates EBS volumes by launching an EC2 instance from a source\nAMI. One or more EBS volumes are attached to the running instance, allowing\nthem to be provisioned into from the running machine. Once provisioning is\ncomplete the source machine is destroyed. The provisioned volumes are kept\nintact.\n\nThis is all done in your own AWS account. The builder will create temporary key\npairs, security group rules, etc. that provide it temporary access to the\ninstance while the image is being created.\n\nThe builder does _not_ manage EBS Volumes. Once it creates volumes and stores\nit in your account, it is up to you to use, delete, etc. the volumes.\n\n-\u003e **Note:** Temporary resources are, by default, all created with the\nprefix `packer`. This can be useful if you want to restrict the security groups\nand key pairs Packer is able to operate on.\n\n## Configuration Reference\n\nThere are many configuration options available for the builder. In addition to\nthe items listed here, you will want to look at the general configuration\nreferences for [AMI](#ami-configuration),\n[BlockDevices](#block-devices-configuration),\n[Access](#access-configuration),\n[Run](#run-configuration) and\n[Communicator](#communicator-configuration)\nconfiguration references, which are\nnecessary for this build to succeed and can be found further down the page.\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/ebsvolume/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ena_support` (boolean) - Enable enhanced networking (ENA but not SriovNetSupport) on\n  HVM-compatible AMIs. If set, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy. Note: you must make sure enhanced networking is enabled\n  on your instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n\n- `sriov_support` (bool) - Enable enhanced networking (SriovNetSupport but not ENA) on\n  HVM-compatible AMIs. If true, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy. Note: you must make sure enhanced networking is enabled\n  on your instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n  Default `false`.\n\n- `ebs_volumes` (BlockDevices) - Add the block device mappings to the AMI. If you add instance store\n  volumes or EBS volumes in addition to the root device volume, the\n  created AMI will contain block device mapping information for those\n  volumes. Amazon creates snapshots of the source instance's root volume\n  and any other EBS volumes described here. When you launch an instance\n  from this new AMI, the instance automatically launches with these\n  additional volumes, and will restore them from snapshots taken from the\n  source instance. See the [BlockDevices](#block-devices-configuration)\n  documentation for fields.\n\n- `run_volume_tags` (map[string]string) - Key/value pair tags to apply to the volumes of the instance that is\n  *launched* to create EBS Volumes. These tags will *not* appear in the\n  tags of the resulting EBS volumes unless they're duplicated under `tags`\n  in the `ebs_volumes` setting. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n  \n   Note: The tags specified here will be *temporarily* applied to volumes\n  specified in `ebs_volumes` - but only while the instance is being\n  created. Packer will replace all tags on the volume with the tags\n  configured in the `ebs_volumes` section as soon as the instance is\n  reported as 'ready'.\n\n- `run_volume_tag` ([]{key string, value string}) - Same as [`run_volume_tags`](#run_volume_tags) but defined as a singular\n  repeatable block containing a `key` and a `value` field. In HCL2 mode\n  the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/ebsvolume/builder.go; --\u003e\n\n\n### Access Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_key` (string) - The access key used to communicate with AWS. [Learn how  to set this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials).\n  On EBS, this is not required if you are using `use_vault_aws_engine`\n  for authentication instead.\n\n- `region` (string) - The name of the region, such as `us-east-1`, in which\n  to launch the EC2 instance to create the AMI.\n  When chroot building, this value is guessed from environment.\n\n- `secret_key` (string) - The secret key used to communicate with AWS. [Learn how to set\n  this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials). This is not required\n  if you are using `use_vault_aws_engine` for authentication instead.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `assume_role` (AssumeRoleConfig) - If provided with a role ARN, Packer will attempt to assume this role\n  using the supplied credentials. See\n  [AssumeRoleConfig](#assume-role-configuration) below for more\n  details on all of the options available, and for a usage example.\n\n- `custom_endpoint_ec2` (string) - This option is useful if you use a cloud\n  provider whose API is compatible with aws EC2. Specify another endpoint\n  like this https://ec2.custom.endpoint.com.\n\n- `shared_credentials_file` (string) - Path to a credentials file to load credentials from\n\n- `decode_authorization_messages` (bool) - Enable automatic decoding of any encoded authorization (error) messages\n  using the `sts:DecodeAuthorizationMessage` API. Note: requires that the\n  effective user/role have permissions to `sts:DecodeAuthorizationMessage`\n  on resource `*`. Default `false`.\n\n- `insecure_skip_tls_verify` (bool) - This allows skipping TLS\n  verification of the AWS EC2 endpoint. The default is false.\n\n- `max_retries` (int) - This is the maximum number of times an API call is retried, in the case\n  where requests are being throttled or experiencing transient failures.\n  The delay between the subsequent API calls increases exponentially.\n\n- `mfa_code` (string) - The MFA\n  [TOTP](https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm)\n  code. This should probably be a user variable since it changes all the\n  time.\n\n- `profile` (string) - The profile to use in the shared credentials file for\n  AWS. See Amazon's documentation on [specifying\n  profiles](https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles)\n  for more details.\n\n- `skip_metadata_api_check` (bool) - Skip Metadata Api Check\n\n- `skip_credential_validation` (bool) - Set to true if you want to skip validating AWS credentials before runtime.\n\n- `token` (string) - The access token to use. This is different from the\n  access key and secret key. If you're not sure what this is, then you\n  probably don't need it. This will also be read from the AWS_SESSION_TOKEN\n  environmental variable.\n\n- `vault_aws_engine` (VaultAWSEngineOptions) - Get credentials from HashiCorp Vault's aws secrets engine. You must\n  already have created a role to use. For more information about\n  generating credentials via the Vault engine, see the [Vault\n  docs.](https://www.vaultproject.io/api/secret/aws#generate-credentials)\n  If you set this flag, you must also set the below options:\n  -   `name` (string) - Required. Specifies the name of the role to generate\n      credentials against. This is part of the request URL.\n  -   `engine_name` (string) - The name of the aws secrets engine. In the\n      Vault docs, this is normally referred to as \"aws\", and Packer will\n      default to \"aws\" if `engine_name` is not set.\n  -   `role_arn` (string)- The ARN of the role to assume if credential\\_type\n      on the Vault role is assumed\\_role. Must match one of the allowed role\n      ARNs in the Vault role. Optional if the Vault role only allows a single\n      AWS role ARN; required otherwise.\n  -   `ttl` (string) - Specifies the TTL for the use of the STS token. This\n      is specified as a string with a duration suffix. Valid only when\n      credential\\_type is assumed\\_role or federation\\_token. When not\n      specified, the default\\_sts\\_ttl set for the role will be used. If that\n      is also not set, then the default value of 3600s will be used. AWS\n      places limits on the maximum TTL allowed. See the AWS documentation on\n      the DurationSeconds parameter for AssumeRole (for assumed\\_role\n      credential types) and GetFederationToken (for federation\\_token\n      credential types) for more details.\n  \n  HCL2 example:\n  \n  ```hcl\n  vault_aws_engine {\n      name = \"myrole\"\n      role_arn = \"myarn\"\n      ttl = \"3600s\"\n  }\n  ```\n  \n  JSON example:\n  \n  ```json\n  {\n      \"vault_aws_engine\": {\n          \"name\": \"myrole\",\n          \"role_arn\": \"myarn\",\n          \"ttl\": \"3600s\"\n      }\n  }\n  ```\n\n- `aws_polling` (\\*AWSPollingConfig) - [Polling configuration](#polling-configuration) for the AWS waiter. Configures the waiter that checks\n  resource state.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Assume Role Configuration\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\nAssumeRoleConfig lets users set configuration options for assuming a special\nrole when executing Packer.\n\nUsage example:\n\nHCL config example:\n\n```HCL\n\n\tsource \"amazon-ebs\" \"example\" {\n\t\tassume_role {\n\t\t\trole_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n\t\t\tsession_name = \"SESSION_NAME\"\n\t\t\texternal_id  = \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\nJSON config example:\n\n```json\n\n\tbuilder{\n\t\t\"type\": \"amazon-ebs\",\n\t\t\"assume_role\": {\n\t\t\t\"role_arn\"    :  \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\",\n\t\t\t\"session_name\":  \"SESSION_NAME\",\n\t\t\t\"external_id\" :  \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `role_arn` (string) - Amazon Resource Name (ARN) of the IAM Role to assume.\n\n- `duration_seconds` (int) - Number of seconds to restrict the assume role session duration.\n\n- `external_id` (string) - The external ID to use when assuming the role. If omitted, no external\n  ID is passed to the AssumeRole call.\n\n- `policy` (string) - IAM Policy JSON describing further restricting permissions for the IAM\n  Role being assumed.\n\n- `policy_arns` ([]string) - Set of Amazon Resource Names (ARNs) of IAM Policies describing further\n  restricting permissions for the IAM Role being\n\n- `session_name` (string) - Session name to use when assuming the role.\n\n- `tags` (map[string]string) - Map of assume role session tags.\n\n- `transitive_tag_keys` ([]string) - Set of assume role session tag keys to pass to any subsequent sessions.\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Polling Configuration\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\nPolling configuration for the AWS waiter. Configures the waiter for resources creation or actions like attaching\nvolumes or importing image.\n\nHCL2 example:\n```hcl\n\n\taws_polling {\n\t\t delay_seconds = 30\n\t\t max_attempts = 50\n\t}\n\n```\n\nJSON example:\n```json\n\n\t\"aws_polling\" : {\n\t\t \"delay_seconds\": 30,\n\t\t \"max_attempts\": 50\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\n- `max_attempts` (int) - Specifies the maximum number of attempts the waiter will check for resource state.\n  This value can also be set via the AWS_MAX_ATTEMPTS.\n  If both option and environment variable are set, the max_attempts will be considered over the AWS_MAX_ATTEMPTS.\n  If none is set, defaults to AWS waiter default which is 40 max_attempts.\n\n- `delay_seconds` (int) - Specifies the delay in seconds between attempts to check the resource state.\n  This value can also be set via the AWS_POLL_DELAY_SECONDS.\n  If both option and environment variable are set, the delay_seconds will be considered over the AWS_POLL_DELAY_SECONDS.\n  If none is set, defaults to AWS waiter default which is 15 seconds.\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n### Block Devices Configuration\n\nBlock devices can be nested in the\n[ebs_volumes](#ebs_volumes) array.\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\nThese will be attached when launching your instance. Your\noptions here may vary depending on the type of VM you use.\n\nExample use case:\n\nThe following mapping will tell Packer to encrypt the root volume of the\nbuild instance at launch using a specific non-default kms key:\n\nHCL2 example:\n\n```hcl\n\n\tlaunch_block_device_mappings {\n\t    device_name = \"/dev/sda1\"\n\t    encrypted = true\n\t    kms_key_id = \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n```\n\nJSON example:\n```json\n\"launch_block_device_mappings\": [\n\n\t{\n\t   \"device_name\": \"/dev/sda1\",\n\t   \"encrypted\": true,\n\t   \"kms_key_id\": \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n]\n```\n\nPlease note that the kms_key_id option in this example exists for\nlaunch_block_device_mappings but not ami_block_device_mappings.\n\nDocumentation for Block Devices Mappings can be found here:\nhttps://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `delete_on_termination` (bool) - Indicates whether the EBS volume is deleted on instance termination.\n  Default false. NOTE: If this value is not explicitly set to true and\n  volumes are not cleaned up by an alternative method, additional volumes\n  will accumulate after every build.\n\n- `device_name` (string) - The device name exposed to the instance (for example, /dev/sdh or xvdh).\n  Required for every device in the block device mapping.\n\n- `encrypted` (boolean) - Indicates whether or not to encrypt the volume. By default, Packer will\n  keep the encryption setting to what it was in the source image. Setting\n  false will result in an unencrypted device, and true will result in an\n  encrypted one.\n\n- `iops` (\\*int64) - The number of I/O operations per second (IOPS) that the volume supports.\n  See the documentation on\n  [IOPs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `no_device` (bool) - Suppresses the specified device included in the block device mapping of\n  the AMI.\n\n- `snapshot_id` (string) - The ID of the snapshot.\n\n- `throughput` (\\*int64) - The throughput for gp3 volumes, only valid for gp3 types\n  See the documentation on\n  [Throughput](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `virtual_name` (string) - The virtual device name. See the documentation on Block Device Mapping\n  for more information.\n\n- `volume_type` (string) - The volume type. gp2 \u0026 gp3 for General Purpose (SSD) volumes, io1 \u0026 io2\n  for Provisioned IOPS (SSD) volumes, st1 for Throughput Optimized HDD,\n  sc1 for Cold HDD, and standard for Magnetic volumes.\n\n- `volume_size` (int64) - The size of the volume, in GiB. Required if not specifying a\n  snapshot_id.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for boot volume encryption.\n  This option exists for launch_block_device_mappings but not\n  ami_block_device_mappings. The kms key id defined here only applies to\n  the original build region; if the AMI gets copied to other regions, the\n  volume in those regions will be encrypted by the default EBS KMS key.\n  For valid formats see KmsKeyId in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html)\n  This field is validated by Packer. When using an alias, you will have to\n  prefix kms_key_id with alias/.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/ebsvolume/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `tags` (map[string]string) - Key/value pair tags to apply to the volume. These are retained after the builder\n  completes. This is a [template engine](/packer/docs/templates/legacy_json_templates/engine), see\n  [Build template data](#build-template-data) for more information.\n\n- `tag` ([]{key string, value string}) - Same as [`tags`](#tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `snapshot_volume` (bool) - Create a Snapshot of this Volume.\n\n- `snapshot_description` (string) - The description for the snapshot.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/ebsvolume/block_device.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `snapshot_tags` (map[string]string) - Key/value pair tags to apply to snapshot. They will override AMI tags if\n  already applied to snapshot. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `snapshot_tag` ([]{key string, value string}) - Same as [`snapshot_tags`](#snapshot_tags) but defined as a singular\n  repeatable block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `snapshot_users` ([]string) - A list of account IDs that have\n  access to create volumes from the snapshot(s). By default no additional\n  users other than the user creating the AMI has permissions to create\n  volumes from the backing snapshot(s).\n\n- `snapshot_groups` ([]string) - A list of groups that have access to\n  create volumes from the snapshot(s). By default no groups have permission\n  to create volumes from the snapshot(s). all will make the snapshot\n  publicly accessible.\n\n\u003c!-- End of code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; --\u003e\n\n\n### Run Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `instance_type` (string) - The EC2 instance type to use while building the\n  AMI, such as t2.small.\n\n- `source_ami` (string) - The source AMI whose root volume will be copied and\n  provisioned on the currently running instance. This must be an EBS-backed\n  AMI with a root volume snapshot that you have access to.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `associate_public_ip_address` (confighelper.Trilean) - If using a non-default VPC,\n  public IP addresses are not provided by default. If this is true, your\n  new instance will get a Public IP. default: unset\n  \n  Note: when specifying this attribute without a `subnet_[id|filter]` or\n  `vpc_[id|filter]`, we will attempt to infer this information from the\n  default VPC/Subnet.\n  This operation may require some extra permissions to the IAM role that\n  runs the build:\n  \n  * ec2:DescribeVpcs\n  * ec2:DescribeSubnets\n  \n  Additionally, since we filter subnets/AZs by their capability to host\n  an instance of the selected type, you may also want to define the\n  `ec2:DescribeInstanceTypeOfferings` action to the role running the build.\n  Otherwise, Packer will pick the most available subnet in the VPC selected,\n  which may not be able to host the instance type you provided.\n\n- `availability_zone` (string) - Destination availability zone to launch\n  instance in. Leave this empty to allow Amazon to auto-assign.\n\n- `block_duration_minutes` (int64) - Requires spot_price to be set. The\n  required duration for the Spot Instances (also known as Spot blocks). This\n  value must be a multiple of 60 (60, 120, 180, 240, 300, or 360). You can't\n  specify an Availability Zone group or a launch group if you specify a\n  duration. Note: This parameter is no longer available to new customers\n  from July 1, 2021. [See Amazon's\n  documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-requests.html#fixed-duration-spot-instances).\n\n- `capacity_reservation_preference` (string) - Set the preference for using a capacity reservation if one exists.\n  Either will be `open` or `none`. Defaults to `none`\n\n- `capacity_reservation_id` (string) - Provide the specific EC2 Capacity Reservation ID that will be used\n  by Packer.\n\n- `capacity_reservation_group_arn` (string) - Provide the EC2 Capacity Reservation Group ARN that will be used by\n  Packer.\n\n- `disable_stop_instance` (bool) - Packer normally stops the build instance after all provisioners have\n  run. For Windows instances, it is sometimes desirable to [run\n  Sysprep](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/Creating_EBSbacked_WinAMI.html)\n  which will stop the instance for you. If this is set to `true`, Packer\n  *will not* stop the instance but will assume that you will send the stop\n  signal yourself through your final provisioner. You can do this with a\n  [windows-shell provisioner](/packer/integrations/hashicorp/windows-shell). Note that\n  Packer will still wait for the instance to be stopped, and failing to\n  send the stop signal yourself, when you have set this flag to `true`,\n  will cause a timeout.\n  \n  An example of a valid windows shutdown command in a `windows-shell`\n  provisioner is :\n  ```shell-session\n    ec2config.exe -sysprep\n  ```\n  or\n  ```sell-session\n    \"%programfiles%\\amazon\\ec2configservice\\\"ec2config.exe -sysprep\"\"\n  ```\n  -\u003e Note: The double quotation marks in the command are not required if\n  your CMD shell is already in the\n  `C:\\Program Files\\Amazon\\EC2ConfigService\\` directory.\n\n- `ebs_optimized` (bool) - Mark instance as [EBS\n  Optimized](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html).\n  Default `false`.\n\n- `enable_nitro_enclave` (bool) - Enable support for Nitro Enclaves on the instance.  Note that the instance type must\n  be able to [support Nitro Enclaves](https://aws.amazon.com/ec2/nitro/nitro-enclaves/faqs/).\n  This option is not supported for spot instances.\n\n- `enable_t2_unlimited` (bool) - Deprecated argument - please use \"enable_unlimited_credits\".\n  Enabling T2 Unlimited allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-credits-baseline-concepts.html)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-unlimited.html)\n  and the **T2 Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [T2\n  Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-std.html)\n  instance instead.\n  \n  To use T2 Unlimited you must use a T2 instance type, e.g. `t2.micro`.\n  Additionally, T2 Unlimited cannot be used in conjunction with Spot\n  Instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error.\n  \n  !\u0026gt; **Warning!** Additional costs may be incurred by enabling T2\n  Unlimited - even for instances that would usually qualify for the\n  [AWS Free Tier](https://aws.amazon.com/free/).\n\n- `enable_unlimited_credits` (bool) - Enabling Unlimited credits allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html#unlimited-mode-surplus-credits)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html)\n  and the **Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-standard-mode.html)\n  instance instead.\n  \n  To use Unlimited you must use a T2/T3/T3a/T4g instance type, e.g. (`t2.micro`, `t3.micro`).\n  Additionally, Unlimited cannot be used in conjunction with Spot\n  Instances for T2 type instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error if the underlying instance type is a T2 type instance.\n  By default the supported burstable instance types (including t3/t3a/t4g) will be provisioned with its cpu credits set to standard,\n  only when `enable_unlimited_credits` is true will the instance be provisioned with unlimited cpu credits.\n\n- `iam_instance_profile` (string) - The name of an [IAM instance\n  profile](https://docs.aws.amazon.com/IAM/latest/UserGuide/instance-profiles.html)\n  to launch the EC2 instance with.\n\n- `fleet_tags` (map[string]string) - Key/value pair tags to apply tags to the fleet that is issued.\n\n- `fleet_tag` ([]{key string, value string}) - Same as [`fleet_tags`](#fleet_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `skip_profile_validation` (bool) - Whether or not to check if the IAM instance profile exists. Defaults to false\n\n- `temporary_iam_instance_profile_policy_document` (\\*PolicyDocument) - Temporary IAM instance profile policy document\n  If IamInstanceProfile is specified it will be used instead.\n  \n  HCL2 example:\n  ```hcl\n  temporary_iam_instance_profile_policy_document {\n  \tStatement {\n  \t\tAction   = [\"logs:*\"]\n  \t\tEffect   = \"Allow\"\n  \t\tResource = [\"*\"]\n  \t}\n  \tVersion = \"2012-10-17\"\n  }\n  ```\n  \n  JSON example:\n  ```json\n  {\n  \t\"Version\": \"2012-10-17\",\n  \t\"Statement\": [\n  \t\t{\n  \t\t\t\"Action\": [\n  \t\t\t\"logs:*\"\n  \t\t\t],\n  \t\t\t\"Effect\": \"Allow\",\n  \t\t\t\"Resource\": [\"*\"]\n  \t\t}\n  \t]\n  }\n  ```\n\n- `shutdown_behavior` (string) - Automatically terminate instances on\n  shutdown in case Packer exits ungracefully. Possible values are stop and\n  terminate. Defaults to stop.\n\n- `security_group_filter` (SecurityGroupFilterOptions) - Filters used to populate the `security_group_ids` field.\n  \n  HCL2 Example:\n  \n  ```hcl\n    security_group_filter {\n      filters = {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  ```\n  \n  JSON Example:\n  ```json\n  {\n    \"security_group_filter\": {\n      \"filters\": {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  }\n  ```\n  \n  This selects the SG's with tag `Class` with the value `packer`.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a\n      `security_group_ids`. Any filter described in the docs for\n      [DescribeSecurityGroups](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSecurityGroups.html)\n      is valid.\n  \n  `security_group_ids` take precedence over this.\n\n- `run_tags` (map[string]string) - Key/value pair tags to apply to the generated key-pair, security group, iam profile and role, snapshot, network interfaces and instance\n  that is *launched* to create the EBS volumes. The resulting AMI will also inherit these tags.\n  This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `run_tag` ([]{key string, value string}) - Same as [`run_tags`](#run_tags) but defined as a singular repeatable\n  block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `security_group_id` (string) - The ID (not the name) of the security\n  group to assign to the instance. By default this is not set and Packer will\n  automatically create a new temporary security group to allow SSH access.\n  Note that if this is specified, you must be sure the security group allows\n  access to the ssh_port given below.\n\n- `security_group_ids` ([]string) - A list of security groups as\n  described above. Note that if this is specified, you must omit the\n  security_group_id.\n\n- `source_ami_filter` (AmiFilterOptions) - Filters used to populate the `source_ami`\n  field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    source_ami_filter {\n      filters = {\n         virtualization-type = \"hvm\"\n         name = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n         root-device-type = \"ebs\"\n      }\n      owners = [\"099720109477\"]\n      most_recent = true\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"source_ami_filter\": {\n         \"filters\": {\n         \"virtualization-type\": \"hvm\",\n         \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n         \"root-device-type\": \"ebs\"\n         },\n         \"owners\": [\"099720109477\"],\n         \"most_recent\": true\n      }\n    }\n  ]\n  ```\n  \n    This selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. NOTE:\n    This will fail unless *exactly* one AMI is returned. In the above example,\n    `most_recent` will cause this to succeed by selecting the newest image.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `source_ami`.\n        NOTE: This will fail unless *exactly* one AMI is returned. Any filter\n        described in the docs for\n        [DescribeImages](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html)\n        is valid.\n  \n    -   `owners` (array of strings) - Filters the images by their owner. You\n        may specify one or more AWS account IDs, \"self\" (which will use the\n        account whose credentials you are using to run Packer), or an AWS owner\n        alias: for example, `amazon`, `aws-marketplace`, or `microsoft`. This\n        option is required for security reasons.\n  \n    -   `most_recent` (boolean) - Selects the newest created image when true.\n        This is most useful for selecting a daily distro build.\n  \n    You may set this in place of `source_ami` or in conjunction with it. If you\n    set this in conjunction with `source_ami`, the `source_ami` will be added\n    to the filter. The provided `source_ami` must meet all of the filtering\n    criteria provided in `source_ami_filter`; this pins the AMI returned by the\n    filter, but will cause Packer to fail if the `source_ami` does not exist.\n\n- `spot_instance_types` ([]string) - a list of acceptable instance\n  types to run your build on. We will request a spot instance using the max\n  price of spot_price and the allocation strategy of \"lowest price\".\n  Your instance will be launched on an instance type of the lowest available\n  price that you have in your list.  This is used in place of instance_type.\n  You may only set either spot_instance_types or instance_type, not both.\n  This feature exists to help prevent situations where a Packer build fails\n  because a particular availability zone does not have capacity for the\n  specific instance_type requested in instance_type.\n\n- `spot_price` (string) - With Spot Instances, you pay the Spot price that's in effect for the\n  time period your instances are running. Spot Instance prices are set by\n  Amazon EC2 and adjust gradually based on long-term trends in supply and\n  demand for Spot Instance capacity.\n  \n  When this field is set, it represents the maximum hourly price you are\n  willing to pay for a spot instance. If you do not set this value, it\n  defaults to a maximum price equal to the on demand price of the\n  instance. In the situation where the current Amazon-set spot price\n  exceeds the value set in this field, Packer will not launch an instance\n  and the build will error. In the situation where the Amazon-set spot\n  price is less than the value set in this field, Packer will launch and\n  you will pay the Amazon-set spot price, not this maximum value.\n  For more information, see the Amazon docs on\n  [spot pricing](https://aws.amazon.com/ec2/spot/pricing/).\n\n- `spot_tags` (map[string]string) - Requires spot_price to be set. Key/value pair tags to apply tags to the\n  spot request that is issued.\n\n- `spot_tag` ([]{key string, value string}) - Same as [`spot_tags`](#spot_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `subnet_filter` (SubnetFilterOptions) - Filters used to populate the `subnet_id` field.\n  \n  HCL2 example:\n  \n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    subnet_filter {\n      filters = {\n            \"tag:Class\": \"build\"\n      }\n      most_free = true\n      random = false\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"subnet_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\"\n        },\n        \"most_free\": true,\n        \"random\": false\n      }\n    }\n  ]\n  ```\n  \n    This selects the Subnet with tag `Class` with the value `build`, which has\n    the most free IP addresses. NOTE: This will fail unless *exactly* one\n    Subnet is returned. By using `most_free` or `random` one will be selected\n    from those matching the filter.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `subnet_id`.\n        NOTE: This will fail unless *exactly* one Subnet is returned. Any\n        filter described in the docs for\n        [DescribeSubnets](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSubnets.html)\n        is valid.\n  \n    -   `most_free` (boolean) - The Subnet with the most free IPv4 addresses\n        will be used if multiple Subnets matches the filter.\n  \n    -   `random` (boolean) - A random Subnet will be used if multiple Subnets\n        matches the filter. `most_free` have precendence over this.\n  \n    `subnet_id` take precedence over this.\n\n- `subnet_id` (string) - If using VPC, the ID of the subnet, such as\n  subnet-12345def, where Packer will launch the EC2 instance. This field is\n  required if you are using an non-default VPC.\n\n- `license_specifications` ([]LicenseSpecification) - The license configurations.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    license_specifications {\n      license_configuration_request = {\n        license_configuration_arn = \"${var.license_configuration_arn}\"\n      }\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"license_specifications\": [\n        {\n          \"license_configuration_request\": {\n            \"license_configuration_arn\": \"{{user `license_configuration_arn`}}\"\n          }\n        }\n      ]\n    }\n  ]\n  ```\n  \n    Each `license_configuration_request` describes a license configuration,\n    the properties of which are:\n  \n    - `license_configuration_arn` (string) - The Amazon Resource Name (ARN)\n      of the license configuration.\n\n- `placement` (Placement) - Describes the placement of an instance.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    placement = {\n      host_resource_group_arn = \"${var.host_resource_group_arn}\"\n      tenancy                 = \"${var.placement_tenancy}\"\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"placement\": {\n        \"host_resource_group_arn\": \"{{user `host_resource_group_arn`}}\",\n        \"tenancy\": \"{{user `placement_tenancy`}}\"\n      }\n    }\n  ]\n  ```\n  \n    - `host_resource_group_arn` (string) - The ARN of the host resource\n      group in which to launch the instances. If you specify a host\n      resource group ARN, omit the Tenancy parameter or set it to `host`.\n    - `tenancy` (string) - The tenancy of the instance (if the instance is\n      running in a VPC). An instance with a tenancy of `dedicated` runs on\n      single-tenant hardware. The default is `default`, meaning shared\n      tenancy. Allowed values are `default`, `dedicated` and `host`.\n\n- `tenancy` (string) - Deprecated: Use Placement Tenancy instead.\n\n- `temporary_security_group_source_cidrs` ([]string) - A list of IPv4 CIDR blocks to be authorized access to the instance, when\n  packer is creating a temporary security group.\n  \n  The default is [`0.0.0.0/0`] (i.e., allow any IPv4 source).\n  Use `temporary_security_group_source_public_ip` to allow current host's\n  public IP instead of any IPv4 source.\n  This is only used when `security_group_id` or `security_group_ids` is not\n  specified.\n\n- `temporary_security_group_source_public_ip` (bool) - When enabled, use public IP of the host (obtained from https://checkip.amazonaws.com)\n  as CIDR block to be authorized access to the instance, when packer\n  is creating a temporary security group. Defaults to `false`.\n  \n  This is only used when `security_group_id`, `security_group_ids`,\n  and `temporary_security_group_source_cidrs` are not specified.\n\n- `user_data` (string) - User data to apply when launching the instance. Note\n  that you need to be careful about escaping characters due to the templates\n  being JSON. It is often more convenient to use user_data_file, instead.\n  Packer will not automatically wait for a user script to finish before\n  shutting down the instance this must be handled in a provisioner.\n\n- `user_data_file` (string) - Path to a file that will be used for the user\n  data when launching the instance.\n\n- `vpc_filter` (VpcFilterOptions) - Filters used to populate the `vpc_id` field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    vpc_filter {\n      filters = {\n        \"tag:Class\": \"build\",\n        \"isDefault\": \"false\",\n        \"cidr\": \"/24\"\n      }\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"vpc_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\",\n          \"isDefault\": \"false\",\n          \"cidr\": \"/24\"\n        }\n      }\n    }\n  ]\n  ```\n  \n  This selects the VPC with tag `Class` with the value `build`, which is not\n  the default VPC, and have a IPv4 CIDR block of `/24`. NOTE: This will fail\n  unless *exactly* one VPC is returned.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `vpc_id`. NOTE:\n      This will fail unless *exactly* one VPC is returned. Any filter\n      described in the docs for\n      [DescribeVpcs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeVpcs.html)\n      is valid.\n  \n  `vpc_id` take precedence over this.\n\n- `vpc_id` (string) - If launching into a VPC subnet, Packer needs the VPC ID\n  in order to create a temporary security group within the VPC. Requires\n  subnet_id to be set. If this field is left blank, Packer will try to get\n  the VPC ID from the subnet_id.\n\n- `windows_password_timeout` (duration string | ex: \"1h5m2s\") - The timeout for waiting for a Windows\n  password for Windows instances. Defaults to 20 minutes. Example value:\n  10m\n\n- `metadata_options` (MetadataOptions) - [Metadata Settings](#metadata-settings)\n\n- `ssh_interface` (string) - One of `public_ip`, `private_ip`, `public_dns`, `private_dns` or `session_manager`.\n     If set, either the public IP address, private IP address, public DNS name\n     or private DNS name will be used as the host for SSH. The default behaviour\n     if inside a VPC is to use the public IP address if available, otherwise\n     the private IP address will be used. If not in a VPC the public DNS name\n     will be used. Also works for WinRM.\n  \n     Where Packer is configured for an outbound proxy but WinRM traffic\n     should be direct, `ssh_interface` must be set to `private_dns` and\n     `\u003cregion\u003e.compute.internal` included in the `NO_PROXY` environment\n     variable.\n  \n     When using `session_manager` the machine running Packer must have\n  \t  the AWS Session Manager Plugin installed and within the users' system path.\n     Connectivity via the `session_manager` interface establishes a secure tunnel\n     between the local host and the remote host on an available local port to the specified `ssh_port`.\n     See [Session Manager Connections](#session-manager-connections) for more information.\n     - Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM communicator.\n     - Upon termination the secure tunnel will be terminated automatically, if however there is a failure in\n     terminating the tunnel it will automatically terminate itself after 20 minutes of inactivity.\n\n- `pause_before_ssm` (duration string | ex: \"1h5m2s\") - The time to wait before establishing the Session Manager session.\n  The value of this should be a duration. Examples are\n  `5s` and `1m30s` which will cause Packer to wait five seconds and one\n  minute 30 seconds, respectively. If no set, defaults to 10 seconds.\n  This option is useful when the remote port takes longer to become available.\n\n- `session_manager_port` (int) - Which port to connect the local end of the session tunnel to. If\n  left blank, Packer will choose a port for you from available ports.\n  This option is only used when `ssh_interface` is set `session_manager`.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n#### Metadata Settings\n\n\u003c!-- Code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\nConfigures the metadata options.\nSee [Configure IMDS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html) for details.\n\n\u003c!-- End of code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `http_endpoint` (string) - A string to enable or disable the IMDS endpoint for an instance. Defaults to enabled.\n  Accepts either \"enabled\" or \"disabled\"\n\n- `http_tokens` (string) - A string to either set the use of IMDSv2 for the instance to optional or required. Defaults to \"optional\".\n  Accepts either \"optional\" or \"required\"\n\n- `http_put_response_hop_limit` (int64) - A numerical value to set an upper limit for the amount of hops allowed when communicating with IMDS endpoints.\n  Defaults to 1.\n\n- `instance_metadata_tags` (string) - A string to enable or disable access to instance tags from the instance metadata. Defaults to disabled.\n  Access to instance metadata tags is available for commercial regions. For non-commercial regions please check availability before enabling.\n  Accepts either \"enabled\" or \"disabled\"\n\n\u003c!-- End of code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; --\u003e\n\n\nUsage Example\n\n**HCL2**\n\n```hcl\nsource \"amazon-ebs\" \"basic-example\" {\n  region        =  \"us-east-1\"\n  source_ami    =  \"ami-fce3c696\"\n  instance_type =  \"t2.micro\"\n  ssh_username  =  \"ubuntu\"\n  ami_name      =  \"packer_AWS_example_{{timestamp}}\"\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens = \"required\"\n    http_put_response_hop_limit = 1\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"aws_access_key\": \"{{env `AWS_ACCESS_KEY_ID`}}\",\n    \"aws_secret_key\": \"{{env `AWS_SECRET_ACCESS_KEY`}}\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"access_key\": \"{{user `aws_access_key`}}\",\n      \"secret_key\": \"{{user `aws_secret_key`}}\",\n      \"region\": \"us-east-1\",\n      \"source_ami\": \"ami-fce3c696\",\n      \"instance_type\": \"t2.micro\",\n      \"ssh_username\": \"ubuntu\",\n      \"ami_name\": \"packer_AWS {{timestamp}}\",\n      \"metadata_options\": {\n        \"http_endpoint\": \"enabled\",\n        \"http_tokens\": \"required\",\n        \"http_put_response_hop_limit\": 1\n      }\n    }\n  ]\n}\n```\n\n\n### Session Manager Connections\n\nSupport for the AWS Systems Manager session manager lets users manage EC2 instances without the need to open inbound ports, or maintain bastion hosts. Session manager connectivity relies on the use of the [session manager plugin](#session-manager-plugin) to open a secure tunnel between the local machine and the remote instance. Once the tunnel has been created all SSH communication will be tunneled through SSM to the remote instance.\n\n-\u003e Note: Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM Communicator.\n\nTo use the session manager as the connection interface for the SSH communicator you need to add the following configuration options to the Amazon builder options:\n\n- `ssh_interface`: The ssh interface must be set to \"session_manager\". When using this option the builder will create an SSM tunnel to the configured `ssh_port` (defaults to 22) on the remote host.\n- `iam_instance_profile`: A valid instance profile granting Systems Manager permissions to manage the remote instance is required in order for the aws ssm-agent to start and stop session connections.\n  See below for more details on [IAM instance profile for Systems Manager](#iam-instance-profile-for-systems-manager).\n\n#### Optional\n\n- `session_manager_port`: A local port on the host machine that should be used as the local end of the session tunnel to the remote host. If not specified Packer will find an available port to use.\n- `temporary_iam_instance_profile_policy_document`: Creates a temporary instance profile policy document to grant Systems Manager permissions to the Ec2 instance. This is an alternative to using an existing `iam_instance_profile`.\n\nHCL2 example:\n\n```hcl\n# file: example.pkr.hcl\n\n# In order to get these variables to read from the environment,\n# set the environment variables to have the same name as the declared\n# variables, with the prefix PKR_VAR_.\n# You could also hardcode them into the file, but we do not recommend that.\n\ndata \"amazon-ami\" \"example\" {\n  filters = {\n    virtualization-type = \"hvm\"\n    name                = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n    root-device-type    = \"ebs\"\n  }\n  owners      = [\"099720109477\"]\n  most_recent = true\n  region      = \"us-east-1\"\n}\n\nsource \"amazon-ebs\" \"ssm-example\" {\n  ami_name             = \"packer_AWS {{timestamp}}\"\n  instance_type        = \"t2.micro\"\n  region               = \"us-east-1\"\n  source_ami           = data.amazon-ami.example.id\n  ssh_username         = \"ubuntu\"\n  ssh_interface        = \"session_manager\"\n  communicator         = \"ssh\"\n  iam_instance_profile = \"myinstanceprofile\"\n}\n\nbuild {\n  sources = [\"source.amazon-ebs.ssm-example\"]\n\n  provisioner \"shell\" {\n    inline = [\"echo Connected via SSM at '${build.User}@${build.Host}:${build.Port}'\"]\n  }\n}\n```\n\nJSON example:\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"ami_name\": \"packer-ami-{{timestamp}}\",\n      \"instance_type\": \"t2.micro\",\n      \"source_ami_filter\": {\n        \"filters\": {\n          \"virtualization-type\": \"hvm\",\n          \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n          \"root-device-type\": \"ebs\"\n        },\n        \"owners\": [\"099720109477\"],\n        \"most_recent\": true\n      },\n      \"ssh_username\": \"ubuntu\",\n      \"ssh_interface\": \"session_manager\",\n      \"communicator\": \"ssh\",\n      \"iam_instance_profile\": \"{{user `iam_instance_profile`}}\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"type\": \"shell\",\n      \"inline\": [\n        \"echo Connected via SSM at '{{build `User`}}@{{build `Host`}}:{{build `Port`}}'\"\n      ]\n    }\n  ]\n}\n```\n\n#### Session Manager Plugin\n\nConnectivity via the session manager requires the use of a session-manger-plugin, which needs to be installed alongside Packer, and an instance AMI that is capable of running the AWS ssm-agent - see [About SSM Agent](https://docs.aws.amazon.com/systems-manager/latest/userguide/prereqs-ssm-agent.html) for details on supported AMIs.\n\nIn order for Packer to start and end sessions that connect you to your managed instances, you must first install the Session Manager plugin on your local machine. The plugin can be installed on supported versions of Microsoft Windows, macOS, Linux, and Ubuntu Server.\n[Installation instructions for the session-manager-plugin](https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html)\n\n#### IAM instance profile for Systems Manager\n\nBy default Systems Manager doesn't have permission to perform actions on created instances so SSM access must be granted by creating an instance profile with the `AmazonSSMManagedInstanceCore` policy. The instance profile can then be attached to any instance you wish to manage via the session-manager-plugin. See [Adding System Manager instance profile](https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html#instance-profile-add-permissions) for details on creating the required instance profile.\n\n#### Permissions for Closing the Tunnel\n\nTo close the SSM tunnels created, this plugin relies on being able to call\n[DescribeInstanceStatus](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstanceStatus.html).\nIn case this is not possible you might see a `Bad exit status` message in the logs.\n\nThe absence of this permission won't prevent you from building the AMI, and the error only means that packer is not able to close the tunnel gracefully.\n\n\n### Communicator Configuration\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `communicator` (string) - Packer currently supports three kinds of communicators:\n  \n  -   `none` - No communicator will be used. If this is set, most\n      provisioners also can't be used.\n  \n  -   `ssh` - An SSH connection will be established to the machine. This\n      is usually the default.\n  \n  -   `winrm` - A WinRM connection will be established.\n  \n  In addition to the above, some builders have custom communicators they\n  can use. For example, the Docker builder has a \"docker\" communicator\n  that uses `docker exec` and `docker cp` to execute scripts and copy\n  files.\n\n- `pause_before_connecting` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\n  guest's bootstrap script, but sometimes you may have a race condition\n  where you need Packer to wait before attempting to connect to your\n  guest.\n  \n  If you end up in this situation, you can use the template option\n  `pause_before_connecting`. By default, there is no pause. For example if\n  you set `pause_before_connecting` to `10m` Packer will check whether it\n  can connect, as normal. But once a connection attempt is successful, it\n  will disconnect and then wait 10 minutes before connecting to the guest\n  and beginning provisioning.\n\n\u003c!-- End of code generated from the comments of the Config struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSH struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ssh_host` (string) - The address to SSH to. This usually is automatically configured by the\n  builder.\n\n- `ssh_port` (int) - The port to connect to SSH. This defaults to `22`.\n\n- `ssh_username` (string) - The username to connect to SSH with. Required if using SSH.\n\n- `ssh_password` (string) - A plaintext password to use to authenticate with SSH.\n\n- `ssh_ciphers` ([]string) - This overrides the value of ciphers supported by default by Golang.\n  The default value is [\n    \"aes128-gcm@openssh.com\",\n    \"chacha20-poly1305@openssh.com\",\n    \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n  ]\n  \n  Valid options for ciphers include:\n  \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\",\n  \"chacha20-poly1305@openssh.com\",\n  \"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",\n\n- `ssh_clear_authorized_keys` (bool) - If true, Packer will attempt to remove its temporary key from\n  `~/.ssh/authorized_keys` and `/root/.ssh/authorized_keys`. This is a\n  mostly cosmetic option, since Packer will delete the temporary private\n  key from the host system regardless of whether this is set to true\n  (unless the user has set the `-debug` flag). Defaults to \"false\";\n  currently only works on guests with `sed` installed.\n\n- `ssh_key_exchange_algorithms` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\n  supported by default by Golang. Acceptable values include:\n  \"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\",\n  \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n  \"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".\n\n- `ssh_certificate_file` (string) - Path to user certificate used to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_pty` (bool) - If `true`, a PTY will be requested for the SSH connection. This defaults\n  to `false`.\n\n- `ssh_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\n  determine when the machine has booted so this is usually quite long.\n  Example value: `10m`.\n  This defaults to `5m`, unless `ssh_handshake_attempts` is set.\n\n- `ssh_disable_agent_forwarding` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `false`.\n\n- `ssh_handshake_attempts` (int) - The number of handshakes to attempt with SSH once it can connect.\n  This defaults to `10`, unless a `ssh_timeout` is set.\n\n- `ssh_bastion_host` (string) - A bastion host to use for the actual SSH connection.\n\n- `ssh_bastion_port` (int) - The port of the bastion host. Defaults to `22`.\n\n- `ssh_bastion_agent_auth` (bool) - If `true`, the local SSH agent will be used to authenticate with the\n  bastion host. Defaults to `false`.\n\n- `ssh_bastion_username` (string) - The username to connect to the bastion host.\n\n- `ssh_bastion_password` (string) - The password to use to authenticate with the bastion host.\n\n- `ssh_bastion_interactive` (bool) - If `true`, the keyboard-interactive used to authenticate with bastion host.\n\n- `ssh_bastion_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with the\n  bastion host. The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_bastion_certificate_file` (string) - Path to user certificate used to authenticate with bastion host.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_file_transfer_method` (string) - `scp` or `sftp` - How to transfer files, Secure copy (default) or SSH\n  File Transfer Protocol.\n  \n  **NOTE**: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n  (the default protocol for copying data) returns a a non-zero error code since the MOTW\n  cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\n  with SFTP instead `ssh_file_transfer_protocol = \"sftp\"`.\n\n- `ssh_proxy_host` (string) - A SOCKS proxy host to use for SSH connection\n\n- `ssh_proxy_port` (int) - A port of the SOCKS proxy. Defaults to `1080`.\n\n- `ssh_proxy_username` (string) - The optional username to authenticate with the proxy server.\n\n- `ssh_proxy_password` (string) - The optional password to use to authenticate with the proxy server.\n\n- `ssh_keep_alive_interval` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\n  value (`-1s`) to disable. Example value: `10s`. Defaults to `5s`.\n\n- `ssh_read_write_timeout` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\n  useful if, for example, packer hangs on a connection after a reboot.\n  Example: `5m`. Disabled by default.\n\n- `ssh_remote_tunnels` ([]string) - \n\n- `ssh_local_tunnels` ([]string) - \n\n\u003c!-- End of code generated from the comments of the SSH struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `temporary_key_pair_type` (string) - `dsa` | `ecdsa` | `ed25519` | `rsa` ( the default )\n  \n  Specifies the type of key to create. The possible values are 'dsa',\n  'ecdsa', 'ed25519', or 'rsa'.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure, please\n  consider other alternatives like RSA or ED25519.\n\n- `temporary_key_pair_bits` (int) - Specifies the number of bits in the key to create. For RSA keys, the\n  minimum size is 1024 bits and the default is 4096 bits. Generally, 3072\n  bits is considered sufficient. DSA keys must be exactly 1024 bits as\n  specified by FIPS 186-2. For ECDSA keys, bits determines the key length\n  by selecting from one of three elliptic curve sizes: 256, 384 or 521\n  bits. Attempting to use bit lengths other than these three values for\n  ECDSA keys will fail. Ed25519 keys have a fixed length and bits will be\n  ignored.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure as specified\n  by FIPS 186-5, please consider other alternatives like RSA or ED25519.\n\n\u003c!-- End of code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; --\u003e\n\n\n- `ssh_keypair_name` (string) - If specified, this is the key that will be used for SSH with the\n  machine. The key must match a key pair name loaded up into the remote.\n  By default, this is blank, and Packer will generate a temporary keypair\n  unless [`ssh_password`](#ssh_password) is used.\n  [`ssh_private_key_file`](#ssh_private_key_file) or\n  [`ssh_agent_auth`](#ssh_agent_auth) must be specified when\n  [`ssh_keypair_name`](#ssh_keypair_name) is utilized.\n\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n- `ssh_agent_auth` (bool) - If true, the local SSH agent will be used to authenticate connections to\n  the source instance. No temporary keypair will be created, and the\n  values of [`ssh_password`](#ssh_password) and\n  [`ssh_private_key_file`](#ssh_private_key_file) will be ignored. The\n  environment variable `SSH_AUTH_SOCK` must be set for this option to work\n  properly.\n\n\n## Basic Example\n\n**HCL2**\n\n```hcl\nsource \"amazon-ebsvolume\" \"basic-example\" {\n  region = \"us-east-1\"\n  ssh_username = \"ubuntu\"\n  instance_type = \"t2.medium\"\n  source_ami = \"ami-40d28157\"\n\n  ebs_volumes {\n      volume_type = \"gp2\"\n      device_name = \"/dev/xvdf\"\n      delete_on_termination = false\n      tags = {\n        zpool = \"data\"\n        Name = \"Data1\"\n      }\n      volume_size = 10\n  }\n\n  ebs_volumes {\n      volume_type = \"gp2\"\n      device_name = \"/dev/xvdg\"\n      tags = {\n        zpool = \"data\"\n        Name = \"Data2\"\n      }\n      delete_on_termination = false\n      volume_size = 10\n  }\n\n  ebs_volumes {\n      volume_size = 10\n      tags = {\n        zpool = \"data\"\n        Name = \"Data3\"\n      }\n      delete_on_termination = false\n      device_name = \"/dev/xvdh\"\n      volume_type = \"gp2\"\n  }\n}\n\nbuild {\n  sources = [\"sources.amazon-ebsvolume.basic-example\"]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebsvolume\",\n      \"region\": \"us-east-1\",\n      \"ssh_username\": \"ubuntu\",\n      \"instance_type\": \"t2.medium\",\n      \"source_ami\": \"ami-40d28157\",\n      \"ebs_volumes\": [\n        {\n          \"volume_type\": \"gp2\",\n          \"device_name\": \"/dev/xvdf\",\n          \"delete_on_termination\": false,\n          \"tags\": {\n            \"zpool\": \"data\",\n            \"Name\": \"Data1\"\n          },\n          \"volume_size\": 10\n        },\n        {\n          \"volume_type\": \"gp2\",\n          \"device_name\": \"/dev/xvdg\",\n          \"tags\": {\n            \"zpool\": \"data\",\n            \"Name\": \"Data2\"\n          },\n          \"delete_on_termination\": false,\n          \"volume_size\": 10\n        },\n        {\n          \"volume_size\": 10,\n          \"tags\": {\n            \"Name\": \"Data3\",\n            \"zpool\": \"data\"\n          },\n          \"delete_on_termination\": false,\n          \"device_name\": \"/dev/xvdh\",\n          \"volume_type\": \"gp2\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n\n-\u003e **Note:** Packer can also read the access key and secret access key from\nenvironmental variables. See the configuration reference in the section above\nfor more information on what environmental variables Packer will look for.\n\nFurther information on locating AMI IDs and their relationship to instance\ntypes and regions can be found in the AWS EC2 Documentation [for\nLinux](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/finding-an-ami.html)\nor [for\nWindows](http://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/finding-an-ami.html).\n\n## Accessing the Instance to Debug\n\nIf you need to access the instance to debug for some reason, run the builder\nwith the `-debug` flag. In debug mode, the Amazon builder will save the private\nkey in the current directory and will output the DNS or IP information as well.\nYou can use this information to access the instance as it is running.\n\n## Build template data\n\nIn configuration directives marked as a template engine above, the following\nvariables are available:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n- `SourceAMITags` - The source AMI Tags, as a `map[string]string` object.\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](/packer/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](/packer/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n\n-\u003e **Note:** Packer uses pre-built AMIs as the source for building images.\nThese source AMIs may include volumes that are not flagged to be destroyed on\ntermination of the instance building the new image. In addition to those\nvolumes created by this builder, any volumes in the source AMI which are not\nmarked for deletion on termination will remain in your account.\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](/packer/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](/packer/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n\nUsage example:\n\n**HCL2**\n\n```hcl\n// When accessing one of these variables from inside the builder, you need to\n// use the golang templating syntax. This is due to an architectural quirk that\n// won't be easily resolvable until legacy json templates are deprecated:\n\n{\nsource \"amazon-ebs\" \"basic-example\" {\n  tags = {\n        OS_Version = \"Ubuntu\"\n        Release = \"Latest\"\n        Base_AMI_ID = \"{{ .SourceAMI }}\"\n        Base_AMI_Name = \"{{ .SourceAMIName }}\"\n    }\n}\n\n// when accessing one of the variables from a provisioner or post-processor, use\n// hcl-syntax\npost-processor \"manifest\" {\n    output = \"manifest.json\"\n    strip_path = true\n    custom_data = {\n        source_ami_name = \"${build.SourceAMIName}\"\n    }\n}\n```\n\n**JSON**\n\n```json\n\"post-processors\": [\n  {\n    \"type\": \"manifest\",\n    \"output\": \"manifest.json\",\n    \"strip_path\": true,\n    \"custom_data\": {\n      \"source_ami_name\": \"{{ build `SourceAMIName` }}\"\n    }\n  }\n]\n```\n\n\n## Which SSH Options to use:\n\nThis chart breaks down what Packer does if you set any of the below SSH options:\n\n| ssh_password | ssh_private_key_file | ssh_keypair_name | temporary_key_pair_name | Packer will...                                                                             |\n| ------------ | -------------------- | ---------------- | ----------------------- | ------------------------------------------------------------------------------------------ |\n| X            | -                    | -                | -                       | ssh authenticating with username and given password                                        |\n| -            | X                    | -                | -                       | ssh authenticating with private key file                                                   |\n| -            | X                    | X                | -                       | ssh authenticating with given private key file and \"attaching\" the keypair to the instance |\n| -            | -                    | -                | X                       | Create a temporary ssh keypair with a particular name, clean it up                         |\n| -            | -                    | -                | -                       | Create a temporary ssh keypair with a default name, clean it up                            |\n","created_at":"2024-04-17T16:47:58.567Z","updated_at":"2024-04-17T16:47:58.567Z","name":"Amazon EBS Volume","slug":"ebsvolume","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"9da5a2b6-97db-41ef-8c8a-cbe0186db762","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","readme":"Type: `amazon-import`\nArtifact BuilderId: `packer.post-processor.amazon-import`\n\nThe Packer Amazon Import post-processor takes an OVA artifact from various\nbuilders and imports it to an AMI available to Amazon Web Services EC2.\n\n~\u003e This post-processor is for advanced users. It depends on specific IAM\nroles inside AWS and is best used with images that operate with the EC2\nconfiguration model (eg, cloud-init for Linux systems). Please ensure you read\nthe [prerequisites for import](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/VMImportPrerequisites.html)\nbefore using this post-processor.\n\n## How Does it Work?\n\nThe import process operates making a temporary copy of the OVA to an S3 bucket,\nand calling an import task in EC2 on the OVA file. Once completed, an AMI is\nreturned containing the converted virtual machine. The temporary OVA copy in S3\ncan be discarded after the import is complete.\n\nThe import process itself run by AWS includes modifications to the image\nuploaded, to allow it to boot and operate in the AWS EC2 environment. However,\nnot all modifications required to make the machine run well in EC2 are\nperformed. Take care around console output from the machine, as debugging can\nbe very difficult without it. On the source OVA artifact make sure to include\ntools suitable for instances in EC2 such as the `cloud-init` package for Linux.\n\nFurther information about the import process can be found in AWS's [EC2\nImport/Export Instance\ndocumentation](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instances_of_your_vm.html).\n\n## Configuration\n\nThere are some configuration options available for the post-processor. They are\nsegmented below into two categories: required and optional parameters. Within\neach category, the available configuration keys are alphabetized.\n\nRequired:\n\n- `access_key` (string) - The access key used to communicate with AWS. [Learn\n  how to set this.](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials)\n\n- `region` (string) - The name of the region, such as `us-east-1` in which to\n  upload the OVA file to S3 and create the AMI. A list of valid regions can\n  be obtained with AWS CLI tools or by consulting the AWS website.\n\n- `s3_bucket_name` (string) - The name of the S3 bucket where the OVA file\n  will be copied to for import. This bucket must exist when the\n  post-processor is run.\n\n- `secret_key` (string) - The secret key used to communicate with AWS. [Learn\n  how to set this.](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials)\n\nOptional:\n\n- `ami_description` (string) - The description to set for the resulting\n  imported AMI. By default this description is generated by the AMI import\n  process.\n\n- `ami_encrypt` (boolean) - Encrypt the resulting AMI using KMS. This defaults\n  to `false`.\n\n- `ami_groups` (array of strings) - A list of groups that have access to\n  launch the imported AMI. By default no groups have permission to launch the\n  AMI. `all` will make the AMI publicly accessible. AWS currently doesn't\n  accept any value other than \"all\".\n\n- `ami_kms_key` (string) - The ID of the KMS key used to encrypt the AMI\n  if `ami_encrypt` is true. If set, the role specified in `role_name` must\n  be granted access to use this key. If not set, the account default KMS key\n  will be used.\n\n- `ami_name` (string) - The name of the ami within the console. If not\n  specified, this will default to something like `ami-import-sfwerwf`. Please\n  note, specifying this option will result in a slightly longer execution\n  time.\n\n- `ami_users` (array of strings) - A list of account IDs that have access to\n  launch the imported AMI. By default no additional users other than the user\n  importing the AMI has permission to launch it.\n\n- `ami_org_arns` (array of strings) -  A list of Amazon Resource Names (ARN) of AWS Organizations that have access to\n\tlaunch the resulting AMI(s). By default no organizations have permission to launch\n\tthe AMI.\n\n- `ami_ou_arns` (array of strings) - A list of Amazon Resource Names (ARN) of AWS Organizations organizational units (OU) that have access to\n\tlaunch the resulting AMI(s). By default no organizational units have permission to launch\n\tthe AMI.\n\n- `architecture` (string) - The architecture of the resultant AMI. One of:\n  `i386`, `x86_64`, or `arm64`. Defaults to `x86_64`.\n\n- `boot_mode` (string) - The supported boot mode of the resultant AMI. One of:\n  `legacy-bios` or `uefi`. If `architecture` is set to `arm64` then this value\n  must be set to  `uefi`.\n\n- `platform` (string) - The operating system of the virtual machine. One of:\n  `linux` or `windows`. If `boot_mode` is set to `uefi` then this value must be \n  set to either `windows` or `linux` depending on the operating system of the \n  virtual machine.\n\n- `custom_endpoint_ec2` (string) - This option is useful if you use a cloud\n  provider whose API is compatible with aws EC2. Specify another endpoint\n  like this `https://ec2.custom.endpoint.com`.\n\n- `format` (string) - One of: `ova`, `raw`, `vhd`, `vhdx`, or `vmdk`. This\n  specifies the format of the source virtual machine image. The resulting\n  artifact from the builder is assumed to have a file extension matching the\n  format. This defaults to `ova`.\n\n- `insecure_skip_tls_verify` (boolean) - This allows skipping TLS\n  verification of the AWS EC2 endpoint. The default is `false`.\n\n- `keep_input_artifact` (boolean) - if true, do not delete the source virtual\n  machine image after importing it to the cloud. Defaults to false.\n\n- `license_type` (string) - The license type to be used for the Amazon\n  Machine Image (AMI) after importing. Valid values: `AWS` or `BYOL`\n  (default). For more details regarding licensing, see\n  [Prerequisites](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/VMImportPrerequisites.html)\n  in the VM Import/Export User Guide.\n\n- `mfa_code` (string) - The MFA\n  [TOTP](https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm)\n  code. This should probably be a user variable since it changes all the\n  time.\n\n- `profile` (string) - The profile to use in the shared credentials file for\n  AWS. See Amazon's documentation on [specifying\n  profiles](https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles)\n  for more details.\n\n- `role_name` (string) - The name of the role to use when not using the\n  default role, 'vmimport'\n\n- `s3_encryption` (string) - One of: `aws:kms`, or `AES256`. The algorithm\n  used to encrypt the artifact in S3. This **does not** encrypt the\n  resulting AMI, and is only used to encrypt the uploaded artifact before\n  it becomes an AMI. By default no encryption is used.\n\n- `s3_encryption_key` (string) - The KMS key ID to use when `aws:kms` is\n  specified in `s3_encryption`. This setting is ignored if AES is used\n  as Amazon does not currently support custom AES keys when using the VM\n  import service. If set, the role specified in `role_name` must be granted\n  access to use this key. If not set, and `s3_encryption` is set to `aws:kms`,\n  the account default KMS key will be used.\n\n- `s3_key_name` (string) - The name of the key in `s3_bucket_name` where the\n  OVA file will be copied to for import. If not specified, this will default\n  to \"packer-import-{{timestamp}}.ova\". This key (i.e., the uploaded OVA)\n  will be removed after import, unless `skip_clean` is `true`. This is\n  treated as a [template engine](/packer/docs/templates/legacy_json_templates/engine). Therefore, you\n  may use user variables and template functions in this field.\n\n- `skip_clean` (boolean) - Whether we should skip removing the OVA file\n  uploaded to S3 after the import process has completed. \"true\" means that we\n  should leave it in the S3 bucket, \"false\" means to clean it out. Defaults\n  to `false`.\n\n- `skip_region_validation` (boolean) - Set to true if you want to skip\n  validation of the region configuration option. Default `false`.\n\n- `tags` (object of key/value strings) - Tags applied to the created AMI and\n  relevant snapshots.\n\n- `token` (string) - The access token to use. This is different from the\n  access key and secret key. If you're not sure what this is, then you\n  probably don't need it. This will also be read from the `AWS_SESSION_TOKEN`\n  environmental variable.\n\n## Basic Example\n\nHere is a basic example. This assumes that the builder has produced an OVA\nartifact for us to work with, and IAM roles for import exist in the AWS account\nbeing imported into.\n\n```json\n{\n  \"type\": \"amazon-import\",\n  \"access_key\": \"YOUR KEY HERE\",\n  \"secret_key\": \"YOUR SECRET KEY HERE\",\n  \"region\": \"us-east-1\",\n  \"s3_bucket_name\": \"importbucket\",\n  \"license_type\": \"BYOL\",\n  \"tags\": {\n    \"Description\": \"packer amazon-import {{timestamp}}\"\n  }\n}\n```\n\n## VMWare Example\n\nThis is an example that uses `vmware-iso` builder and exports the `.ova` file\nusing ovftool.\n\n```json\n\"post-processors\" : [\n     [\n        {\n          \"type\": \"shell-local\",\n          \"inline\": [ \"/usr/bin/ovftool \u003cpacker-output-directory\u003e/\u003cvmware-name\u003e.vmx \u003cpacker-output-directory\u003e/\u003cvmware-name\u003e.ova\" ]\n        },\n        {\n           \"files\": [\n             \"\u003cpacker-output-directory\u003e/\u003cvmware-name\u003e.ova\"\n           ],\n           \"type\": \"artifice\"\n        },\n        {\n          \"type\": \"amazon-import\",\n          \"access_key\": \"YOUR KEY HERE\",\n          \"secret_key\": \"YOUR SECRET KEY HERE\",\n          \"region\": \"us-east-1\",\n          \"s3_bucket_name\": \"importbucket\",\n          \"license_type\": \"BYOL\",\n          \"tags\": {\n            \"Description\": \"packer amazon-import {{timestamp}}\"\n          }\n       }\n    ]\n  ]\n```\n\n## Amazon Permissions\n\nYou'll need at least the following permissions in the policy for your IAM user\nin order to successfully upload an image via the amazon-import post-processor.\n\n```json\n(\"ec2:CancelImportTask\",\n\"ec2:CopyImage\",\n\"ec2:CreateTags\",\n\"ec2:DescribeImages\",\n\"ec2:DescribeImportImageTasks\",\n\"ec2:ImportImage\",\n\"ec2:ModifyImageAttribute\",\n\"ec2:DeregisterImage\")\n```\n\n## Troubleshooting Timeouts\n\nThe amazon-import feature can take a long time to upload and convert your OVAs\ninto AMIs; if you find that your build is failing because you have exceeded\nyour max retries or find yourself being rate limited, you can override the max\nretries and the delay in between retries by setting the environment variables\n`AWS_MAX_ATTEMPTS` and `AWS_POLL_DELAY_SECONDS` on the machine running the\nPacker build. By default, the waiter that waits for your image to be imported\nfrom s3 will retry for up to an hour: it retries up to 720 times with a 5\nsecond delay in between retries.\n\nThis is dramatically higher than many of our other waiters, to account for how\nlong this process can take.\n\n-\u003e **Note:** Packer can also read the access key and secret access key from\nenvironmental variables. See the configuration reference in the section above\nfor more information on what environmental variables Packer will look for.\n\nThis will take the OVA generated by a builder and upload it to S3. In this\ncase, an existing bucket called `importbucket` in the `us-east-1` region will\nbe where the copy is placed. The key name of the copy will be a default name\ngenerated by packer.\n\nOnce uploaded, the import process will start, creating an AMI in the\n\"us-east-1\" region with a \"Description\" tag applied to both the AMI and the\nsnapshots associated with it. Note: the import process does not allow you to\nname the AMI, the name is automatically generated by AWS.\n\nAfter tagging is completed, the OVA uploaded to S3 will be removed.\n","created_at":"2024-04-17T16:47:59.054Z","updated_at":"2024-04-17T16:47:59.054Z","name":"Amazon Import","slug":"import","component":{"id":"73965f1c-ad56-4f38-a31b-dc17d08c0ba6","slug":"post-processor","name":"Post-Processor","plural_name":"Post-Processors","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.157Z","updated_at":"2023-07-26T17:26:54.831Z"},"variable_groups":[]}]},"component":{"id":"3e31583f-0061-4c0f-8a29-99ea925ed0a3","integration_release_id":"0f9c1e99-9b6d-439e-b8be-0d21d8a75905","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `amazon-ebsvolume`\nArtifact BuilderId: `mitchellh.amazon.ebsvolume`\n\nThe `amazon-ebsvolume` Packer builder is able to create Amazon Elastic Block\nStore volumes which are prepopulated with filesystems or data.\n\nThis builder creates EBS volumes by launching an EC2 instance from a source\nAMI. One or more EBS volumes are attached to the running instance, allowing\nthem to be provisioned into from the running machine. Once provisioning is\ncomplete the source machine is destroyed. The provisioned volumes are kept\nintact.\n\nThis is all done in your own AWS account. The builder will create temporary key\npairs, security group rules, etc. that provide it temporary access to the\ninstance while the image is being created.\n\nThe builder does _not_ manage EBS Volumes. Once it creates volumes and stores\nit in your account, it is up to you to use, delete, etc. the volumes.\n\n-\u003e **Note:** Temporary resources are, by default, all created with the\nprefix `packer`. This can be useful if you want to restrict the security groups\nand key pairs Packer is able to operate on.\n\n## Configuration Reference\n\nThere are many configuration options available for the builder. In addition to\nthe items listed here, you will want to look at the general configuration\nreferences for [AMI](#ami-configuration),\n[BlockDevices](#block-devices-configuration),\n[Access](#access-configuration),\n[Run](#run-configuration) and\n[Communicator](#communicator-configuration)\nconfiguration references, which are\nnecessary for this build to succeed and can be found further down the page.\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/ebsvolume/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ena_support` (boolean) - Enable enhanced networking (ENA but not SriovNetSupport) on\n  HVM-compatible AMIs. If set, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy. Note: you must make sure enhanced networking is enabled\n  on your instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n\n- `sriov_support` (bool) - Enable enhanced networking (SriovNetSupport but not ENA) on\n  HVM-compatible AMIs. If true, add `ec2:ModifyInstanceAttribute` to your\n  AWS IAM policy. Note: you must make sure enhanced networking is enabled\n  on your instance. See [Amazon's documentation on enabling enhanced\n  networking](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking).\n  Default `false`.\n\n- `ebs_volumes` (BlockDevices) - Add the block device mappings to the AMI. If you add instance store\n  volumes or EBS volumes in addition to the root device volume, the\n  created AMI will contain block device mapping information for those\n  volumes. Amazon creates snapshots of the source instance's root volume\n  and any other EBS volumes described here. When you launch an instance\n  from this new AMI, the instance automatically launches with these\n  additional volumes, and will restore them from snapshots taken from the\n  source instance. See the [BlockDevices](#block-devices-configuration)\n  documentation for fields.\n\n- `run_volume_tags` (map[string]string) - Key/value pair tags to apply to the volumes of the instance that is\n  *launched* to create EBS Volumes. These tags will *not* appear in the\n  tags of the resulting EBS volumes unless they're duplicated under `tags`\n  in the `ebs_volumes` setting. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n  \n   Note: The tags specified here will be *temporarily* applied to volumes\n  specified in `ebs_volumes` - but only while the instance is being\n  created. Packer will replace all tags on the volume with the tags\n  configured in the `ebs_volumes` section as soon as the instance is\n  reported as 'ready'.\n\n- `run_volume_tag` ([]{key string, value string}) - Same as [`run_volume_tags`](#run_volume_tags) but defined as a singular\n  repeatable block containing a `key` and a `value` field. In HCL2 mode\n  the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/ebsvolume/builder.go; --\u003e\n\n\n### Access Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `access_key` (string) - The access key used to communicate with AWS. [Learn how  to set this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials).\n  On EBS, this is not required if you are using `use_vault_aws_engine`\n  for authentication instead.\n\n- `region` (string) - The name of the region, such as `us-east-1`, in which\n  to launch the EC2 instance to create the AMI.\n  When chroot building, this value is guessed from environment.\n\n- `secret_key` (string) - The secret key used to communicate with AWS. [Learn how to set\n  this](/packer/integrations/hashicorp/amazon#specifying-amazon-credentials). This is not required\n  if you are using `use_vault_aws_engine` for authentication instead.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the AccessConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `assume_role` (AssumeRoleConfig) - If provided with a role ARN, Packer will attempt to assume this role\n  using the supplied credentials. See\n  [AssumeRoleConfig](#assume-role-configuration) below for more\n  details on all of the options available, and for a usage example.\n\n- `custom_endpoint_ec2` (string) - This option is useful if you use a cloud\n  provider whose API is compatible with aws EC2. Specify another endpoint\n  like this https://ec2.custom.endpoint.com.\n\n- `shared_credentials_file` (string) - Path to a credentials file to load credentials from\n\n- `decode_authorization_messages` (bool) - Enable automatic decoding of any encoded authorization (error) messages\n  using the `sts:DecodeAuthorizationMessage` API. Note: requires that the\n  effective user/role have permissions to `sts:DecodeAuthorizationMessage`\n  on resource `*`. Default `false`.\n\n- `insecure_skip_tls_verify` (bool) - This allows skipping TLS\n  verification of the AWS EC2 endpoint. The default is false.\n\n- `max_retries` (int) - This is the maximum number of times an API call is retried, in the case\n  where requests are being throttled or experiencing transient failures.\n  The delay between the subsequent API calls increases exponentially.\n\n- `mfa_code` (string) - The MFA\n  [TOTP](https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm)\n  code. This should probably be a user variable since it changes all the\n  time.\n\n- `profile` (string) - The profile to use in the shared credentials file for\n  AWS. See Amazon's documentation on [specifying\n  profiles](https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles)\n  for more details.\n\n- `skip_metadata_api_check` (bool) - Skip Metadata Api Check\n\n- `skip_credential_validation` (bool) - Set to true if you want to skip validating AWS credentials before runtime.\n\n- `token` (string) - The access token to use. This is different from the\n  access key and secret key. If you're not sure what this is, then you\n  probably don't need it. This will also be read from the AWS_SESSION_TOKEN\n  environmental variable.\n\n- `vault_aws_engine` (VaultAWSEngineOptions) - Get credentials from HashiCorp Vault's aws secrets engine. You must\n  already have created a role to use. For more information about\n  generating credentials via the Vault engine, see the [Vault\n  docs.](https://www.vaultproject.io/api/secret/aws#generate-credentials)\n  If you set this flag, you must also set the below options:\n  -   `name` (string) - Required. Specifies the name of the role to generate\n      credentials against. This is part of the request URL.\n  -   `engine_name` (string) - The name of the aws secrets engine. In the\n      Vault docs, this is normally referred to as \"aws\", and Packer will\n      default to \"aws\" if `engine_name` is not set.\n  -   `role_arn` (string)- The ARN of the role to assume if credential\\_type\n      on the Vault role is assumed\\_role. Must match one of the allowed role\n      ARNs in the Vault role. Optional if the Vault role only allows a single\n      AWS role ARN; required otherwise.\n  -   `ttl` (string) - Specifies the TTL for the use of the STS token. This\n      is specified as a string with a duration suffix. Valid only when\n      credential\\_type is assumed\\_role or federation\\_token. When not\n      specified, the default\\_sts\\_ttl set for the role will be used. If that\n      is also not set, then the default value of 3600s will be used. AWS\n      places limits on the maximum TTL allowed. See the AWS documentation on\n      the DurationSeconds parameter for AssumeRole (for assumed\\_role\n      credential types) and GetFederationToken (for federation\\_token\n      credential types) for more details.\n  \n  HCL2 example:\n  \n  ```hcl\n  vault_aws_engine {\n      name = \"myrole\"\n      role_arn = \"myarn\"\n      ttl = \"3600s\"\n  }\n  ```\n  \n  JSON example:\n  \n  ```json\n  {\n      \"vault_aws_engine\": {\n          \"name\": \"myrole\",\n          \"role_arn\": \"myarn\",\n          \"ttl\": \"3600s\"\n      }\n  }\n  ```\n\n- `aws_polling` (\\*AWSPollingConfig) - [Polling configuration](#polling-configuration) for the AWS waiter. Configures the waiter that checks\n  resource state.\n\n\u003c!-- End of code generated from the comments of the AccessConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Assume Role Configuration\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\nAssumeRoleConfig lets users set configuration options for assuming a special\nrole when executing Packer.\n\nUsage example:\n\nHCL config example:\n\n```HCL\n\n\tsource \"amazon-ebs\" \"example\" {\n\t\tassume_role {\n\t\t\trole_arn     = \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"\n\t\t\tsession_name = \"SESSION_NAME\"\n\t\t\texternal_id  = \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\nJSON config example:\n\n```json\n\n\tbuilder{\n\t\t\"type\": \"amazon-ebs\",\n\t\t\"assume_role\": {\n\t\t\t\"role_arn\"    :  \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\",\n\t\t\t\"session_name\":  \"SESSION_NAME\",\n\t\t\t\"external_id\" :  \"EXTERNAL_ID\"\n\t\t}\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `role_arn` (string) - Amazon Resource Name (ARN) of the IAM Role to assume.\n\n- `duration_seconds` (int) - Number of seconds to restrict the assume role session duration.\n\n- `external_id` (string) - The external ID to use when assuming the role. If omitted, no external\n  ID is passed to the AssumeRole call.\n\n- `policy` (string) - IAM Policy JSON describing further restricting permissions for the IAM\n  Role being assumed.\n\n- `policy_arns` ([]string) - Set of Amazon Resource Names (ARNs) of IAM Policies describing further\n  restricting permissions for the IAM Role being\n\n- `session_name` (string) - Session name to use when assuming the role.\n\n- `tags` (map[string]string) - Map of assume role session tags.\n\n- `transitive_tag_keys` ([]string) - Set of assume role session tag keys to pass to any subsequent sessions.\n\n\u003c!-- End of code generated from the comments of the AssumeRoleConfig struct in builder/common/access_config.go; --\u003e\n\n\n### Polling Configuration\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\nPolling configuration for the AWS waiter. Configures the waiter for resources creation or actions like attaching\nvolumes or importing image.\n\nHCL2 example:\n```hcl\n\n\taws_polling {\n\t\t delay_seconds = 30\n\t\t max_attempts = 50\n\t}\n\n```\n\nJSON example:\n```json\n\n\t\"aws_polling\" : {\n\t\t \"delay_seconds\": 30,\n\t\t \"max_attempts\": 50\n\t}\n\n```\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; DO NOT EDIT MANUALLY --\u003e\n\n- `max_attempts` (int) - Specifies the maximum number of attempts the waiter will check for resource state.\n  This value can also be set via the AWS_MAX_ATTEMPTS.\n  If both option and environment variable are set, the max_attempts will be considered over the AWS_MAX_ATTEMPTS.\n  If none is set, defaults to AWS waiter default which is 40 max_attempts.\n\n- `delay_seconds` (int) - Specifies the delay in seconds between attempts to check the resource state.\n  This value can also be set via the AWS_POLL_DELAY_SECONDS.\n  If both option and environment variable are set, the delay_seconds will be considered over the AWS_POLL_DELAY_SECONDS.\n  If none is set, defaults to AWS waiter default which is 15 seconds.\n\n\u003c!-- End of code generated from the comments of the AWSPollingConfig struct in builder/common/state.go; --\u003e\n\n\n### Block Devices Configuration\n\nBlock devices can be nested in the\n[ebs_volumes](#ebs_volumes) array.\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\nThese will be attached when launching your instance. Your\noptions here may vary depending on the type of VM you use.\n\nExample use case:\n\nThe following mapping will tell Packer to encrypt the root volume of the\nbuild instance at launch using a specific non-default kms key:\n\nHCL2 example:\n\n```hcl\n\n\tlaunch_block_device_mappings {\n\t    device_name = \"/dev/sda1\"\n\t    encrypted = true\n\t    kms_key_id = \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n```\n\nJSON example:\n```json\n\"launch_block_device_mappings\": [\n\n\t{\n\t   \"device_name\": \"/dev/sda1\",\n\t   \"encrypted\": true,\n\t   \"kms_key_id\": \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"\n\t}\n\n]\n```\n\nPlease note that the kms_key_id option in this example exists for\nlaunch_block_device_mappings but not ami_block_device_mappings.\n\nDocumentation for Block Devices Mappings can be found here:\nhttps://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/common/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `delete_on_termination` (bool) - Indicates whether the EBS volume is deleted on instance termination.\n  Default false. NOTE: If this value is not explicitly set to true and\n  volumes are not cleaned up by an alternative method, additional volumes\n  will accumulate after every build.\n\n- `device_name` (string) - The device name exposed to the instance (for example, /dev/sdh or xvdh).\n  Required for every device in the block device mapping.\n\n- `encrypted` (boolean) - Indicates whether or not to encrypt the volume. By default, Packer will\n  keep the encryption setting to what it was in the source image. Setting\n  false will result in an unencrypted device, and true will result in an\n  encrypted one.\n\n- `iops` (\\*int64) - The number of I/O operations per second (IOPS) that the volume supports.\n  See the documentation on\n  [IOPs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `no_device` (bool) - Suppresses the specified device included in the block device mapping of\n  the AMI.\n\n- `snapshot_id` (string) - The ID of the snapshot.\n\n- `throughput` (\\*int64) - The throughput for gp3 volumes, only valid for gp3 types\n  See the documentation on\n  [Throughput](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html)\n  for more information\n\n- `virtual_name` (string) - The virtual device name. See the documentation on Block Device Mapping\n  for more information.\n\n- `volume_type` (string) - The volume type. gp2 \u0026 gp3 for General Purpose (SSD) volumes, io1 \u0026 io2\n  for Provisioned IOPS (SSD) volumes, st1 for Throughput Optimized HDD,\n  sc1 for Cold HDD, and standard for Magnetic volumes.\n\n- `volume_size` (int64) - The size of the volume, in GiB. Required if not specifying a\n  snapshot_id.\n\n- `kms_key_id` (string) - ID, alias or ARN of the KMS key to use for boot volume encryption.\n  This option exists for launch_block_device_mappings but not\n  ami_block_device_mappings. The kms key id defined here only applies to\n  the original build region; if the AMI gets copied to other regions, the\n  volume in those regions will be encrypted by the default EBS KMS key.\n  For valid formats see KmsKeyId in the [AWS API docs -\n  CopyImage](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html)\n  This field is validated by Packer. When using an alias, you will have to\n  prefix kms_key_id with alias/.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/common/block_device.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the BlockDevice struct in builder/ebsvolume/block_device.go; DO NOT EDIT MANUALLY --\u003e\n\n- `tags` (map[string]string) - Key/value pair tags to apply to the volume. These are retained after the builder\n  completes. This is a [template engine](/packer/docs/templates/legacy_json_templates/engine), see\n  [Build template data](#build-template-data) for more information.\n\n- `tag` ([]{key string, value string}) - Same as [`tags`](#tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `snapshot_volume` (bool) - Create a Snapshot of this Volume.\n\n- `snapshot_description` (string) - The description for the snapshot.\n\n\u003c!-- End of code generated from the comments of the BlockDevice struct in builder/ebsvolume/block_device.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `snapshot_tags` (map[string]string) - Key/value pair tags to apply to snapshot. They will override AMI tags if\n  already applied to snapshot. This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `snapshot_tag` ([]{key string, value string}) - Same as [`snapshot_tags`](#snapshot_tags) but defined as a singular\n  repeatable block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `snapshot_users` ([]string) - A list of account IDs that have\n  access to create volumes from the snapshot(s). By default no additional\n  users other than the user creating the AMI has permissions to create\n  volumes from the backing snapshot(s).\n\n- `snapshot_groups` ([]string) - A list of groups that have access to\n  create volumes from the snapshot(s). By default no groups have permission\n  to create volumes from the snapshot(s). all will make the snapshot\n  publicly accessible.\n\n\u003c!-- End of code generated from the comments of the SnapshotConfig struct in builder/common/snapshot_config.go; --\u003e\n\n\n### Run Configuration\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `instance_type` (string) - The EC2 instance type to use while building the\n  AMI, such as t2.small.\n\n- `source_ami` (string) - The source AMI whose root volume will be copied and\n  provisioned on the currently running instance. This must be an EBS-backed\n  AMI with a root volume snapshot that you have access to.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the RunConfig struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `associate_public_ip_address` (confighelper.Trilean) - If using a non-default VPC,\n  public IP addresses are not provided by default. If this is true, your\n  new instance will get a Public IP. default: unset\n  \n  Note: when specifying this attribute without a `subnet_[id|filter]` or\n  `vpc_[id|filter]`, we will attempt to infer this information from the\n  default VPC/Subnet.\n  This operation may require some extra permissions to the IAM role that\n  runs the build:\n  \n  * ec2:DescribeVpcs\n  * ec2:DescribeSubnets\n  \n  Additionally, since we filter subnets/AZs by their capability to host\n  an instance of the selected type, you may also want to define the\n  `ec2:DescribeInstanceTypeOfferings` action to the role running the build.\n  Otherwise, Packer will pick the most available subnet in the VPC selected,\n  which may not be able to host the instance type you provided.\n\n- `availability_zone` (string) - Destination availability zone to launch\n  instance in. Leave this empty to allow Amazon to auto-assign.\n\n- `block_duration_minutes` (int64) - Requires spot_price to be set. The\n  required duration for the Spot Instances (also known as Spot blocks). This\n  value must be a multiple of 60 (60, 120, 180, 240, 300, or 360). You can't\n  specify an Availability Zone group or a launch group if you specify a\n  duration. Note: This parameter is no longer available to new customers\n  from July 1, 2021. [See Amazon's\n  documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-requests.html#fixed-duration-spot-instances).\n\n- `capacity_reservation_preference` (string) - Set the preference for using a capacity reservation if one exists.\n  Either will be `open` or `none`. Defaults to `none`\n\n- `capacity_reservation_id` (string) - Provide the specific EC2 Capacity Reservation ID that will be used\n  by Packer.\n\n- `capacity_reservation_group_arn` (string) - Provide the EC2 Capacity Reservation Group ARN that will be used by\n  Packer.\n\n- `disable_stop_instance` (bool) - Packer normally stops the build instance after all provisioners have\n  run. For Windows instances, it is sometimes desirable to [run\n  Sysprep](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/Creating_EBSbacked_WinAMI.html)\n  which will stop the instance for you. If this is set to `true`, Packer\n  *will not* stop the instance but will assume that you will send the stop\n  signal yourself through your final provisioner. You can do this with a\n  [windows-shell provisioner](/packer/integrations/hashicorp/windows-shell). Note that\n  Packer will still wait for the instance to be stopped, and failing to\n  send the stop signal yourself, when you have set this flag to `true`,\n  will cause a timeout.\n  \n  An example of a valid windows shutdown command in a `windows-shell`\n  provisioner is :\n  ```shell-session\n    ec2config.exe -sysprep\n  ```\n  or\n  ```sell-session\n    \"%programfiles%\\amazon\\ec2configservice\\\"ec2config.exe -sysprep\"\"\n  ```\n  -\u003e Note: The double quotation marks in the command are not required if\n  your CMD shell is already in the\n  `C:\\Program Files\\Amazon\\EC2ConfigService\\` directory.\n\n- `ebs_optimized` (bool) - Mark instance as [EBS\n  Optimized](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html).\n  Default `false`.\n\n- `enable_nitro_enclave` (bool) - Enable support for Nitro Enclaves on the instance.  Note that the instance type must\n  be able to [support Nitro Enclaves](https://aws.amazon.com/ec2/nitro/nitro-enclaves/faqs/).\n  This option is not supported for spot instances.\n\n- `enable_t2_unlimited` (bool) - Deprecated argument - please use \"enable_unlimited_credits\".\n  Enabling T2 Unlimited allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-credits-baseline-concepts.html)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-unlimited.html)\n  and the **T2 Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [T2\n  Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-std.html)\n  instance instead.\n  \n  To use T2 Unlimited you must use a T2 instance type, e.g. `t2.micro`.\n  Additionally, T2 Unlimited cannot be used in conjunction with Spot\n  Instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error.\n  \n  !\u0026gt; **Warning!** Additional costs may be incurred by enabling T2\n  Unlimited - even for instances that would usually qualify for the\n  [AWS Free Tier](https://aws.amazon.com/free/).\n\n- `enable_unlimited_credits` (bool) - Enabling Unlimited credits allows the source instance to burst additional CPU\n  beyond its available [CPU\n  Credits](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html#unlimited-mode-surplus-credits)\n  for as long as the demand exists. This is in contrast to the standard\n  configuration that only allows an instance to consume up to its\n  available CPU Credits. See the AWS documentation for [T2\n  Unlimited](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html)\n  and the **Unlimited Pricing** section of the [Amazon EC2 On-Demand\n  Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) document for\n  more information. By default this option is disabled and Packer will set\n  up a [Standard](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-standard-mode.html)\n  instance instead.\n  \n  To use Unlimited you must use a T2/T3/T3a/T4g instance type, e.g. (`t2.micro`, `t3.micro`).\n  Additionally, Unlimited cannot be used in conjunction with Spot\n  Instances for T2 type instances, e.g. when the `spot_price` option has been configured.\n  Attempting to do so will cause an error if the underlying instance type is a T2 type instance.\n  By default the supported burstable instance types (including t3/t3a/t4g) will be provisioned with its cpu credits set to standard,\n  only when `enable_unlimited_credits` is true will the instance be provisioned with unlimited cpu credits.\n\n- `iam_instance_profile` (string) - The name of an [IAM instance\n  profile](https://docs.aws.amazon.com/IAM/latest/UserGuide/instance-profiles.html)\n  to launch the EC2 instance with.\n\n- `fleet_tags` (map[string]string) - Key/value pair tags to apply tags to the fleet that is issued.\n\n- `fleet_tag` ([]{key string, value string}) - Same as [`fleet_tags`](#fleet_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `skip_profile_validation` (bool) - Whether or not to check if the IAM instance profile exists. Defaults to false\n\n- `temporary_iam_instance_profile_policy_document` (\\*PolicyDocument) - Temporary IAM instance profile policy document\n  If IamInstanceProfile is specified it will be used instead.\n  \n  HCL2 example:\n  ```hcl\n  temporary_iam_instance_profile_policy_document {\n  \tStatement {\n  \t\tAction   = [\"logs:*\"]\n  \t\tEffect   = \"Allow\"\n  \t\tResource = [\"*\"]\n  \t}\n  \tVersion = \"2012-10-17\"\n  }\n  ```\n  \n  JSON example:\n  ```json\n  {\n  \t\"Version\": \"2012-10-17\",\n  \t\"Statement\": [\n  \t\t{\n  \t\t\t\"Action\": [\n  \t\t\t\"logs:*\"\n  \t\t\t],\n  \t\t\t\"Effect\": \"Allow\",\n  \t\t\t\"Resource\": [\"*\"]\n  \t\t}\n  \t]\n  }\n  ```\n\n- `shutdown_behavior` (string) - Automatically terminate instances on\n  shutdown in case Packer exits ungracefully. Possible values are stop and\n  terminate. Defaults to stop.\n\n- `security_group_filter` (SecurityGroupFilterOptions) - Filters used to populate the `security_group_ids` field.\n  \n  HCL2 Example:\n  \n  ```hcl\n    security_group_filter {\n      filters = {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  ```\n  \n  JSON Example:\n  ```json\n  {\n    \"security_group_filter\": {\n      \"filters\": {\n        \"tag:Class\": \"packer\"\n      }\n    }\n  }\n  ```\n  \n  This selects the SG's with tag `Class` with the value `packer`.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a\n      `security_group_ids`. Any filter described in the docs for\n      [DescribeSecurityGroups](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSecurityGroups.html)\n      is valid.\n  \n  `security_group_ids` take precedence over this.\n\n- `run_tags` (map[string]string) - Key/value pair tags to apply to the generated key-pair, security group, iam profile and role, snapshot, network interfaces and instance\n  that is *launched* to create the EBS volumes. The resulting AMI will also inherit these tags.\n  This is a [template\n  engine](/packer/docs/templates/legacy_json_templates/engine), see [Build template\n  data](#build-template-data) for more information.\n\n- `run_tag` ([]{key string, value string}) - Same as [`run_tags`](#run_tags) but defined as a singular repeatable\n  block containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `security_group_id` (string) - The ID (not the name) of the security\n  group to assign to the instance. By default this is not set and Packer will\n  automatically create a new temporary security group to allow SSH access.\n  Note that if this is specified, you must be sure the security group allows\n  access to the ssh_port given below.\n\n- `security_group_ids` ([]string) - A list of security groups as\n  described above. Note that if this is specified, you must omit the\n  security_group_id.\n\n- `source_ami_filter` (AmiFilterOptions) - Filters used to populate the `source_ami`\n  field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    source_ami_filter {\n      filters = {\n         virtualization-type = \"hvm\"\n         name = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n         root-device-type = \"ebs\"\n      }\n      owners = [\"099720109477\"]\n      most_recent = true\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"source_ami_filter\": {\n         \"filters\": {\n         \"virtualization-type\": \"hvm\",\n         \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n         \"root-device-type\": \"ebs\"\n         },\n         \"owners\": [\"099720109477\"],\n         \"most_recent\": true\n      }\n    }\n  ]\n  ```\n  \n    This selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. NOTE:\n    This will fail unless *exactly* one AMI is returned. In the above example,\n    `most_recent` will cause this to succeed by selecting the newest image.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `source_ami`.\n        NOTE: This will fail unless *exactly* one AMI is returned. Any filter\n        described in the docs for\n        [DescribeImages](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html)\n        is valid.\n  \n    -   `owners` (array of strings) - Filters the images by their owner. You\n        may specify one or more AWS account IDs, \"self\" (which will use the\n        account whose credentials you are using to run Packer), or an AWS owner\n        alias: for example, `amazon`, `aws-marketplace`, or `microsoft`. This\n        option is required for security reasons.\n  \n    -   `most_recent` (boolean) - Selects the newest created image when true.\n        This is most useful for selecting a daily distro build.\n  \n    You may set this in place of `source_ami` or in conjunction with it. If you\n    set this in conjunction with `source_ami`, the `source_ami` will be added\n    to the filter. The provided `source_ami` must meet all of the filtering\n    criteria provided in `source_ami_filter`; this pins the AMI returned by the\n    filter, but will cause Packer to fail if the `source_ami` does not exist.\n\n- `spot_instance_types` ([]string) - a list of acceptable instance\n  types to run your build on. We will request a spot instance using the max\n  price of spot_price and the allocation strategy of \"lowest price\".\n  Your instance will be launched on an instance type of the lowest available\n  price that you have in your list.  This is used in place of instance_type.\n  You may only set either spot_instance_types or instance_type, not both.\n  This feature exists to help prevent situations where a Packer build fails\n  because a particular availability zone does not have capacity for the\n  specific instance_type requested in instance_type.\n\n- `spot_price` (string) - With Spot Instances, you pay the Spot price that's in effect for the\n  time period your instances are running. Spot Instance prices are set by\n  Amazon EC2 and adjust gradually based on long-term trends in supply and\n  demand for Spot Instance capacity.\n  \n  When this field is set, it represents the maximum hourly price you are\n  willing to pay for a spot instance. If you do not set this value, it\n  defaults to a maximum price equal to the on demand price of the\n  instance. In the situation where the current Amazon-set spot price\n  exceeds the value set in this field, Packer will not launch an instance\n  and the build will error. In the situation where the Amazon-set spot\n  price is less than the value set in this field, Packer will launch and\n  you will pay the Amazon-set spot price, not this maximum value.\n  For more information, see the Amazon docs on\n  [spot pricing](https://aws.amazon.com/ec2/spot/pricing/).\n\n- `spot_tags` (map[string]string) - Requires spot_price to be set. Key/value pair tags to apply tags to the\n  spot request that is issued.\n\n- `spot_tag` ([]{key string, value string}) - Same as [`spot_tags`](#spot_tags) but defined as a singular repeatable block\n  containing a `key` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `subnet_filter` (SubnetFilterOptions) - Filters used to populate the `subnet_id` field.\n  \n  HCL2 example:\n  \n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    subnet_filter {\n      filters = {\n            \"tag:Class\": \"build\"\n      }\n      most_free = true\n      random = false\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"subnet_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\"\n        },\n        \"most_free\": true,\n        \"random\": false\n      }\n    }\n  ]\n  ```\n  \n    This selects the Subnet with tag `Class` with the value `build`, which has\n    the most free IP addresses. NOTE: This will fail unless *exactly* one\n    Subnet is returned. By using `most_free` or `random` one will be selected\n    from those matching the filter.\n  \n    -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `subnet_id`.\n        NOTE: This will fail unless *exactly* one Subnet is returned. Any\n        filter described in the docs for\n        [DescribeSubnets](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSubnets.html)\n        is valid.\n  \n    -   `most_free` (boolean) - The Subnet with the most free IPv4 addresses\n        will be used if multiple Subnets matches the filter.\n  \n    -   `random` (boolean) - A random Subnet will be used if multiple Subnets\n        matches the filter. `most_free` have precendence over this.\n  \n    `subnet_id` take precedence over this.\n\n- `subnet_id` (string) - If using VPC, the ID of the subnet, such as\n  subnet-12345def, where Packer will launch the EC2 instance. This field is\n  required if you are using an non-default VPC.\n\n- `license_specifications` ([]LicenseSpecification) - The license configurations.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    license_specifications {\n      license_configuration_request = {\n        license_configuration_arn = \"${var.license_configuration_arn}\"\n      }\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"license_specifications\": [\n        {\n          \"license_configuration_request\": {\n            \"license_configuration_arn\": \"{{user `license_configuration_arn`}}\"\n          }\n        }\n      ]\n    }\n  ]\n  ```\n  \n    Each `license_configuration_request` describes a license configuration,\n    the properties of which are:\n  \n    - `license_configuration_arn` (string) - The Amazon Resource Name (ARN)\n      of the license configuration.\n\n- `placement` (Placement) - Describes the placement of an instance.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    placement = {\n      host_resource_group_arn = \"${var.host_resource_group_arn}\"\n      tenancy                 = \"${var.placement_tenancy}\"\n    }\n  }\n  ```\n  \n  JSON example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"placement\": {\n        \"host_resource_group_arn\": \"{{user `host_resource_group_arn`}}\",\n        \"tenancy\": \"{{user `placement_tenancy`}}\"\n      }\n    }\n  ]\n  ```\n  \n    - `host_resource_group_arn` (string) - The ARN of the host resource\n      group in which to launch the instances. If you specify a host\n      resource group ARN, omit the Tenancy parameter or set it to `host`.\n    - `tenancy` (string) - The tenancy of the instance (if the instance is\n      running in a VPC). An instance with a tenancy of `dedicated` runs on\n      single-tenant hardware. The default is `default`, meaning shared\n      tenancy. Allowed values are `default`, `dedicated` and `host`.\n\n- `tenancy` (string) - Deprecated: Use Placement Tenancy instead.\n\n- `temporary_security_group_source_cidrs` ([]string) - A list of IPv4 CIDR blocks to be authorized access to the instance, when\n  packer is creating a temporary security group.\n  \n  The default is [`0.0.0.0/0`] (i.e., allow any IPv4 source).\n  Use `temporary_security_group_source_public_ip` to allow current host's\n  public IP instead of any IPv4 source.\n  This is only used when `security_group_id` or `security_group_ids` is not\n  specified.\n\n- `temporary_security_group_source_public_ip` (bool) - When enabled, use public IP of the host (obtained from https://checkip.amazonaws.com)\n  as CIDR block to be authorized access to the instance, when packer\n  is creating a temporary security group. Defaults to `false`.\n  \n  This is only used when `security_group_id`, `security_group_ids`,\n  and `temporary_security_group_source_cidrs` are not specified.\n\n- `user_data` (string) - User data to apply when launching the instance. Note\n  that you need to be careful about escaping characters due to the templates\n  being JSON. It is often more convenient to use user_data_file, instead.\n  Packer will not automatically wait for a user script to finish before\n  shutting down the instance this must be handled in a provisioner.\n\n- `user_data_file` (string) - Path to a file that will be used for the user\n  data when launching the instance.\n\n- `vpc_filter` (VpcFilterOptions) - Filters used to populate the `vpc_id` field.\n  \n  HCL2 example:\n  ```hcl\n  source \"amazon-ebs\" \"basic-example\" {\n    vpc_filter {\n      filters = {\n        \"tag:Class\": \"build\",\n        \"isDefault\": \"false\",\n        \"cidr\": \"/24\"\n      }\n    }\n  }\n  ```\n  \n  JSON Example:\n  ```json\n  \"builders\" [\n    {\n      \"type\": \"amazon-ebs\",\n      \"vpc_filter\": {\n        \"filters\": {\n          \"tag:Class\": \"build\",\n          \"isDefault\": \"false\",\n          \"cidr\": \"/24\"\n        }\n      }\n    }\n  ]\n  ```\n  \n  This selects the VPC with tag `Class` with the value `build`, which is not\n  the default VPC, and have a IPv4 CIDR block of `/24`. NOTE: This will fail\n  unless *exactly* one VPC is returned.\n  \n  -   `filters` (map[string,string] | multiple filters are allowed when seperated by commas) - filters used to select a `vpc_id`. NOTE:\n      This will fail unless *exactly* one VPC is returned. Any filter\n      described in the docs for\n      [DescribeVpcs](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeVpcs.html)\n      is valid.\n  \n  `vpc_id` take precedence over this.\n\n- `vpc_id` (string) - If launching into a VPC subnet, Packer needs the VPC ID\n  in order to create a temporary security group within the VPC. Requires\n  subnet_id to be set. If this field is left blank, Packer will try to get\n  the VPC ID from the subnet_id.\n\n- `windows_password_timeout` (duration string | ex: \"1h5m2s\") - The timeout for waiting for a Windows\n  password for Windows instances. Defaults to 20 minutes. Example value:\n  10m\n\n- `metadata_options` (MetadataOptions) - [Metadata Settings](#metadata-settings)\n\n- `ssh_interface` (string) - One of `public_ip`, `private_ip`, `public_dns`, `private_dns` or `session_manager`.\n     If set, either the public IP address, private IP address, public DNS name\n     or private DNS name will be used as the host for SSH. The default behaviour\n     if inside a VPC is to use the public IP address if available, otherwise\n     the private IP address will be used. If not in a VPC the public DNS name\n     will be used. Also works for WinRM.\n  \n     Where Packer is configured for an outbound proxy but WinRM traffic\n     should be direct, `ssh_interface` must be set to `private_dns` and\n     `\u003cregion\u003e.compute.internal` included in the `NO_PROXY` environment\n     variable.\n  \n     When using `session_manager` the machine running Packer must have\n  \t  the AWS Session Manager Plugin installed and within the users' system path.\n     Connectivity via the `session_manager` interface establishes a secure tunnel\n     between the local host and the remote host on an available local port to the specified `ssh_port`.\n     See [Session Manager Connections](#session-manager-connections) for more information.\n     - Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM communicator.\n     - Upon termination the secure tunnel will be terminated automatically, if however there is a failure in\n     terminating the tunnel it will automatically terminate itself after 20 minutes of inactivity.\n\n- `pause_before_ssm` (duration string | ex: \"1h5m2s\") - The time to wait before establishing the Session Manager session.\n  The value of this should be a duration. Examples are\n  `5s` and `1m30s` which will cause Packer to wait five seconds and one\n  minute 30 seconds, respectively. If no set, defaults to 10 seconds.\n  This option is useful when the remote port takes longer to become available.\n\n- `session_manager_port` (int) - Which port to connect the local end of the session tunnel to. If\n  left blank, Packer will choose a port for you from available ports.\n  This option is only used when `ssh_interface` is set `session_manager`.\n\n\u003c!-- End of code generated from the comments of the RunConfig struct in builder/common/run_config.go; --\u003e\n\n\n#### Metadata Settings\n\n\u003c!-- Code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\nConfigures the metadata options.\nSee [Configure IMDS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html) for details.\n\n\u003c!-- End of code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `http_endpoint` (string) - A string to enable or disable the IMDS endpoint for an instance. Defaults to enabled.\n  Accepts either \"enabled\" or \"disabled\"\n\n- `http_tokens` (string) - A string to either set the use of IMDSv2 for the instance to optional or required. Defaults to \"optional\".\n  Accepts either \"optional\" or \"required\"\n\n- `http_put_response_hop_limit` (int64) - A numerical value to set an upper limit for the amount of hops allowed when communicating with IMDS endpoints.\n  Defaults to 1.\n\n- `instance_metadata_tags` (string) - A string to enable or disable access to instance tags from the instance metadata. Defaults to disabled.\n  Access to instance metadata tags is available for commercial regions. For non-commercial regions please check availability before enabling.\n  Accepts either \"enabled\" or \"disabled\"\n\n\u003c!-- End of code generated from the comments of the MetadataOptions struct in builder/common/run_config.go; --\u003e\n\n\nUsage Example\n\n**HCL2**\n\n```hcl\nsource \"amazon-ebs\" \"basic-example\" {\n  region        =  \"us-east-1\"\n  source_ami    =  \"ami-fce3c696\"\n  instance_type =  \"t2.micro\"\n  ssh_username  =  \"ubuntu\"\n  ami_name      =  \"packer_AWS_example_{{timestamp}}\"\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens = \"required\"\n    http_put_response_hop_limit = 1\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"aws_access_key\": \"{{env `AWS_ACCESS_KEY_ID`}}\",\n    \"aws_secret_key\": \"{{env `AWS_SECRET_ACCESS_KEY`}}\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"access_key\": \"{{user `aws_access_key`}}\",\n      \"secret_key\": \"{{user `aws_secret_key`}}\",\n      \"region\": \"us-east-1\",\n      \"source_ami\": \"ami-fce3c696\",\n      \"instance_type\": \"t2.micro\",\n      \"ssh_username\": \"ubuntu\",\n      \"ami_name\": \"packer_AWS {{timestamp}}\",\n      \"metadata_options\": {\n        \"http_endpoint\": \"enabled\",\n        \"http_tokens\": \"required\",\n        \"http_put_response_hop_limit\": 1\n      }\n    }\n  ]\n}\n```\n\n\n### Session Manager Connections\n\nSupport for the AWS Systems Manager session manager lets users manage EC2 instances without the need to open inbound ports, or maintain bastion hosts. Session manager connectivity relies on the use of the [session manager plugin](#session-manager-plugin) to open a secure tunnel between the local machine and the remote instance. Once the tunnel has been created all SSH communication will be tunneled through SSM to the remote instance.\n\n-\u003e Note: Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM Communicator.\n\nTo use the session manager as the connection interface for the SSH communicator you need to add the following configuration options to the Amazon builder options:\n\n- `ssh_interface`: The ssh interface must be set to \"session_manager\". When using this option the builder will create an SSM tunnel to the configured `ssh_port` (defaults to 22) on the remote host.\n- `iam_instance_profile`: A valid instance profile granting Systems Manager permissions to manage the remote instance is required in order for the aws ssm-agent to start and stop session connections.\n  See below for more details on [IAM instance profile for Systems Manager](#iam-instance-profile-for-systems-manager).\n\n#### Optional\n\n- `session_manager_port`: A local port on the host machine that should be used as the local end of the session tunnel to the remote host. If not specified Packer will find an available port to use.\n- `temporary_iam_instance_profile_policy_document`: Creates a temporary instance profile policy document to grant Systems Manager permissions to the Ec2 instance. This is an alternative to using an existing `iam_instance_profile`.\n\nHCL2 example:\n\n```hcl\n# file: example.pkr.hcl\n\n# In order to get these variables to read from the environment,\n# set the environment variables to have the same name as the declared\n# variables, with the prefix PKR_VAR_.\n# You could also hardcode them into the file, but we do not recommend that.\n\ndata \"amazon-ami\" \"example\" {\n  filters = {\n    virtualization-type = \"hvm\"\n    name                = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"\n    root-device-type    = \"ebs\"\n  }\n  owners      = [\"099720109477\"]\n  most_recent = true\n  region      = \"us-east-1\"\n}\n\nsource \"amazon-ebs\" \"ssm-example\" {\n  ami_name             = \"packer_AWS {{timestamp}}\"\n  instance_type        = \"t2.micro\"\n  region               = \"us-east-1\"\n  source_ami           = data.amazon-ami.example.id\n  ssh_username         = \"ubuntu\"\n  ssh_interface        = \"session_manager\"\n  communicator         = \"ssh\"\n  iam_instance_profile = \"myinstanceprofile\"\n}\n\nbuild {\n  sources = [\"source.amazon-ebs.ssm-example\"]\n\n  provisioner \"shell\" {\n    inline = [\"echo Connected via SSM at '${build.User}@${build.Host}:${build.Port}'\"]\n  }\n}\n```\n\nJSON example:\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebs\",\n      \"ami_name\": \"packer-ami-{{timestamp}}\",\n      \"instance_type\": \"t2.micro\",\n      \"source_ami_filter\": {\n        \"filters\": {\n          \"virtualization-type\": \"hvm\",\n          \"name\": \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\",\n          \"root-device-type\": \"ebs\"\n        },\n        \"owners\": [\"099720109477\"],\n        \"most_recent\": true\n      },\n      \"ssh_username\": \"ubuntu\",\n      \"ssh_interface\": \"session_manager\",\n      \"communicator\": \"ssh\",\n      \"iam_instance_profile\": \"{{user `iam_instance_profile`}}\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"type\": \"shell\",\n      \"inline\": [\n        \"echo Connected via SSM at '{{build `User`}}@{{build `Host`}}:{{build `Port`}}'\"\n      ]\n    }\n  ]\n}\n```\n\n#### Session Manager Plugin\n\nConnectivity via the session manager requires the use of a session-manger-plugin, which needs to be installed alongside Packer, and an instance AMI that is capable of running the AWS ssm-agent - see [About SSM Agent](https://docs.aws.amazon.com/systems-manager/latest/userguide/prereqs-ssm-agent.html) for details on supported AMIs.\n\nIn order for Packer to start and end sessions that connect you to your managed instances, you must first install the Session Manager plugin on your local machine. The plugin can be installed on supported versions of Microsoft Windows, macOS, Linux, and Ubuntu Server.\n[Installation instructions for the session-manager-plugin](https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html)\n\n#### IAM instance profile for Systems Manager\n\nBy default Systems Manager doesn't have permission to perform actions on created instances so SSM access must be granted by creating an instance profile with the `AmazonSSMManagedInstanceCore` policy. The instance profile can then be attached to any instance you wish to manage via the session-manager-plugin. See [Adding System Manager instance profile](https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html#instance-profile-add-permissions) for details on creating the required instance profile.\n\n#### Permissions for Closing the Tunnel\n\nTo close the SSM tunnels created, this plugin relies on being able to call\n[DescribeInstanceStatus](https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstanceStatus.html).\nIn case this is not possible you might see a `Bad exit status` message in the logs.\n\nThe absence of this permission won't prevent you from building the AMI, and the error only means that packer is not able to close the tunnel gracefully.\n\n\n### Communicator Configuration\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `communicator` (string) - Packer currently supports three kinds of communicators:\n  \n  -   `none` - No communicator will be used. If this is set, most\n      provisioners also can't be used.\n  \n  -   `ssh` - An SSH connection will be established to the machine. This\n      is usually the default.\n  \n  -   `winrm` - A WinRM connection will be established.\n  \n  In addition to the above, some builders have custom communicators they\n  can use. For example, the Docker builder has a \"docker\" communicator\n  that uses `docker exec` and `docker cp` to execute scripts and copy\n  files.\n\n- `pause_before_connecting` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\n  guest's bootstrap script, but sometimes you may have a race condition\n  where you need Packer to wait before attempting to connect to your\n  guest.\n  \n  If you end up in this situation, you can use the template option\n  `pause_before_connecting`. By default, there is no pause. For example if\n  you set `pause_before_connecting` to `10m` Packer will check whether it\n  can connect, as normal. But once a connection attempt is successful, it\n  will disconnect and then wait 10 minutes before connecting to the guest\n  and beginning provisioning.\n\n\u003c!-- End of code generated from the comments of the Config struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSH struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ssh_host` (string) - The address to SSH to. This usually is automatically configured by the\n  builder.\n\n- `ssh_port` (int) - The port to connect to SSH. This defaults to `22`.\n\n- `ssh_username` (string) - The username to connect to SSH with. Required if using SSH.\n\n- `ssh_password` (string) - A plaintext password to use to authenticate with SSH.\n\n- `ssh_ciphers` ([]string) - This overrides the value of ciphers supported by default by Golang.\n  The default value is [\n    \"aes128-gcm@openssh.com\",\n    \"chacha20-poly1305@openssh.com\",\n    \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n  ]\n  \n  Valid options for ciphers include:\n  \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\",\n  \"chacha20-poly1305@openssh.com\",\n  \"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",\n\n- `ssh_clear_authorized_keys` (bool) - If true, Packer will attempt to remove its temporary key from\n  `~/.ssh/authorized_keys` and `/root/.ssh/authorized_keys`. This is a\n  mostly cosmetic option, since Packer will delete the temporary private\n  key from the host system regardless of whether this is set to true\n  (unless the user has set the `-debug` flag). Defaults to \"false\";\n  currently only works on guests with `sed` installed.\n\n- `ssh_key_exchange_algorithms` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\n  supported by default by Golang. Acceptable values include:\n  \"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\",\n  \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n  \"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".\n\n- `ssh_certificate_file` (string) - Path to user certificate used to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_pty` (bool) - If `true`, a PTY will be requested for the SSH connection. This defaults\n  to `false`.\n\n- `ssh_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\n  determine when the machine has booted so this is usually quite long.\n  Example value: `10m`.\n  This defaults to `5m`, unless `ssh_handshake_attempts` is set.\n\n- `ssh_disable_agent_forwarding` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `false`.\n\n- `ssh_handshake_attempts` (int) - The number of handshakes to attempt with SSH once it can connect.\n  This defaults to `10`, unless a `ssh_timeout` is set.\n\n- `ssh_bastion_host` (string) - A bastion host to use for the actual SSH connection.\n\n- `ssh_bastion_port` (int) - The port of the bastion host. Defaults to `22`.\n\n- `ssh_bastion_agent_auth` (bool) - If `true`, the local SSH agent will be used to authenticate with the\n  bastion host. Defaults to `false`.\n\n- `ssh_bastion_username` (string) - The username to connect to the bastion host.\n\n- `ssh_bastion_password` (string) - The password to use to authenticate with the bastion host.\n\n- `ssh_bastion_interactive` (bool) - If `true`, the keyboard-interactive used to authenticate with bastion host.\n\n- `ssh_bastion_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with the\n  bastion host. The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_bastion_certificate_file` (string) - Path to user certificate used to authenticate with bastion host.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_file_transfer_method` (string) - `scp` or `sftp` - How to transfer files, Secure copy (default) or SSH\n  File Transfer Protocol.\n  \n  **NOTE**: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n  (the default protocol for copying data) returns a a non-zero error code since the MOTW\n  cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\n  with SFTP instead `ssh_file_transfer_protocol = \"sftp\"`.\n\n- `ssh_proxy_host` (string) - A SOCKS proxy host to use for SSH connection\n\n- `ssh_proxy_port` (int) - A port of the SOCKS proxy. Defaults to `1080`.\n\n- `ssh_proxy_username` (string) - The optional username to authenticate with the proxy server.\n\n- `ssh_proxy_password` (string) - The optional password to use to authenticate with the proxy server.\n\n- `ssh_keep_alive_interval` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\n  value (`-1s`) to disable. Example value: `10s`. Defaults to `5s`.\n\n- `ssh_read_write_timeout` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\n  useful if, for example, packer hangs on a connection after a reboot.\n  Example: `5m`. Disabled by default.\n\n- `ssh_remote_tunnels` ([]string) - \n\n- `ssh_local_tunnels` ([]string) - \n\n\u003c!-- End of code generated from the comments of the SSH struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `temporary_key_pair_type` (string) - `dsa` | `ecdsa` | `ed25519` | `rsa` ( the default )\n  \n  Specifies the type of key to create. The possible values are 'dsa',\n  'ecdsa', 'ed25519', or 'rsa'.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure, please\n  consider other alternatives like RSA or ED25519.\n\n- `temporary_key_pair_bits` (int) - Specifies the number of bits in the key to create. For RSA keys, the\n  minimum size is 1024 bits and the default is 4096 bits. Generally, 3072\n  bits is considered sufficient. DSA keys must be exactly 1024 bits as\n  specified by FIPS 186-2. For ECDSA keys, bits determines the key length\n  by selecting from one of three elliptic curve sizes: 256, 384 or 521\n  bits. Attempting to use bit lengths other than these three values for\n  ECDSA keys will fail. Ed25519 keys have a fixed length and bits will be\n  ignored.\n  \n  NOTE: DSA is deprecated and no longer recognized as secure as specified\n  by FIPS 186-5, please consider other alternatives like RSA or ED25519.\n\n\u003c!-- End of code generated from the comments of the SSHTemporaryKeyPair struct in communicator/config.go; --\u003e\n\n\n- `ssh_keypair_name` (string) - If specified, this is the key that will be used for SSH with the\n  machine. The key must match a key pair name loaded up into the remote.\n  By default, this is blank, and Packer will generate a temporary keypair\n  unless [`ssh_password`](#ssh_password) is used.\n  [`ssh_private_key_file`](#ssh_private_key_file) or\n  [`ssh_agent_auth`](#ssh_agent_auth) must be specified when\n  [`ssh_keypair_name`](#ssh_keypair_name) is utilized.\n\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n- `ssh_agent_auth` (bool) - If true, the local SSH agent will be used to authenticate connections to\n  the source instance. No temporary keypair will be created, and the\n  values of [`ssh_password`](#ssh_password) and\n  [`ssh_private_key_file`](#ssh_private_key_file) will be ignored. The\n  environment variable `SSH_AUTH_SOCK` must be set for this option to work\n  properly.\n\n\n## Basic Example\n\n**HCL2**\n\n```hcl\nsource \"amazon-ebsvolume\" \"basic-example\" {\n  region = \"us-east-1\"\n  ssh_username = \"ubuntu\"\n  instance_type = \"t2.medium\"\n  source_ami = \"ami-40d28157\"\n\n  ebs_volumes {\n      volume_type = \"gp2\"\n      device_name = \"/dev/xvdf\"\n      delete_on_termination = false\n      tags = {\n        zpool = \"data\"\n        Name = \"Data1\"\n      }\n      volume_size = 10\n  }\n\n  ebs_volumes {\n      volume_type = \"gp2\"\n      device_name = \"/dev/xvdg\"\n      tags = {\n        zpool = \"data\"\n        Name = \"Data2\"\n      }\n      delete_on_termination = false\n      volume_size = 10\n  }\n\n  ebs_volumes {\n      volume_size = 10\n      tags = {\n        zpool = \"data\"\n        Name = \"Data3\"\n      }\n      delete_on_termination = false\n      device_name = \"/dev/xvdh\"\n      volume_type = \"gp2\"\n  }\n}\n\nbuild {\n  sources = [\"sources.amazon-ebsvolume.basic-example\"]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"amazon-ebsvolume\",\n      \"region\": \"us-east-1\",\n      \"ssh_username\": \"ubuntu\",\n      \"instance_type\": \"t2.medium\",\n      \"source_ami\": \"ami-40d28157\",\n      \"ebs_volumes\": [\n        {\n          \"volume_type\": \"gp2\",\n          \"device_name\": \"/dev/xvdf\",\n          \"delete_on_termination\": false,\n          \"tags\": {\n            \"zpool\": \"data\",\n            \"Name\": \"Data1\"\n          },\n          \"volume_size\": 10\n        },\n        {\n          \"volume_type\": \"gp2\",\n          \"device_name\": \"/dev/xvdg\",\n          \"tags\": {\n            \"zpool\": \"data\",\n            \"Name\": \"Data2\"\n          },\n          \"delete_on_termination\": false,\n          \"volume_size\": 10\n        },\n        {\n          \"volume_size\": 10,\n          \"tags\": {\n            \"Name\": \"Data3\",\n            \"zpool\": \"data\"\n          },\n          \"delete_on_termination\": false,\n          \"device_name\": \"/dev/xvdh\",\n          \"volume_type\": \"gp2\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n\n-\u003e **Note:** Packer can also read the access key and secret access key from\nenvironmental variables. See the configuration reference in the section above\nfor more information on what environmental variables Packer will look for.\n\nFurther information on locating AMI IDs and their relationship to instance\ntypes and regions can be found in the AWS EC2 Documentation [for\nLinux](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/finding-an-ami.html)\nor [for\nWindows](http://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/finding-an-ami.html).\n\n## Accessing the Instance to Debug\n\nIf you need to access the instance to debug for some reason, run the builder\nwith the `-debug` flag. In debug mode, the Amazon builder will save the private\nkey in the current directory and will output the DNS or IP information as well.\nYou can use this information to access the instance as it is running.\n\n## Build template data\n\nIn configuration directives marked as a template engine above, the following\nvariables are available:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n- `SourceAMITags` - The source AMI Tags, as a `map[string]string` object.\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](/packer/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](/packer/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `BuildRegion` - The region (for example `eu-central-1`) where Packer is\n  building the AMI.\n- `SourceAMI` - The source AMI ID (for example `ami-a2412fcd`) used to build\n  the AMI.\n- `SourceAMICreationDate` - The source AMI creation date (for example `\"2020-05-14T19:26:34.000Z\"`).\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n- `SourceAMIOwner` - The source AMI owner ID.\n- `SourceAMIOwnerName` - The source AMI owner alias/name (for example `amazon`).\n\n-\u003e **Note:** Packer uses pre-built AMIs as the source for building images.\nThese source AMIs may include volumes that are not flagged to be destroyed on\ntermination of the instance building the new image. In addition to those\nvolumes created by this builder, any volumes in the source AMI which are not\nmarked for deletion on termination will remain in your account.\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](/packer/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](/packer/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `SourceAMIName` - The source AMI Name (for example\n  `ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`) used to\n  build the AMI.\n\nUsage example:\n\n**HCL2**\n\n```hcl\n// When accessing one of these variables from inside the builder, you need to\n// use the golang templating syntax. This is due to an architectural quirk that\n// won't be easily resolvable until legacy json templates are deprecated:\n\n{\nsource \"amazon-ebs\" \"basic-example\" {\n  tags = {\n        OS_Version = \"Ubuntu\"\n        Release = \"Latest\"\n        Base_AMI_ID = \"{{ .SourceAMI }}\"\n        Base_AMI_Name = \"{{ .SourceAMIName }}\"\n    }\n}\n\n// when accessing one of the variables from a provisioner or post-processor, use\n// hcl-syntax\npost-processor \"manifest\" {\n    output = \"manifest.json\"\n    strip_path = true\n    custom_data = {\n        source_ami_name = \"${build.SourceAMIName}\"\n    }\n}\n```\n\n**JSON**\n\n```json\n\"post-processors\": [\n  {\n    \"type\": \"manifest\",\n    \"output\": \"manifest.json\",\n    \"strip_path\": true,\n    \"custom_data\": {\n      \"source_ami_name\": \"{{ build `SourceAMIName` }}\"\n    }\n  }\n]\n```\n\n\n## Which SSH Options to use:\n\nThis chart breaks down what Packer does if you set any of the below SSH options:\n\n| ssh_password | ssh_private_key_file | ssh_keypair_name | temporary_key_pair_name | Packer will...                                                                             |\n| ------------ | -------------------- | ---------------- | ----------------------- | ------------------------------------------------------------------------------------------ |\n| X            | -                    | -                | -                       | ssh authenticating with username and given password                                        |\n| -            | X                    | -                | -                       | ssh authenticating with private key file                                                   |\n| -            | X                    | X                | -                       | ssh authenticating with given private key file and \"attaching\" the keypair to the instance |\n| -            | -                    | -                | X                       | Create a temporary ssh keypair with a particular name, clean it up                         |\n| -            | -                    | -                | -                       | Create a temporary ssh keypair with a default name, clean it up                            |\n","created_at":"2024-04-17T16:47:58.567Z","updated_at":"2024-04-17T16:47:58.567Z","name":"Amazon EBS Volume","slug":"ebsvolume","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},"processedVariablesMarkdown":{},"anchorLinks":[{"id":"configuration-reference","level":2,"title":"Configuration Reference"},{"id":"optional:","level":3,"title":"Optional:"},{"id":"access-configuration","level":3,"title":"Access Configuration"},{"id":"required:","level":4,"title":"Required:"},{"id":"optional:","level":4,"title":"Optional:"},{"id":"assume-role-configuration","level":3,"title":"Assume Role Configuration"},{"id":"polling-configuration","level":3,"title":"Polling Configuration"},{"id":"block-devices-configuration","level":3,"title":"Block Devices Configuration"},{"id":"optional:","level":4,"title":"Optional:"},{"id":"run-configuration","level":3,"title":"Run Configuration"},{"id":"required:","level":4,"title":"Required:"},{"id":"optional:","level":4,"title":"Optional:"},{"id":"metadata-settings","level":4,"title":"Metadata Settings"},{"id":"session-manager-connections","level":3,"title":"Session Manager Connections"},{"id":"optional","level":4,"title":"Optional"},{"id":"session-manager-plugin","level":4,"title":"Session Manager Plugin"},{"id":"iam-instance-profile-for-systems-manager","level":4,"title":"IAM instance profile for Systems Manager"},{"id":"permissions-for-closing-the-tunnel","level":4,"title":"Permissions for Closing the Tunnel"},{"id":"communicator-configuration","level":3,"title":"Communicator Configuration"},{"id":"optional:","level":4,"title":"Optional:"},{"id":"basic-example","level":2,"title":"Basic Example"},{"id":"accessing-the-instance-to-debug","level":2,"title":"Accessing the Instance to Debug"},{"id":"build-template-data","level":2,"title":"Build template data"},{"id":"build-shared-information-variables","level":2,"title":"Build Shared Information Variables"},{"id":"build-shared-information-variables","level":2,"title":"Build Shared Information Variables"},{"id":"which-ssh-options-to-use:","level":2,"title":"Which SSH Options to use:"}],"serializedREADME":{"compiledSource":"const layoutProps={};const MDXLayout=\"wrapper\";function MDXContent({components,...props}){return mdx(MDXLayout,{...layoutProps,...props,components:components,mdxType:\"MDXLayout\"},mdx(\"p\",{\"className\":\"g-type-long-body\"},`Type: `,mdx(\"inlineCode\",{parentName:\"p\"},`amazon-ebsvolume`),`\nArtifact BuilderId: `,mdx(\"inlineCode\",{parentName:\"p\"},`mitchellh.amazon.ebsvolume`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The `,mdx(\"inlineCode\",{parentName:\"p\"},`amazon-ebsvolume`),` Packer builder is able to create Amazon Elastic Block\nStore volumes which are prepopulated with filesystems or data.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This builder creates EBS volumes by launching an EC2 instance from a source\nAMI. One or more EBS volumes are attached to the running instance, allowing\nthem to be provisioned into from the running machine. Once provisioning is\ncomplete the source machine is destroyed. The provisioned volumes are kept\nintact.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This is all done in your own AWS account. The builder will create temporary key\npairs, security group rules, etc. that provide it temporary access to the\ninstance while the image is being created.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The builder does `,mdx(\"em\",{parentName:\"p\"},`not`),` manage EBS Volumes. Once it creates volumes and stores\nit in your account, it is up to you to use, delete, etc. the volumes.`),mdx(\"div\",{\"className\":\"alert alert-info g-type-body\"},mdx(\"p\",{parentName:\"div\",\"className\":\"g-type-long-body\"},``,mdx(\"strong\",{parentName:\"p\"},`Note:`),` Temporary resources are, by default, all created with the\nprefix `,mdx(\"inlineCode\",{parentName:\"p\"},`packer`),`. This can be useful if you want to restrict the security groups\nand key pairs Packer is able to operate on.`)),mdx(\"h2\",{\"id\":\"user-content-configuration-reference\",\"data-text-content\":\"Configuration Reference\",\"className\":\"g-type-display-3\"},`Configuration Reference`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`There are many configuration options available for the builder. In addition to\nthe items listed here, you will want to look at the general configuration\nreferences for `,mdx(\"a\",{parentName:\"p\",\"href\":\"#ami-configuration\"},`AMI`),`,\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"#block-devices-configuration\"},`BlockDevices`),`,\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"#access-configuration\"},`Access`),`,\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"#run-configuration\"},`Run`),` and\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"#communicator-configuration\"},`Communicator`),`\nconfiguration references, which are\nnecessary for this build to succeed and can be found further down the page.`),mdx(\"h3\",{\"id\":\"user-content-optional:\",\"data-text-content\":\"Optional\",\"className\":\"g-type-display-4\"},`Optional:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ena_support`),` (boolean) - Enable enhanced networking (ENA but not SriovNetSupport) on\nHVM-compatible AMIs. If set, add `,mdx(\"inlineCode\",{parentName:\"p\"},`ec2:ModifyInstanceAttribute`),` to your\nAWS IAM policy. Note: you must make sure enhanced networking is enabled\non your instance. See `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking\"},`Amazon's documentation on enabling enhanced\nnetworking`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`sriov_support`),` (bool) - Enable enhanced networking (SriovNetSupport but not ENA) on\nHVM-compatible AMIs. If true, add `,mdx(\"inlineCode\",{parentName:\"p\"},`ec2:ModifyInstanceAttribute`),` to your\nAWS IAM policy. Note: you must make sure enhanced networking is enabled\non your instance. See `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enhanced-networking.html#enabling_enhanced_networking\"},`Amazon's documentation on enabling enhanced\nnetworking`),`.\nDefault `,mdx(\"inlineCode\",{parentName:\"p\"},`false`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ebs_volumes`),` (BlockDevices) - Add the block device mappings to the AMI. If you add instance store\nvolumes or EBS volumes in addition to the root device volume, the\ncreated AMI will contain block device mapping information for those\nvolumes. Amazon creates snapshots of the source instance's root volume\nand any other EBS volumes described here. When you launch an instance\nfrom this new AMI, the instance automatically launches with these\nadditional volumes, and will restore them from snapshots taken from the\nsource instance. See the `,mdx(\"a\",{parentName:\"p\",\"href\":\"#block-devices-configuration\"},`BlockDevices`),`\ndocumentation for fields.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`run_volume_tags`),` (map`,`[string]`,`string) - Key/value pair tags to apply to the volumes of the instance that is\n`,mdx(\"em\",{parentName:\"p\"},`launched`),` to create EBS Volumes. These tags will `,mdx(\"em\",{parentName:\"p\"},`not`),` appear in the\ntags of the resulting EBS volumes unless they're duplicated under `,mdx(\"inlineCode\",{parentName:\"p\"},`tags`),`\nin the `,mdx(\"inlineCode\",{parentName:\"p\"},`ebs_volumes`),` setting. This is a `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/legacy_json_templates/engine\"},`template\nengine`),`, see `,mdx(\"a\",{parentName:\"p\",\"href\":\"#build-template-data\"},`Build template\ndata`),` for more information.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},` Note: The tags specified here will be `,mdx(\"em\",{parentName:\"p\"},`temporarily`),` applied to volumes\nspecified in `,mdx(\"inlineCode\",{parentName:\"p\"},`ebs_volumes`),` - but only while the instance is being\ncreated. Packer will replace all tags on the volume with the tags\nconfigured in the `,mdx(\"inlineCode\",{parentName:\"p\"},`ebs_volumes`),` section as soon as the instance is\nreported as 'ready'.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`run_volume_tag`),` ([]{key string, value string}) - Same as `,mdx(\"a\",{parentName:\"p\",\"href\":\"#run_volume_tags\"},mdx(\"inlineCode\",{parentName:\"a\"},`run_volume_tags`)),` but defined as a singular\nrepeatable block containing a `,mdx(\"inlineCode\",{parentName:\"p\"},`key`),` and a `,mdx(\"inlineCode\",{parentName:\"p\"},`value`),` field. In HCL2 mode\nthe\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/hcl_templates/expressions#dynamic-blocks\"},mdx(\"inlineCode\",{parentName:\"a\"},`dynamic_block`)),`\nwill allow you to create those programatically.`))),mdx(\"h3\",{\"id\":\"user-content-access-configuration\",\"data-text-content\":\"Access Configuration\",\"className\":\"g-type-display-4\"},`Access Configuration`),mdx(\"h4\",{\"id\":\"user-content-required:\",\"data-text-content\":\"Required\",\"className\":\"g-type-display-5\"},`Required:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`access_key`),` (string) - The access key used to communicate with AWS. `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/integrations/hashicorp/amazon#specifying-amazon-credentials\"},`Learn how  to set this`),`.\nOn EBS, this is not required if you are using `,mdx(\"inlineCode\",{parentName:\"p\"},`use_vault_aws_engine`),`\nfor authentication instead.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`region`),` (string) - The name of the region, such as `,mdx(\"inlineCode\",{parentName:\"p\"},`us-east-1`),`, in which\nto launch the EC2 instance to create the AMI.\nWhen chroot building, this value is guessed from environment.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`secret_key`),` (string) - The secret key used to communicate with AWS. `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/integrations/hashicorp/amazon#specifying-amazon-credentials\"},`Learn how to set\nthis`),`. This is not required\nif you are using `,mdx(\"inlineCode\",{parentName:\"p\"},`use_vault_aws_engine`),` for authentication instead.`))),mdx(\"h4\",{\"id\":\"user-content-optional:\",\"data-text-content\":\"Optional\",\"className\":\"g-type-display-5\"},`Optional:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`assume_role`),` (AssumeRoleConfig) - If provided with a role ARN, Packer will attempt to assume this role\nusing the supplied credentials. See\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"#assume-role-configuration\"},`AssumeRoleConfig`),` below for more\ndetails on all of the options available, and for a usage example.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`custom_endpoint_ec2`),` (string) - This option is useful if you use a cloud\nprovider whose API is compatible with aws EC2. Specify another endpoint\nlike this `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://ec2.custom.endpoint.com\"},`https://ec2.custom.endpoint.com`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`shared_credentials_file`),` (string) - Path to a credentials file to load credentials from`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`decode_authorization_messages`),` (bool) - Enable automatic decoding of any encoded authorization (error) messages\nusing the `,mdx(\"inlineCode\",{parentName:\"p\"},`sts:DecodeAuthorizationMessage`),` API. Note: requires that the\neffective user/role have permissions to `,mdx(\"inlineCode\",{parentName:\"p\"},`sts:DecodeAuthorizationMessage`),`\non resource `,mdx(\"inlineCode\",{parentName:\"p\"},`*`),`. Default `,mdx(\"inlineCode\",{parentName:\"p\"},`false`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`insecure_skip_tls_verify`),` (bool) - This allows skipping TLS\nverification of the AWS EC2 endpoint. The default is false.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`max_retries`),` (int) - This is the maximum number of times an API call is retried, in the case\nwhere requests are being throttled or experiencing transient failures.\nThe delay between the subsequent API calls increases exponentially.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`mfa_code`),` (string) - The MFA\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm\"},`TOTP`),`\ncode. This should probably be a user variable since it changes all the\ntime.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`profile`),` (string) - The profile to use in the shared credentials file for\nAWS. See Amazon's documentation on `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-profiles\"},`specifying\nprofiles`),`\nfor more details.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`skip_metadata_api_check`),` (bool) - Skip Metadata Api Check`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`skip_credential_validation`),` (bool) - Set to true if you want to skip validating AWS credentials before runtime.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`token`),` (string) - The access token to use. This is different from the\naccess key and secret key. If you're not sure what this is, then you\nprobably don't need it. This will also be read from the AWS_SESSION_TOKEN\nenvironmental variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`vault_aws_engine`),` (VaultAWSEngineOptions) - Get credentials from HashiCorp Vault's aws secrets engine. You must\nalready have created a role to use. For more information about\ngenerating credentials via the Vault engine, see the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.vaultproject.io/api/secret/aws#generate-credentials\"},`Vault\ndocs.`),`\nIf you set this flag, you must also set the below options:`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`name`),` (string) - Required. Specifies the name of the role to generate\ncredentials against. This is part of the request URL.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`engine_name`),` (string) - The name of the aws secrets engine. In the\nVault docs, this is normally referred to as \"aws\", and Packer will\ndefault to \"aws\" if `,mdx(\"inlineCode\",{parentName:\"li\"},`engine_name`),` is not set.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`role_arn`),` (string)- The ARN of the role to assume if credential`,`_`,`type\non the Vault role is assumed`,`_`,`role. Must match one of the allowed role\nARNs in the Vault role. Optional if the Vault role only allows a single\nAWS role ARN; required otherwise.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`ttl`),` (string) - Specifies the TTL for the use of the STS token. This\nis specified as a string with a duration suffix. Valid only when\ncredential`,`_`,`type is assumed`,`_`,`role or federation`,`_`,`token. When not\nspecified, the default`,`_`,`sts`,`_`,`ttl set for the role will be used. If that\nis also not set, then the default value of 3600s will be used. AWS\nplaces limits on the maximum TTL allowed. See the AWS documentation on\nthe DurationSeconds parameter for AssumeRole (for assumed`,`_`,`role\ncredential types) and GetFederationToken (for federation`,`_`,`token\ncredential types) for more details.`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`vault_aws_engine`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"myrole\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    role_arn `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"myarn\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    ttl `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"3600s\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`JSON example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"vault_aws_engine\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"myrole\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"role_arn\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"myarn\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"ttl\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"3600s\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`aws_polling`),` (`,`*`,`AWSPollingConfig) - `,mdx(\"a\",{parentName:\"p\",\"href\":\"#polling-configuration\"},`Polling configuration`),` for the AWS waiter. Configures the waiter that checks\nresource state.`))),mdx(\"h3\",{\"id\":\"user-content-assume-role-configuration\",\"data-text-content\":\"Assume Role Configuration\",\"className\":\"g-type-display-4\"},`Assume Role Configuration`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`AssumeRoleConfig lets users set configuration options for assuming a special\nrole when executing Packer.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Usage example:`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`HCL config example:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`    source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`        assume_role`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`            role_arn     `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`            session_name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"SESSION_NAME\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`            external_id  `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"EXTERNAL_ID\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`JSON config example:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    builder{`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"assume_role\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"role_arn\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`    :`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`  \"arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"session_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`  \"SESSION_NAME\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"external_id\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},` :`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`  \"EXTERNAL_ID\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,`\n`)),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`role_arn`),` (string) - Amazon Resource Name (ARN) of the IAM Role to assume.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`duration_seconds`),` (int) - Number of seconds to restrict the assume role session duration.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`external_id`),` (string) - The external ID to use when assuming the role. If omitted, no external\nID is passed to the AssumeRole call.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`policy`),` (string) - IAM Policy JSON describing further restricting permissions for the IAM\nRole being assumed.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`policy_arns`),` ([]string) - Set of Amazon Resource Names (ARNs) of IAM Policies describing further\nrestricting permissions for the IAM Role being`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`session_name`),` (string) - Session name to use when assuming the role.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`tags`),` (map`,`[string]`,`string) - Map of assume role session tags.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`transitive_tag_keys`),` ([]string) - Set of assume role session tag keys to pass to any subsequent sessions.`))),mdx(\"h3\",{\"id\":\"user-content-polling-configuration\",\"data-text-content\":\"Polling Configuration\",\"className\":\"g-type-display-4\"},`Polling Configuration`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Polling configuration for the AWS waiter. Configures the waiter for resources creation or actions like attaching\nvolumes or importing image.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`    aws_polling`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`         delay_seconds `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 30`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`         max_attempts `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 50`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`JSON example:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`    \"aws_polling\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` : {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`         \"delay_seconds\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 30`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`         \"max_attempts\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 50`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,`\n`)),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`max_attempts`),` (int) - Specifies the maximum number of attempts the waiter will check for resource state.\nThis value can also be set via the AWS_MAX_ATTEMPTS.\nIf both option and environment variable are set, the max_attempts will be considered over the AWS_MAX_ATTEMPTS.\nIf none is set, defaults to AWS waiter default which is 40 max_attempts.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`delay_seconds`),` (int) - Specifies the delay in seconds between attempts to check the resource state.\nThis value can also be set via the AWS_POLL_DELAY_SECONDS.\nIf both option and environment variable are set, the delay_seconds will be considered over the AWS_POLL_DELAY_SECONDS.\nIf none is set, defaults to AWS waiter default which is 15 seconds.`))),mdx(\"h3\",{\"id\":\"user-content-block-devices-configuration\",\"data-text-content\":\"Block Devices Configuration\",\"className\":\"g-type-display-4\"},`Block Devices Configuration`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Block devices can be nested in the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"#ebs_volumes\"},`ebs_volumes`),` array.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`These will be attached when launching your instance. Your\noptions here may vary depending on the type of VM you use.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Example use case:`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The following mapping will tell Packer to encrypt the root volume of the\nbuild instance at launch using a specific non-default kms key:`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`    launch_block_device_mappings`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        device_name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/dev/sda1\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        encrypted `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        kms_key_id `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`JSON example:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"launch_block_device_mappings\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`: [`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`       \"device_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/dev/sda1\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`       \"encrypted\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`       \"kms_key_id\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"1a2b3c4d-5e6f-1a2b-3c4d-5e6f1a2b3c4d\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Please note that the kms_key_id option in this example exists for\nlaunch_block_device_mappings but not ami_block_device_mappings.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Documentation for Block Devices Mappings can be found here:\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html\"},`https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/block-device-mapping-concepts.html`)),mdx(\"h4\",{\"id\":\"user-content-optional:\",\"data-text-content\":\"Optional\",\"className\":\"g-type-display-5\"},`Optional:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`delete_on_termination`),` (bool) - Indicates whether the EBS volume is deleted on instance termination.\nDefault false. NOTE: If this value is not explicitly set to true and\nvolumes are not cleaned up by an alternative method, additional volumes\nwill accumulate after every build.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`device_name`),` (string) - The device name exposed to the instance (for example, /dev/sdh or xvdh).\nRequired for every device in the block device mapping.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`encrypted`),` (boolean) - Indicates whether or not to encrypt the volume. By default, Packer will\nkeep the encryption setting to what it was in the source image. Setting\nfalse will result in an unencrypted device, and true will result in an\nencrypted one.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`iops`),` (`,`*`,`int64) - The number of I/O operations per second (IOPS) that the volume supports.\nSee the documentation on\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html\"},`IOPs`),`\nfor more information`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`no_device`),` (bool) - Suppresses the specified device included in the block device mapping of\nthe AMI.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_id`),` (string) - The ID of the snapshot.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`throughput`),` (`,`*`,`int64) - The throughput for gp3 volumes, only valid for gp3 types\nSee the documentation on\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_EbsBlockDevice.html\"},`Throughput`),`\nfor more information`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`virtual_name`),` (string) - The virtual device name. See the documentation on Block Device Mapping\nfor more information.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`volume_type`),` (string) - The volume type. gp2 \u0026 gp3 for General Purpose (SSD) volumes, io1 \u0026 io2\nfor Provisioned IOPS (SSD) volumes, st1 for Throughput Optimized HDD,\nsc1 for Cold HDD, and standard for Magnetic volumes.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`volume_size`),` (int64) - The size of the volume, in GiB. Required if not specifying a\nsnapshot_id.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`kms_key_id`),` (string) - ID, alias or ARN of the KMS key to use for boot volume encryption.\nThis option exists for launch_block_device_mappings but not\nami_block_device_mappings. The kms key id defined here only applies to\nthe original build region; if the AMI gets copied to other regions, the\nvolume in those regions will be encrypted by the default EBS KMS key.\nFor valid formats see KmsKeyId in the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CopyImage.html\"},`AWS API docs -\nCopyImage`),`\nThis field is validated by Packer. When using an alias, you will have to\nprefix kms_key_id with alias/.`))),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`tags`),` (map`,`[string]`,`string) - Key/value pair tags to apply to the volume. These are retained after the builder\ncompletes. This is a `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/legacy_json_templates/engine\"},`template engine`),`, see\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"#build-template-data\"},`Build template data`),` for more information.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`tag`),` ([]{key string, value string}) - Same as `,mdx(\"a\",{parentName:\"p\",\"href\":\"#tags\"},mdx(\"inlineCode\",{parentName:\"a\"},`tags`)),` but defined as a singular repeatable block\ncontaining a `,mdx(\"inlineCode\",{parentName:\"p\"},`key`),` and a `,mdx(\"inlineCode\",{parentName:\"p\"},`value`),` field. In HCL2 mode the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/hcl_templates/expressions#dynamic-blocks\"},mdx(\"inlineCode\",{parentName:\"a\"},`dynamic_block`)),`\nwill allow you to create those programatically.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_volume`),` (bool) - Create a Snapshot of this Volume.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_description`),` (string) - The description for the snapshot.`))),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_tags`),` (map`,`[string]`,`string) - Key/value pair tags to apply to snapshot. They will override AMI tags if\nalready applied to snapshot. This is a `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/legacy_json_templates/engine\"},`template\nengine`),`, see `,mdx(\"a\",{parentName:\"p\",\"href\":\"#build-template-data\"},`Build template\ndata`),` for more information.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_tag`),` ([]{key string, value string}) - Same as `,mdx(\"a\",{parentName:\"p\",\"href\":\"#snapshot_tags\"},mdx(\"inlineCode\",{parentName:\"a\"},`snapshot_tags`)),` but defined as a singular\nrepeatable block containing a `,mdx(\"inlineCode\",{parentName:\"p\"},`key`),` and a `,mdx(\"inlineCode\",{parentName:\"p\"},`value`),` field. In HCL2 mode the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/hcl_templates/expressions#dynamic-blocks\"},mdx(\"inlineCode\",{parentName:\"a\"},`dynamic_block`)),`\nwill allow you to create those programatically.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_users`),` ([]string) - A list of account IDs that have\naccess to create volumes from the snapshot(s). By default no additional\nusers other than the user creating the AMI has permissions to create\nvolumes from the backing snapshot(s).`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_groups`),` ([]string) - A list of groups that have access to\ncreate volumes from the snapshot(s). By default no groups have permission\nto create volumes from the snapshot(s). all will make the snapshot\npublicly accessible.`))),mdx(\"h3\",{\"id\":\"user-content-run-configuration\",\"data-text-content\":\"Run Configuration\",\"className\":\"g-type-display-4\"},`Run Configuration`),mdx(\"h4\",{\"id\":\"user-content-required:\",\"data-text-content\":\"Required\",\"className\":\"g-type-display-5\"},`Required:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`instance_type`),` (string) - The EC2 instance type to use while building the\nAMI, such as t2.small.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`source_ami`),` (string) - The source AMI whose root volume will be copied and\nprovisioned on the currently running instance. This must be an EBS-backed\nAMI with a root volume snapshot that you have access to.`))),mdx(\"h4\",{\"id\":\"user-content-optional:\",\"data-text-content\":\"Optional\",\"className\":\"g-type-display-5\"},`Optional:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`associate_public_ip_address`),` (confighelper.Trilean) - If using a non-default VPC,\npublic IP addresses are not provided by default. If this is true, your\nnew instance will get a Public IP. default: unset`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Note: when specifying this attribute without a `,mdx(\"inlineCode\",{parentName:\"p\"},`subnet_[id|filter]`),` or\n`,mdx(\"inlineCode\",{parentName:\"p\"},`vpc_[id|filter]`),`, we will attempt to infer this information from the\ndefault VPC/Subnet.\nThis operation may require some extra permissions to the IAM role that\nruns the build:`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},`ec2:DescribeVpcs`),mdx(\"li\",{parentName:\"ul\"},`ec2:DescribeSubnets`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Additionally, since we filter subnets/AZs by their capability to host\nan instance of the selected type, you may also want to define the\n`,mdx(\"inlineCode\",{parentName:\"p\"},`ec2:DescribeInstanceTypeOfferings`),` action to the role running the build.\nOtherwise, Packer will pick the most available subnet in the VPC selected,\nwhich may not be able to host the instance type you provided.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`availability_zone`),` (string) - Destination availability zone to launch\ninstance in. Leave this empty to allow Amazon to auto-assign.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`block_duration_minutes`),` (int64) - Requires spot_price to be set. The\nrequired duration for the Spot Instances (also known as Spot blocks). This\nvalue must be a multiple of 60 (60, 120, 180, 240, 300, or 360). You can't\nspecify an Availability Zone group or a launch group if you specify a\nduration. Note: This parameter is no longer available to new customers\nfrom July 1, 2021. `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-requests.html#fixed-duration-spot-instances\"},`See Amazon's\ndocumentation`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`capacity_reservation_preference`),` (string) - Set the preference for using a capacity reservation if one exists.\nEither will be `,mdx(\"inlineCode\",{parentName:\"p\"},`open`),` or `,mdx(\"inlineCode\",{parentName:\"p\"},`none`),`. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`none`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`capacity_reservation_id`),` (string) - Provide the specific EC2 Capacity Reservation ID that will be used\nby Packer.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`capacity_reservation_group_arn`),` (string) - Provide the EC2 Capacity Reservation Group ARN that will be used by\nPacker.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`disable_stop_instance`),` (bool) - Packer normally stops the build instance after all provisioners have\nrun. For Windows instances, it is sometimes desirable to `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/Creating_EBSbacked_WinAMI.html\"},`run\nSysprep`),`\nwhich will stop the instance for you. If this is set to `,mdx(\"inlineCode\",{parentName:\"p\"},`true`),`, Packer\n`,mdx(\"em\",{parentName:\"p\"},`will not`),` stop the instance but will assume that you will send the stop\nsignal yourself through your final provisioner. You can do this with a\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/integrations/hashicorp/windows-shell\"},`windows-shell provisioner`),`. Note that\nPacker will still wait for the instance to be stopped, and failing to\nsend the stop signal yourself, when you have set this flag to `,mdx(\"inlineCode\",{parentName:\"p\"},`true`),`,\nwill cause a timeout.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`An example of a valid windows shutdown command in a `,mdx(\"inlineCode\",{parentName:\"p\"},`windows-shell`),`\nprovisioner is :`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ec2config.exe -sysprep`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`or`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  \"%programfiles%\\\\amazon\\\\ec2configservice\\\\\"ec2config.exe -sysprep\"\"`)),`\n`)),mdx(\"div\",{parentName:\"li\",\"className\":\"alert alert-info g-type-body\"},mdx(\"p\",{parentName:\"div\",\"className\":\"g-type-long-body\"},`Note: The double quotation marks in the command are not required if\nyour CMD shell is already in the\n`,mdx(\"inlineCode\",{parentName:\"p\"},`C:\\\\Program Files\\\\Amazon\\\\EC2ConfigService\\\\`),` directory.`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ebs_optimized`),` (bool) - Mark instance as `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html\"},`EBS\nOptimized`),`.\nDefault `,mdx(\"inlineCode\",{parentName:\"p\"},`false`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`enable_nitro_enclave`),` (bool) - Enable support for Nitro Enclaves on the instance.  Note that the instance type must\nbe able to `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://aws.amazon.com/ec2/nitro/nitro-enclaves/faqs/\"},`support Nitro Enclaves`),`.\nThis option is not supported for spot instances.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`enable_t2_unlimited`),` (bool) - Deprecated argument - please use \"enable_unlimited_credits\".\nEnabling T2 Unlimited allows the source instance to burst additional CPU\nbeyond its available `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-credits-baseline-concepts.html\"},`CPU\nCredits`),`\nfor as long as the demand exists. This is in contrast to the standard\nconfiguration that only allows an instance to consume up to its\navailable CPU Credits. See the AWS documentation for `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-unlimited.html\"},`T2\nUnlimited`),`\nand the `,mdx(\"strong\",{parentName:\"p\"},`T2 Unlimited Pricing`),` section of the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://aws.amazon.com/ec2/pricing/on-demand/\"},`Amazon EC2 On-Demand\nPricing`),` document for\nmore information. By default this option is disabled and Packer will set\nup a `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/t2-std.html\"},`T2\nStandard`),`\ninstance instead.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`To use T2 Unlimited you must use a T2 instance type, e.g. `,mdx(\"inlineCode\",{parentName:\"p\"},`t2.micro`),`.\nAdditionally, T2 Unlimited cannot be used in conjunction with Spot\nInstances, e.g. when the `,mdx(\"inlineCode\",{parentName:\"p\"},`spot_price`),` option has been configured.\nAttempting to do so will cause an error.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`!`,`\u003e`,` `,mdx(\"strong\",{parentName:\"p\"},`Warning!`),` Additional costs may be incurred by enabling T2\nUnlimited - even for instances that would usually qualify for the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://aws.amazon.com/free/\"},`AWS Free Tier`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`enable_unlimited_credits`),` (bool) - Enabling Unlimited credits allows the source instance to burst additional CPU\nbeyond its available `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html#unlimited-mode-surplus-credits\"},`CPU\nCredits`),`\nfor as long as the demand exists. This is in contrast to the standard\nconfiguration that only allows an instance to consume up to its\navailable CPU Credits. See the AWS documentation for `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode-concepts.html\"},`T2\nUnlimited`),`\nand the `,mdx(\"strong\",{parentName:\"p\"},`Unlimited Pricing`),` section of the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://aws.amazon.com/ec2/pricing/on-demand/\"},`Amazon EC2 On-Demand\nPricing`),` document for\nmore information. By default this option is disabled and Packer will set\nup a `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-standard-mode.html\"},`Standard`),`\ninstance instead.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`To use Unlimited you must use a T2/T3/T3a/T4g instance type, e.g. (`,mdx(\"inlineCode\",{parentName:\"p\"},`t2.micro`),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`t3.micro`),`).\nAdditionally, Unlimited cannot be used in conjunction with Spot\nInstances for T2 type instances, e.g. when the `,mdx(\"inlineCode\",{parentName:\"p\"},`spot_price`),` option has been configured.\nAttempting to do so will cause an error if the underlying instance type is a T2 type instance.\nBy default the supported burstable instance types (including t3/t3a/t4g) will be provisioned with its cpu credits set to standard,\nonly when `,mdx(\"inlineCode\",{parentName:\"p\"},`enable_unlimited_credits`),` is true will the instance be provisioned with unlimited cpu credits.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`iam_instance_profile`),` (string) - The name of an `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/IAM/latest/UserGuide/instance-profiles.html\"},`IAM instance\nprofile`),`\nto launch the EC2 instance with.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`fleet_tags`),` (map`,`[string]`,`string) - Key/value pair tags to apply tags to the fleet that is issued.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`fleet_tag`),` ([]{key string, value string}) - Same as `,mdx(\"a\",{parentName:\"p\",\"href\":\"#fleet_tags\"},mdx(\"inlineCode\",{parentName:\"a\"},`fleet_tags`)),` but defined as a singular repeatable block\ncontaining a `,mdx(\"inlineCode\",{parentName:\"p\"},`key`),` and a `,mdx(\"inlineCode\",{parentName:\"p\"},`value`),` field. In HCL2 mode the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/hcl_templates/expressions#dynamic-blocks\"},mdx(\"inlineCode\",{parentName:\"a\"},`dynamic_block`)),`\nwill allow you to create those programatically.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`skip_profile_validation`),` (bool) - Whether or not to check if the IAM instance profile exists. Defaults to false`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`temporary_iam_instance_profile_policy_document`),` (`,`*`,`PolicyDocument) - Temporary IAM instance profile policy document\nIf IamInstanceProfile is specified it will be used instead.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`temporary_iam_instance_profile_policy_document`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`    Statement`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        Action   `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"logs:*\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        Effect   `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Allow\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        Resource `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"*\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    Version `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"2012-10-17\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`JSON example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"Version\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"2012-10-17\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"Statement\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"Action\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`            \"logs:*\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`            ]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"Effect\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Allow\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"Resource\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"*\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    ]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`shutdown_behavior`),` (string) - Automatically terminate instances on\nshutdown in case Packer exits ungracefully. Possible values are stop and\nterminate. Defaults to stop.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`security_group_filter`),` (SecurityGroupFilterOptions) - Filters used to populate the `,mdx(\"inlineCode\",{parentName:\"p\"},`security_group_ids`),` field.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`HCL2 Example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  security_group_filter`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    filters `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`      \"tag:Class\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"packer\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`JSON Example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"security_group_filter\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"filters\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"tag:Class\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"packer\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`This selects the SG's with tag `,mdx(\"inlineCode\",{parentName:\"p\"},`Class`),` with the value `,mdx(\"inlineCode\",{parentName:\"p\"},`packer`),`.`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`filters`),` (map`,`[string,string]`,` | multiple filters are allowed when seperated by commas) - filters used to select a\n`,mdx(\"inlineCode\",{parentName:\"li\"},`security_group_ids`),`. Any filter described in the docs for\n`,mdx(\"a\",{parentName:\"li\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSecurityGroups.html\"},`DescribeSecurityGroups`),`\nis valid.`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`security_group_ids`),` take precedence over this.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`run_tags`),` (map`,`[string]`,`string) - Key/value pair tags to apply to the generated key-pair, security group, iam profile and role, snapshot, network interfaces and instance\nthat is `,mdx(\"em\",{parentName:\"p\"},`launched`),` to create the EBS volumes. The resulting AMI will also inherit these tags.\nThis is a `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/legacy_json_templates/engine\"},`template\nengine`),`, see `,mdx(\"a\",{parentName:\"p\",\"href\":\"#build-template-data\"},`Build template\ndata`),` for more information.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`run_tag`),` ([]{key string, value string}) - Same as `,mdx(\"a\",{parentName:\"p\",\"href\":\"#run_tags\"},mdx(\"inlineCode\",{parentName:\"a\"},`run_tags`)),` but defined as a singular repeatable\nblock containing a `,mdx(\"inlineCode\",{parentName:\"p\"},`key`),` and a `,mdx(\"inlineCode\",{parentName:\"p\"},`value`),` field. In HCL2 mode the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/hcl_templates/expressions#dynamic-blocks\"},mdx(\"inlineCode\",{parentName:\"a\"},`dynamic_block`)),`\nwill allow you to create those programatically.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`security_group_id`),` (string) - The ID (not the name) of the security\ngroup to assign to the instance. By default this is not set and Packer will\nautomatically create a new temporary security group to allow SSH access.\nNote that if this is specified, you must be sure the security group allows\naccess to the ssh_port given below.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`security_group_ids`),` ([]string) - A list of security groups as\ndescribed above. Note that if this is specified, you must omit the\nsecurity_group_id.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`source_ami_filter`),` (AmiFilterOptions) - Filters used to populate the `,mdx(\"inlineCode\",{parentName:\"p\"},`source_ami`),`\nfield.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"basic-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  source_ami_filter`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    filters `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`       virtualization-type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"hvm\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`       name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`       root-device-type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ebs\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    owners `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"099720109477\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    most_recent `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`JSON Example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"builders\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"source_ami_filter\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`       \"filters\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`       \"virtualization-type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"hvm\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`       \"name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`       \"root-device-type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ebs\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`       }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`       \"owners\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"099720109477\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`       \"most_recent\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`  This selects the most recent Ubuntu 16.04 HVM EBS AMI from Canonical. NOTE:\nThis will fail unless `,mdx(\"em\",{parentName:\"p\"},`exactly`),` one AMI is returned. In the above example,\n`,mdx(\"inlineCode\",{parentName:\"p\"},`most_recent`),` will cause this to succeed by selecting the newest image.`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`filters`),` (map`,`[string,string]`,` | multiple filters are allowed when seperated by commas) - filters used to select a `,mdx(\"inlineCode\",{parentName:\"p\"},`source_ami`),`.\nNOTE: This will fail unless `,mdx(\"em\",{parentName:\"p\"},`exactly`),` one AMI is returned. Any filter\ndescribed in the docs for\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html\"},`DescribeImages`),`\nis valid.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`owners`),` (array of strings) - Filters the images by their owner. You\nmay specify one or more AWS account IDs, \"self\" (which will use the\naccount whose credentials you are using to run Packer), or an AWS owner\nalias: for example, `,mdx(\"inlineCode\",{parentName:\"p\"},`amazon`),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`aws-marketplace`),`, or `,mdx(\"inlineCode\",{parentName:\"p\"},`microsoft`),`. This\noption is required for security reasons.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`most_recent`),` (boolean) - Selects the newest created image when true.\nThis is most useful for selecting a daily distro build.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`You may set this in place of `,mdx(\"inlineCode\",{parentName:\"p\"},`source_ami`),` or in conjunction with it. If you\nset this in conjunction with `,mdx(\"inlineCode\",{parentName:\"p\"},`source_ami`),`, the `,mdx(\"inlineCode\",{parentName:\"p\"},`source_ami`),` will be added\nto the filter. The provided `,mdx(\"inlineCode\",{parentName:\"p\"},`source_ami`),` must meet all of the filtering\ncriteria provided in `,mdx(\"inlineCode\",{parentName:\"p\"},`source_ami_filter`),`; this pins the AMI returned by the\nfilter, but will cause Packer to fail if the `,mdx(\"inlineCode\",{parentName:\"p\"},`source_ami`),` does not exist.`)))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`spot_instance_types`),` ([]string) - a list of acceptable instance\ntypes to run your build on. We will request a spot instance using the max\nprice of spot_price and the allocation strategy of \"lowest price\".\nYour instance will be launched on an instance type of the lowest available\nprice that you have in your list.  This is used in place of instance_type.\nYou may only set either spot_instance_types or instance_type, not both.\nThis feature exists to help prevent situations where a Packer build fails\nbecause a particular availability zone does not have capacity for the\nspecific instance_type requested in instance_type.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`spot_price`),` (string) - With Spot Instances, you pay the Spot price that's in effect for the\ntime period your instances are running. Spot Instance prices are set by\nAmazon EC2 and adjust gradually based on long-term trends in supply and\ndemand for Spot Instance capacity.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`When this field is set, it represents the maximum hourly price you are\nwilling to pay for a spot instance. If you do not set this value, it\ndefaults to a maximum price equal to the on demand price of the\ninstance. In the situation where the current Amazon-set spot price\nexceeds the value set in this field, Packer will not launch an instance\nand the build will error. In the situation where the Amazon-set spot\nprice is less than the value set in this field, Packer will launch and\nyou will pay the Amazon-set spot price, not this maximum value.\nFor more information, see the Amazon docs on\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://aws.amazon.com/ec2/spot/pricing/\"},`spot pricing`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`spot_tags`),` (map`,`[string]`,`string) - Requires spot_price to be set. Key/value pair tags to apply tags to the\nspot request that is issued.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`spot_tag`),` ([]{key string, value string}) - Same as `,mdx(\"a\",{parentName:\"p\",\"href\":\"#spot_tags\"},mdx(\"inlineCode\",{parentName:\"a\"},`spot_tags`)),` but defined as a singular repeatable block\ncontaining a `,mdx(\"inlineCode\",{parentName:\"p\"},`key`),` and a `,mdx(\"inlineCode\",{parentName:\"p\"},`value`),` field. In HCL2 mode the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/hcl_templates/expressions#dynamic-blocks\"},mdx(\"inlineCode\",{parentName:\"a\"},`dynamic_block`)),`\nwill allow you to create those programatically.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`subnet_filter`),` (SubnetFilterOptions) - Filters used to populate the `,mdx(\"inlineCode\",{parentName:\"p\"},`subnet_id`),` field.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"basic-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  subnet_filter`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    filters `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`          \"tag:Class\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"build\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    most_free `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    random `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`JSON Example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"builders\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"subnet_filter\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"filters\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"tag:Class\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"build\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"most_free\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"random\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`  This selects the Subnet with tag `,mdx(\"inlineCode\",{parentName:\"p\"},`Class`),` with the value `,mdx(\"inlineCode\",{parentName:\"p\"},`build`),`, which has\nthe most free IP addresses. NOTE: This will fail unless `,mdx(\"em\",{parentName:\"p\"},`exactly`),` one\nSubnet is returned. By using `,mdx(\"inlineCode\",{parentName:\"p\"},`most_free`),` or `,mdx(\"inlineCode\",{parentName:\"p\"},`random`),` one will be selected\nfrom those matching the filter.`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`filters`),` (map`,`[string,string]`,` | multiple filters are allowed when seperated by commas) - filters used to select a `,mdx(\"inlineCode\",{parentName:\"p\"},`subnet_id`),`.\nNOTE: This will fail unless `,mdx(\"em\",{parentName:\"p\"},`exactly`),` one Subnet is returned. Any\nfilter described in the docs for\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeSubnets.html\"},`DescribeSubnets`),`\nis valid.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`most_free`),` (boolean) - The Subnet with the most free IPv4 addresses\nwill be used if multiple Subnets matches the filter.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`random`),` (boolean) - A random Subnet will be used if multiple Subnets\nmatches the filter. `,mdx(\"inlineCode\",{parentName:\"p\"},`most_free`),` have precendence over this.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`subnet_id`),` take precedence over this.`)))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`subnet_id`),` (string) - If using VPC, the ID of the subnet, such as\nsubnet-12345def, where Packer will launch the EC2 instance. This field is\nrequired if you are using an non-default VPC.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`license_specifications`),` ([]LicenseSpecification) - The license configurations.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"basic-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  license_specifications`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    license_configuration_request `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      license_configuration_arn `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`var`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`license_configuration_arn`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`JSON example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"builders\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"license_specifications\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"license_configuration_request\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"license_configuration_arn\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{user \\`license_configuration_arn\\`}}\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    ]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`  Each `,mdx(\"inlineCode\",{parentName:\"p\"},`license_configuration_request`),` describes a license configuration,\nthe properties of which are:`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`license_configuration_arn`),` (string) - The Amazon Resource Name (ARN)\nof the license configuration.`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`placement`),` (Placement) - Describes the placement of an instance.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"basic-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  placement `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    host_resource_group_arn `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`var`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`host_resource_group_arn`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    tenancy                 `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`var`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`placement_tenancy`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`JSON example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"builders\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"placement\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"host_resource_group_arn\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{user \\`host_resource_group_arn\\`}}\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"tenancy\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{user \\`placement_tenancy\\`}}\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`)),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`host_resource_group_arn`),` (string) - The ARN of the host resource\ngroup in which to launch the instances. If you specify a host\nresource group ARN, omit the Tenancy parameter or set it to `,mdx(\"inlineCode\",{parentName:\"li\"},`host`),`.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`tenancy`),` (string) - The tenancy of the instance (if the instance is\nrunning in a VPC). An instance with a tenancy of `,mdx(\"inlineCode\",{parentName:\"li\"},`dedicated`),` runs on\nsingle-tenant hardware. The default is `,mdx(\"inlineCode\",{parentName:\"li\"},`default`),`, meaning shared\ntenancy. Allowed values are `,mdx(\"inlineCode\",{parentName:\"li\"},`default`),`, `,mdx(\"inlineCode\",{parentName:\"li\"},`dedicated`),` and `,mdx(\"inlineCode\",{parentName:\"li\"},`host`),`.`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`tenancy`),` (string) - Deprecated: Use Placement Tenancy instead.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`temporary_security_group_source_cidrs`),` ([]string) - A list of IPv4 CIDR blocks to be authorized access to the instance, when\npacker is creating a temporary security group.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`The default is `,`[`,mdx(\"inlineCode\",{parentName:\"p\"},`0.0.0.0/0`),`]`,` (i.e., allow any IPv4 source).\nUse `,mdx(\"inlineCode\",{parentName:\"p\"},`temporary_security_group_source_public_ip`),` to allow current host's\npublic IP instead of any IPv4 source.\nThis is only used when `,mdx(\"inlineCode\",{parentName:\"p\"},`security_group_id`),` or `,mdx(\"inlineCode\",{parentName:\"p\"},`security_group_ids`),` is not\nspecified.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`temporary_security_group_source_public_ip`),` (bool) - When enabled, use public IP of the host (obtained from `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://checkip.amazonaws.com\"},`https://checkip.amazonaws.com`),`)\nas CIDR block to be authorized access to the instance, when packer\nis creating a temporary security group. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`false`),`.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`This is only used when `,mdx(\"inlineCode\",{parentName:\"p\"},`security_group_id`),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`security_group_ids`),`,\nand `,mdx(\"inlineCode\",{parentName:\"p\"},`temporary_security_group_source_cidrs`),` are not specified.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`user_data`),` (string) - User data to apply when launching the instance. Note\nthat you need to be careful about escaping characters due to the templates\nbeing JSON. It is often more convenient to use user_data_file, instead.\nPacker will not automatically wait for a user script to finish before\nshutting down the instance this must be handled in a provisioner.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`user_data_file`),` (string) - Path to a file that will be used for the user\ndata when launching the instance.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`vpc_filter`),` (VpcFilterOptions) - Filters used to populate the `,mdx(\"inlineCode\",{parentName:\"p\"},`vpc_id`),` field.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"basic-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  vpc_filter`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    filters `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`      \"tag:Class\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"build\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`      \"isDefault\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"false\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`      \"cidr\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/24\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`JSON Example:`),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"builders\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"vpc_filter\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"filters\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"tag:Class\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"build\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"isDefault\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"false\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"cidr\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/24\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`This selects the VPC with tag `,mdx(\"inlineCode\",{parentName:\"p\"},`Class`),` with the value `,mdx(\"inlineCode\",{parentName:\"p\"},`build`),`, which is not\nthe default VPC, and have a IPv4 CIDR block of `,mdx(\"inlineCode\",{parentName:\"p\"},`/24`),`. NOTE: This will fail\nunless `,mdx(\"em\",{parentName:\"p\"},`exactly`),` one VPC is returned.`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`filters`),` (map`,`[string,string]`,` | multiple filters are allowed when seperated by commas) - filters used to select a `,mdx(\"inlineCode\",{parentName:\"li\"},`vpc_id`),`. NOTE:\nThis will fail unless `,mdx(\"em\",{parentName:\"li\"},`exactly`),` one VPC is returned. Any filter\ndescribed in the docs for\n`,mdx(\"a\",{parentName:\"li\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeVpcs.html\"},`DescribeVpcs`),`\nis valid.`)),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`vpc_id`),` take precedence over this.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`vpc_id`),` (string) - If launching into a VPC subnet, Packer needs the VPC ID\nin order to create a temporary security group within the VPC. Requires\nsubnet_id to be set. If this field is left blank, Packer will try to get\nthe VPC ID from the subnet_id.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`windows_password_timeout`),` (duration string | ex: \"1h5m2s\") - The timeout for waiting for a Windows\npassword for Windows instances. Defaults to 20 minutes. Example value:\n10m`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`metadata_options`),` (MetadataOptions) - `,mdx(\"a\",{parentName:\"p\",\"href\":\"#metadata-settings\"},`Metadata Settings`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_interface`),` (string) - One of `,mdx(\"inlineCode\",{parentName:\"p\"},`public_ip`),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`private_ip`),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`public_dns`),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`private_dns`),` or `,mdx(\"inlineCode\",{parentName:\"p\"},`session_manager`),`.\nIf set, either the public IP address, private IP address, public DNS name\nor private DNS name will be used as the host for SSH. The default behaviour\nif inside a VPC is to use the public IP address if available, otherwise\nthe private IP address will be used. If not in a VPC the public DNS name\nwill be used. Also works for WinRM.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`   Where Packer is configured for an outbound proxy but WinRM traffic\nshould be direct, `,mdx(\"inlineCode\",{parentName:\"p\"},`ssh_interface`),` must be set to `,mdx(\"inlineCode\",{parentName:\"p\"},`private_dns`),` and\n`,mdx(\"inlineCode\",{parentName:\"p\"},`\u003cregion\u003e.compute.internal`),` included in the `,mdx(\"inlineCode\",{parentName:\"p\"},`NO_PROXY`),` environment\nvariable.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`   When using `,mdx(\"inlineCode\",{parentName:\"p\"},`session_manager`),` the machine running Packer must have\nthe AWS Session Manager Plugin installed and within the users' system path.\nConnectivity via the `,mdx(\"inlineCode\",{parentName:\"p\"},`session_manager`),` interface establishes a secure tunnel\nbetween the local host and the remote host on an available local port to the specified `,mdx(\"inlineCode\",{parentName:\"p\"},`ssh_port`),`.\nSee `,mdx(\"a\",{parentName:\"p\",\"href\":\"#session-manager-connections\"},`Session Manager Connections`),` for more information.`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},`Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM communicator.`),mdx(\"li\",{parentName:\"ul\"},`Upon termination the secure tunnel will be terminated automatically, if however there is a failure in\nterminating the tunnel it will automatically terminate itself after 20 minutes of inactivity.`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`pause_before_ssm`),` (duration string | ex: \"1h5m2s\") - The time to wait before establishing the Session Manager session.\nThe value of this should be a duration. Examples are\n`,mdx(\"inlineCode\",{parentName:\"p\"},`5s`),` and `,mdx(\"inlineCode\",{parentName:\"p\"},`1m30s`),` which will cause Packer to wait five seconds and one\nminute 30 seconds, respectively. If no set, defaults to 10 seconds.\nThis option is useful when the remote port takes longer to become available.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`session_manager_port`),` (int) - Which port to connect the local end of the session tunnel to. If\nleft blank, Packer will choose a port for you from available ports.\nThis option is only used when `,mdx(\"inlineCode\",{parentName:\"p\"},`ssh_interface`),` is set `,mdx(\"inlineCode\",{parentName:\"p\"},`session_manager`),`.`))),mdx(\"h4\",{\"id\":\"user-content-metadata-settings\",\"data-text-content\":\"Metadata Settings\",\"className\":\"g-type-display-5\"},`Metadata Settings`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Configures the metadata options.\nSee `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html\"},`Configure IMDS`),` for details.`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`http_endpoint`),` (string) - A string to enable or disable the IMDS endpoint for an instance. Defaults to enabled.\nAccepts either \"enabled\" or \"disabled\"`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`http_tokens`),` (string) - A string to either set the use of IMDSv2 for the instance to optional or required. Defaults to \"optional\".\nAccepts either \"optional\" or \"required\"`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`http_put_response_hop_limit`),` (int64) - A numerical value to set an upper limit for the amount of hops allowed when communicating with IMDS endpoints.\nDefaults to 1.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`instance_metadata_tags`),` (string) - A string to enable or disable access to instance tags from the instance metadata. Defaults to disabled.\nAccess to instance metadata tags is available for commercial regions. For non-commercial regions please check availability before enabling.\nAccepts either \"enabled\" or \"disabled\"`))),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Usage Example`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`HCL2`)),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"basic-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  region        `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`  \"us-east-1\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  source_ami    `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`  \"ami-fce3c696\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  instance_type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`  \"t2.micro\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ssh_username  `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`  \"ubuntu\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ami_name      `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`  \"packer_AWS_example_{{timestamp}}\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  metadata_options`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    http_endpoint `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"enabled\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    http_tokens `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"required\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    http_put_response_hop_limit `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 1`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`JSON`)),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"variables\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"aws_access_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{env \\`AWS_ACCESS_KEY_ID\\`}}\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"aws_secret_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{env \\`AWS_SECRET_ACCESS_KEY\\`}}\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"builders\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"access_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{user \\`aws_access_key\\`}}\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"secret_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{user \\`aws_secret_key\\`}}\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"region\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"us-east-1\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"source_ami\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ami-fce3c696\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"instance_type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"t2.micro\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"ssh_username\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"ami_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"packer_AWS {{timestamp}}\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"metadata_options\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"http_endpoint\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"enabled\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"http_tokens\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"required\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"http_put_response_hop_limit\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 1`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"h3\",{\"id\":\"user-content-session-manager-connections\",\"data-text-content\":\"Session Manager Connections\",\"className\":\"g-type-display-4\"},`Session Manager Connections`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Support for the AWS Systems Manager session manager lets users manage EC2 instances without the need to open inbound ports, or maintain bastion hosts. Session manager connectivity relies on the use of the `,mdx(\"a\",{parentName:\"p\",\"href\":\"#session-manager-plugin\"},`session manager plugin`),` to open a secure tunnel between the local machine and the remote instance. Once the tunnel has been created all SSH communication will be tunneled through SSM to the remote instance.`),mdx(\"div\",{\"className\":\"alert alert-info g-type-body\"},mdx(\"p\",{parentName:\"div\",\"className\":\"g-type-long-body\"},`Note: Session manager connectivity is currently only implemented for the SSH communicator, not the WinRM Communicator.`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`To use the session manager as the connection interface for the SSH communicator you need to add the following configuration options to the Amazon builder options:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`ssh_interface`),`: The ssh interface must be set to \"session_manager\". When using this option the builder will create an SSM tunnel to the configured `,mdx(\"inlineCode\",{parentName:\"li\"},`ssh_port`),` (defaults to 22) on the remote host.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`iam_instance_profile`),`: A valid instance profile granting Systems Manager permissions to manage the remote instance is required in order for the aws ssm-agent to start and stop session connections.\nSee below for more details on `,mdx(\"a\",{parentName:\"li\",\"href\":\"#iam-instance-profile-for-systems-manager\"},`IAM instance profile for Systems Manager`),`.`)),mdx(\"h4\",{\"id\":\"user-content-optional\",\"data-text-content\":\"Optional\",\"className\":\"g-type-display-5\"},`Optional`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`session_manager_port`),`: A local port on the host machine that should be used as the local end of the session tunnel to the remote host. If not specified Packer will find an available port to use.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`temporary_iam_instance_profile_policy_document`),`: Creates a temporary instance profile policy document to grant Systems Manager permissions to the Ec2 instance. This is an alternative to using an existing `,mdx(\"inlineCode\",{parentName:\"li\"},`iam_instance_profile`),`.`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`HCL2 example:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# file: example.pkr.hcl`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# In order to get these variables to read from the environment,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# set the environment variables to have the same name as the declared`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# variables, with the prefix PKR_VAR_.`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# You could also hardcode them into the file, but we do not recommend that.`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`data`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ami\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  filters `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    virtualization-type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"hvm\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    name                `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    root-device-type    `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ebs\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  owners      `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"099720109477\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  most_recent `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  region      `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"us-east-1\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"ssm-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ami_name             `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"packer_AWS {{timestamp}}\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  instance_type        `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"t2.micro\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  region               `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"us-east-1\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  source_ami           `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` data.amazon-ami.example.id`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ssh_username         `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ssh_interface        `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"session_manager\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  communicator         `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ssh\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  iam_instance_profile `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"myinstanceprofile\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  sources `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"source.amazon-ebs.ssm-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  provisioner`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"shell\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    inline `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"echo Connected via SSM at '`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`User`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`@`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`Host`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`Port`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`'\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`JSON example:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"builders\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"ami_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"packer-ami-{{timestamp}}\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"instance_type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"t2.micro\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"source_ami_filter\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"filters\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"virtualization-type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"hvm\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"root-device-type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ebs\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"owners\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"099720109477\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`        \"most_recent\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"ssh_username\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"ssh_interface\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"session_manager\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"communicator\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ssh\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"iam_instance_profile\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{user \\`iam_instance_profile\\`}}\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"provisioners\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"shell\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"inline\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`        \"echo Connected via SSM at '{{build \\`User\\`}}@{{build \\`Host\\`}}:{{build \\`Port\\`}}'\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      ]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"h4\",{\"id\":\"user-content-session-manager-plugin\",\"data-text-content\":\"Session Manager Plugin\",\"className\":\"g-type-display-5\"},`Session Manager Plugin`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Connectivity via the session manager requires the use of a session-manger-plugin, which needs to be installed alongside Packer, and an instance AMI that is capable of running the AWS ssm-agent - see `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/systems-manager/latest/userguide/prereqs-ssm-agent.html\"},`About SSM Agent`),` for details on supported AMIs.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`In order for Packer to start and end sessions that connect you to your managed instances, you must first install the Session Manager plugin on your local machine. The plugin can be installed on supported versions of Microsoft Windows, macOS, Linux, and Ubuntu Server.\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html\"},`Installation instructions for the session-manager-plugin`)),mdx(\"h4\",{\"id\":\"user-content-iam-instance-profile-for-systems-manager\",\"data-text-content\":\"IAM instance profile for Systems Manager\",\"className\":\"g-type-display-5\"},`IAM instance profile for Systems Manager`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`By default Systems Manager doesn't have permission to perform actions on created instances so SSM access must be granted by creating an instance profile with the `,mdx(\"inlineCode\",{parentName:\"p\"},`AmazonSSMManagedInstanceCore`),` policy. The instance profile can then be attached to any instance you wish to manage via the session-manager-plugin. See `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html#instance-profile-add-permissions\"},`Adding System Manager instance profile`),` for details on creating the required instance profile.`),mdx(\"h4\",{\"id\":\"user-content-permissions-for-closing-the-tunnel\",\"data-text-content\":\"Permissions for Closing the Tunnel\",\"className\":\"g-type-display-5\"},`Permissions for Closing the Tunnel`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`To close the SSM tunnels created, this plugin relies on being able to call\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstanceStatus.html\"},`DescribeInstanceStatus`),`.\nIn case this is not possible you might see a `,mdx(\"inlineCode\",{parentName:\"p\"},`Bad exit status`),` message in the logs.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The absence of this permission won't prevent you from building the AMI, and the error only means that packer is not able to close the tunnel gracefully.`),mdx(\"h3\",{\"id\":\"user-content-communicator-configuration\",\"data-text-content\":\"Communicator Configuration\",\"className\":\"g-type-display-4\"},`Communicator Configuration`),mdx(\"h4\",{\"id\":\"user-content-optional:\",\"data-text-content\":\"Optional\",\"className\":\"g-type-display-5\"},`Optional:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`communicator`),` (string) - Packer currently supports three kinds of communicators:`),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`none`),` - No communicator will be used. If this is set, most\nprovisioners also can't be used.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh`),` - An SSH connection will be established to the machine. This\nis usually the default.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`winrm`),` - A WinRM connection will be established.`))),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`In addition to the above, some builders have custom communicators they\ncan use. For example, the Docker builder has a \"docker\" communicator\nthat uses `,mdx(\"inlineCode\",{parentName:\"p\"},`docker exec`),` and `,mdx(\"inlineCode\",{parentName:\"p\"},`docker cp`),` to execute scripts and copy\nfiles.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`pause_before_connecting`),` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\nguest's bootstrap script, but sometimes you may have a race condition\nwhere you need Packer to wait before attempting to connect to your\nguest.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`If you end up in this situation, you can use the template option\n`,mdx(\"inlineCode\",{parentName:\"p\"},`pause_before_connecting`),`. By default, there is no pause. For example if\nyou set `,mdx(\"inlineCode\",{parentName:\"p\"},`pause_before_connecting`),` to `,mdx(\"inlineCode\",{parentName:\"p\"},`10m`),` Packer will check whether it\ncan connect, as normal. But once a connection attempt is successful, it\nwill disconnect and then wait 10 minutes before connecting to the guest\nand beginning provisioning.`))),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_host`),` (string) - The address to SSH to. This usually is automatically configured by the\nbuilder.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_port`),` (int) - The port to connect to SSH. This defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`22`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_username`),` (string) - The username to connect to SSH with. Required if using SSH.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_password`),` (string) - A plaintext password to use to authenticate with SSH.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_ciphers`),` ([]string) - This overrides the value of ciphers supported by default by Golang.\nThe default value is `,`[\n\"aes128-gcm@openssh.com\",\n\"chacha20-poly1305@openssh.com\",\n\"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n]`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Valid options for ciphers include:\n\"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"`,mdx(\"a\",{parentName:\"p\",\"href\":\"mailto:aes128-gcm@openssh.com\"},`aes128-gcm@openssh.com`),`\",\n\"`,mdx(\"a\",{parentName:\"p\",\"href\":\"mailto:chacha20-poly1305@openssh.com\"},`chacha20-poly1305@openssh.com`),`\",\n\"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_clear_authorized_keys`),` (bool) - If true, Packer will attempt to remove its temporary key from\n`,mdx(\"inlineCode\",{parentName:\"p\"},`~/.ssh/authorized_keys`),` and `,mdx(\"inlineCode\",{parentName:\"p\"},`/root/.ssh/authorized_keys`),`. This is a\nmostly cosmetic option, since Packer will delete the temporary private\nkey from the host system regardless of whether this is set to true\n(unless the user has set the `,mdx(\"inlineCode\",{parentName:\"p\"},`-debug`),` flag). Defaults to \"false\";\ncurrently only works on guests with `,mdx(\"inlineCode\",{parentName:\"p\"},`sed`),` installed.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_key_exchange_algorithms`),` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\nsupported by default by Golang. Acceptable values include:\n\"`,mdx(\"a\",{parentName:\"p\",\"href\":\"mailto:curve25519-sha256@libssh.org\"},`curve25519-sha256@libssh.org`),`\", \"ecdh-sha2-nistp256\",\n\"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n\"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_certificate_file`),` (string) - Path to user certificate used to authenticate with SSH.\nThe `,mdx(\"inlineCode\",{parentName:\"p\"},`~`),` can be used in path and will be expanded to the\nhome directory of current user.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_pty`),` (bool) - If `,mdx(\"inlineCode\",{parentName:\"p\"},`true`),`, a PTY will be requested for the SSH connection. This defaults\nto `,mdx(\"inlineCode\",{parentName:\"p\"},`false`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_timeout`),` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\ndetermine when the machine has booted so this is usually quite long.\nExample value: `,mdx(\"inlineCode\",{parentName:\"p\"},`10m`),`.\nThis defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`5m`),`, unless `,mdx(\"inlineCode\",{parentName:\"p\"},`ssh_handshake_attempts`),` is set.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_disable_agent_forwarding`),` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`false`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_handshake_attempts`),` (int) - The number of handshakes to attempt with SSH once it can connect.\nThis defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`10`),`, unless a `,mdx(\"inlineCode\",{parentName:\"p\"},`ssh_timeout`),` is set.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_bastion_host`),` (string) - A bastion host to use for the actual SSH connection.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_bastion_port`),` (int) - The port of the bastion host. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`22`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_bastion_agent_auth`),` (bool) - If `,mdx(\"inlineCode\",{parentName:\"p\"},`true`),`, the local SSH agent will be used to authenticate with the\nbastion host. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`false`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_bastion_username`),` (string) - The username to connect to the bastion host.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_bastion_password`),` (string) - The password to use to authenticate with the bastion host.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_bastion_interactive`),` (bool) - If `,mdx(\"inlineCode\",{parentName:\"p\"},`true`),`, the keyboard-interactive used to authenticate with bastion host.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_bastion_private_key_file`),` (string) - Path to a PEM encoded private key file to use to authenticate with the\nbastion host. The `,mdx(\"inlineCode\",{parentName:\"p\"},`~`),` can be used in path and will be expanded to the\nhome directory of current user.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_bastion_certificate_file`),` (string) - Path to user certificate used to authenticate with bastion host.\nThe `,mdx(\"inlineCode\",{parentName:\"p\"},`~`),` can be used in path and will be expanded to the\nhome directory of current user.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_file_transfer_method`),` (string) - `,mdx(\"inlineCode\",{parentName:\"p\"},`scp`),` or `,mdx(\"inlineCode\",{parentName:\"p\"},`sftp`),` - How to transfer files, Secure copy (default) or SSH\nFile Transfer Protocol.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`NOTE`),`: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n(the default protocol for copying data) returns a a non-zero error code since the MOTW\ncannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\nwith SFTP instead `,mdx(\"inlineCode\",{parentName:\"p\"},`ssh_file_transfer_protocol = \"sftp\"`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_proxy_host`),` (string) - A SOCKS proxy host to use for SSH connection`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_proxy_port`),` (int) - A port of the SOCKS proxy. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`1080`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_proxy_username`),` (string) - The optional username to authenticate with the proxy server.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_proxy_password`),` (string) - The optional password to use to authenticate with the proxy server.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_keep_alive_interval`),` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\nvalue (`,mdx(\"inlineCode\",{parentName:\"p\"},`-1s`),`) to disable. Example value: `,mdx(\"inlineCode\",{parentName:\"p\"},`10s`),`. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},`5s`),`.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_read_write_timeout`),` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\nuseful if, for example, packer hangs on a connection after a reboot.\nExample: `,mdx(\"inlineCode\",{parentName:\"p\"},`5m`),`. Disabled by default.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_remote_tunnels`),` ([]string) - `)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`ssh_local_tunnels`),` ([]string) - `))),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`temporary_key_pair_type`),` (string) - `,mdx(\"inlineCode\",{parentName:\"p\"},`dsa`),` | `,mdx(\"inlineCode\",{parentName:\"p\"},`ecdsa`),` | `,mdx(\"inlineCode\",{parentName:\"p\"},`ed25519`),` | `,mdx(\"inlineCode\",{parentName:\"p\"},`rsa`),` ( the default )`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`Specifies the type of key to create. The possible values are 'dsa',\n'ecdsa', 'ed25519', or 'rsa'.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`NOTE: DSA is deprecated and no longer recognized as secure, please\nconsider other alternatives like RSA or ED25519.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},mdx(\"inlineCode\",{parentName:\"p\"},`temporary_key_pair_bits`),` (int) - Specifies the number of bits in the key to create. For RSA keys, the\nminimum size is 1024 bits and the default is 4096 bits. Generally, 3072\nbits is considered sufficient. DSA keys must be exactly 1024 bits as\nspecified by FIPS 186-2. For ECDSA keys, bits determines the key length\nby selecting from one of three elliptic curve sizes: 256, 384 or 521\nbits. Attempting to use bit lengths other than these three values for\nECDSA keys will fail. Ed25519 keys have a fixed length and bits will be\nignored.`),mdx(\"p\",{parentName:\"li\",\"className\":\"g-type-long-body\"},`NOTE: DSA is deprecated and no longer recognized as secure as specified\nby FIPS 186-5, please consider other alternatives like RSA or ED25519.`))),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`ssh_keypair_name`),` (string) - If specified, this is the key that will be used for SSH with the\nmachine. The key must match a key pair name loaded up into the remote.\nBy default, this is blank, and Packer will generate a temporary keypair\nunless `,mdx(\"a\",{parentName:\"li\",\"href\":\"#ssh_password\"},mdx(\"inlineCode\",{parentName:\"a\"},`ssh_password`)),` is used.\n`,mdx(\"a\",{parentName:\"li\",\"href\":\"#ssh_private_key_file\"},mdx(\"inlineCode\",{parentName:\"a\"},`ssh_private_key_file`)),` or\n`,mdx(\"a\",{parentName:\"li\",\"href\":\"#ssh_agent_auth\"},mdx(\"inlineCode\",{parentName:\"a\"},`ssh_agent_auth`)),` must be specified when\n`,mdx(\"a\",{parentName:\"li\",\"href\":\"#ssh_keypair_name\"},mdx(\"inlineCode\",{parentName:\"a\"},`ssh_keypair_name`)),` is utilized.`)),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`ssh_private_key_file`),` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\nThe `,mdx(\"inlineCode\",{parentName:\"li\"},`~`),` can be used in path and will be expanded to the home directory\nof current user.`)),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`ssh_agent_auth`),` (bool) - If true, the local SSH agent will be used to authenticate connections to\nthe source instance. No temporary keypair will be created, and the\nvalues of `,mdx(\"a\",{parentName:\"li\",\"href\":\"#ssh_password\"},mdx(\"inlineCode\",{parentName:\"a\"},`ssh_password`)),` and\n`,mdx(\"a\",{parentName:\"li\",\"href\":\"#ssh_private_key_file\"},mdx(\"inlineCode\",{parentName:\"a\"},`ssh_private_key_file`)),` will be ignored. The\nenvironment variable `,mdx(\"inlineCode\",{parentName:\"li\"},`SSH_AUTH_SOCK`),` must be set for this option to work\nproperly.`)),mdx(\"h2\",{\"id\":\"user-content-basic-example\",\"data-text-content\":\"Basic Example\",\"className\":\"g-type-display-3\"},`Basic Example`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`HCL2`)),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`source`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"amazon-ebsvolume\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"basic-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  region `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"us-east-1\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ssh_username `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  instance_type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"t2.medium\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  source_ami `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ami-40d28157\"`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  ebs_volumes`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      volume_type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"gp2\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      device_name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/dev/xvdf\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      delete_on_termination `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      tags `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        zpool `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"data\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        Name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Data1\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      volume_size `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 10`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  ebs_volumes`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      volume_type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"gp2\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      device_name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/dev/xvdg\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      tags `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        zpool `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"data\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        Name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Data2\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      delete_on_termination `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      volume_size `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 10`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`  ebs_volumes`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      volume_size `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 10`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      tags `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        zpool `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"data\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        Name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Data3\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      delete_on_termination `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      device_name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/dev/xvdh\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      volume_type `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"gp2\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  sources `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"sources.amazon-ebsvolume.basic-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`JSON`)),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"builders\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"amazon-ebsvolume\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"region\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"us-east-1\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"ssh_username\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ubuntu\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"instance_type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"t2.medium\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"source_ami\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"ami-40d28157\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"ebs_volumes\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"volume_type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"gp2\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"device_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/dev/xvdf\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"delete_on_termination\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"tags\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"zpool\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"data\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"Name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Data1\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`          }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"volume_size\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 10`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"volume_type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"gp2\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"device_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/dev/xvdg\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"tags\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"zpool\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"data\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"Name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Data2\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`          }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"delete_on_termination\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"volume_size\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 10`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"volume_size\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 10`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"tags\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"Name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Data3\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`            \"zpool\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"data\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`          }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"delete_on_termination\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"device_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/dev/xvdh\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"volume_type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"gp2\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      ]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ]`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"div\",{\"className\":\"alert alert-info g-type-body\"},mdx(\"p\",{parentName:\"div\",\"className\":\"g-type-long-body\"},``,mdx(\"strong\",{parentName:\"p\"},`Note:`),` Packer can also read the access key and secret access key from\nenvironmental variables. See the configuration reference in the section above\nfor more information on what environmental variables Packer will look for.`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Further information on locating AMI IDs and their relationship to instance\ntypes and regions can be found in the AWS EC2 Documentation `,mdx(\"a\",{parentName:\"p\",\"href\":\"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/finding-an-ami.html\"},`for\nLinux`),`\nor `,mdx(\"a\",{parentName:\"p\",\"href\":\"http://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/finding-an-ami.html\"},`for\nWindows`),`.`),mdx(\"h2\",{\"id\":\"user-content-accessing-the-instance-to-debug\",\"data-text-content\":\"Accessing the Instance to Debug\",\"className\":\"g-type-display-3\"},`Accessing the Instance to Debug`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`If you need to access the instance to debug for some reason, run the builder\nwith the `,mdx(\"inlineCode\",{parentName:\"p\"},`-debug`),` flag. In debug mode, the Amazon builder will save the private\nkey in the current directory and will output the DNS or IP information as well.\nYou can use this information to access the instance as it is running.`),mdx(\"h2\",{\"id\":\"user-content-build-template-data\",\"data-text-content\":\"Build template data\",\"className\":\"g-type-display-3\"},`Build template data`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`In configuration directives marked as a template engine above, the following\nvariables are available:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`BuildRegion`),` - The region (for example `,mdx(\"inlineCode\",{parentName:\"li\"},`eu-central-1`),`) where Packer is\nbuilding the AMI.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMI`),` - The source AMI ID (for example `,mdx(\"inlineCode\",{parentName:\"li\"},`ami-a2412fcd`),`) used to build\nthe AMI.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMICreationDate`),` - The source AMI creation date (for example `,mdx(\"inlineCode\",{parentName:\"li\"},`\"2020-05-14T19:26:34.000Z\"`),`).`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMIName`),` - The source AMI Name (for example\n`,mdx(\"inlineCode\",{parentName:\"li\"},`ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`),`) used to\nbuild the AMI.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMIOwner`),` - The source AMI owner ID.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMIOwnerName`),` - The source AMI owner alias/name (for example `,mdx(\"inlineCode\",{parentName:\"li\"},`amazon`),`).`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMITags`),` - The source AMI Tags, as a `,mdx(\"inlineCode\",{parentName:\"li\"},`map[string]string`),` object.`)),mdx(\"h2\",{\"id\":\"user-content-build-shared-information-variables\",\"data-text-content\":\"Build Shared Information Variables\",\"className\":\"g-type-display-3\"},`Build Shared Information Variables`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This builder generates data that are shared with provisioner and post-processor via build function of `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/legacy_json_templates/engine\"},`template engine`),` for JSON and `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/hcl_templates/contextual-variables\"},`contextual variables`),` for HCL2.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The generated variables available for this builder are:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`BuildRegion`),` - The region (for example `,mdx(\"inlineCode\",{parentName:\"li\"},`eu-central-1`),`) where Packer is\nbuilding the AMI.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMI`),` - The source AMI ID (for example `,mdx(\"inlineCode\",{parentName:\"li\"},`ami-a2412fcd`),`) used to build\nthe AMI.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMICreationDate`),` - The source AMI creation date (for example `,mdx(\"inlineCode\",{parentName:\"li\"},`\"2020-05-14T19:26:34.000Z\"`),`).`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMIName`),` - The source AMI Name (for example\n`,mdx(\"inlineCode\",{parentName:\"li\"},`ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`),`) used to\nbuild the AMI.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMIOwner`),` - The source AMI owner ID.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMIOwnerName`),` - The source AMI owner alias/name (for example `,mdx(\"inlineCode\",{parentName:\"li\"},`amazon`),`).`)),mdx(\"div\",{\"className\":\"alert alert-info g-type-body\"},mdx(\"p\",{parentName:\"div\",\"className\":\"g-type-long-body\"},``,mdx(\"strong\",{parentName:\"p\"},`Note:`),` Packer uses pre-built AMIs as the source for building images.\nThese source AMIs may include volumes that are not flagged to be destroyed on\ntermination of the instance building the new image. In addition to those\nvolumes created by this builder, any volumes in the source AMI which are not\nmarked for deletion on termination will remain in your account.`)),mdx(\"h2\",{\"id\":\"user-content-build-shared-information-variables\",\"data-text-content\":\"Build Shared Information Variables\",\"className\":\"g-type-display-3\"},`Build Shared Information Variables`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This builder generates data that are shared with provisioner and post-processor via build function of `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/legacy_json_templates/engine\"},`template engine`),` for JSON and `,mdx(\"a\",{parentName:\"p\",\"href\":\"/packer/docs/templates/hcl_templates/contextual-variables\"},`contextual variables`),` for HCL2.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The generated variables available for this builder are:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`SourceAMIName`),` - The source AMI Name (for example\n`,mdx(\"inlineCode\",{parentName:\"li\"},`ubuntu/images/ebs-ssd/ubuntu-xenial-16.04-amd64-server-20180306`),`) used to\nbuild the AMI.`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`Usage example:`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`HCL2`)),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`// When accessing one of these variables from inside the builder, you need to`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`// use the golang templating syntax. This is due to an architectural quirk that`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`// won't be easily resolvable until legacy json templates are deprecated:`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`source `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"amazon-ebs\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"basic-example\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  tags `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        OS_Version `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Ubuntu\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        Release `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Latest\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        Base_AMI_ID `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{ .SourceAMI }}\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        Base_AMI_Name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{ .SourceAMIName }}\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`// when accessing one of the variables from a provisioner or post-processor, use`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`// hcl-syntax`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`post`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`-`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`processor `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"manifest\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    output `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"manifest.json\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    strip_path `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    custom_data `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        source_ami_name `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`\\${`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`build`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`.`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`SourceAMIName`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`}`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"strong\",{parentName:\"p\"},`JSON`)),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"post-processors\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`: [`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"type\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"manifest\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"output\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"manifest.json\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"strip_path\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` true`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"custom_data\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"source_ami_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"{{ build \\`SourceAMIName\\` }}\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`)),mdx(\"h2\",{\"id\":\"user-content-which-ssh-options-to-use:\",\"data-text-content\":\"Which SSH Options to use\",\"className\":\"g-type-display-3\"},`Which SSH Options to use:`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`This chart breaks down what Packer does if you set any of the below SSH options:`),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",{parentName:\"tr\"},`ssh_password`),mdx(\"th\",{parentName:\"tr\"},`ssh_private_key_file`),mdx(\"th\",{parentName:\"tr\"},`ssh_keypair_name`),mdx(\"th\",{parentName:\"tr\"},`temporary_key_pair_name`),mdx(\"th\",{parentName:\"tr\"},`Packer will...`))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\"},`X`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`ssh authenticating with username and given password`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`X`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`ssh authenticating with private key file`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`X`),mdx(\"td\",{parentName:\"tr\"},`X`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`ssh authenticating with given private key file and \"attaching\" the keypair to the instance`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`X`),mdx(\"td\",{parentName:\"tr\"},`Create a temporary ssh keypair with a particular name, clean it up`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`-`),mdx(\"td\",{parentName:\"tr\"},`Create a temporary ssh keypair with a default name, clean it up`)))))};MDXContent.isMDXComponent=true;","scope":{}},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Integrations","url":"/packer/integrations"},{"title":"Amazon","url":"/packer/integrations/hashicorp/amazon","isCurrentPage":false},{"title":"v1.3.2","url":"/packer/integrations/hashicorp/amazon/v1.3.2","isCurrentPage":false},{"title":"Components"},{"title":"Builder"},{"title":"Amazon EBS Volume","url":"/packer/integrations/hashicorp/amazon/latest/components/builder/ebsvolume","isCurrentPage":true}]},"__N_SSG":true},"page":"/[productSlug]/integrations/[organizationSlug]/[integrationSlug]/[integrationVersion]/components/[componentType]/[componentSlug]","query":{"productSlug":"packer","organizationSlug":"hashicorp","integrationSlug":"amazon","integrationVersion":"latest","componentType":"builder","componentSlug":"ebsvolume"},"buildId":"SwQkbDp-tm71svT9AbX6U","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-warning.js"><\x2fscript>');</script></body></html>