(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[633],{67:e=>{"use strict";e.exports=require("node:async_hooks")},195:e=>{"use strict";e.exports=require("node:buffer")},562:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c}),s(639);var n=s(826),a=s(161),r=s(254);let o=r.z.object({conversationId:r.z.string(),messageId:r.z.string(),text:r.z.string().transform(e=>e.trim()).optional(),rating:r.z.number().min(-1).max(1).optional()});async function i(e,t){console.log(`[${e.method}] ${e.url}`);let s=e.headers.get("authorization");if(!s)return new Response("Not found",{status:404});let n=s.split(" ")[1];if("POST"===e.method){let t=await e.json(),s=o.safeParse(t);if(!s.success)return new Response("Bad Request",{status:400});let{conversationId:a,messageId:r,rating:i,text:c}=s.data,d=await u({conversationId:a,messageId:r,accessToken:n},{rating:i,text:c}),f=await d.json();return new Response(f,{status:d.status})}}async function u({conversationId:e,messageId:t,accessToken:s},{rating:n,text:a}){let r=new Headers;r.set("Authorization",`Bearer ${s}`),r.set("Content-Type","application/json");let o=new URL(`/v1/conversations/${e}/messages/${t}/feedback`,process.env.EXPERIMENTAL_CHAT_API_BASE_URL);return fetch(o.toString(),{body:JSON.stringify({rating:n,text:a}),method:"POST",headers:r})}function c(e){return(0,n.V)({...e,IncrementalCache:a.k,page:"/api/chat/feedback",handler:i})}}},e=>{var t=t=>e(e.s=t);e.O(0,[826,773],()=>t(562));var s=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_pages/api/chat/feedback"]=s}]);
//# sourceMappingURL=feedback.js.map