{"pageProps":{"metadata":{"title":"Prometheus Consul Exporter | Integrations","description":"The Prometheus Consul Exporter exposes Consul service health to Prometheus."},"product":{"name":"Nomad","slug":"nomad","algoliaConfig":{"indexName":"product_NOMAD","searchOnlyApiKey":"9bfec34ea54e56a11bd50d6bfedc5e71"},"analyticsConfig":{"includedDomains":"nomadproject.io www.nomadproject.io","segmentWriteKey":"qW11yxgipKMsKFKQUCpTVgQUYftYsJj0"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Nomad by HashiCorp","description":"Nomad is a highly available, distributed, data-center aware cluster and application scheduler designed to support the modern datacenter with support for long-running services, batch jobs, and much more.","image":"https://www.nomadproject.io/nomad-public/img/og-image.png","icon":[{"href":"/nomad-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiDays","url":"https://hashicorp.com/conferences/hashidays","text":"One conference. Three cities.","linkText":"Find a city near you","expirationDate":"2024-06-14T00:00:00-08:00"},"version":"1.2.5","subnavItems":[{"text":"Overview","url":"/","type":"inbound"},{"text":"Enterprise","url":"https://www.hashicorp.com/products/nomad/","type":"outbound"},"divider",{"text":"Tutorials","url":"https://developer.hashicorp.com/nomad/tutorials","type":"outbound"},{"text":"Docs","url":"/docs","type":"inbound"},{"text":"API","url":"/api-docs","type":"inbound"},{"text":"Plugins","url":"/plugins","type":"inbound"},{"text":"Tools","url":"/tools","type":"inbound"},{"text":"Community","url":"/community","type":"inbound"}],"basePaths":["docs","api-docs","plugins","tools","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"entry-point","name":"Intro","path":"intro"},{"iconName":"api","name":"API","path":"api-docs"},{"iconName":"terminal-screen","name":"Tools","path":"tools"},{"iconName":"plug","name":"Plugins","path":"plugins"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Nomad Integrations."}},"integration":{"id":"a22a3fef-f2a4-42a8-98c3-a4665d746425","slug":"prometheus-consul-exporter","name":"Prometheus Consul Exporter","description":"The Prometheus Consul Exporter exposes Consul service health to Prometheus.","license_type":null,"license_url":null,"external_only":false,"external_url":"https://github.com/prometheus/consul_exporter","tier":"community","repo_url":"https://github.com/hashicorp/nomad-pack-community-registry","subdirectory":"/packs/prometheus_consul_exporter","created_at":"2023-05-17T17:27:42.011Z","updated_at":"2023-07-12T18:05:09.581Z","hide_versions":false,"organization":{"id":"a4a0551a-1451-4d89-9f56-8031c8350c77","slug":"hashicorp","created_at":"2022-11-09T22:56:32.391Z","updated_at":"2022-11-09T22:56:32.391Z"},"product":{"id":"40557cca-56ca-4cb2-abc6-9bba2a9ca62d","slug":"nomad","name":"Nomad","created_at":"2022-11-09T22:56:29.799Z","updated_at":"2022-11-09T22:56:29.799Z"},"versions":["0.0.1"],"components":[],"flags":[],"integration_type":{"id":"e8835871-6a6a-4836-8797-505cbfbe426a","product_id":"40557cca-56ca-4cb2-abc6-9bba2a9ca62d","slug":"pack","name":"Pack","plural_name":"Packs","description":"Packs are templated sets of resources that are meant to be deployed to Nomad together. Each pack defines parameters that can be customized by the end user.","created_at":"2023-05-02T17:31:29.062Z","updated_at":"2023-05-17T22:44:11.429Z"}},"activeRelease":{"id":"e3cfe570-c737-43b6-b72c-c58a761d9fdd","integration_id":"a22a3fef-f2a4-42a8-98c3-a4665d746425","version":"0.0.1","readme":"This pack contains a single job that runs\n[Prometheus Consul Exporter](https://github.com/prometheus/consul_exporter) as a service job. It\ncurrently supports being run by the [Docker driver](https://www.nomadproject.io/docs/drivers/docker).\n\nThe Consul exporter task registers a Consul service and health check by default. Once running, your\nPrometheus configuration can be updated with the following scrape config entry example which will\nallow Prometheus to discover and scrape all deployed Consul exporter instances.\n```yaml\n- job_name: \"consul_exporter\"\n  metrics_path: \"/metrics\"\n  consul_sd_configs:\n    - server: \"consul.example.com:8500\"\n      services:\n        - \"prometheus-consul-exporter\"\n```\n\n## Variables\n\n- `job_name` (string \"\") - The name to use as the job name which overrides using the pack name.\n- `datacenters` (list(string) [\"dc1\"]) - A list of datacenters in the region which are eligible for\n  task placement.\n- `region` (string \"global\") - The region where the job should be placed.\n- `namespace` (string \"default\") - The namespace where the job should be placed.\n- `constraints` (list(object)) - Constraints to apply to the entire job.\n- `consul_exporter_group_network` (object) - The Consul exporter network configuration options.\n- `consul_exporter_task_config` (object) - The Consul exporter task config options.\n- `consul_exporter_task_resources` (object) - The resource to assign to the Consul exporter task.\n- `consul_exporter_task_services` (object) - Configuration options of the Consul exporter services\nand checks.\n\n### `constraints` List of Objects\n\n[Nomad job specification constraints][job_constraint] allows restricting the set of eligible nodes\non which the Prometheus Consul Exporter task will run.\n\n- `attribute` (string) - Specifies the name or reference of the attribute to examine for the\n  constraint.\n- `operator` (string) - Specifies the comparison operator. The ordering is compared lexically.\n- `value` (string) - Specifies the value to compare the attribute against using the specified\n  operation.\n\nThe default value constrains the job to run on client whose kernel name is `linux`. The HCL\nvariable list of objects is shown below and uses a double dollar sign for escaping:\n```hcl\n[\n  {\n    attribute = \"$${attr.kernel.name}\",\n    value     = \"linux\",\n    operator  = \"\",\n  }\n]\n```\n\n### `consul_exporter_group_network` Object\n\n- `mode` (string \"bridge\") - Mode of the network.\n- `ports` (map<string|number> http:9107) - Specifies the port mapping for the Consul exporter task.\n\n### `consul_exporter_task_config` Object\n\n- `version` (string \"v0.7.1\") - The Prometheus Consul Exporter version to run.\n- `cli_args` (list(string) []) - CLI arguments to pass to the Consul Exporter app.\n\n### `consul_exporter_task_resources` Object\n\n-`cpu` (number 100) - Specifies the CPU required to run this task in MHz.\n-`memory` (number 128) - Specifies the memory required in MB.\n\n### `consul_exporter_task_services` List of Objects\n\n- `service_port_label` (string) - Specifies the port to advertise for this service.\n- `service_name` (string) - Specifies the name this service will be advertised as in Consul.\n- `service_tags` (list(string)) - Specifies the list of tags to associate with this service.\n- `check_enabled` (bool) - Whether to enable a check for this service.\n- `check_path` (string) - Specifies the path of the HTTP endpoint which Consul will query to query\nthe health of a service.\n- `check_type` (string) - The type of check to configure.\n- `check_interval` (string) - Specifies the frequency of the health checks that Consul will perform.\n- `check_timeout` (string)-  Specifies how long Consul will wait for a health check query to succeed.\n\nThe default value for this variable configures a service and a check for the Consul exporter `http`\nport defined as default within the `consul_exporter_group_network.ports` mapping.\n\n[job_constraint]: (https://www.nomadproject.io/docs/job-specification/constraint)","created_at":"2023-05-17T22:19:01.386Z","updated_at":"2023-05-17T22:19:01.386Z","components":[]},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Nomad","url":"/nomad"},{"title":"Integrations","url":"/nomad/integrations"},{"title":"Prometheus Consul Exporter","url":"/nomad/integrations/hashicorp/prometheus-consul-exporter","isCurrentPage":true}],"anchorLinks":[{"id":"variables","level":2,"title":"Variables"},{"id":"constraints-list-of-objects","level":3,"title":"constraints List of Objects"},{"id":"consul_exporter_group_network-object","level":3,"title":"consul_exporter_group_network Object"},{"id":"consul_exporter_task_config-object","level":3,"title":"consul_exporter_task_config Object"},{"id":"consul_exporter_task_resources-object","level":3,"title":"consul_exporter_task_resources Object"},{"id":"consul_exporter_task_services-list-of-objects","level":3,"title":"consul_exporter_task_services List of Objects"}],"serializedREADME":{"compiledSource":"const layoutProps={};const MDXLayout=\"wrapper\";function MDXContent({components,...props}){return mdx(MDXLayout,{...layoutProps,...props,components:components,mdxType:\"MDXLayout\"},mdx(\"p\",{\"className\":\"g-type-long-body\"},`This pack contains a single job that runs\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/prometheus/consul_exporter\"},`Prometheus Consul Exporter`),` as a service job. It\ncurrently supports being run by the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.nomadproject.io/docs/drivers/docker\"},`Docker driver`),`.`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The Consul exporter task registers a Consul service and health check by default. Once running, your\nPrometheus configuration can be updated with the following scrape config entry example which will\nallow Prometheus to discover and scrape all deployed Consul exporter instances.`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`- `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`job_name`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"consul_exporter\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  metrics_path`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"/metrics\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  consul_sd_configs`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`server`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"consul.example.com:8500\"`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      services`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`:`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        - `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"prometheus-consul-exporter\"`)),`\n`)),mdx(\"h2\",{\"id\":\"user-content-variables\",\"data-text-content\":\"Variables\",\"className\":\"g-type-display-3\"},`Variables`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`job_name`),` (string \"\") - The name to use as the job name which overrides using the pack name.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`datacenters`),` (list(string) `,`[\"dc1\"]`,`) - A list of datacenters in the region which are eligible for\ntask placement.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`region`),` (string \"global\") - The region where the job should be placed.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`namespace`),` (string \"default\") - The namespace where the job should be placed.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`constraints`),` (list(object)) - Constraints to apply to the entire job.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`consul_exporter_group_network`),` (object) - The Consul exporter network configuration options.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`consul_exporter_task_config`),` (object) - The Consul exporter task config options.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`consul_exporter_task_resources`),` (object) - The resource to assign to the Consul exporter task.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`consul_exporter_task_services`),` (object) - Configuration options of the Consul exporter services\nand checks.`)),mdx(\"h3\",{\"id\":\"user-content-constraints-list-of-objects\",\"data-text-content\":\"constraints List of Objects\",\"className\":\"g-type-display-4\"},mdx(\"inlineCode\",{parentName:\"h3\"},`constraints`),` List of Objects`),mdx(\"p\",{\"className\":\"g-type-long-body\"},mdx(\"a\",{parentName:\"p\"},`Nomad job specification constraints`),` allows restricting the set of eligible nodes\non which the Prometheus Consul Exporter task will run.`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`attribute`),` (string) - Specifies the name or reference of the attribute to examine for the\nconstraint.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`operator`),` (string) - Specifies the comparison operator. The ordering is compared lexically.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`value`),` (string) - Specifies the value to compare the attribute against using the specified\noperation.`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The default value constrains the job to run on client whose kernel name is `,mdx(\"inlineCode\",{parentName:\"p\"},`linux`),`. The HCL\nvariable list of objects is shown below and uses a double dollar sign for escaping:`),mdx(\"pre\",null,mdx(\"code\",{parentName:\"pre\"},mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`[`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  {`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    attribute `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"$\\${attr.kernel.name}\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    value     `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"linux\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    operator  `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`)),`\n`)),mdx(\"h3\",{\"id\":\"user-content-consul_exporter_group_network-object\",\"data-text-content\":\"consul_exporter_group_network Object\",\"className\":\"g-type-display-4\"},mdx(\"inlineCode\",{parentName:\"h3\"},`consul_exporter_group_network`),` Object`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`mode`),` (string \"bridge\") - Mode of the network.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`ports`),` (map<string|number> http:9107) - Specifies the port mapping for the Consul exporter task.`)),mdx(\"h3\",{\"id\":\"user-content-consul_exporter_task_config-object\",\"data-text-content\":\"consul_exporter_task_config Object\",\"className\":\"g-type-display-4\"},mdx(\"inlineCode\",{parentName:\"h3\"},`consul_exporter_task_config`),` Object`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`version`),` (string \"v0.7.1\") - The Prometheus Consul Exporter version to run.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`cli_args`),` (list(string) []) - CLI arguments to pass to the Consul Exporter app.`)),mdx(\"h3\",{\"id\":\"user-content-consul_exporter_task_resources-object\",\"data-text-content\":\"consul_exporter_task_resources Object\",\"className\":\"g-type-display-4\"},mdx(\"inlineCode\",{parentName:\"h3\"},`consul_exporter_task_resources`),` Object`),mdx(\"p\",{\"className\":\"g-type-long-body\"},`-`,mdx(\"inlineCode\",{parentName:\"p\"},`cpu`),` (number 100) - Specifies the CPU required to run this task in MHz.\n-`,mdx(\"inlineCode\",{parentName:\"p\"},`memory`),` (number 128) - Specifies the memory required in MB.`),mdx(\"h3\",{\"id\":\"user-content-consul_exporter_task_services-list-of-objects\",\"data-text-content\":\"consul_exporter_task_services List of Objects\",\"className\":\"g-type-display-4\"},mdx(\"inlineCode\",{parentName:\"h3\"},`consul_exporter_task_services`),` List of Objects`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`service_port_label`),` (string) - Specifies the port to advertise for this service.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`service_name`),` (string) - Specifies the name this service will be advertised as in Consul.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`service_tags`),` (list(string)) - Specifies the list of tags to associate with this service.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`check_enabled`),` (bool) - Whether to enable a check for this service.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`check_path`),` (string) - Specifies the path of the HTTP endpoint which Consul will query to query\nthe health of a service.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`check_type`),` (string) - The type of check to configure.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`check_interval`),` (string) - Specifies the frequency of the health checks that Consul will perform.`),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},`check_timeout`),` (string)-  Specifies how long Consul will wait for a health check query to succeed.`)),mdx(\"p\",{\"className\":\"g-type-long-body\"},`The default value for this variable configures a service and a check for the Consul exporter `,mdx(\"inlineCode\",{parentName:\"p\"},`http`),`\nport defined as default within the `,mdx(\"inlineCode\",{parentName:\"p\"},`consul_exporter_group_network.ports`),` mapping.`))};MDXContent.isMDXComponent=true;","scope":{}}},"__N_SSG":true}