<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Azure Builder | Integrations | Packer | HashiCorp Developer</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="Explore Packer product documentation, tutorials, and examples."/><meta name="twitter:description" content="Explore Packer product documentation, tutorials, and examples."/><meta property="og:site_name" content="Azure Builder | Integrations | Packer | HashiCorp Developer"/><meta property="og:title" content="Azure Builder | Integrations | Packer | HashiCorp Developer"/><meta property="og:image" content="https://developer.hashicorp.com/og-image/packer.jpg"/><link rel="canonical" href="https://developer.hashicorp.com/packer/integrations/hashicorp/azure/latest/components/builder/chroot"/><link rel="icon" href="/favicon.ico" sizes="any"/><link rel="icon" href="/icon.svg" type="image/svg+xml"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="google-site-verification" content="zRQZqfAsOX-ypXfU0mzAIzb5rUvj5fA4Zw2jWJRN-JI"/><meta name="zd-site-verification" content="xnvnvv1i0wl4tf0pzaymb" data-product="hcp"/><meta name="zd-site-verification" content="36fp2i1pj67d8cjtzf4fi9" data-product="terraform"/><meta name="zd-site-verification" content="nbe87kfyp1sck7b13vj1i" data-product="packer"/><meta name="zd-site-verification" content="wvsmmqa1cfb9am9zlwfj" data-product="consul"/><meta name="zd-site-verification" content="cw22oopfwr68ujj0n5pn9i" data-product="boundary"/><meta name="zd-site-verification" content="lkslvganwfgfqfwpdeicgh" data-product="vault"/><meta name="zd-site-verification" content="jl2wp2hoej9rz6c8rmqdns" data-product="nomad"/><meta name="zd-site-verification" content="2eb0cu6xceo73t0038m0tb" data-product="waypoint"/><meta name="zd-site-verification" content="n52xisxdf3higs2q9kuogd" data-product="vagrant"/><meta name="twitter:image" content="https://developer.hashicorp.com/og-image/packer.jpg"/><link rel="prefetch" href="https://www.datadoghq-browser-agent.com/datadog-rum-v4.js"/><script type="application/ld+json">[{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Developer","item":"https://developer.hashicorp.com/"},{"@type":"ListItem","position":2,"name":"Packer","item":"https://developer.hashicorp.com/packer"},{"@type":"ListItem","position":3,"name":"Integrations","item":"https://developer.hashicorp.com/packer/integrations"},{"@type":"ListItem","position":4,"name":"Azure","item":"https://developer.hashicorp.com/packer/integrations/hashicorp/azure"},{"@type":"ListItem","position":5,"name":"v2.0.4","item":"https://developer.hashicorp.com/packer/integrations/hashicorp/azure/v2.0.4"},{"@type":"ListItem","position":6,"name":"chroot","item":"https://developer.hashicorp.com/packer/integrations/hashicorp/azure/latest/components/builder/chroot"}]}]</script><meta name="next-head-count" content="31"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/hashicorp-packer/_next/static/css/8e76dc12ec22e9bf.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/8e76dc12ec22e9bf.css" crossorigin="" data-n-g=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/63deaa568623a226.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/63deaa568623a226.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/e6c79edad9f1145a.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/e6c79edad9f1145a.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/5734d1b25a4d4e7f.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/5734d1b25a4d4e7f.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/d84fe9967a765e18.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/d84fe9967a765e18.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-packer/_next/static/css/def171e8e14cab7c.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-packer/_next/static/css/def171e8e14cab7c.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/hashicorp-packer/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/hashicorp-packer/_next/static/chunks/webpack-1521af968f608cd8.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/framework-314c182fa7e2bf37.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/main-6c325c133e122e6d.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/pages/_app-d64f6e366399db98.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/3262-6fae8170c293f081.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/9547-de090b52af7ba1ea.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/1525-1f498930a8249e9e.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/9873-c28499ab98934c46.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/5665-db60618a811e4f85.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/62-c057cd57b8b1ff03.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/6517-fbf40a8ad08e1173.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/1151-988429f2096a886d.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/5044-1418005e37ce10ae.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/5765-a7b4415bf53b3f18.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/9913-f57823d12ca48e78.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/chunks/pages/%5BproductSlug%5D/integrations/%5BorganizationSlug%5D/%5BintegrationSlug%5D/%5BintegrationVersion%5D/components/%5BcomponentType%5D/%5BcomponentSlug%5D-c2b2832a5364f15e.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/1sdYLlFQ1437_Ko0L9N2-/_buildManifest.js" defer="" crossorigin=""></script><script src="/hashicorp-packer/_next/static/1sdYLlFQ1437_Ko0L9N2-/_ssgManifest.js" defer="" crossorigin=""></script></head><body><script>!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://artemis.hashicorp.com/script/"+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics._cdn="https://artemis.hashicorp.com";analytics.SNIPPET_VERSION="4.1.0";}}();</script><div id="__next"><div class="style_root__dZhZu"><a href="https://hashi.co/dev-ai-signup" class="style_linkElem__hCESK"><span class="style_textContainer__6CuI7 g-grid-container"><span class="style_tag__jbHGz g-type-body-small-x-strong">HashiCorp Developer AI<!-- --> </span><span class="style_text__rwS0u g-type-body-small">Private beta now available<span class="style_linkText__E8GJf g-type-body-small-x-strong"> <!-- -->Sign up today</span></span></span></a><button class="style_closeButton__57J9w"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 5L5 15M5 5l10 10" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div><span style="position:absolute;border:0;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;word-wrap:normal">Dismiss alert</span></button></div><script type="text/javascript">
(function checkDismissAlertBanner() {
  try {
    if (document.cookie.includes('banner_private-beta-now-available=1')) {
      const element = document.querySelector('.style_root__dZhZu')
      element.classList.remove('style_isShown__D4mb6')
    }
  } catch (_) {
    // do nothing
  }
})()
</script><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="core-dev-dot-layout_root__MT1PZ"><div class="base-layout_root___qiZs" data-layout="base-new"><div class="base-layout_header__XhkxS"><header class="navigation-header_root__oE_HT"><div class="navigation-header_leftSide__V0xlc"><div class="product-page-content_productsDropdown__haUyw"><div class="dropdown-menu_root__Hwy5S"><div class="dropdown-menu_activatorWrapper__LxPRt"><button aria-controls="navigation-header-menu-react-aria-1" aria-expanded="false" aria-label="Main menu" class="dropdown-menu_activator__xXb00 g-focus-ring-from-box-shadow-dark product-page-content_productsDropdownButton__bnKKs" data-heap-track="navigation-header-dropdown-menu-activator"><span class="dropdown-menu_activatorLeadingIcon__YQQlH"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true" class="product-page-content_productsDropdownIcon__gXtly"><g fill="currentColor"><path d="M10.336 1.5L2 6.268v11.456l3.131 1.793V8.061l5.205-2.979V1.5z"></path><path d="M13.664 1.5v9.123h-3.328V7.219L7.203 9.012V20.7l3.133 1.796V13.4h3.328v3.381l3.131-1.793V3.293L13.664 1.5z"></path><path d="M22 17.732L13.664 22.5v-3.582l5.203-2.98V4.484L22 6.276v11.456z"></path></g></svg></span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="dropdown-menu_activatorTrailingIcon__r_cCd"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button></div><div class="dropdown-menu_dropdownContainer__AZWxN product-page-content_productsDropdownPane__bcdWz" id="navigation-header-menu-react-aria-1" style="display:none"><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M7.846 2.574a.25.25 0 01.308 0l5.25 4.12a.25.25 0 01.096.196v7.36a.75.75 0 001.5 0V6.89a1.75 1.75 0 00-.67-1.377L9.08 1.394a1.75 1.75 0 00-2.16 0l-5.25 4.12A1.75 1.75 0 001 6.89v7.36a.75.75 0 001.5 0V6.89a.25.25 0 01.096-.196l5.25-4.12z"></path><path d="M6.5 14.25V10.5h3v3.75a.75.75 0 001.5 0v-4C11 9.56 10.44 9 9.75 9h-3.5C5.56 9 5 9.56 5 10.25v4a.75.75 0 001.5 0z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Developer</span></div></div></a></li></ul><hr class="dropdown-menu_itemGroupDivider__X38aR"/><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/hcp"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Cloud Platform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/terraform"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-terraform-brand)"><path d="M1 0v5.05l4.349 2.527V2.526L1 0zM10.175 5.344l-4.35-2.525v5.05l4.35 2.527V5.344zM10.651 10.396V5.344L15 2.819v5.05l-4.349 2.527zM10.174 16l-4.349-2.526v-5.05l4.349 2.525V16z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Terraform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/packer"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Packer</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/consul"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Consul</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/vault"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-vault-brand)" d="M0 0l7.971 15.516L16 0H0zm6.732 6.16h-1.27V4.89h1.27v1.27zm0-1.906h-1.27V2.985h1.27v1.269zm1.904 3.81h-1.27v-1.27h1.27v1.27zm0-1.905h-1.27V4.89h1.27v1.27zm0-1.905h-1.27V2.985h1.27v1.269zm1.894 1.905H9.26V4.89h1.27v1.27zM9.26 4.254V2.985h1.27v1.269H9.26z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vault</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/boundary"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-boundary-brand)"><path d="M4.81 15v-1.085h2.25v-.67H5.968v-1.093h5.149L8.726 8l2.392-4.154H5.84v5.76H3V1h9.775l1.631 2.832L12.006 8l2.448 4.252L12.872 15H4.81z"></path><path d="M5.248 12.152h-1.09v1.092h1.09v-1.092zM3 13.907h1.09v1.092H3v-1.092z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Boundary</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/nomad"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-nomad-brand)" d="M8 0L1 4v8l7 4 7-4V4L8 0zm3.119 8.797L9.254 9.863 7.001 8.65v2.549l-2.118 1.33v-5.33l1.68-1.018 2.332 1.216V4.794l2.23-1.322-.006 5.325z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Nomad</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/waypoint"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-waypoint-brand)"><path d="M4 5.312h1.334L10 13.4l3.334-5.777L10.666 3H8l2.666 4.623L10 8.778 6.667 3H0l6 10.4 1.333-2.31L4 5.311zM14.002 6.463L16 3h-3.996l1.998 3.463z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Waypoint</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-packer/vagrant"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="#1868F2" d="M13.08.75L9.924 2.58v1.123L8 8.245 6.076 3.703V2.58L2.92.75 1 1.864v1.293l4.276 10.514L8 15.25l2.724-1.579L15 3.157V1.864L13.08.75z"></path><path fill="#0850C5" d="M15 1.865l-3.157 1.829v1.124L9.28 10.57 8 11.312v3.939l2.724-1.579L15 3.158V1.865zM6.076 3.703V2.58l-1.92 1.113v1.125l2.564 5.751L8 9.827V8.245L6.076 3.703z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vagrant</span></div></div></a></li></ul></div></div></div><div class="product-page-content_productLinkAndNav__YTzcr"><a aria-label="Packer home" class="product-icon-text-link_root__bNTSz g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-product-logo-link" href="/hashicorp-packer/packer"><div class="product-icon-text-lockup_root__358wV"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="product-icon-text-lockup_icon__Zp_5o"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="product-icon-text-lockup_text__nHTL7 hds-typography-body-200">Packer</span></div></a><nav class="nav-bar-list-container_nav__C_i0_"><ul class="nav-bar-list-container_ul___04HI"><li><a aria-label="Packer Install" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/install"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Install</span></a></li><li><a aria-label="Packer Tutorials" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/tutorials"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Tutorials</span></a></li><li><a aria-label="Packer Documentation" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/docs"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Documentation</span></a></li><li><a aria-label="Packer Guides" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/guides"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Guides</span></a></li><li><a aria-label="Packer Integrations" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-packer/packer/integrations"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Integrations</span></a></li><li><a aria-label="Packer Try Cloud" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="undefinedopens-in-new-tab-label-react-aria-18" target="_blank" href="https://portal.cloud.hashicorp.com/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Try Cloud</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-18">(opens in new tab)</span></li></ul></nav></div></div><div class="navigation-header_rightSide___Vvh_"><button aria-label="Search" class="command-bar-activator_root__qgVMy g-focus-ring-from-box-shadow-dark"><span class="command-bar-activator_left__ATQTg"><span class="command-bar-activator_leadingIcon__jECP5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M7.25 2a5.25 5.25 0 103.144 9.455l2.326 2.325a.75.75 0 101.06-1.06l-2.325-2.326A5.25 5.25 0 007.25 2zM3.5 7.25a3.75 3.75 0 117.5 0 3.75 3.75 0 01-7.5 0z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular command-bar-activator_text__pTZN_">Search</span></span><span class="command-bar-activator_right__XejfJ"><span class="g-screen-reader-only">Command or control key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="cmd-ctrl-icon_root___TToz"><svg width="41" height="11" viewBox="0 0 41 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.125 2.063V3h2.25v-.938a2.062 2.062 0 112.063 2.063H7.5v2.25h.938a2.062 2.062 0 11-2.063 2.063V7.5h-2.25v.938a2.062 2.062 0 11-2.063-2.063H3v-2.25h-.938a2.062 2.062 0 112.063-2.063zm-2.063-.938a.937.937 0 100 1.875H3v-.938a.937.937 0 00-.938-.937zM7.5 7.5v.938a.937.937 0 10.938-.938H7.5zM6.375 6.375v-2.25h-2.25v2.25h2.25zM2.062 7.5H3v.938a.937.937 0 11-.938-.938zM7.5 3h.938a.937.937 0 10-.938-.938V3z" fill="#fff"/><path d="M15.09 10.5L18.085 0h-1.097L14 10.5h1.09zm11.297-5.192c-.183-1.445-1.263-2.534-3.05-2.534C21.264 2.774 20 4.247 20 6.61c0 2.41 1.27 3.89 3.344 3.89 1.76 0 2.86-1.034 3.043-2.5H25.02c-.184.808-.792 1.247-1.682 1.247-1.172 0-1.898-.994-1.898-2.637 0-1.61.72-2.583 1.898-2.583.942 0 1.518.555 1.681 1.281h1.368zM28.6 1.041v1.897h-1.133v1.178H28.6v4.281c0 1.432.622 2.007 2.186 2.007.275 0 .537-.034.766-.075V9.158c-.196.02-.32.034-.537.034-.7 0-1.008-.35-1.008-1.15V4.115h1.545V2.938h-1.545V1.041H28.6zm4.607 9.315h1.407V5.911c0-1.048.752-1.767 1.819-1.767.249 0 .667.048.785.082V2.842a3.372 3.372 0 00-.628-.054c-.93 0-1.721.527-1.924 1.26h-.105v-1.13h-1.354v7.438zm5.431 0h1.407V0h-1.407v10.356z" fill="#fff"/></svg></div></span><span class="g-screen-reader-only">K key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="k-icon_root__a_5pR"><svg width="8" height="10" viewBox="0 0 8 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.512 9.84v-3l.986-1.147L5.445 9.84h1.704L3.46 4.745 6.857.84H5.244L1.61 5.094h-.098V.84H.15v9h1.363z" fill="#fff"/></svg></div></span></span></button><div class="navigation-header_authenticationControls__EP1LY"><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj"><button aria-controls="disclosure-react-aria-19-content" aria-expanded="false" aria-label="User menu" class="disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo navigation-header_userDropdownDisclosureActivator__RayIV g-focus-ring-from-box-shadow-dark activator_hasIcon__5HO6W g-focus-ring-from-box-shadow"><span class="activator_childrenWrapper__kaK0w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path fill-rule="evenodd" d="M12 3a5 5 0 100 10 5 5 0 000-10zM8.5 8a3.5 3.5 0 117 0 3.5 3.5 0 01-7 0z" clip-rule="evenodd"></path><path d="M7.75 14.5A4.75 4.75 0 003 19.25v1a.75.75 0 001.5 0v-1A3.25 3.25 0 017.75 16h8.5a3.25 3.25 0 013.25 3.25v1a.75.75 0 001.5 0v-1a4.75 4.75 0 00-4.75-4.75h-8.5z"></path></g></svg></span><span class="activator_chevronWrapper__4_AVG"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></span></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-19-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><button class="list-item_button__nXy5K g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign in</span></button></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign up</span></a></li><li class="list-item_root__ZdUej"><hr class="list-item_separator__cBVLs"/></li><li class="list-item_root__ZdUej user-dropdown-switcher_listItem__Q_GIj hds-font-weight-medium"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-21">Theme</label></li></ul></div></div></div><button aria-label="Open navigation menu" class="navigation-header_mobileMenuButton__74S4w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path d="M2 5.75A.75.75 0 012.75 5h18.5a.75.75 0 010 1.5H2.75A.75.75 0 012 5.75zM2 11.75a.75.75 0 01.75-.75h18.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2.75 17a.75.75 0 000 1.5h18.5a.75.75 0 000-1.5H2.75z"></path></g></svg></button></div></header></div><div class="base-layout_contentArea__BMvQn"><div class="sidebar-sidecar-layout_root__h5rD8 sidebar-sidecar-layout_mainWidth-wide__TwGq8"><div class="mobile-menu-container_root__fPUFu sidebar-sidecar-layout_sidebarContainer__4fcF8"><div class="sidebar-sidecar-layout_sidebarContentWrapper__ftn5q"><div class="sidebar_sidebar___fTlC"><div class="sidebar_backToLinkWrapper__F6iLs"><div class="sidebar-back-to-link_root__z_Hj1"><a class="standalone-link_standaloneLink__ahuej g-focus-ring-from-box-shadow standalone-link_primary__ESNCA" data-heap-track="standalone-link sidebar-back-to-link" href="/hashicorp-packer/packer/integrations"><div class="standalone-link_standaloneLinkContents__4I2XN standalone-link_medium__J2yVM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M10.795 3.235a.75.75 0 01-.03 1.06L6.842 8l3.923 3.705a.75.75 0 01-1.03 1.09l-4.5-4.25a.75.75 0 010-1.09l4.5-4.25a.75.75 0 011.06.03z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__7GEyG">Packer Integrations</span></div></a></div></div><nav aria-labelledby="sidebar-label" class="sidebar_nav__IworY" id="sidebar-nav"><div><h2 class="sidebar-headings_root__tGfxC" id="sidebar-label"></h2></div><ul class="sidebar_navList__4Rg4g"><li><a class="sidebar-nav-highlight-item_root___pPhp g-focus-ring-from-box-shadow sidebar-nav-highlight-item_theme-packer__I5KHY" href="/hashicorp-packer/packer/integrations/hashicorp/azure"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="sidebar-nav-highlight-item_icon__G8JxG"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg><span class="sidebar-nav-highlight-item_text__VORFJ hds-typography-body-200">Azure</span></a></li><li><button aria-controls="undefined-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="undefined-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Builders</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="undefined-list"><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/arm"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">ARM</span></a></li><li><a aria-current="page" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">chroot</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/dtl"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">DTL</span></a></li></ul></li><li><button aria-controls="undefined-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="undefined-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Provisioners</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="undefined-list"><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/provisioner/dtlartifact"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">DTL Artifact</span></a></li></ul></li></ul><hr class="sidebar-horizontal-rule_root__UY7oh"/><ul class="sidebar_navList__4Rg4g"><li><h3 class="sidebar-headings_root__tGfxC">Resources</h3></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-packer/tutorials/library?product=packer"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Tutorial Library</span></a></li><li><a aria-label="Community Forum. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-29" target="_blank" href="https://discuss.hashicorp.com/c/packer/23"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Community Forum</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-29">(opens in new tab)</span></li><li><a aria-label="Support. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-30" target="_blank" href="https://www.hashicorp.com/customer-success"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Support</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-30">(opens in new tab)</span></li><li><a aria-label="GitHub. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-31" target="_blank" href="https://github.com/hashicorp/packer"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">GitHub</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-31">(opens in new tab)</span></li></ul></nav></div></div></div><div class="sidebar-sidecar-layout_contentWrapper__Z5BK4"><div class="sidebar-sidecar-layout_paddedAreaWrapper___S_Ff"><div class="sidebar-sidecar-layout_breadcrumbContainer__3uz7P"><div class="sidebar-sidecar-layout_breadcrumbMaxWidth__coOcu"><nav aria-label="Breadcrumb" class="breadcrumb-bar_root__wd_C5"><ol class="breadcrumb-bar_listRoot__8eupO"><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-packer">Developer</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-packer/packer">Packer</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-packer/packer/integrations">Integrations</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-packer/packer/integrations/hashicorp/azure">Azure</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v2.0.4">v2.0.4</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><span class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item">Components</span></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><span class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item">Builder</span></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><span class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" aria-current="page" data-heap-track="breadcrumb-bar-item">chroot</span></li></ol></nav></div></div><div class="sidebar-sidecar-layout_mainAndSidecar__UDm3Z"><main id="main" class="sidebar-sidecar-layout_main__0SN51"><div class="hds-surface-base card_root__RyqjV content-header-card_contentHeaderCard__SDMMP style_header__b3NdM"><div class="content-header-card_cardTop__GTpii"><span class="icon-tile_root__ShC0s icon-tile_size-large__NxGIv icon-tile_color-packer__LRaQF content-header-card_icon__A1Xna"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><div class="content-header-card_content__XPCtf"><div class="content-header-card_upper__PQsUG"><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj content-header-card_dropdown__Gt1Vp g-hide-on-desktop g-hide-on-tablet"><button aria-controls="disclosure-react-aria-37-content" aria-expanded="false" class="button_root__itF9E hds-font-weight-medium button_medium__Cm2eg button_secondary__m5f7i disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo" data-heap-track="button " type="button"><span>v2.0.4 (latest)</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="activator_chevronWrapper__4_AVG"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-37-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v2.0.3/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v2.0.3</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v2.0.2/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v2.0.2</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v2.0.1/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v2.0.1</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v2.0.0/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v2.0.0</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v1.4.5/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.4.5</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v1.0.2/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.2</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v1.0.1/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.1</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v1.0.0/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.0</span></a></li></ul></div></div><div class="content-header-card_left__FSNcW"><div class="content-header-card_titleWrap__IAC6o"><span class="content-header-card_title__HGHfo hds-typography-display-300 from global, hds-font-weight-bold">Azure</span><p class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium content-header-card_attribution__yKU4q">@hashicorp</p></div><p class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular content-header-card_description__M_DkB">Packer can create Azure virtual machine images through variety of ways depending on the strategy that you want to use for building the images.</p></div><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj content-header-card_dropdown__Gt1Vp g-hide-on-mobile"><button aria-controls="disclosure-react-aria-46-content" aria-expanded="false" class="button_root__itF9E hds-font-weight-medium button_medium__Cm2eg button_secondary__m5f7i disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo" data-heap-track="button " type="button"><span>v2.0.4 (latest)</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="activator_chevronWrapper__4_AVG"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-46-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v2.0.3/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v2.0.3</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v2.0.2/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v2.0.2</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v2.0.1/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v2.0.1</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v2.0.0/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v2.0.0</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v1.4.5/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.4.5</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v1.0.2/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.2</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v1.0.1/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.1</span></a></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/v1.0.0/components/builder/chroot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">v1.0.0</span></a></li></ul></div></div></div><div class="content-header-card_lower__ut_Dv"><ul class="badge-list_badgeList__l_z6s content-header-card_badgeList__I_FGK"><li class="badge-list_badge__mQSlF"><span data-state="tooltip-hidden" data-reach-tooltip-trigger=""><span class="g-screen-reader-only">Official</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral__NhUW0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg><span>Official</span></span></span></li><li class="badge-list_badge__mQSlF"><span data-state="tooltip-hidden" data-reach-tooltip-trigger=""><span class="g-screen-reader-only">HCP Ready</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral__NhUW0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9.78 7.28a.75.75 0 00-1.06-1.06l-.5.5a.75.75 0 001.06 1.06l.5-.5z"></path><path fill-rule="evenodd" d="M12.627 1.32a1.731 1.731 0 012.054 2.053c-.27 1.28-.686 3.19-1.103 4.859a3.625 3.625 0 01-.58 1.224c.002.015.002.03.002.044v2.441a1.75 1.75 0 01-.833 1.49l-2.021 1.244a1.75 1.75 0 01-2.284-.397l-1.27-1.587a2.028 2.028 0 01-1.08-.917 3.426 3.426 0 00-.542-.744 3.428 3.428 0 00-.744-.542c-.4-.223-.755-.61-.917-1.08l-1.587-1.27a1.75 1.75 0 01-.398-2.284l1.244-2.021A1.75 1.75 0 014.058 3H6.5l.044.001c.37-.263.777-.467 1.224-.579 1.669-.417 3.58-.833 4.859-1.103zm-5.43 9.956a.754.754 0 00-.167-.025.517.517 0 01-.209-.208 4.913 4.913 0 00-.79-1.073 4.913 4.913 0 00-1.074-.791.516.516 0 01-.208-.21.754.754 0 00-.025-.166l.002-.008c.255-.78.694-1.941 1.307-2.958.634-1.05 1.353-1.773 2.099-1.96 1.641-.41 3.53-.821 4.804-1.09a.231.231 0 01.277.277c-.269 1.274-.68 3.163-1.09 4.804-.187.746-.91 1.465-1.96 2.099-1.017.613-2.177 1.052-2.958 1.307a.173.173 0 01-.008.002zm1.139 1.193l.697.872a.25.25 0 00.327.057l2.021-1.244a.25.25 0 00.119-.213v-1.056c-.186.13-.375.252-.562.366-.88.53-1.832.936-2.602 1.218zM2.659 6.967l.872.697c.282-.77.687-1.722 1.218-2.602.113-.187.235-.376.366-.562H4.059a.25.25 0 00-.213.119L2.602 6.64a.25.25 0 00.057.327z" clip-rule="evenodd"></path><path d="M4.442 11.558a.625.625 0 010 .884l-2 2a.625.625 0 11-.884-.884l2-2a.625.625 0 01.884 0zM2.692 10.308a.625.625 0 010 .884l-.75.75a.625.625 0 11-.884-.884l.75-.75a.625.625 0 01.884 0zM5.692 14.192a.625.625 0 10-.884-.884l-.75.75a.625.625 0 10.884.884l.75-.75z"></path></g></svg><span>HCP Ready</span></span></span></li></ul><p class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular content-header-card_note__QTtmc">Updated 8 months ago</p></div></div></div><div class="content-header-card_cardBottom__ndKDE"><ul class="content-header-card_linksList__vaxQ3"><li class="content-header-card_link___8sUH"><a class="standalone-link_standaloneLink__ahuej g-focus-ring-from-box-shadow standalone-link_secondary__H0E0A" data-heap-track="standalone-link " rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-55" target="_blank" href="https://github.com/hashicorp/packer-plugin-azure/tree/main/docs"><div class="standalone-link_standaloneLinkContents__4I2XN standalone-link_medium__J2yVM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M8 1C4.133 1 1 4.13 1 7.993c0 3.09 2.006 5.71 4.787 6.635.35.064.478-.152.478-.337 0-.166-.006-.606-.01-1.19-1.947.423-2.357-.937-2.357-.937-.319-.808-.778-1.023-.778-1.023-.635-.434.048-.425.048-.425.703.05 1.073.72 1.073.72.624 1.07 1.638.76 2.037.582.063-.452.244-.76.444-.935-1.554-.176-3.188-.776-3.188-3.456 0-.763.273-1.388.72-1.876-.072-.177-.312-.888.07-1.85 0 0 .586-.189 1.924.716A6.711 6.711 0 018 4.381c.595.003 1.194.08 1.753.236 1.336-.905 1.923-.717 1.923-.717.382.963.142 1.674.07 1.85.448.49.72 1.114.72 1.877 0 2.686-1.638 3.278-3.197 3.45.251.216.475.643.475 1.296 0 .934-.009 1.688-.009 1.918 0 .187.127.404.482.336A6.996 6.996 0 0015 7.993 6.997 6.997 0 008 1z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__7GEyG">GitHub</span></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-55">(opens in new tab)</span></li></ul></div></div><h1>chroot</h1><div class="style_integrationComponentView__dxO7C"><div class="style_mdxWrapper__6wQJC"><div class="dev-dot-content_root__UJDct hds-typography-body-300"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Type: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">azure-chroot</code>
Artifact BuilderId: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">azure.chroot</code></p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">azure-chroot</code> builder is able to build Azure managed disk (MD) images. For
more information on managed disks, see <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/managed-disks-overview">Azure Managed Disks Overview</a>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The difference between this builder and the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">azure-arm</code> builder is that this
builder is able to build a managed disk image without launching a new Azure VM
for every build, but instead use an already-running Azure VM. This can
dramatically speed up image builds. It also allows for more deterministic image
content and enables some capabilities that are not possible with the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">azure-arm</code> builder.</p><blockquote class="mdx-blockquote_blockquote__h7k9H"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>This is an advanced builder</strong> If you&#x27;re just getting started with Packer,
it is recommend to start with the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://packer.io/docs/builder/azure-arm">azure-arm builder</a>,
which is much easier to use.</p></blockquote><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-how-does-it-work"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="How Does it Work permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#how-does-it-work"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>How Does it Work?</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This builder works by creating a new MD from either an existing source or from
scratch and attaching it to the (already existing) Azure VM where Packer is
running. Once attached, a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://en.wikipedia.org/wiki/Chroot">chroot</a> is set
up and made available to the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://packer.io/docs/provisioners">provisioners</a>.
After provisioning, the MD is detached, snapshotted and a MD image is created.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Using this process, minutes can be shaved off the image creation process
because Packer does not need to launch a VM instance.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">There are some restrictions however:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg">The host system must be a similar system (generally the same OS version,
kernel versions, etc.) as the image being built.</li><li class="mdx-lists_listItem__nkqhg">If the source is a managed disk, it must be made available in the same
region as the host system.</li><li class="mdx-lists_listItem__nkqhg">The host system SKU has to allow for all of the specified disks to be
attached.</li></ul><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-configuration-reference"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Configuration Reference permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#configuration-reference"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Configuration Reference</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">There are many configuration options available for the builder. We&#x27;ll start
with authentication parameters, then go over the Azure chroot builder specific
options.</p><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-authentication-options"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Authentication options permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#authentication-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Authentication options</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">None of the authentication options are required, but depending on which
ones are specified a different authentication method may be used. See the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://packer.io/docs/builder/azure">shared Azure builders documentation</a> for more
information.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">cloud_environment_name</code> (string) - One of Public, China, or
USGovernment. Defaults to Public. Long forms such as
USGovernmentCloud and AzureUSGovernmentCloud are also supported.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">metadata_host</code> (string) - The Hostname of the Azure Metadata Service
(for example management.azure.com), used to obtain the Cloud Environment
when using a Custom Azure Environment. This can also be sourced from the
ARM_METADATA_HOST Environment Variable.
Note: CloudEnvironmentName must be set to the requested environment
name in the list of available environments held in the metadata_host.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_id</code> (string) - The application ID of the AAD Service Principal.
Requires either <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_secret</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_cert_path</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_jwt</code> to be set as well.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_secret</code> (string) - A password/secret registered for the AAD SP.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_cert_path</code> (string) - The path to a PKCS#12 bundle (.pfx file) to be used as the client certificate
that will be used to authenticate as the specified AAD SP.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_cert_password</code> (string) - The password for decrypting the client certificate bundle.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_jwt</code> (string) - A JWT bearer token for client auth (RFC 7523, Sec. 2.2) that will be used
to authenticate the AAD SP. Provides more control over token the expiration
when using certificate authentication than when using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_cert_path</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">object_id</code> (string) - The object ID for the AAD SP. Optional, will be derived from the oAuth token if left empty.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">tenant_id</code> (string) - The Active Directory tenant identifier with which your <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">client_id</code> and
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">subscription_id</code> are associated. If not specified, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">tenant_id</code> will be
looked up using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">subscription_id</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">subscription_id</code> (string) - The subscription to use.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">use_azure_cli_auth</code> (bool) - Flag to use Azure CLI authentication. Defaults to false.
CLI auth will use the information from an active <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">az login</code> session to connect to Azure and set the subscription id and tenant id associated to the signed in account.
If enabled, it will use the authentication provided by the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">az</code> CLI.
Azure CLI authentication will use the credential marked as <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">isDefault</code> and can be verified using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">az account show</code>.
Works with normal authentication (<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">az login</code>) and service principals (<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">az login --service-principal --username APP_ID --password PASSWORD --tenant TENANT_ID</code>).
Ignores all other configurations if enabled.</p></li></ul><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-azure-chroot-builder-specific-options"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Azure chroot builder specific options permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#azure-chroot-builder-specific-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Azure chroot builder specific options</h3><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-required:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Required permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#required:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Required:</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source</code> (string) - One of the following can be used as a source for an image:<ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg">a shared image version resource ID</li><li class="mdx-lists_listItem__nkqhg">a managed disk resource ID</li><li class="mdx-lists_listItem__nkqhg">a publisher:offer:sku:version specifier for plaform image sources.</li></ul></li></ul><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-optional:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Optional permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#optional:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Optional:</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">from_scratch</code> (bool) - When set to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">true</code>, starts with an empty, unpartitioned disk. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command_wrapper</code> (string) - How to run shell commands. This may be useful to set environment variables or perhaps run
a command with sudo or so on. This is a configuration template where the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">.Command</code> variable
is replaced with the command to be run. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">{{.Command}}</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">pre_mount_commands</code> ([]string) - A series of commands to execute after attaching the root volume and before mounting the chroot.
This is not required unless using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">from_scratch</code>. If so, this should include any partitioning
and filesystem creation commands. The path to the device is provided by <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">{{.Device}}</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">mount_options</code> ([]string) - Options to supply the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">mount</code> command when mounting devices. Each option will be prefixed with
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-o</code> and supplied to the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">mount</code> command ran by Packer. Because this command is ran in a shell,
user discretion is advised. See this manual page for the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">mount</code> command for valid file system specific options.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">mount_partition</code> (string) - The partition number containing the / partition. By default this is the first partition of the volume.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">mount_path</code> (string) - The path where the volume will be mounted. This is where the chroot environment will be. This defaults
to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/mnt/packer-amazon-chroot-volumes/{{.Device}}</code>. This is a configuration template where the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">.Device</code>
variable is replaced with the name of the device where the volume is attached.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">post_mount_commands</code> ([]string) - As <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">pre_mount_commands</code>, but the commands are executed after mounting the root device and before the
extra mount and copy steps. The device and mount path are provided by <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">{{.Device}}</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">{{.MountPath}}</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">chroot_mounts</code> (<!-- -->[][]<!-- -->string) - This is a list of devices to mount into the chroot environment. This configuration parameter requires
some additional documentation which is in the &quot;Chroot Mounts&quot; section below. Please read that section
for more information on how to use this.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">copy_files</code> ([]string) - Paths to files on the running Azure instance that will be copied into the chroot environment prior to
provisioning. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/etc/resolv.conf</code> so that DNS lookups work. Pass an empty list to skip copying
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/etc/resolv.conf</code>. You may need to do this if you&#x27;re building an image that uses systemd.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">os_disk_size_gb</code> (int64) - Try to resize the OS disk to this size on the first copy. Disks can only be englarged. If not specified,
the disk will keep its original size. Required when using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">from_scratch</code></p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">os_disk_storage_account_type</code> (string) - The <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.microsoft.com/en-us/rest/api/compute/disks/createorupdate#diskstorageaccounttypes">storage SKU</a>
to use for the OS Disk. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Standard_LRS</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">os_disk_cache_type</code> (string) - The <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#cachingtypes">cache type</a>
specified in the resulting image and for attaching it to the Packer VM. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ReadOnly</code></p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">data_disk_storage_account_type</code> (string) - The <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.microsoft.com/en-us/rest/api/compute/disks/createorupdate#diskstorageaccounttypes">storage SKU</a>
to use for datadisks. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">Standard_LRS</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">data_disk_cache_type</code> (string) - The <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#cachingtypes">cache type</a>
specified in the resulting image and for attaching it to the Packer VM. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ReadOnly</code></p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">image_hyperv_generation</code> (string) - The <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#hypervgenerationtypes">Hyper-V generation type</a> for Managed Image output.
Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">V1</code>.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_os_disk_id</code> (string) - The id of the temporary OS disk that will be created. Will be generated if not set.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_os_disk_snapshot_id</code> (string) - The id of the temporary OS disk snapshot that will be created. Will be generated if not set.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_data_disk_id_prefix</code> (string) - The prefix for the resource ids of the temporary data disks that will be created. The disks will be suffixed with a number. Will be generated if not set.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">temporary_data_disk_snapshot_id</code> (string) - The prefix for the resource ids of the temporary data disk snapshots that will be created. The snapshots will be suffixed with a number. Will be generated if not set.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">skip_cleanup</code> (bool) - If set to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">true</code>, leaves the temporary disks and snapshots behind in the Packer VM resource group. Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code></p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">image_resource_id</code> (string) - The managed image to create using this build.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">shared_image_destination</code> (SharedImageGalleryDestination) - The shared image to create using this build.</p></li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">skip_create_image</code> (bool) - Skip creating the image.
Useful for setting to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">true</code> during a build test stage.
Defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">false</code>.</li></ul><h4 class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716" id="user-content-output-options:"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="Output options permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#output-options:"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Output options:</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">At least one of these options needs to be specified:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">image_resource_id</code> (string) - The managed image to create using this build.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">shared_image_destination</code> (object) - The shared image to create using this build.</p></li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Where <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">shared_image_destination</code> is an object with the following properties:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">resource_group</code> (string) - Resource Group</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">gallery_name</code> (string) - Gallery Name</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">image_name</code> (string) - Image Name</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">image_version</code> (string) - Image Version</p></li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">target_regions</code> ([]TargetRegion) - Target Regions</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">exclude_from_latest</code> (bool) - Exclude From Latest</p></li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">And <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">target_regions</code> is an array of objects with the following properties:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">name</code> (string) - Name of the Azure region</li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">replicas</code> (int64) - Number of replicas in this region. Default: 1</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">storage_account_type</code> (string) - Storage account type: Standard_LRS or Standard_ZRS. Default: Standard_ZRS</p></li></ul><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-chroot-mounts"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Chroot Mounts permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#chroot-mounts"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Chroot Mounts</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">chroot_mounts</code> configuration can be used to mount specific devices within
the chroot. By default, the following additional mounts are added into the
chroot by Packer:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/proc</code> (proc)</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/sys</code> (sysfs)</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/dev</code> (bind to real <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/dev</code>)</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/dev/pts</code> (devpts)</li><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/proc/sys/fs/binfmt_misc</code> (binfmt_misc)</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">These default mounts are usually good enough for anyone and are sane defaults.
However, if you want to change or add the mount points, you may using the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">chroot_mounts</code> configuration. Here is an example configuration which only
mounts <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/prod</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">/dev</code>:</p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;chroot_mounts&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">[</span><span class="token string">&quot;proc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;proc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/proc&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">[</span><span class="token string">&quot;bind&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/dev&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/dev&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">chroot_mounts</code> is a list of a 3-tuples of strings. The three components of the
3-tuple, in order, are:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The filesystem type. If this is &quot;bind&quot;, then Packer will properly bind the
filesystem to another mount point.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The source device.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The mount directory.</p></li></ul><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-additional-template-function"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Additional template function permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#additional-template-function"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Additional template function</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Because this builder runs on an Azure VM, there is an additional template function
available called <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vm</code>, which returns the following VM metadata:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg">name</li><li class="mdx-lists_listItem__nkqhg">subscription_id</li><li class="mdx-lists_listItem__nkqhg">resource_group</li><li class="mdx-lists_listItem__nkqhg">location</li><li class="mdx-lists_listItem__nkqhg">resource_id</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This function can be used in the configuration templates, for example, use</p><div class="g-code-block style_root__i1k0c language-text mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-text mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-text mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">&quot;{{ vm `subscription_id` }}&quot;<!-- -->
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">to fill in the subscription ID of the VM in any of the configuration options.</p><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-build-shared-information-variables"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Build Shared Information Variables permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#build-shared-information-variables"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Build Shared Information Variables</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This builder generates data that are shared with provisioner and post-processor via build function of <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://packer.io/docs/templates/legacy_json_templates/engine">template engine</a> for JSON and <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://packer.io/docs/templates/hcl_templates/contextual-variables">contextual variables</a> for HCL2.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The generated variables available for this builder are:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">SourceImageName</code> - The full name of the source image used in the deployment. When using
shared images the resulting name will point to the actual source used to create the said version.
building the AMI.</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Usage example:</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment">// When accessing one of these variables from inside the builder, you need to</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment">// use the golang templating syntax. This is due to an architectural quirk that</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment">// won&#x27;t be easily resolvable until legacy json templates are deprecated:</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source <span class="token string">&quot;amazon-arm&quot;</span> <span class="token string">&quot;basic-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source</span> <span class="token punctuation">=</span> <span class="token string">&quot;credativ:Debian:9:latest&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment">// when accessing one of the variables from a provisioner or post-processor, use</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment">// hcl-syntax</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">post-processor <span class="token string">&quot;manifest&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">output</span> <span class="token punctuation">=</span> <span class="token string">&quot;manifest.json&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">strip_path</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">custom_data</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">        <span class="token property">source_image_name</span> <span class="token punctuation">=</span> <span class="token string">&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span>build<span class="token punctuation">.</span>SourceImageName<span class="token punctuation">}</span></span>&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token property">&quot;post-processors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;manifest&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;output&quot;</span><span class="token operator">:</span> <span class="token string">&quot;manifest.json&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;strip_path&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;custom_data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;source_image_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{{ build `SourceImageName` }}&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">]</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h2 class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_" id="user-content-examples"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="Examples permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#examples"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Examples</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Here are some examples using this builder.
This builder requires privileged actions, such as mounting disks, running
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">chroot</code> and other admin commands. Usually it needs to be run with root
permissions, for example:</p><div class="g-code-block style_root__i1k0c language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> -E packer build example.pkr.json</span></span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-using-a-vm-with-a-managed-identity"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Using a VM with a Managed Identity permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#using-a-vm-with-a-managed-identity"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Using a VM with a Managed Identity</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">On a VM with a system-assigned managed identity that has the contributor role
on its own resource group, the following config can be used to create an
updated Debian image:</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source <span class="token string">&quot;azure-chroot&quot;</span> <span class="token string">&quot;example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">image_resource_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;/subscriptions/{{vm `subscription_id`}}/resourceGroups/{{vm `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source</span>            <span class="token punctuation">=</span> <span class="token string">&quot;credativ:Debian:9:latest&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;source.azure-chroot.example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">provisioner<span class="token type variable"> &quot;shell&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">inline</span>         <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;apt-get update&quot;</span>, <span class="token string">&quot;apt-get upgrade -y&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">inline_shebang</span> <span class="token punctuation">=</span> <span class="token string">&quot;/bin/sh -x&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;azure-chroot&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;image_resource_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/subscriptions/{{vm `subscription_id`}}/resourceGroups/{{vm `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;source&quot;</span><span class="token operator">:</span> <span class="token string">&quot;credativ:Debian:9:latest&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;provisioners&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;inline&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;apt-get update&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;apt-get upgrade -y&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;inline_shebang&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/bin/sh -x&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shell&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h3 class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z" id="user-content-using-a-service-principal"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="Using a Service Principal permalink" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#using-a-service-principal"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Using a Service Principal</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Here is an example that creates a Debian image with updated packages. Specify
all environment variables (<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ARM_CLIENT_ID</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ARM_CLIENT_SECRET</code>,
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ARM_SUBSCRIPTION_ID</code>) to use a service principal.
The identity you choose should have permission to create disks and images and also
to update your VM.
Set the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ARM_IMAGE_RESOURCEGROUP_ID</code> variable to an existing resource group in the
subscription where the resulting image will be created.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>HCL2</strong></p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;client_id&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;client_secret&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;subscription_id&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span> <span class="token keyword">variable<span class="token type variable"> &quot;resource_group&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">source <span class="token string">&quot;azure-chroot&quot;</span> <span class="token string">&quot;basic-example&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">client_id</span> <span class="token punctuation">=</span> var.client_id<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">client_secret</span> <span class="token punctuation">=</span> var.client_secret<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">subscription_id</span> <span class="token punctuation">=</span> var.subscription_id<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">image_resource_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;/subscriptions/<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">subscription_id</span><span class="token punctuation">}</span></span>/resourceGroups/<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">resource_group</span><span class="token punctuation">}</span></span>/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source</span> <span class="token punctuation">=</span> <span class="token string">&quot;credativ:Debian:9:latest&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">build</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sources.azure-chroot.basic-example&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">provisioner<span class="token type variable"> &quot;shell&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">inline</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;apt-get update&quot;</span>, <span class="token string">&quot;apt-get upgrade -y&quot;</span><span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">inline_shebang</span> <span class="token punctuation">=</span> <span class="token string">&quot;/bin/sh -x&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>JSON</strong></p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;variables&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;client_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{{env `ARM_CLIENT_ID`}}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;client_secret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{{env `ARM_CLIENT_SECRET`}}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;subscription_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{{env `ARM_SUBSCRIPTION_ID`}}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;resource_group&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{{env `ARM_IMAGE_RESOURCEGROUP_ID`}}&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;builders&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;azure-chroot&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;client_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{{user `client_id`}}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;client_secret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{{user `client_secret`}}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;subscription_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{{user `subscription_id`}}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;image_resource_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/subscriptions/{{user `subscription_id`}}/resourceGroups/{{user `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;source&quot;</span><span class="token operator">:</span> <span class="token string">&quot;credativ:Debian:9:latest&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;provisioners&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;inline&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;apt-get update&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;apt-get upgrade -y&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;inline_shebang&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/bin/sh -x&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shell&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div></div></div></div></main><div class="sidebar-sidecar-layout_sidecarPosition__WtTq0"><div class="sidebar-sidecar-layout_sidecarTopSlot__qRAEI"></div><div class="sidecar-scroll-container_root__a8nIj"><div class="sidecar-scroll-container_scrollContainer__Dw9id"><div><nav aria-labelledby="react-aria-68"><p id="react-aria-68" class="outline-nav_navLabel__HrjQb hds-typography-body-100">On this page:</p><ol class="outline-nav_listRoot__Sm1fr"><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#how-does-it-work">How Does it Work?</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#configuration-reference">Configuration Reference</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#authentication-options">Authentication options</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#azure-chroot-builder-specific-options">Azure chroot builder specific options</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#required:">Required:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#optional:">Optional:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#output-options:">Output options:</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#chroot-mounts">Chroot Mounts</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#additional-template-function">Additional template function</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#build-shared-information-variables">Build Shared Information Variables</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#examples">Examples</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#using-a-vm-with-a-managed-identity">Using a VM with a Managed Identity</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/hashicorp-packer/packer/integrations/hashicorp/azure/latest/components/builder/chroot#using-a-service-principal">Using a Service Principal</a></li></ol></nav></div></div></div></div></div></div></div></div></div><div class="base-layout_footer__HGqK8 base-layout_showFooterTopBorder__4_CwH"><footer class="footer_root__qJO_k"><span class="footer_logoAndSwitcher__CJkN3"><a href="https://www.hashicorp.com/" aria-label="Go to HashiCorp home page" class="footer_logo__pe9i3 g-focus-ring-from-box-shadow"><div><svg width="317" height="88" viewBox="0 0 317 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M107.692 64.421V47.4h-14.97v17.02h-7.623V24.06h7.622v16.602h14.971V24.06h7.622v40.36h-7.622zm35.567-.001h-6.053l-.548-1.996a16.137 16.137 0 01-8.789 2.607c-5.397 0-7.699-3.697-7.699-8.79 0-5.998 2.607-8.3 8.606-8.3h7.089v-3.095c0-3.27-.907-4.421-5.633-4.421a41.255 41.255 0 00-8.179.877l-.907-5.634a38.496 38.496 0 0110.122-1.395c9.269 0 11.998 3.27 11.998 10.672l-.007 19.476zm-7.394-11.151h-5.45c-2.424 0-3.087.663-3.087 2.912 0 2.058.663 2.973 2.972 2.973a11.629 11.629 0 005.572-1.525l-.007-4.36zm21.701 11.754a34.776 34.776 0 01-10.183-1.7l1.029-5.633a33.038 33.038 0 008.788 1.273c3.271 0 3.758-.762 3.758-2.973 0-1.814-.366-2.729-5.152-3.88-7.211-1.76-8.058-3.575-8.058-9.269 0-5.938 2.607-8.545 11.03-8.545 2.98.003 5.949.348 8.85 1.03l-.762 5.876a51.98 51.98 0 00-8.118-.846c-3.209 0-3.758.763-3.758 2.546 0 2.363.183 2.546 4.185 3.575 8.263 2.188 9.055 3.278 9.055 9.307 0 5.725-1.761 9.239-10.664 9.239zm32.663-.602V43.84c0-1.578-.663-2.363-2.363-2.363-1.814 0-5.031 1.09-7.699 2.485v20.459h-7.394V22.847l7.394-1.029v15.33a26.045 26.045 0 0110.786-2.852c4.909 0 6.662 3.453 6.662 8.728v21.397h-7.386zm12.844-33.692v-8.545h7.394v8.545h-7.394zm0 33.692V34.906h7.394v29.515h-7.394zM215.62 35.15c0-7.394 4.299-11.693 14.361-11.693 3.697 0 7.38.447 10.969 1.334l-.839 6.601a59.517 59.517 0 00-9.909-1.029c-5.275 0-6.967 1.822-6.967 6.098v15.512c0 4.3 1.7 6.098 6.967 6.098a59.506 59.506 0 009.909-1.029l.846 6.609a45.672 45.672 0 01-10.968 1.334c-10.062 0-14.361-4.3-14.361-11.693l-.008-18.142zm40.499 29.873c-10.123 0-12.844-5.572-12.844-11.632v-7.455c0-6.06 2.728-11.632 12.844-11.632 10.115 0 12.844 5.572 12.844 11.632v7.455c-.023 6.06-2.744 11.632-12.844 11.632zm0-24.392c-3.941 0-5.45 1.76-5.45 5.092v7.912c0 3.331 1.524 5.092 5.45 5.092 3.925 0 5.45-1.76 5.45-5.092v-7.943c-.015-3.33-1.532-5.092-5.45-5.092v.03zm32.457.457a57.835 57.835 0 00-7.821 4.3v19.056h-7.394V34.906h6.243l.488 3.27a33.064 33.064 0 017.76-3.88l.724 6.792zm28.035 13.515c0 6.548-2.911 10.42-9.756 10.42a40.76 40.76 0 01-7.882-.853v12.196l-7.394 1.029V34.906h5.877l.762 2.485a15.535 15.535 0 019.33-3.087c5.938 0 9.086 3.514 9.086 10.245l-.023 10.054zm-17.631 3.331c2.152.474 4.346.73 6.548.763 2.668 0 3.697-1.274 3.697-3.941V44.35c0-2.424-.907-3.758-3.636-3.758a10.46 10.46 0 00-6.609 2.668v14.673zM29.134 7L0 23.808v40.361l10.946 6.32V30.127l18.188-10.504V7z" fill="#000"/><path d="M40.758 7v32.144H29.133V27.147l-10.945 6.319V74.65l10.946 6.335V48.932h11.624v11.914l10.946-6.312V13.32L40.758 7z" fill="#000"/><path d="M40.758 81L69.89 64.192V23.831l-10.946-6.32v40.362L40.758 68.377V81z" fill="#000"/></svg></div></a><span class="footer_themeSwitcher__CPJxw hds-font-weight-regular"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-82">Theme</label></span></span><ul class="footer_links__t81SU"><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="/hashicorp-packer/certifications"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Certifications</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://status.hashicorp.com"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">System Status</span></a></li><li><button class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Cookie Manager</span></button></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/terms-of-service"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Terms of Use</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/security"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Security</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/privacy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Privacy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trademark-policy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trademark Policy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trade-controls"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trade Controls</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="undefinedopens-in-new-tab-label-react-aria-90" target="_blank" href="https://forms.gle/fnHLuNahLEhjuKvE6"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Give Feedback</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-90">(opens in new tab)</span></li></ul></footer></div></div></div><div class="style_root__owpNH"></div><div style="position:fixed;z-index:99;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none;inset:24px"></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"metadata":{"title":"Azure Builder | Integrations"},"product":{"name":"Packer","slug":"packer","algoliaConfig":{"indexName":"product_PACKER","searchOnlyApiKey":"4e1ea7f4bf4335ac43d9f28463e42148"},"analyticsConfig":{"includedDomains":"packer.io www.packer.io","segmentWriteKey":"AjXdfmTTk1I9q9dfyePuDFHBrz1tCO3l"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Packer by HashiCorp","description":"Packer helps you create golden images for multiple platforms from a single source configuration.","image":"https://www.packer.io/packer-public/img/og-image.png","icon":[{"href":"/packer-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiConf","url":"https://hashiconf.com/2023?utm_source=direct\u0026utm_medium=banner\u0026utm_campaign=23Q3_HASHICONFGLOBAL_EVENT\u0026utm_content=\u0026utm_offer=event","text":"Our community conference is taking place in San Francisco and online October 10-12.","linkText":"Register now","expirationDate":""},"version":"1.7.10","basePaths":["docs","guides","intro","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"guide","name":"Guides","path":"guides"}],"integrationsConfig":{"description":"A curated collection of official, partner, and community Packer Integrations."}},"integration":{"id":"fbb2d9cf-2fc6-47db-8593-90e829ce6bfb","slug":"azure","name":"Azure","description":"Packer can create Azure virtual machine images through variety of ways depending on the strategy that you want to use for building the images.","license_type":null,"license_url":null,"external_only":false,"external_url":null,"tier":"official","repo_url":"https://github.com/hashicorp/packer-plugin-azure","subdirectory":"/.web-docs","created_at":"2022-11-09T22:56:33.296Z","updated_at":"2023-08-08T17:01:04.293Z","hide_versions":false,"organization":{"id":"a4a0551a-1451-4d89-9f56-8031c8350c77","slug":"hashicorp","created_at":"2022-11-09T22:56:32.391Z","updated_at":"2022-11-09T22:56:32.391Z"},"product":{"id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","slug":"packer","name":"Packer","created_at":"2022-11-09T22:56:29.896Z","updated_at":"2022-11-09T22:56:29.896Z"},"versions":["2.0.4","2.0.3","2.0.2","2.0.1","2.0.0","1.4.5","1.0.2","1.0.1","1.0.0"],"components":[{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders"},{"id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","slug":"provisioner","name":"Provisioner","plural_name":"Provisioners"}],"flags":[{"id":"3709e036-b45f-4be8-9043-f7c8cc2af00f","slug":"hcp-ready","name":"HCP Ready","description":"This integration has been tested to work with HashiCorp Cloud Platform (HCP)","created_at":"2022-11-09T22:56:30.673Z","updated_at":"2022-11-09T22:56:30.673Z"}],"integration_type":null},"activeRelease":{"id":"de917766-2908-45e4-ad61-19ce27f637cc","integration_id":"fbb2d9cf-2fc6-47db-8593-90e829ce6bfb","version":"2.0.4","readme":"The Azure plugin can be used with HashiCorp Packer to create custom images on Azure.\nTo do so, the plugin exposes multiple builders, among which you can choose the one most adapted to your workflow.\n\n## Installation\n\nTo install this plugin, copy and paste this code into your Packer configuration, then run [`packer init`](https://www.packer.io/docs/commands/init).\n\n```hcl\npacker {\n  required_plugins {\n    azure = {\n      source  = \"github.com/hashicorp/azure\"\n      version = \"~\u003e 2\"\n    }\n  }\n}\n```\n\nAlternatively, you can use `packer plugins install` to manage installation of this plugin.\n\n```sh\n$ packer plugins install github.com/hashicorp/azure\n```\n\n## Components\n\nPacker can create Azure virtual machine images through variety of ways depending on the strategy that you want to use for building the images.\n\n### Builders\n\n- [azure-arm](/packer/integrations/hashicorp/azure/latest/components/builder/arm) - The Azure ARM builder supports building Virtual Hard Disks (VHDs) and\n  Managed Images in Azure Resource Manager.\n- [azure-chroot](/packer/integrations/hashicorp/azure/latest/components/builder/chroot) - The Azure chroot builder supports building a managed disk image without\n  launching a new Azure VM for every build, but instead use an already-running Azure VM.\n- [azure-dtl](/packer/integrations/hashicorp/azure/latest/components/builder/dtl) - The Azure DevTest Labs builder builds custom images and uploads them to DevTest Lab image repository automatically.\n\n### Provisioners\n\n- [azure-dtlartifact](/packer/integrations/hashicorp/azure/latest/components/provisioner/dtlartifact) - The Azure DevTest Labs provisioner can be used to apply an artifact to a VM - Refer to [Add an artifact to a VM](https://docs.microsoft.com/en-us/azure/devtest-labs/add-artifact-vm)\n\n## Authentication\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/common/client/config.go; DO NOT EDIT MANUALLY --\u003e\n\nConfig allows for various ways to authenticate Azure clients.  When\n`client_id` and `subscription_id` are specified in addition to one and only\none of the following: `client_secret`, `client_jwt`, `client_cert_path` --\nPacker will use the specified Azure Active Directory (AAD) Service Principal\n(SP).\nIf none ofthese options are specified, Packer will attempt to use the Managed Identity\nand subscription of the VM that Packer is running on.  This will only work if\nPacker is running on an Azure VM with either a System Assigned Managed\nIdentity or User Assigned Managed Identity.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/common/client/config.go; --\u003e\n\n\n### Managed Identity\n\nIf you're running Packer on an Azure VM with a [managed\nidentity](https://packer.io/docs/builders/azure#azure-managed-identity) you\ndon't need to specify any additional configuration options. As Packer will\nattempt to use the Managed Identity and subscription of the VM that Packer is\nrunning on.\n\nYou can use a different subscription if you set `subscription_id`.  If your VM\nhas multiple user assigned managed identities you will need to set `client_id`\ntoo.\n\n### Interactive User Authentication\n\nTo use interactive user authentication, you should specify\n`use_interactive_auth` only.  Packer will use cached credentials or redirect you\nto a website to log in.\n\n### Service Principal\n\nTo use a [service principal](https://packer.io/docs/builders/azure#azure-active-directory-service-principal)\nyou should specify `subscription_id`, `client_id` and one of `client_secret`,\n`client_cert_path` or `client_jwt`.\n\n- `subscription_id` (string) - Subscription under which the build will be\n  performed. **The service principal specified in `client_id` must have full\n  access to this subscription, unless build_resource_group_name option is\n  specified in which case it needs to have owner access to the existing\n  resource group specified in build_resource_group_name parameter.**\n\n- `client_id` (string) - The Active Directory service principal associated with\n  your builder.\n\n- `client_secret` (string) - The password or secret for your service principal.\n\n- `client_cert_path` (string) - The location of a PEM file containing a\n  certificate and private key for service principal.\n\n- `client_cert_token_timeout` (duration string | ex: \"1h30m12s\") - How long to set the expire time on the token created when using\n  `client_cert_path`.\n\n- `client_jwt` (string) - The bearer JWT assertion signed using a certificate\n  associated with your service principal principal. See [Azure Active\n  Directory docs](https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-certificate-credentials)\n  for more information.\n\n## Troubleshooting\n\nAs with any Packer plugin, you may produce verbose logs to troubleshoot if the default output does not help narrow down the issue.\nTo do so, you can set the `PACKER_LOG` environment variable to a non-zero value (e.g. \"1\" or any non-empty string) to enable verbose logs that can help you figure out which part of the process errors, and hopefully why.\n\nIn addition to this, you may also enable the `PACKER_AZURE_DEBUG_LOG` environment variable alongside `PACKER_LOG` for visibility into the API calls being made to the Azure platform.\nEnabling this will add HTTP response inspection in the logs and the body sent with each request to the Azure APIs.\n\n~\u003e Warning: the `PACKER_AZURE_DEBUG_LOG` variable contains a high degree of verbosity and may expose sensitive information in the logs. For this reason, we strongly advise only enabling this in a trusted environment and only for a temporary debugging session.\n","created_at":"2024-02-22T15:44:29.362Z","updated_at":"2024-02-22T15:44:29.362Z","components":[{"id":"6b993cd8-25da-40d8-b50a-a6edb8fb7d8f","integration_release_id":"de917766-2908-45e4-ad61-19ce27f637cc","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `azure-arm`\nArtifact BuilderId: `Azure.ResourceManagement.VMImage`\n\nPacker supports building Virtual Hard Disks (VHDs) and Managed Images in [Azure Resource\nManager](https://azure.microsoft.com/en-us/documentation/articles/resource-group-overview/).\nAzure provides new users a [`$200` credit for the first 30\ndays](https://azure.microsoft.com/en-us/free/); after which you will incur\ncosts for VMs built and stored using Packer.\n\nAzure uses a combination of OAuth and Active Directory to authorize requests to\nthe ARM API. Learn how to [authorize access to\nARM](https://packer.io/docs/builder/azure#authentication-for-azure).\n\nThe documentation below references command output from the [Azure\nCLI](https://azure.microsoft.com/en-us/documentation/articles/xplat-cli-install/).\n\n## Configuration Reference\n\nThere are many configuration options available for the builder. We'll start\nwith authentication parameters, then go over the Azure ARM builder specific\noptions. In addition to the options listed here, a [communicator](https://packer.io/docs/templates/legacy_json_templates/communicator) can be configured for this builder.\n\n### Azure ARM builder specific options\n\nThe Azure builder can create either a VHD, managed image or create a Shared Image Gallery.\nIf you are creating a VHD, you **must** start with a VHD. Likewise, if you want to create\na managed image you **must** start with a managed image.\nManaged images can also be published to shared image galleries,\nbut a managed image definition is not required to publish to a gallery.\n\n### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/arm/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `image_publisher` (string) - Name of the publisher to use for your base image (Azure Marketplace Images only). See\n  [documentation](https://docs.microsoft.com/en-us/cli/azure/vm/image)\n  for details.\n  \n  CLI example `az vm image list-publishers --location westus`\n\n- `image_offer` (string) - Name of the publisher's offer to use for your base image (Azure Marketplace Images only). See\n  [documentation](https://docs.microsoft.com/en-us/cli/azure/vm/image)\n  for details.\n  \n  CLI example\n  `az vm image list-offers --location westus --publisher Canonical`\n\n- `image_sku` (string) - SKU of the image offer to use for your base image (Azure Marketplace Images only). See\n  [documentation](https://docs.microsoft.com/en-us/cli/azure/vm/image)\n  for details.\n  \n  CLI example\n  `az vm image list-skus --location westus --publisher Canonical --offer UbuntuServer`\n\n- `image_url` (string) - URL to a custom VHD to use for your base image. If this value is set,\n  image_publisher, image_offer, image_sku, or image_version should not be set.\n\n- `custom_managed_image_name` (string) - Name of a custom managed image to use for your base image. If this value is set, do\n  not set image_publisher, image_offer, image_sku, or image_version.\n  If this value is set, the option\n  `custom_managed_image_resource_group_name` must also be set. See\n  [documentation](https://docs.microsoft.com/en-us/azure/storage/storage-managed-disks-overview#images)\n  to learn more about managed images.\n\n- `custom_managed_image_resource_group_name` (string) - Name of a custom managed image's resource group to use for your base image. If this\n  value is set, image_publisher, image_offer, image_sku, or image_version should not be set.\n  If this value is set, the option\n  `custom_managed_image_name` must also be set. See\n  [documentation](https://docs.microsoft.com/en-us/azure/storage/storage-managed-disks-overview#images)\n  to learn more about managed images.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/arm/config.go; --\u003e\n\n\nWhen creating a VHD the following additional options are required:\n\n- `capture_container_name` (string) - Destination container name. Essentially\n  the \"directory\" where your VHD will be organized in Azure. The captured\n  VHD's URL will be\n  `https://\u003cstorage_account\u003e.blob.core.windows.net/system/Microsoft.Compute/Images/\u003ccapture_container_name\u003e/\u003ccapture_name_prefix\u003e.xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.vhd`.\n\n- `capture_name_prefix` (string) - VHD prefix. The final artifacts will be\n  named `PREFIX-osDisk.UUID` and `PREFIX-vmTemplate.UUID`.\n\n- `resource_group_name` (string) - Resource group under which the final\n  artifact will be stored.\n\n- `storage_account` (string) - Storage account under which the final artifact\n  will be stored.\n\nWhen creating a managed image the following additional options are required:\n\n- `managed_image_name` (string) - Specify the managed image name where the\n  result of the Packer build will be saved. The image name must not exist\n  ahead of time, and will not be overwritten. If this value is set, the value\n  `managed_image_resource_group_name` must also be set. See\n  [documentation](https://docs.microsoft.com/en-us/azure/storage/storage-managed-disks-overview#images)\n  to learn more about managed images.\n\n- `managed_image_resource_group_name` (string) - Specify the managed image\n  resource group name where the result of the Packer build will be saved. The\n  resource group must already exist. If this value is set, the value\n  `managed_image_name` must also be set. See\n  [documentation](https://docs.microsoft.com/en-us/azure/storage/storage-managed-disks-overview#images)\n  to learn more about managed images.\n\nCreating a managed image using a [Shared Gallery image](https://azure.microsoft.com/en-us/blog/announcing-the-public-preview-of-shared-image-gallery/) as the source can be achieved by specifying the [shared_image_gallery](#shared-image-gallery) configuration option.\n\n#### Resource Group Usage\n\nThe Azure builder can either provision resources into a new resource group that\nit controls (default) or an existing one. The advantage of using a packer\ndefined resource group is that failed resource cleanup is easier because you\ncan simply remove the entire resource group, however this means that the\nprovided credentials must have permission to create and remove resource groups.\nBy using an existing resource group you can scope the provided credentials to\njust this group, however failed builds are more likely to leave unused\nartifacts.\n\nTo have Packer create a resource group you **must** provide:\n\n- `location` (string) Azure datacenter in which your VM will build.\n\n  CLI example `az account list-locations`\n\nand optionally:\n\n- `temp_resource_group_name` (string) name assigned to the temporary resource\n  group created during the build. If this value is not set, a random value\n  will be assigned. This resource group is deleted at the end of the build.\n\nTo use an existing resource group you **must** provide:\n\n- `build_resource_group_name` (string) - Specify an existing resource group\n  to run the build in.\n\nProviding `temp_resource_group_name` or `location` in combination with\n`build_resource_group_name` is not allowed.\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/arm/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `user_assigned_managed_identities` ([]string) - A list of one or more fully-qualified resource IDs of user assigned\n  managed identities to be configured on the VM.\n  See [documentation](https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/how-to-use-vm-token)\n  for how to acquire tokens within the VM.\n  To assign a user assigned managed identity to a VM, the provided account or service principal must have [Managed Identity Operator](https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#managed-identity-operator)\n  and [Virtual Machine Contributor](https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#virtual-machine-contributor) role assignments.\n\n- `capture_name_prefix` (string) - VHD prefix.\n\n- `capture_container_name` (string) - Destination container name.\n\n- `shared_image_gallery` (SharedImageGallery) - Use a [Shared Gallery\n  image](https://azure.microsoft.com/en-us/blog/announcing-the-public-preview-of-shared-image-gallery/)\n  as the source for this build. *VHD targets are incompatible with this\n  build type* - the target must be a *Managed Image*. When using shared_image_gallery as a source, image_publisher,\n  image_offer, image_sku, image_version, and custom_managed_image_name should not be set.\n  \n  In JSON\n  ```json\n  \"shared_image_gallery\": {\n      \"subscription\": \"00000000-0000-0000-0000-00000000000\",\n      \"resource_group\": \"ResourceGroup\",\n      \"gallery_name\": \"GalleryName\",\n      \"image_name\": \"ImageName\",\n      \"image_version\": \"1.0.0\",\n  }\n  \"managed_image_name\": \"TargetImageName\",\n  \"managed_image_resource_group_name\": \"TargetResourceGroup\"\n  ```\n  In HCL2\n  ```hcl\n  shared_image_gallery {\n      subscription = \"00000000-0000-0000-0000-00000000000\"\n      resource_group = \"ResourceGroup\"\n      gallery_name = \"GalleryName\"\n      image_name = \"ImageName\"\n      image_version = \"1.0.0\"\n  }\n  managed_image_name = \"TargetImageName\"\n  managed_image_resource_group_name = \"TargetResourceGroup\"\n  ```\n\n- `shared_image_gallery_destination` (SharedImageGalleryDestination) - The name of the Shared Image Gallery under which the managed image will be published as Shared Gallery Image version.\n  \n  Following is an example.\n  \n  In JSON\n  ```json\n  \"shared_image_gallery_destination\": {\n      \"subscription\": \"00000000-0000-0000-0000-00000000000\",\n      \"resource_group\": \"ResourceGroup\",\n      \"gallery_name\": \"GalleryName\",\n      \"image_name\": \"ImageName\",\n      \"image_version\": \"1.0.0\",\n      \"replication_regions\": [\"regionA\", \"regionB\", \"regionC\"],\n      \"storage_account_type\": \"Standard_LRS\"\n  }\n  \"managed_image_name\": \"TargetImageName\",\n  \"managed_image_resource_group_name\": \"TargetResourceGroup\"\n  ```\n  In HCL2\n  ```hcl\n  shared_image_gallery_destination {\n      subscription = \"00000000-0000-0000-0000-00000000000\"\n      resource_group = \"ResourceGroup\"\n      gallery_name = \"GalleryName\"\n      image_name = \"ImageName\"\n      image_version = \"1.0.0\"\n      storage_account_type = \"Standard_LRS\"\n      target_region {\n        name = \"regionA\"\n      }\n      target_region {\n        name = \"regionB\"\n      }\n      target_region {\n        name = \"regionC\"\n      }\n  }\n  managed_image_name = \"TargetImageName\"\n  managed_image_resource_group_name = \"TargetResourceGroup\"\n  ```\n\n- `shared_image_gallery_timeout` (duration string | ex: \"1h5m2s\") - How long to wait for an image to be published to the shared image\n  gallery before timing out. If your Packer build is failing on the\n  Publishing to Shared Image Gallery step with the error `Original Error:\n  context deadline exceeded`, but the image is present when you check your\n  Azure dashboard, then you probably need to increase this timeout from\n  its default of \"60m\" (valid time units include `s` for seconds, `m` for\n  minutes, and `h` for hours.)\n\n- `shared_gallery_image_version_end_of_life_date` (string) - The end of life date (2006-01-02T15:04:05.99Z) of the gallery Image Version. This property\n  can be used for decommissioning purposes.\n\n- `shared_image_gallery_replica_count` (int64) - The number of replicas of the Image Version to be created per region.\n  Replica count must be between 1 and 100, but 50 replicas should be sufficient for most use cases.\n  When using shallow replication `use_shallow_replication=true` the value can only be 1.\n\n- `shared_gallery_image_version_exclude_from_latest` (bool) - If set to true, Virtual Machines deployed from the latest version of the\n  Image Definition won't use this Image Version.\n\n- `image_version` (string) - Specify a specific version of an OS to boot from.\n  Defaults to `latest`. There may be a difference in versions available\n  across regions due to image synchronization latency. To ensure a consistent\n  version across regions set this value to one that is available in all\n  regions where you are deploying.\n  \n  CLI example\n  `az vm image list --location westus --publisher Canonical --offer UbuntuServer --sku 16.04.0-LTS --all`\n\n- `location` (string) - Azure datacenter in which your VM will build.\n\n- `vm_size` (string) - Size of the VM used for building. This can be changed when you deploy a\n  VM from your VHD. See\n  [pricing](https://azure.microsoft.com/en-us/pricing/details/virtual-machines/)\n  information. Defaults to `Standard_A1`.\n  \n  CLI example `az vm list-sizes --location westus`\n\n- `spot` (Spot) - If set use a spot instance during build; spot configuration settings only apply to the virtual machine launched by Packer and will not be persisted on the resulting image artifact.\n  \n  Following is an example.\n  \n  In JSON\n  \n  ```json\n  \"spot\": {\n      \"eviction_policy\": \"Delete\",\n  \t   \"max_price\": \"0.4\",\n  }\n  ```\n  \n  In HCL2\n  \n  ```hcl\n  spot {\n      eviction_policy = \"Delete\"\n      max_price = \"0.4\"\n  }\n  ```\n\n- `managed_image_resource_group_name` (string) - Specify the managed image resource group name where the result of the\n  Packer build will be saved. The resource group must already exist. If\n  this value is set, the value managed_image_name must also be set. See\n  documentation to learn more about managed images.\n\n- `managed_image_name` (string) - Specify the managed image name where the result of the Packer build will\n  be saved. The image name must not exist ahead of time, and will not be\n  overwritten. If this value is set, the value\n  managed_image_resource_group_name must also be set. See documentation to\n  learn more about managed images.\n\n- `managed_image_storage_account_type` (string) - Specify the storage account\n  type for a managed image. Valid values are Standard_LRS and Premium_LRS.\n  The default is Standard_LRS.\n\n- `managed_image_os_disk_snapshot_name` (string) - If\n  managed_image_os_disk_snapshot_name is set, a snapshot of the OS disk\n  is created with the same name as this value before the VM is captured.\n\n- `managed_image_data_disk_snapshot_prefix` (string) - If\n  managed_image_data_disk_snapshot_prefix is set, snapshot of the data\n  disk(s) is created with the same prefix as this value before the VM is\n  captured.\n\n- `keep_os_disk` (bool) - If\n  keep_os_disk is set, the OS disk is not deleted.\n  The default is false.\n\n- `managed_image_zone_resilient` (bool) - Store the image in zone-resilient storage. You need to create it in a\n  region that supports [availability\n  zones](https://docs.microsoft.com/en-us/azure/availability-zones/az-overview).\n\n- `azure_tags` (map[string]string) - Name/value pair tags to apply to every resource deployed i.e. Resource\n  Group, VM, NIC, VNET, Public IP, KeyVault, etc. The user can define up\n  to 15 tags. Tag names cannot exceed 512 characters, and tag values\n  cannot exceed 256 characters.\n\n- `azure_tag` ([]{name string, value string}) - Same as [`azure_tags`](#azure_tags) but defined as a singular repeatable block\n  containing a `name` and a `value` field. In HCL2 mode the\n  [`dynamic_block`](/packer/docs/templates/hcl_templates/expressions#dynamic-blocks)\n  will allow you to create those programatically.\n\n- `resource_group_name` (string) - Resource group under which the final artifact will be stored.\n\n- `storage_account` (string) - Storage account under which the final artifact will be stored.\n\n- `temp_compute_name` (string) - temporary name assigned to the VM. If this\n  value is not set, a random value will be assigned. Knowing the resource\n  group and VM name allows one to execute commands to update the VM during a\n  Packer build, e.g. attach a resource disk to the VM.\n\n- `temp_nic_name` (string) - temporary name assigned to the Nic. If this\n  value is not set, a random value will be assigned. Being able to assign a custom\n  nicname could ease deployment if naming conventions are used.\n\n- `temp_resource_group_name` (string) - name assigned to the temporary resource group created during the build.\n  If this value is not set, a random value will be assigned. This resource\n  group is deleted at the end of the build.\n\n- `build_resource_group_name` (string) - Specify an existing resource group to run the build in.\n\n- `build_key_vault_name` (string) - Specify an existing key vault to use for uploading the certificate for the\n  instance to connect.\n\n- `build_key_vault_secret_name` (string) - Specify the secret name to use for the certificate created in the key vault.\n\n- `build_key_vault_sku` (string) - Specify the KeyVault SKU to create during the build. Valid values are\n  standard or premium. The default value is standard.\n\n- `disk_encryption_set_id` (string) - Specify the Disk Encryption Set ID to use to encrypt the OS and data disks created with the VM during the build\n  Only supported when publishing to Shared Image Galleries, without a managed image\n  The disk encryption set ID can be found in the properties tab of a disk encryption set on the Azure Portal, and is labeled as its resource ID\n  https://learn.microsoft.com/en-us/azure/virtual-machines/image-version-encryption\n\n- `private_virtual_network_with_public_ip` (bool) - This value allows you to\n  set a virtual_network_name and obtain a public IP. If this value is not\n  set and virtual_network_name is defined Packer is only allowed to be\n  executed from a host on the same subnet / virtual network.\n\n- `virtual_network_name` (string) - Use a pre-existing virtual network for the\n  VM. This option enables private communication with the VM, no public IP\n  address is used or provisioned (unless you set\n  private_virtual_network_with_public_ip).\n\n- `virtual_network_subnet_name` (string) - If virtual_network_name is set,\n  this value may also be set. If virtual_network_name is set, and this\n  value is not set the builder attempts to determine the subnet to use with\n  the virtual network. If the subnet cannot be found, or it cannot be\n  disambiguated, this value should be set.\n\n- `virtual_network_resource_group_name` (string) - If virtual_network_name is\n  set, this value may also be set. If virtual_network_name is set, and\n  this value is not set the builder attempts to determine the resource group\n  containing the virtual network. If the resource group cannot be found, or\n  it cannot be disambiguated, this value should be set.\n\n- `custom_data_file` (string) - Specify a file containing custom data to inject into the cloud-init\n  process. The contents of the file are read and injected into the ARM\n  template. The custom data will be passed to cloud-init for processing at\n  the time of provisioning. See\n  [documentation](http://cloudinit.readthedocs.io/en/latest/topics/examples.html)\n  to learn more about custom data, and how it can be used to influence the\n  provisioning process.\n\n- `custom_data` (string) - Specify a Base64-encode custom data to apply when launching the instance.\n  Note that you need to be careful about escaping characters due to the templates being JSON.\n  The custom data will be passed to cloud-init for processing at\n  the time of provisioning. See\n  [documentation](http://cloudinit.readthedocs.io/en/latest/topics/examples.html)\n  to learn more about custom data, and how it can be used to influence the\n  provisioning process.\n\n- `user_data_file` (string) - Specify a file containing user data to inject into the cloud-init\n  process. The contents of the file are read and injected into the ARM\n  template. The user data will be available from the provision until the vm is\n  deleted. Any application on the virtual machine can access the user data\n  from the Azure Instance Metadata Service (IMDS) after provision.\n  See [documentation](https://docs.microsoft.com/en-us/azure/virtual-machines/user-data)\n  to learn more about user data.\n\n- `user_data` (string) - Specify a Base64-encode user data to apply\n  Note that you need to be careful about escaping characters due to the templates being JSON.\n  The user data will be available from the provision until the vm is\n  deleted. Any application on the virtual machine can access the user data\n  from the Azure Instance Metadata Service (IMDS) after provision.\n  See [documentation](https://docs.microsoft.com/en-us/azure/virtual-machines/user-data)\n  to learn more about user data.\n\n- `custom_script` (string) - Used for running a script on VM provision during the image build\n  The following example executes the contents of the file specified by `user_data_file`:\n   ```hcl2\n   custom_script   = \"powershell -ExecutionPolicy Unrestricted -NoProfile -NonInteractive -Command \\\"$userData = (Invoke-RestMethod -Headers @{Metadata=$true} -Method GET -Uri http://169.254.169.254/metadata/instance/compute/userData?api-version=2021-01-01$([char]38)format=text); $contents = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($userData)); set-content -path c:\\\\Windows\\\\Temp\\\\userdata.ps1 -value $contents; . c:\\\\Windows\\\\Temp\\\\userdata.ps1;\\\"\"\n   user_data_file  = \"./scripts/userdata.ps1\"\n   ```\n  Specify a command to inject into the CustomScriptExtension, to run on startup\n  on Windows builds, before the communicator attempts to connect\n  See [documentation](https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/custom-script-windows)\n  to learn more.\n\n- `plan_info` (PlanInformation) - Used for creating images from Marketplace images. Please refer to\n  [Deploy an image with Marketplace\n  terms](https://aka.ms/azuremarketplaceapideployment) for more details.\n  Not all Marketplace images support programmatic deployment, and support\n  is controlled by the image publisher.\n  \n  An example plan\\_info object is defined below.\n  \n  ```json\n  {\n    \"plan_info\": {\n        \"plan_name\": \"rabbitmq\",\n        \"plan_product\": \"rabbitmq\",\n        \"plan_publisher\": \"bitnami\"\n    }\n  }\n  ```\n  \n  `plan_name` (string) - The plan name, required. `plan_product` (string) -\n  The plan product, required. `plan_publisher` (string) - The plan publisher,\n  required. `plan_promotion_code` (string) - Some images accept a promotion\n  code, optional.\n  \n  Images created from the Marketplace with `plan_info` **must** specify\n  `plan_info` whenever the image is deployed. The builder automatically adds\n  tags to the image to ensure this information is not lost. The following\n  tags are added.\n  \n  ```text\n  1.  PlanName\n  2.  PlanProduct\n  3.  PlanPublisher\n  4.  PlanPromotionCode\n  ```\n\n- `polling_duration_timeout` (duration string | ex: \"1h5m2s\") - The default PollingDuration for azure is 15mins, this property will override\n  that value.\n  If your Packer build is failing on the\n  ARM deployment step with the error `Original Error:\n  context deadline exceeded`, then you probably need to increase this timeout from\n  its default of \"15m\" (valid time units include `s` for seconds, `m` for\n  minutes, and `h` for hours.)\n\n- `os_type` (string) - If either Linux or Windows is specified Packer will\n  automatically configure authentication credentials for the provisioned\n  machine. For Linux this configures an SSH authorized key. For Windows\n  this configures a WinRM certificate.\n\n- `winrm_expiration_time` (duration string | ex: \"1h5m2s\") - A time duration with which to set the WinRM certificate to expire\n  This only works for Windows builds (valid time units include `s` for seconds, `m` for\n  minutes, and `h` for hours.)\n\n- `temp_os_disk_name` (string) - temporary name assigned to the OSDisk. If this\n  value is not set, a random value will be assigned. Being able to assign a custom\n  osDiskName could ease deployment if naming conventions are used.\n\n- `os_disk_size_gb` (int32) - Specify the size of the OS disk in GB\n  (gigabytes). Values of zero or less than zero are ignored.\n\n- `disk_additional_size` ([]int32) - The size(s) of any additional hard disks for the VM in gigabytes. If\n  this is not specified then the VM will only contain an OS disk. The\n  number of additional disks and maximum size of a disk depends on the\n  configuration of your VM. See\n  [Windows](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/about-disks-and-vhds)\n  or\n  [Linux](https://docs.microsoft.com/en-us/azure/virtual-machines/linux/about-disks-and-vhds)\n  for more information.\n  \n  For VHD builds the final artifacts will be named\n  `PREFIX-dataDisk-\u003cn\u003e.UUID.vhd` and stored in the specified capture\n  container along side the OS disk. The additional disks are included in\n  the deployment template `PREFIX-vmTemplate.UUID`.\n  \n  For Managed build the final artifacts are included in the managed image.\n  The additional disk will have the same storage account type as the OS\n  disk, as specified with the `managed_image_storage_account_type`\n  setting.\n\n- `disk_caching_type` (string) - Specify the disk caching type. Valid values\n  are None, ReadOnly, and ReadWrite. The default value is ReadWrite.\n\n- `allowed_inbound_ip_addresses` ([]string) - Specify the list of IP addresses and CIDR blocks that should be\n  allowed access to the VM. If provided, an Azure Network Security\n  Group will be created with corresponding rules and be bound to\n  the subnet of the VM.\n  Providing `allowed_inbound_ip_addresses` in combination with\n  `virtual_network_name` is not allowed.\n\n- `boot_diag_storage_account` (string) - Specify storage to store Boot Diagnostics -- Enabling this option\n  will create 2 Files in the specified storage account. (serial console log \u0026 screehshot file)\n  once the build is completed, it has to be removed manually.\n  see [here](https://docs.microsoft.com/en-us/azure/virtual-machines/troubleshooting/boot-diagnostics) for more info\n\n- `custom_resource_build_prefix` (string) - specify custom azure resource names during build limited to max 10 characters\n  this will set the prefix for the resources. The actuall resource names will be\n  `custom_resource_build_prefix` + resourcetype + 5 character random alphanumeric string\n\n- `license_type` (string) - Specify a license type for the build VM to enable Azure Hybrid Benefit. If not set, Pay-As-You-Go license\n  model (default) will be used. Valid values are:\n  \n  For Windows:\n  - `Windows_Client`\n  - `Windows_Server`\n  \n  For Linux:\n  - `RHEL_BYOS`\n  - `SLES_BYOS`\n  \n  Refer to the following documentation for more information about Hybrid Benefit:\n  [Windows](https://learn.microsoft.com/en-us/azure/virtual-machines/windows/hybrid-use-benefit-licensing)\n  or\n  [Linux](https://learn.microsoft.com/en-us/azure/virtual-machines/linux/azure-hybrid-benefit-linux)\n\n- `secure_boot_enabled` (bool) - Specifies if Secure Boot and Trusted Launch is enabled for the Virtual Machine.\n\n- `encryption_at_host` (\\*bool) - Specifies if Encryption at host is enabled for the Virtual Machine.\n  Requires enabling encryption at host in the Subscription read more [here](https://learn.microsoft.com/en-us/azure/virtual-machines/disks-enable-host-based-encryption-portal?tabs=azure-powershell)\n\n- `vtpm_enabled` (bool) - Specifies if vTPM (virtual Trusted Platform Module) and Trusted Launch is enabled for the Virtual Machine.\n\n- `async_resourcegroup_delete` (bool) - If you want packer to delete the\n  temporary resource group asynchronously set this value. It's a boolean\n  value and defaults to false. Important Setting this true means that\n  your builds are faster, however any failed deletes are not reported.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/arm/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/common/client/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `cloud_environment_name` (string) - One of Public, China, or\n  USGovernment. Defaults to Public. Long forms such as\n  USGovernmentCloud and AzureUSGovernmentCloud are also supported.\n\n- `metadata_host` (string) - The Hostname of the Azure Metadata Service\n  (for example management.azure.com), used to obtain the Cloud Environment\n  when using a Custom Azure Environment. This can also be sourced from the\n  ARM_METADATA_HOST Environment Variable.\n  Note: CloudEnvironmentName must be set to the requested environment\n  name in the list of available environments held in the metadata_host.\n\n- `client_id` (string) - The application ID of the AAD Service Principal.\n  Requires either `client_secret`, `client_cert_path` or `client_jwt` to be set as well.\n\n- `client_secret` (string) - A password/secret registered for the AAD SP.\n\n- `client_cert_path` (string) - The path to a PKCS#12 bundle (.pfx file) to be used as the client certificate\n  that will be used to authenticate as the specified AAD SP.\n\n- `client_cert_password` (string) - The password for decrypting the client certificate bundle.\n\n- `client_jwt` (string) - A JWT bearer token for client auth (RFC 7523, Sec. 2.2) that will be used\n  to authenticate the AAD SP. Provides more control over token the expiration\n  when using certificate authentication than when using `client_cert_path`.\n\n- `object_id` (string) - The object ID for the AAD SP. Optional, will be derived from the oAuth token if left empty.\n\n- `tenant_id` (string) - The Active Directory tenant identifier with which your `client_id` and\n  `subscription_id` are associated. If not specified, `tenant_id` will be\n  looked up using `subscription_id`.\n\n- `subscription_id` (string) - The subscription to use.\n\n- `use_azure_cli_auth` (bool) - Flag to use Azure CLI authentication. Defaults to false.\n  CLI auth will use the information from an active `az login` session to connect to Azure and set the subscription id and tenant id associated to the signed in account.\n  If enabled, it will use the authentication provided by the `az` CLI.\n  Azure CLI authentication will use the credential marked as `isDefault` and can be verified using `az account show`.\n  Works with normal authentication (`az login`) and service principals (`az login --service-principal --username APP_ID --password PASSWORD --tenant TENANT_ID`).\n  Ignores all other configurations if enabled.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/common/client/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/common/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `skip_create_image` (bool) - Skip creating the image.\n  Useful for setting to `true` during a build test stage.\n  Defaults to `false`.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/common/config.go; --\u003e\n\n\n\n### Shared Image Gallery\n\nThe shared_image_gallery block is available for building a new image from a private or [community shared imaged gallery](https://docs.microsoft.com/en-us/azure/virtual-machines/azure-compute-gallery#community-gallery-preview) owned gallery.\n\n\u003c!-- Code generated from the comments of the SharedImageGallery struct in builder/azure/arm/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `subscription` (string) - Subscription\n\n- `resource_group` (string) - Resource Group\n\n- `gallery_name` (string) - Gallery Name\n\n- `image_name` (string) - Image Name\n\n- `image_version` (string) - Specify a specific version of an OS to boot from.\n  Defaults to latest. There may be a difference in versions available\n  across regions due to image synchronization latency. To ensure a consistent\n  version across regions set this value to one that is available in all\n  regions where you are deploying.\n\n- `community_gallery_image_id` (string) - Id of the community gallery image : /CommunityGalleries/{galleryUniqueName}/Images/{img}[/Versions/{}] (Versions part is optional)\n\n- `direct_shared_gallery_image_id` (string) - Id of the direct shared gallery image : /sharedGalleries/{galleryUniqueName}/Images/{img}[/Versions/{}] (Versions part is optional)\n\n\u003c!-- End of code generated from the comments of the SharedImageGallery struct in builder/azure/arm/config.go; --\u003e\n\n\n\n### Shared Image Gallery Destination\n\nThe shared_image_gallery_destination block is available for publishing a new image version to an existing shared image gallery.\n\n\u003c!-- Code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/arm/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `subscription` (string) - Sig Destination Subscription\n\n- `resource_group` (string) - Sig Destination Resource Group\n\n- `gallery_name` (string) - Sig Destination Gallery Name\n\n- `image_name` (string) - Sig Destination Image Name\n\n- `image_version` (string) - Sig Destination Image Version\n\n- `replication_regions` ([]string) - A list of regions to replicate the image version in, by default the build location will be used as a replication region (the build location is either set in the location field, or the location of the resource group used in `build_resource_group_name` will be included.\n  Can not contain any region but the build region when using shallow replication\n\n- `target_region` ([]TargetRegion) - A target region to store the image version in. The attribute supersedes `replication_regions` which is now considered deprecated.\n  One or more target_region blocks can be specified for storing an imager version to various regions. In addition to specifying a region,\n  a DiskEncryptionSetId can be specified for each target region to support multi-region disk encryption.\n  At a minimum their must be one target region entry for the primary build region where the image version will be stored.\n  Target region must only contain one entry matching the build region when using shallow replication.\n\n- `storage_account_type` (string) - Specify a storage account type for the Shared Image Gallery Image Version.\n  Defaults to `Standard_LRS`. Accepted values are `Standard_LRS`, `Standard_ZRS` and `Premium_LRS`\n\n- `specialized` (bool) - Set to true if publishing to a Specialized Gallery, this skips a call to set the build VM's OS state as Generalized\n\n- `use_shallow_replication` (bool) - Setting a `shared_image_gallery_replica_count` or any `replication_regions` is unnecessary for shallow builds, as they can only replicate to the build region and must have a replica count of 1\n  Refer to [Shallow Replication](https://learn.microsoft.com/en-us/azure/virtual-machines/shared-image-galleries?tabs=azure-cli#shallow-replication) for details on when to use shallow replication mode.\n\n\u003c!-- End of code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/arm/config.go; --\u003e\n\n\n\n### Spot\n\nThe `spot` block is available to use a spot instance during build.\n\n\u003c!-- Code generated from the comments of the Spot struct in builder/azure/arm/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `eviction_policy` (virtualmachines.VirtualMachineEvictionPolicyTypes) - Specify eviction policy for spot instance: \"Deallocate\" or \"Delete\". If this is set, a spot instance will be used.\n\n- `max_price` (float32) - How much should the VM cost maximally per hour. Specify -1 (or do not specify) to not evict based on price.\n\n\u003c!-- End of code generated from the comments of the Spot struct in builder/azure/arm/config.go; --\u003e\n\n\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](https://packer.io/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](https://packer.io/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `SourceImageName` - The full name of the source image used in the deployment. When using\nshared images the resulting name will point to the actual source used to create the said version.\n  building the AMI.\n\nUsage example:\n\n**HCL2**\n\n```hcl\n// When accessing one of these variables from inside the builder, you need to\n// use the golang templating syntax. This is due to an architectural quirk that\n// won't be easily resolvable until legacy json templates are deprecated:\n\n{\nsource \"azure-arm\" \"basic-example\" {\n  os_type = \"Linux\"\n  image_publisher = \"Canonical\"\n  image_offer = \"UbuntuServer\"\n  image_sku = \"14.04.4-LTS\"\n}\n\n// when accessing one of the variables from a provisioner or post-processor, use\n// hcl-syntax\npost-processor \"manifest\" {\n    output = \"manifest.json\"\n    strip_path = true\n    custom_data = {\n        source_image_name = \"${build.SourceImageName}\"\n    }\n}\n```\n**JSON**\n\n```json\n\"post-processors\": [\n  {\n    \"type\": \"manifest\",\n    \"output\": \"manifest.json\",\n    \"strip_path\": true,\n    \"custom_data\": {\n      \"source_image_name\": \"{{ build `SourceImageName` }}\"\n    }\n  }\n]\n```\n\n\n### Communicator Config\n\nIn addition to the builder options, a communicator may also be defined:\n\n\u003c!-- Code generated from the comments of the Config struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `communicator` (string) - Packer currently supports three kinds of communicators:\n  \n  -   `none` - No communicator will be used. If this is set, most\n      provisioners also can't be used.\n  \n  -   `ssh` - An SSH connection will be established to the machine. This\n      is usually the default.\n  \n  -   `winrm` - A WinRM connection will be established.\n  \n  In addition to the above, some builders have custom communicators they\n  can use. For example, the Docker builder has a \"docker\" communicator\n  that uses `docker exec` and `docker cp` to execute scripts and copy\n  files.\n\n- `pause_before_connecting` (duration string | ex: \"1h5m2s\") - We recommend that you enable SSH or WinRM as the very last step in your\n  guest's bootstrap script, but sometimes you may have a race condition\n  where you need Packer to wait before attempting to connect to your\n  guest.\n  \n  If you end up in this situation, you can use the template option\n  `pause_before_connecting`. By default, there is no pause. For example if\n  you set `pause_before_connecting` to `10m` Packer will check whether it\n  can connect, as normal. But once a connection attempt is successful, it\n  will disconnect and then wait 10 minutes before connecting to the guest\n  and beginning provisioning.\n\n\u003c!-- End of code generated from the comments of the Config struct in communicator/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SSH struct in communicator/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `ssh_host` (string) - The address to SSH to. This usually is automatically configured by the\n  builder.\n\n- `ssh_port` (int) - The port to connect to SSH. This defaults to `22`.\n\n- `ssh_username` (string) - The username to connect to SSH with. Required if using SSH.\n\n- `ssh_password` (string) - A plaintext password to use to authenticate with SSH.\n\n- `ssh_ciphers` ([]string) - This overrides the value of ciphers supported by default by Golang.\n  The default value is [\n    \"aes128-gcm@openssh.com\",\n    \"chacha20-poly1305@openssh.com\",\n    \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n  ]\n  \n  Valid options for ciphers include:\n  \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\", \"aes128-gcm@openssh.com\",\n  \"chacha20-poly1305@openssh.com\",\n  \"arcfour256\", \"arcfour128\", \"arcfour\", \"aes128-cbc\", \"3des-cbc\",\n\n- `ssh_clear_authorized_keys` (bool) - If true, Packer will attempt to remove its temporary key from\n  `~/.ssh/authorized_keys` and `/root/.ssh/authorized_keys`. This is a\n  mostly cosmetic option, since Packer will delete the temporary private\n  key from the host system regardless of whether this is set to true\n  (unless the user has set the `-debug` flag). Defaults to \"false\";\n  currently only works on guests with `sed` installed.\n\n- `ssh_key_exchange_algorithms` ([]string) - If set, Packer will override the value of key exchange (kex) algorithms\n  supported by default by Golang. Acceptable values include:\n  \"curve25519-sha256@libssh.org\", \"ecdh-sha2-nistp256\",\n  \"ecdh-sha2-nistp384\", \"ecdh-sha2-nistp521\",\n  \"diffie-hellman-group14-sha1\", and \"diffie-hellman-group1-sha1\".\n\n- `ssh_certificate_file` (string) - Path to user certificate used to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_pty` (bool) - If `true`, a PTY will be requested for the SSH connection. This defaults\n  to `false`.\n\n- `ssh_timeout` (duration string | ex: \"1h5m2s\") - The time to wait for SSH to become available. Packer uses this to\n  determine when the machine has booted so this is usually quite long.\n  Example value: `10m`.\n  This defaults to `5m`, unless `ssh_handshake_attempts` is set.\n\n- `ssh_disable_agent_forwarding` (bool) - If true, SSH agent forwarding will be disabled. Defaults to `false`.\n\n- `ssh_handshake_attempts` (int) - The number of handshakes to attempt with SSH once it can connect.\n  This defaults to `10`, unless a `ssh_timeout` is set.\n\n- `ssh_bastion_host` (string) - A bastion host to use for the actual SSH connection.\n\n- `ssh_bastion_port` (int) - The port of the bastion host. Defaults to `22`.\n\n- `ssh_bastion_agent_auth` (bool) - If `true`, the local SSH agent will be used to authenticate with the\n  bastion host. Defaults to `false`.\n\n- `ssh_bastion_username` (string) - The username to connect to the bastion host.\n\n- `ssh_bastion_password` (string) - The password to use to authenticate with the bastion host.\n\n- `ssh_bastion_interactive` (bool) - If `true`, the keyboard-interactive used to authenticate with bastion host.\n\n- `ssh_bastion_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with the\n  bastion host. The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_bastion_certificate_file` (string) - Path to user certificate used to authenticate with bastion host.\n  The `~` can be used in path and will be expanded to the\n  home directory of current user.\n\n- `ssh_file_transfer_method` (string) - `scp` or `sftp` - How to transfer files, Secure copy (default) or SSH\n  File Transfer Protocol.\n  \n  **NOTE**: Guests using Windows with Win32-OpenSSH v9.1.0.0p1-Beta, scp\n  (the default protocol for copying data) returns a a non-zero error code since the MOTW\n  cannot be set, which cause any file transfer to fail. As a workaround you can override the transfer protocol\n  with SFTP instead `ssh_file_transfer_protocol = \"sftp\"`.\n\n- `ssh_proxy_host` (string) - A SOCKS proxy host to use for SSH connection\n\n- `ssh_proxy_port` (int) - A port of the SOCKS proxy. Defaults to `1080`.\n\n- `ssh_proxy_username` (string) - The optional username to authenticate with the proxy server.\n\n- `ssh_proxy_password` (string) - The optional password to use to authenticate with the proxy server.\n\n- `ssh_keep_alive_interval` (duration string | ex: \"1h5m2s\") - How often to send \"keep alive\" messages to the server. Set to a negative\n  value (`-1s`) to disable. Example value: `10s`. Defaults to `5s`.\n\n- `ssh_read_write_timeout` (duration string | ex: \"1h5m2s\") - The amount of time to wait for a remote command to end. This might be\n  useful if, for example, packer hangs on a connection after a reboot.\n  Example: `5m`. Disabled by default.\n\n- `ssh_remote_tunnels` ([]string) - \n\n- `ssh_local_tunnels` ([]string) - \n\n\u003c!-- End of code generated from the comments of the SSH struct in communicator/config.go; --\u003e\n\n\n- `ssh_private_key_file` (string) - Path to a PEM encoded private key file to use to authenticate with SSH.\n  The `~` can be used in path and will be expanded to the home directory\n  of current user.\n\n\n## Basic Example\n\nHere is a basic example for Azure.\n\n**HCL2**\n\n```hcl\nsource \"azure-arm\" \"basic-example\" {\n  client_id = \"fe354398-d7sf-4dc9-87fd-c432cd8a7e09\"\n  client_secret = \"keepitsecret\u0026#*$\"\n  resource_group_name = \"packerdemo\"\n  storage_account = \"virtualmachines\"\n  subscription_id = \"44cae533-4247-4093-42cf-897ded6e7823\"\n  tenant_id = \"de39842a-caba-497e-a798-7896aea43218\"\n\n  capture_container_name = \"images\"\n  capture_name_prefix = \"packer\"\n\n  os_type = \"Linux\"\n  image_publisher = \"Canonical\"\n  image_offer = \"UbuntuServer\"\n  image_sku = \"14.04.4-LTS\"\n\n  azure_tags = {\n    dept = \"engineering\"\n  }\n\n  location = \"West US\"\n  vm_size = \"Standard_A2\"\n}\n\nbuild {\n  sources = [\"sources.azure-arm.basic-example\"]\n}\n```\n\n**JSON**\n\n```json\n{\n  \"type\": \"azure-arm\",\n\n  \"client_id\": \"fe354398-d7sf-4dc9-87fd-c432cd8a7e09\",\n  \"client_secret\": \"keepitsecret\u0026#*$\",\n  \"resource_group_name\": \"packerdemo\",\n  \"storage_account\": \"virtualmachines\",\n  \"subscription_id\": \"44cae533-4247-4093-42cf-897ded6e7823\",\n  \"tenant_id\": \"de39842a-caba-497e-a798-7896aea43218\",\n\n  \"capture_container_name\": \"images\",\n  \"capture_name_prefix\": \"packer\",\n\n  \"os_type\": \"Linux\",\n  \"image_publisher\": \"Canonical\",\n  \"image_offer\": \"UbuntuServer\",\n  \"image_sku\": \"14.04.4-LTS\",\n\n  \"azure_tags\": {\n    \"dept\": \"engineering\"\n  },\n\n  \"location\": \"West US\",\n  \"vm_size\": \"Standard_A2\"\n}\n```\n\n\n## Deprovision\n\nAzure VMs should be deprovisioned at the end of every build. For Windows this\nmeans executing sysprep, and for Linux this means executing the waagent\ndeprovision process.\n\nPlease refer to the Azure\n[example](https://github.com/hashicorp/packer-plugin-azure/tree/main/example) folder for\ncomplete examples showing the deprovision process.\n\n### Windows\n\nThe following provisioner snippet shows how to sysprep a Windows VM.\nDeprovision should be the last operation executed by a build. The code below\nwill wait for sysprep to write the image status in the registry and will exit\nafter that. The possible states, in case you want to wait for another state,\n[are documented\nhere](https://technet.microsoft.com/en-us/library/hh824815.aspx)\n\n**JSON**\n\n```json\n{\n  \"provisioners\": [\n    {\n      \"type\": \"powershell\",\n      \"inline\": [\n        \"# If Guest Agent services are installed, make sure that they have started.\",\n        \"foreach ($service in Get-Service -Name RdAgent, WindowsAzureTelemetryService, WindowsAzureGuestAgent -ErrorAction SilentlyContinue) { while ((Get-Service $service.Name).Status -ne 'Running') { Start-Sleep -s 5 } }\",\n\n        \"\u0026 $env:SystemRoot\\\\System32\\\\Sysprep\\\\Sysprep.exe /oobe /generalize /quiet /quit /mode:vm\",\n        \"while($true) { $imageState = Get-ItemProperty HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Setup\\\\State | Select ImageState; if($imageState.ImageState -ne 'IMAGE_STATE_GENERALIZE_RESEAL_TO_OOBE') { Write-Output $imageState.ImageState; Start-Sleep -s 10  } else { break } }\"\n      ]\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nprovisioner \"powershell\" {\n   inline = [\n        \"# If Guest Agent services are installed, make sure that they have started.\",\n        \"foreach ($service in Get-Service -Name RdAgent, WindowsAzureTelemetryService, WindowsAzureGuestAgent -ErrorAction SilentlyContinue) { while ((Get-Service $service.Name).Status -ne 'Running') { Start-Sleep -s 5 } }\",\n\n        \"\u0026 $env:SystemRoot\\\\System32\\\\Sysprep\\\\Sysprep.exe /oobe /generalize /quiet /quit /mode:vm\",\n        \"while($true) { $imageState = Get-ItemProperty HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Setup\\\\State | Select ImageState; if($imageState.ImageState -ne 'IMAGE_STATE_GENERALIZE_RESEAL_TO_OOBE') { Write-Output $imageState.ImageState; Start-Sleep -s 10  } else { break } }\"\n   ]\n}\n```\n\n\nThe Windows Guest Agent participates in the Sysprep process. The agent must be\nfully installed before the VM can be sysprep'ed. To ensure this is true all\nagent services must be running before executing sysprep.exe. The above JSON\nsnippet shows one way to do this in the PowerShell provisioner. This snippet is\n**only** required if the VM is configured to install the agent, which is the\ndefault. To learn more about disabling the Windows Guest Agent please see\n[Install the VM\nAgent](https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/agent-windows#install-the-vm-agent).\n\nPlease note that sysprep can get stuck in infinite loops if it is not configured\ncorrectly -- for example, if it is waiting for a reboot that you never perform.\n\n### Linux\n\nThe following provisioner snippet shows how to deprovision a Linux VM.\nDeprovision should be the last operation executed by a build.\n\n**JSON**\n\n```json\n{\n  \"provisioners\": [\n    {\n      \"execute_command\": \"chmod +x {{ .Path }}; {{ .Vars }} sudo -E sh '{{ .Path }}'\",\n      \"inline\": [\n        \"/usr/sbin/waagent -force -deprovision+user \u0026\u0026 export HISTSIZE=0 \u0026\u0026 sync\"\n      ],\n      \"inline_shebang\": \"/bin/sh -x\",\n      \"type\": \"shell\"\n    }\n  ]\n}\n```\n\n**HCL2**\n\n```hcl\nprovisioner \"shell\" {\n   execute_command = \"chmod +x {{ .Path }}; {{ .Vars }} sudo -E sh '{{ .Path }}'\"\n   inline = [\n        \"/usr/sbin/waagent -force -deprovision+user \u0026\u0026 export HISTSIZE=0 \u0026\u0026 sync\"\n   ]\n   inline_shebang = \"/bin/sh -x\"\n}\n```\n\n\nTo learn more about the Linux deprovision process please see WALinuxAgent's\n[README](https://github.com/Azure/WALinuxAgent/blob/master/README.md).\n\n#### skip_clean\n\nCustomers have reported issues with the deprovision process where the builder\nhangs. The error message is similar to the following.\n\n    Build 'azure-arm' errored: Retryable error: Error removing temporary script at /tmp/script_9899.sh: ssh: handshake failed: EOF\n\nOne solution is to set skip_clean to true in the provisioner. This prevents\nPacker from cleaning up any helper scripts uploaded to the VM during the build.\n\n## Defaults\n\nThe Azure builder attempts to pick default values that provide for a just works\nexperience. These values can be changed by the user to more suitable values.\n\n- The default user name is Packer not root as in other builders. Most distros\n  on Azure do not allow root to SSH to a VM hence the need for a non-root\n  default user. Set the ssh_username option to override the default value.\n- The default VM size is Standard_A1. Set the vm_size option to override\n  the default value.\n- The default image version is latest. Set the image_version option to\n  override the default value.\n- By default a temporary resource group will be created and destroyed as part\n  of the build. If you do not have permissions to do so, use\n  `build_resource_group_name` to specify an existing resource group to run\n  the build in.\n\n## Implementation\n\n~\u003e **Warning!** This is an advanced topic. You do not need to understand\nthe implementation to use the Azure builder.\n\nThe Azure builder uses ARM\n[templates](https://azure.microsoft.com/en-us/documentation/articles/resource-group-authoring-templates/)\nto deploy resources. ARM templates allow you to express the what without having\nto express the how.\n\nThe Azure builder works under the assumption that it creates everything it\nneeds to execute a build. When the build has completed it simply deletes the\nresource group to cleanup any runtime resources. Resource groups are named\nusing the form `packer-Resource-Group-\u003crandom\u003e`. The value `\u003crandom\u003e` is a\nrandom value that is generated at every invocation of packer. The `\u003crandom\u003e`\nvalue is re-used as much as possible when naming resources, so users can better\nidentify and group these transient resources when seen in their subscription.\n\n\u003e The VHD is created on a user specified storage account, not a random one\n\u003e created at runtime. When a virtual machine is captured the resulting VHD is\n\u003e stored on the same storage account as the source VHD. The VHD created by\n\u003e Packer must persist after a build is complete, which is why the storage\n\u003e account is set by the user.\n\nThe basic steps for a build are:\n\n1.  Create a resource group.\n2.  Validate and deploy a VM template.\n3.  Execute provision - defined by the user; typically shell commands.\n4.  Power off and capture the VM.\n5.  Delete the resource group.\n6.  Delete the temporary VM's OS disk.\n\nThe templates used for a build are currently fixed in the code. There is a\ntemplate for Linux, Windows, and KeyVault. The templates are themselves\ntemplated with place holders for names, passwords, SSH keys, certificates, etc.\n\n### What's Randomized?\n\nThe Azure builder creates the following random values at runtime.\n\n- Administrator Password: a random 32-character value using the _password\n  alphabet_.\n- Certificate: a 2,048-bit certificate used to secure WinRM communication.\n  The certificate is valid for 24-hours, which starts roughly at invocation\n  time.\n- Certificate Password: a random 32-character value using the _password\n  alphabet_ used to protect the private key of the certificate.\n- Compute Name: a random 15-character name prefixed with pkrvm; the name of\n  the VM.\n- Deployment Name: a random 15-character name prefixed with pkfdp; the name\n  of the deployment.\n- KeyVault Name: a random 15-character name prefixed with pkrkv.\n- NIC Name: a random 15-character name prefixed with pkrni.\n- Public IP Name: a random 15-character name prefixed with pkrip.\n- OS Disk Name: a random 15-character name prefixed with pkros.\n- Data Disk Name: a random 15-character name prefixed with pkrdd.\n- Resource Group Name: a random 33-character name prefixed with\n  packer-Resource-Group-.\n- Subnet Name: a random 15-character name prefixed with pkrsn.\n- SSH Key Pair: a 2,048-bit asymmetric key pair; can be overridden by the\n  user.\n- Virtual Network Name: a random 15-character name prefixed with pkrvn.\n\nThe default alphabet used for random values is\n**0123456789bcdfghjklmnpqrstvwxyz**. The alphabet was reduced (no vowels) to\nprevent running afoul of Azure decency controls.\n\nThe password alphabet used for random values is\n**0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ**.\n\n### Windows\n\nThe Windows implementation is very similar to the Linux build, with the\nexception that it deploys a template to configure KeyVault. Packer communicates\nwith a Windows VM using the WinRM protocol. Windows VMs on Azure default to\nusing both password and certificate based authentication for WinRM. The\npassword is easily set via the VM ARM template, but the certificate requires an\nintermediary. The intermediary for Azure is KeyVault. The certificate is\nuploaded to a new KeyVault provisioned in the same resource group as the VM.\nWhen the Windows VM is deployed, it links to the certificate in KeyVault, and\nAzure will ensure the certificate is injected as part of deployment.\n\nThe basic steps for a Windows build are:\n\n1.  Create a resource group.\n2.  Validate and deploy a KeyVault template.\n3.  Validate and deploy a VM template.\n4.  Execute provision - defined by the user; typically shell commands.\n5.  Power off and capture the VM.\n6.  Delete the resource group.\n7.  Delete the temporary VM's OS disk.\n\nA Windows build requires two templates and two deployments. Unfortunately, the\nKeyVault and VM cannot be deployed at the same time hence the need for two\ntemplates and deployments. The time required to deploy a KeyVault template is\nminimal, so overall impact is small.\n\nSee the\n[example](https://github.com/hashicorp/packer-plugin-azure/tree/main/example)\nfolder in the Packer project for more examples.\n","created_at":"2024-02-22T15:44:30.302Z","updated_at":"2024-02-22T15:44:30.302Z","name":"ARM","slug":"arm","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"06794322-3663-4b29-8f57-e104c2d418a7","integration_release_id":"de917766-2908-45e4-ad61-19ce27f637cc","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `azure-chroot`\nArtifact BuilderId: `azure.chroot`\n\nThe `azure-chroot` builder is able to build Azure managed disk (MD) images. For\nmore information on managed disks, see [Azure Managed Disks Overview](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/managed-disks-overview).\n\nThe difference between this builder and the `azure-arm` builder is that this\nbuilder is able to build a managed disk image without launching a new Azure VM\nfor every build, but instead use an already-running Azure VM. This can\ndramatically speed up image builds. It also allows for more deterministic image\ncontent and enables some capabilities that are not possible with the\n`azure-arm` builder.\n\n\u003e **This is an advanced builder** If you're just getting started with Packer,\n\u003e it is recommend to start with the [azure-arm builder](https://packer.io/docs/builder/azure-arm),\n\u003e which is much easier to use.\n\n## How Does it Work?\n\nThis builder works by creating a new MD from either an existing source or from\nscratch and attaching it to the (already existing) Azure VM where Packer is\nrunning. Once attached, a [chroot](https://en.wikipedia.org/wiki/Chroot) is set\nup and made available to the [provisioners](https://packer.io/docs/provisioners).\nAfter provisioning, the MD is detached, snapshotted and a MD image is created.\n\nUsing this process, minutes can be shaved off the image creation process\nbecause Packer does not need to launch a VM instance.\n\nThere are some restrictions however:\n\n- The host system must be a similar system (generally the same OS version,\n  kernel versions, etc.) as the image being built.\n- If the source is a managed disk, it must be made available in the same\n  region as the host system.\n- The host system SKU has to allow for all of the specified disks to be\n  attached.\n\n## Configuration Reference\n\nThere are many configuration options available for the builder. We'll start\nwith authentication parameters, then go over the Azure chroot builder specific\noptions.\n\n### Authentication options\n\nNone of the authentication options are required, but depending on which\nones are specified a different authentication method may be used. See the\n[shared Azure builders documentation](https://packer.io/docs/builder/azure) for more\ninformation.\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/common/client/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `cloud_environment_name` (string) - One of Public, China, or\n  USGovernment. Defaults to Public. Long forms such as\n  USGovernmentCloud and AzureUSGovernmentCloud are also supported.\n\n- `metadata_host` (string) - The Hostname of the Azure Metadata Service\n  (for example management.azure.com), used to obtain the Cloud Environment\n  when using a Custom Azure Environment. This can also be sourced from the\n  ARM_METADATA_HOST Environment Variable.\n  Note: CloudEnvironmentName must be set to the requested environment\n  name in the list of available environments held in the metadata_host.\n\n- `client_id` (string) - The application ID of the AAD Service Principal.\n  Requires either `client_secret`, `client_cert_path` or `client_jwt` to be set as well.\n\n- `client_secret` (string) - A password/secret registered for the AAD SP.\n\n- `client_cert_path` (string) - The path to a PKCS#12 bundle (.pfx file) to be used as the client certificate\n  that will be used to authenticate as the specified AAD SP.\n\n- `client_cert_password` (string) - The password for decrypting the client certificate bundle.\n\n- `client_jwt` (string) - A JWT bearer token for client auth (RFC 7523, Sec. 2.2) that will be used\n  to authenticate the AAD SP. Provides more control over token the expiration\n  when using certificate authentication than when using `client_cert_path`.\n\n- `object_id` (string) - The object ID for the AAD SP. Optional, will be derived from the oAuth token if left empty.\n\n- `tenant_id` (string) - The Active Directory tenant identifier with which your `client_id` and\n  `subscription_id` are associated. If not specified, `tenant_id` will be\n  looked up using `subscription_id`.\n\n- `subscription_id` (string) - The subscription to use.\n\n- `use_azure_cli_auth` (bool) - Flag to use Azure CLI authentication. Defaults to false.\n  CLI auth will use the information from an active `az login` session to connect to Azure and set the subscription id and tenant id associated to the signed in account.\n  If enabled, it will use the authentication provided by the `az` CLI.\n  Azure CLI authentication will use the credential marked as `isDefault` and can be verified using `az account show`.\n  Works with normal authentication (`az login`) and service principals (`az login --service-principal --username APP_ID --password PASSWORD --tenant TENANT_ID`).\n  Ignores all other configurations if enabled.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/common/client/config.go; --\u003e\n\n\n### Azure chroot builder specific options\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/chroot/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `source` (string) - One of the following can be used as a source for an image:\n  - a shared image version resource ID\n  - a managed disk resource ID\n  - a publisher:offer:sku:version specifier for plaform image sources.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/chroot/builder.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/chroot/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `from_scratch` (bool) - When set to `true`, starts with an empty, unpartitioned disk. Defaults to `false`.\n\n- `command_wrapper` (string) - How to run shell commands. This may be useful to set environment variables or perhaps run\n  a command with sudo or so on. This is a configuration template where the `.Command` variable\n  is replaced with the command to be run. Defaults to `{{.Command}}`.\n\n- `pre_mount_commands` ([]string) - A series of commands to execute after attaching the root volume and before mounting the chroot.\n  This is not required unless using `from_scratch`. If so, this should include any partitioning\n  and filesystem creation commands. The path to the device is provided by `{{.Device}}`.\n\n- `mount_options` ([]string) - Options to supply the `mount` command when mounting devices. Each option will be prefixed with\n  `-o` and supplied to the `mount` command ran by Packer. Because this command is ran in a shell,\n  user discretion is advised. See this manual page for the `mount` command for valid file system specific options.\n\n- `mount_partition` (string) - The partition number containing the / partition. By default this is the first partition of the volume.\n\n- `mount_path` (string) - The path where the volume will be mounted. This is where the chroot environment will be. This defaults\n  to `/mnt/packer-amazon-chroot-volumes/{{.Device}}`. This is a configuration template where the `.Device`\n  variable is replaced with the name of the device where the volume is attached.\n\n- `post_mount_commands` ([]string) - As `pre_mount_commands`, but the commands are executed after mounting the root device and before the\n  extra mount and copy steps. The device and mount path are provided by `{{.Device}}` and `{{.MountPath}}`.\n\n- `chroot_mounts` ([][]string) - This is a list of devices to mount into the chroot environment. This configuration parameter requires\n  some additional documentation which is in the \"Chroot Mounts\" section below. Please read that section\n  for more information on how to use this.\n\n- `copy_files` ([]string) - Paths to files on the running Azure instance that will be copied into the chroot environment prior to\n  provisioning. Defaults to `/etc/resolv.conf` so that DNS lookups work. Pass an empty list to skip copying\n  `/etc/resolv.conf`. You may need to do this if you're building an image that uses systemd.\n\n- `os_disk_size_gb` (int64) - Try to resize the OS disk to this size on the first copy. Disks can only be englarged. If not specified,\n  the disk will keep its original size. Required when using `from_scratch`\n\n- `os_disk_storage_account_type` (string) - The [storage SKU](https://docs.microsoft.com/en-us/rest/api/compute/disks/createorupdate#diskstorageaccounttypes)\n  to use for the OS Disk. Defaults to `Standard_LRS`.\n\n- `os_disk_cache_type` (string) - The [cache type](https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#cachingtypes)\n  specified in the resulting image and for attaching it to the Packer VM. Defaults to `ReadOnly`\n\n- `data_disk_storage_account_type` (string) - The [storage SKU](https://docs.microsoft.com/en-us/rest/api/compute/disks/createorupdate#diskstorageaccounttypes)\n  to use for datadisks. Defaults to `Standard_LRS`.\n\n- `data_disk_cache_type` (string) - The [cache type](https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#cachingtypes)\n  specified in the resulting image and for attaching it to the Packer VM. Defaults to `ReadOnly`\n\n- `image_hyperv_generation` (string) - The [Hyper-V generation type](https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#hypervgenerationtypes) for Managed Image output.\n  Defaults to `V1`.\n\n- `temporary_os_disk_id` (string) - The id of the temporary OS disk that will be created. Will be generated if not set.\n\n- `temporary_os_disk_snapshot_id` (string) - The id of the temporary OS disk snapshot that will be created. Will be generated if not set.\n\n- `temporary_data_disk_id_prefix` (string) - The prefix for the resource ids of the temporary data disks that will be created. The disks will be suffixed with a number. Will be generated if not set.\n\n- `temporary_data_disk_snapshot_id` (string) - The prefix for the resource ids of the temporary data disk snapshots that will be created. The snapshots will be suffixed with a number. Will be generated if not set.\n\n- `skip_cleanup` (bool) - If set to `true`, leaves the temporary disks and snapshots behind in the Packer VM resource group. Defaults to `false`\n\n- `image_resource_id` (string) - The managed image to create using this build.\n\n- `shared_image_destination` (SharedImageGalleryDestination) - The shared image to create using this build.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/chroot/builder.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/common/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `skip_create_image` (bool) - Skip creating the image.\n  Useful for setting to `true` during a build test stage.\n  Defaults to `false`.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/common/config.go; --\u003e\n\n\n#### Output options:\n\nAt least one of these options needs to be specified:\n\n- `image_resource_id` (string) - The managed image to create using this build.\n\n- `shared_image_destination` (object) - The shared image to create using this build.\n\nWhere `shared_image_destination` is an object with the following properties:\n\n\u003c!-- Code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/chroot/shared_image_gallery_destination.go; DO NOT EDIT MANUALLY --\u003e\n\n- `resource_group` (string) - Resource Group\n\n- `gallery_name` (string) - Gallery Name\n\n- `image_name` (string) - Image Name\n\n- `image_version` (string) - Image Version\n\n\u003c!-- End of code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/chroot/shared_image_gallery_destination.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/chroot/shared_image_gallery_destination.go; DO NOT EDIT MANUALLY --\u003e\n\n- `target_regions` ([]TargetRegion) - Target Regions\n\n- `exclude_from_latest` (bool) - Exclude From Latest\n\n\u003c!-- End of code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/chroot/shared_image_gallery_destination.go; --\u003e\n\n\nAnd `target_regions` is an array of objects with the following properties:\n\n\u003c!-- Code generated from the comments of the TargetRegion struct in builder/azure/chroot/shared_image_gallery_destination.go; DO NOT EDIT MANUALLY --\u003e\n\n- `name` (string) - Name of the Azure region\n\n\u003c!-- End of code generated from the comments of the TargetRegion struct in builder/azure/chroot/shared_image_gallery_destination.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the TargetRegion struct in builder/azure/chroot/shared_image_gallery_destination.go; DO NOT EDIT MANUALLY --\u003e\n\n- `replicas` (int64) - Number of replicas in this region. Default: 1\n\n- `storage_account_type` (string) - Storage account type: Standard_LRS or Standard_ZRS. Default: Standard_ZRS\n\n\u003c!-- End of code generated from the comments of the TargetRegion struct in builder/azure/chroot/shared_image_gallery_destination.go; --\u003e\n\n\n## Chroot Mounts\n\nThe `chroot_mounts` configuration can be used to mount specific devices within\nthe chroot. By default, the following additional mounts are added into the\nchroot by Packer:\n\n- `/proc` (proc)\n- `/sys` (sysfs)\n- `/dev` (bind to real `/dev`)\n- `/dev/pts` (devpts)\n- `/proc/sys/fs/binfmt_misc` (binfmt_misc)\n\nThese default mounts are usually good enough for anyone and are sane defaults.\nHowever, if you want to change or add the mount points, you may using the\n`chroot_mounts` configuration. Here is an example configuration which only\nmounts `/prod` and `/dev`:\n\n```json\n{\n  \"chroot_mounts\": [\n    [\"proc\", \"proc\", \"/proc\"],\n    [\"bind\", \"/dev\", \"/dev\"]\n  ]\n}\n```\n\n`chroot_mounts` is a list of a 3-tuples of strings. The three components of the\n3-tuple, in order, are:\n\n- The filesystem type. If this is \"bind\", then Packer will properly bind the\n  filesystem to another mount point.\n\n- The source device.\n\n- The mount directory.\n\n## Additional template function\n\nBecause this builder runs on an Azure VM, there is an additional template function\navailable called `vm`, which returns the following VM metadata:\n\n- name\n- subscription_id\n- resource_group\n- location\n- resource_id\n\nThis function can be used in the configuration templates, for example, use\n\n```text\n\"{{ vm `subscription_id` }}\"\n```\n\nto fill in the subscription ID of the VM in any of the configuration options.\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](https://packer.io/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](https://packer.io/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `SourceImageName` - The full name of the source image used in the deployment. When using\nshared images the resulting name will point to the actual source used to create the said version.\n  building the AMI.\n\nUsage example:\n\n**HCL2**\n\n```hcl\n// When accessing one of these variables from inside the builder, you need to\n// use the golang templating syntax. This is due to an architectural quirk that\n// won't be easily resolvable until legacy json templates are deprecated:\n\n{\nsource \"amazon-arm\" \"basic-example\" {\n  source = \"credativ:Debian:9:latest\"\n}\n\n// when accessing one of the variables from a provisioner or post-processor, use\n// hcl-syntax\npost-processor \"manifest\" {\n    output = \"manifest.json\"\n    strip_path = true\n    custom_data = {\n        source_image_name = \"${build.SourceImageName}\"\n    }\n}\n```\n**JSON**\n\n```json\n\"post-processors\": [\n  {\n    \"type\": \"manifest\",\n    \"output\": \"manifest.json\",\n    \"strip_path\": true,\n    \"custom_data\": {\n      \"source_image_name\": \"{{ build `SourceImageName` }}\"\n    }\n  }\n]\n```\n\n\n\n## Examples\n\nHere are some examples using this builder.\nThis builder requires privileged actions, such as mounting disks, running\n`chroot` and other admin commands. Usually it needs to be run with root\npermissions, for example:\n\n```shell-session\n$ sudo -E packer build example.pkr.json\n```\n\n### Using a VM with a Managed Identity\n\nOn a VM with a system-assigned managed identity that has the contributor role\non its own resource group, the following config can be used to create an\nupdated Debian image:\n\n\n**HCL2**\n\n```hcl\nsource \"azure-chroot\" \"example\" {\n  image_resource_id = \"/subscriptions/{{vm `subscription_id`}}/resourceGroups/{{vm `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\"\n  source            = \"credativ:Debian:9:latest\"\n}\n\nbuild {\n  sources = [\"source.azure-chroot.example\"]\n\n  provisioner \"shell\" {\n    inline         = [\"apt-get update\", \"apt-get upgrade -y\"]\n    inline_shebang = \"/bin/sh -x\"\n  }\n}\n```\n\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"azure-chroot\",\n\n      \"image_resource_id\": \"/subscriptions/{{vm `subscription_id`}}/resourceGroups/{{vm `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\",\n      \"source\": \"credativ:Debian:9:latest\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"inline\": [\"apt-get update\", \"apt-get upgrade -y\"],\n      \"inline_shebang\": \"/bin/sh -x\",\n      \"type\": \"shell\"\n    }\n  ]\n}\n```\n\n\n### Using a Service Principal\n\nHere is an example that creates a Debian image with updated packages. Specify\nall environment variables (`ARM_CLIENT_ID`, `ARM_CLIENT_SECRET`,\n`ARM_SUBSCRIPTION_ID`) to use a service principal.\nThe identity you choose should have permission to create disks and images and also\nto update your VM.\nSet the `ARM_IMAGE_RESOURCEGROUP_ID` variable to an existing resource group in the\nsubscription where the resulting image will be created.\n\n**HCL2**\n\n```hcl\nvariable \"client_id\" {\n  type = string\n}\nvariable \"client_secret\" {\n  type = string\n}\nvariable \"subscription_id\" {\n  type = string\n} variable \"resource_group\" {\n  type = string\n}\n\nsource \"azure-chroot\" \"basic-example\" {\n  client_id = var.client_id\n  client_secret = var.client_secret\n  subscription_id = var.subscription_id\n\n  image_resource_id = \"/subscriptions/${var.subscription_id}/resourceGroups/${var.resource_group}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\"\n\n  source = \"credativ:Debian:9:latest\"\n}\n\nbuild {\n  sources = [\"sources.azure-chroot.basic-example\"]\n\n  provisioner \"shell\" {\n    inline = [\"apt-get update\", \"apt-get upgrade -y\"]\n    inline_shebang = \"/bin/sh -x\"\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"client_id\": \"{{env `ARM_CLIENT_ID`}}\",\n    \"client_secret\": \"{{env `ARM_CLIENT_SECRET`}}\",\n    \"subscription_id\": \"{{env `ARM_SUBSCRIPTION_ID`}}\",\n    \"resource_group\": \"{{env `ARM_IMAGE_RESOURCEGROUP_ID`}}\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"azure-chroot\",\n\n      \"client_id\": \"{{user `client_id`}}\",\n      \"client_secret\": \"{{user `client_secret`}}\",\n      \"subscription_id\": \"{{user `subscription_id`}}\",\n\n      \"image_resource_id\": \"/subscriptions/{{user `subscription_id`}}/resourceGroups/{{user `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\",\n\n      \"source\": \"credativ:Debian:9:latest\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"inline\": [\"apt-get update\", \"apt-get upgrade -y\"],\n      \"inline_shebang\": \"/bin/sh -x\",\n      \"type\": \"shell\"\n    }\n  ]\n}\n```\n","created_at":"2024-02-22T15:44:30.705Z","updated_at":"2024-02-22T15:44:30.705Z","name":"chroot","slug":"chroot","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"c3fd9388-33e1-4ed2-b062-71ddcb3e8ce0","integration_release_id":"de917766-2908-45e4-ad61-19ce27f637cc","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `azure-dtl`\nArtifact BuilderId: `Azure.ResourceManagement.VMImage`\n\nThe Azure DevTest Labs builder builds custom images and uploads them to an existing DevTest Lab image repository automatically.\nFor more information on crating an Azure DevTest Lab see the [Configuring a Lab How-to guide](https://docs.microsoft.com/en-us/azure/devtest-labs/devtest-lab-create-lab).\n\n## Configuration Reference\n\nThere are many configuration options available for the builder. We'll start\nwith authentication parameters, then go over the Azure ARM builder specific\noptions. In addition to the options listed here, a [communicator](/packer/docs/templates/legacy_json_templates/communicator) can be configured for this builder.\n\n## Azure DevTest Labs builder specific options\n\n### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/dtl/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `managed_image_resource_group_name` (string) - Specify the managed image resource group name where the result of the\n  Packer build will be saved. The resource group must already exist. If\n  this value is set, the value managed_image_name must also be set. See\n  documentation to learn more about managed images.\n\n- `managed_image_name` (string) - Specify the managed image name where the result of the Packer build will\n  be saved. The image name must not exist ahead of time, and will not be\n  overwritten. If this value is set, the value\n  managed_image_resource_group_name must also be set. See documentation to\n  learn more about managed images.\n\n- `lab_name` (string) - Name of the existing lab where the virtual machine will be created.\n\n- `lab_subnet_name` (string) - Name of the subnet being used in the lab, if not the default.\n\n- `lab_resource_group_name` (string) - Name of the resource group where the lab exist.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/dtl/config.go; --\u003e\n\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/dtl/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `capture_name_prefix` (string) - Capture\n\n- `capture_container_name` (string) - Capture Container Name\n\n- `shared_image_gallery` (SharedImageGallery) - Use a [Shared Gallery\n  image](https://azure.microsoft.com/en-us/blog/announcing-the-public-preview-of-shared-image-gallery/)\n  as the source for this build. *VHD targets are incompatible with this\n  build type* - the target must be a *Managed Image*.\n\n- `shared_image_gallery_destination` (SharedImageGalleryDestination) - The name of the Shared Image Gallery under which the managed image will be published as Shared Gallery Image version.\n  \n  Following is an example.\n\n- `shared_image_gallery_timeout` (duration string | ex: \"1h5m2s\") - How long to wait for an image to be published to the shared image\n  gallery before timing out. If your Packer build is failing on the\n  Publishing to Shared Image Gallery step with the error `Original Error:\n  context deadline exceeded`, but the image is present when you check your\n  Azure dashboard, then you probably need to increase this timeout from\n  its default of \"60m\" (valid time units include `s` for seconds, `m` for\n  minutes, and `h` for hours.)\n\n- `custom_image_capture_timeout` (duration string | ex: \"1h5m2s\") - How long to wait for an image to be captured before timing out\n  If your Packer build is failing on the Capture Image step with the\n  error `Original Error: context deadline exceeded`, but the image is\n  present when you check your custom image repository, then you probably\n  need to increase this timeout from its default of \"30m\" (valid time units\n  include `s` for seconds, `m` for minutes, and `h` for hours.)\n\n- `image_publisher` (string) - PublisherName for your base image. See\n  [documentation](https://docs.microsoft.com/en-us/cli/azure/vm/image)\n  for details.\n  \n  CLI example `az vm image list-publishers --location westus`\n\n- `image_offer` (string) - Offer for your base image. See\n  [documentation](https://docs.microsoft.com/en-us/cli/azure/vm/image)\n  for details.\n  \n  CLI example\n  `az vm image list-offers --location westus --publisher Canonical`\n\n- `image_sku` (string) - SKU for your base image. See\n  [documentation](https://docs.microsoft.com/en-us/cli/azure/vm/image)\n  for details.\n  \n  CLI example\n  `az vm image list-skus --location westus --publisher Canonical --offer UbuntuServer`\n\n- `image_version` (string) - Specify a specific version of an OS to boot from.\n  Defaults to `latest`. There may be a difference in versions available\n  across regions due to image synchronization latency. To ensure a consistent\n  version across regions set this value to one that is available in all\n  regions where you are deploying.\n  \n  CLI example\n  `az vm image list --location westus --publisher Canonical --offer UbuntuServer --sku 16.04.0-LTS --all`\n\n- `image_url` (string) - Specify a custom VHD to use. If this value is set, do\n  not set image_publisher, image_offer, image_sku, or image_version.\n\n- `custom_managed_image_resource_group_name` (string) - Specify the source managed image's resource group used to use. If this\n  value is set, do not set image\\_publisher, image\\_offer, image\\_sku, or\n  image\\_version. If this value is set, the value\n  `custom_managed_image_name` must also be set. See\n  [documentation](https://docs.microsoft.com/en-us/azure/storage/storage-managed-disks-overview#images)\n  to learn more about managed images.\n\n- `custom_managed_image_name` (string) - Specify the source managed image's name to use. If this value is set, do\n  not set image\\_publisher, image\\_offer, image\\_sku, or image\\_version.\n  If this value is set, the value\n  `custom_managed_image_resource_group_name` must also be set. See\n  [documentation](https://docs.microsoft.com/en-us/azure/storage/storage-managed-disks-overview#images)\n  to learn more about managed images.\n\n- `location` (string) - Location\n\n- `vm_size` (string) - Size of the VM used for building. This can be changed when you deploy a\n  VM from your VHD. See\n  [pricing](https://azure.microsoft.com/en-us/pricing/details/virtual-machines/)\n  information. Defaults to `Standard_A1`.\n  \n  CLI example `az vm list-sizes --location westus`\n\n- `managed_image_storage_account_type` (string) - Specify the storage account\n  type for a managed image. Valid values are Standard_LRS and Premium_LRS.\n  The default is Standard_LRS.\n\n- `azure_tags` (map[string]string) - the user can define up to 15\n  tags. Tag names cannot exceed 512 characters, and tag values cannot exceed\n  256 characters. Tags are applied to every resource deployed by a Packer\n  build, i.e. Resource Group, VM, NIC, VNET, Public IP, KeyVault, etc.\n\n- `plan_id` (string) - Used for creating images from Marketplace images. Please refer to\n  [Deploy an image with Marketplace\n  terms](https://aka.ms/azuremarketplaceapideployment) for more details.\n  Not all Marketplace images support programmatic deployment, and support\n  is controlled by the image publisher.\n  Plan_id is a string with unique identifier for the plan associated with images.\n  Ex plan_id=\"1-12ab\"\n\n- `polling_duration_timeout` (duration string | ex: \"1h5m2s\") - The default PollingDuration for azure is 15mins, this property will override\n  that value.\n  If your Packer build is failing on the\n  ARM deployment step with the error `Original Error:\n  context deadline exceeded`, then you probably need to increase this timeout from\n  its default of \"15m\" (valid time units include `s` for seconds, `m` for\n  minutes, and `h` for hours.)\n\n- `os_type` (string) - If either Linux or Windows is specified Packer will\n  automatically configure authentication credentials for the provisioned\n  machine. For Linux this configures an SSH authorized key. For Windows\n  this configures a WinRM certificate.\n\n- `os_disk_size_gb` (int32) - Specify the size of the OS disk in GB\n  (gigabytes). Values of zero or less than zero are ignored.\n\n- `disk_additional_size` ([]int32) - For Managed build the final artifacts are included in the managed image.\n  The additional disk will have the same storage account type as the OS\n  disk, as specified with the `managed_image_storage_account_type`\n  setting.\n\n- `disk_caching_type` (string) - Specify the disk caching type. Valid values\n  are None, ReadOnly, and ReadWrite. The default value is ReadWrite.\n\n- `storage_type` (string) - DTL values\n\n- `lab_virtual_network_name` (string) - Name of the virtual network used for communicating with the lab vms.\n\n- `dtl_artifacts` ([]DtlArtifact) - One or more Artifacts that should be added to the VM at start.\n\n- `vm_name` (string) - Name for the virtual machine within the DevTest lab.\n\n- `disallow_public_ip` (bool) - DisallowPublicIPAddress - Indicates whether the virtual machine is to be created without a public IP address.\n\n- `skip_sysprep` (bool) - SkipSysprep - Indicates whether SysPrep is to be requested to the DTL or if it should be skipped because it has already been applied. Defaults to false.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/dtl/config.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/common/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `skip_create_image` (bool) - Skip creating the image.\n  Useful for setting to `true` during a build test stage.\n  Defaults to `false`.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/common/config.go; --\u003e\n\n\n#### DtlArtifact\n\u003c!-- Code generated from the comments of the DtlArtifact struct in provisioner/azure-dtlartifact/provisioner.go; DO NOT EDIT MANUALLY --\u003e\n\n- `artifact_name` (string) - Artifact Name\n\n- `artifact_id` (string) - Artifact Id\n\n- `parameters` ([]ArtifactParameter) - Parameters\n\n\u003c!-- End of code generated from the comments of the DtlArtifact struct in provisioner/azure-dtlartifact/provisioner.go; --\u003e\n\n\n#### ArtifactParmater\n\u003c!-- Code generated from the comments of the ArtifactParameter struct in provisioner/azure-dtlartifact/provisioner.go; DO NOT EDIT MANUALLY --\u003e\n\n- `name` (string) - Name\n\n- `value` (string) - Value\n\n- `type` (string) - Type\n\n\u003c!-- End of code generated from the comments of the ArtifactParameter struct in provisioner/azure-dtlartifact/provisioner.go; --\u003e\n\n\n\n## Basic Example\n\n```hcl\n\nvariable \"client_id\" {\n  type    = string\n  default = \"${env(\"ARM_CLIENT_ID\")}\"\n}\n\nvariable \"client_secret\" {\n  type    = string\n  default = \"${env(\"ARM_CLIENT_SECRET\")}\"\n}\n\nvariable \"subscription_id\" {\n  type    = string\n  default = \"${env(\"ARM_SUBSCRIPTION_ID\")}\"\n}\n\nlocals { timestamp = regex_replace(timestamp(), \"[- TZ:]\", \"\") }\n\nsource \"azure-dtl\" \"example\" {\n  subscription_id                   = \"${var.subscription_id}\"\n  client_id          = \"${var.client_id}\"\n  client_secret      = \"${var.client_secret}\"\n  disallow_public_ip = true\n  dtl_artifacts {\n    artifact_name = \"linux-apt-package\"\n    parameters {\n      name  = \"packages\"\n      value = \"vim\"\n    }\n    parameters {\n      name  = \"update\"\n      value = \"true\"\n    }\n    parameters {\n      name  = \"options\"\n      value = \"--fix-broken\"\n    }\n  }\n  image_offer                       = \"UbuntuServer\"\n  image_publisher                   = \"Canonical\"\n  image_sku                         = \"16.04-LTS\"\n  lab_name                          = \"packer-test\"\n  lab_resource_group_name           = \"packer-test\"\n  lab_virtual_network_name          = \"dtlpacker-test\"\n  location                          = \"South Central US\"\n  managed_image_name                = \"ManagedDiskLinux-${local.timestamp}\"\n  managed_image_resource_group_name = \"packer-test\"\n  os_type                           = \"Linux\"\n  vm_size                           = \"Standard_DS2_v2\"\n}\n\nbuild {\n  sources = [\"source.azure-dtl.example\"]\n\n}\n```\n","created_at":"2024-02-22T15:44:30.950Z","updated_at":"2024-02-22T15:44:30.950Z","name":"DTL","slug":"dtl","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},{"id":"9604f3ff-12a3-458b-9afa-d4bbdc574c88","integration_release_id":"de917766-2908-45e4-ad61-19ce27f637cc","component_id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","readme":"Type: `azure-dtlartifact`\n\nThe Azure DevTest Labs provisioner can be used to apply an artifact to a VM - See [Add an artifact to a VM](https://docs.microsoft.com/en-us/azure/devtest-labs/add-artifact-vm)\n\n## Azure DevTest Labs provisioner specific options\n\n### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in provisioner/azure-dtlartifact/provisioner.go; DO NOT EDIT MANUALLY --\u003e\n\n- `dtl_artifacts` ([]DtlArtifact) - Dtl Artifacts\n\n- `lab_name` (string) - Name of the existing lab where the virtual machine exist.\n\n- `lab_resource_group_name` (string) - Name of the resource group where the lab exist.\n\n- `vm_name` (string) - Name of the virtual machine within the DevTest lab.\n\n\u003c!-- End of code generated from the comments of the Config struct in provisioner/azure-dtlartifact/provisioner.go; --\u003e\n\n\n### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in provisioner/azure-dtlartifact/provisioner.go; DO NOT EDIT MANUALLY --\u003e\n\n- `polling_duration_timeout` (duration string | ex: \"1h5m2s\") - The default PollingDuration for azure is 15mins, this property will override\n  that value.\n  If your Packer build is failing on the\n  ARM deployment step with the error `Original Error:\n  context deadline exceeded`, then you probably need to increase this timeout from\n  its default of \"15m\" (valid time units include `s` for seconds, `m` for\n  minutes, and `h` for hours.)\n\n- `azure_tags` (map[string]\\*string) - Azure Tags\n\n\u003c!-- End of code generated from the comments of the Config struct in provisioner/azure-dtlartifact/provisioner.go; --\u003e\n\n\n#### DtlArtifact\n\u003c!-- Code generated from the comments of the DtlArtifact struct in provisioner/azure-dtlartifact/provisioner.go; DO NOT EDIT MANUALLY --\u003e\n\n- `artifact_name` (string) - Artifact Name\n\n- `artifact_id` (string) - Artifact Id\n\n- `parameters` ([]ArtifactParameter) - Parameters\n\n\u003c!-- End of code generated from the comments of the DtlArtifact struct in provisioner/azure-dtlartifact/provisioner.go; --\u003e\n\n\n#### ArtifactParmater\n\u003c!-- Code generated from the comments of the ArtifactParameter struct in provisioner/azure-dtlartifact/provisioner.go; DO NOT EDIT MANUALLY --\u003e\n\n- `name` (string) - Name\n\n- `value` (string) - Value\n\n- `type` (string) - Type\n\n\u003c!-- End of code generated from the comments of the ArtifactParameter struct in provisioner/azure-dtlartifact/provisioner.go; --\u003e\n\n\n## Basic Example\n\n```hcl\nsource \"null\" \"example\" {\n  communicator = \"none\"\n}\n\nbuild {\n  sources = [\"source.null.example\"]\n\n  provisioner \"azure-dtlartifact\" {\n    lab_name                          = \"packer-test\"\n    lab_resource_group_name           = \"packer-test\"\n    vm_name                          = \"packer-test-vm\"\n    dtl_artifacts {\n        artifact_name = \"linux-apt-package\"\n        parameters {\n          name  = \"packages\"\n          value = \"vim\"\n        }\n        parameters {\n          name  = \"update\"\n          value = \"true\"\n        }\n        parameters {\n          name  = \"options\"\n          value = \"--fix-broken\"\n        }\n    }\n  }\n}\n```\n","created_at":"2024-02-22T15:44:31.237Z","updated_at":"2024-02-22T15:44:31.237Z","name":"DTL Artifact","slug":"dtlartifact","component":{"id":"418417de-2c71-46a1-8dbc-7e9ae777a22e","slug":"provisioner","name":"Provisioner","plural_name":"Provisioners","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:31.054Z","updated_at":"2022-11-09T22:56:31.054Z"},"variable_groups":[]}]},"component":{"id":"06794322-3663-4b29-8f57-e104c2d418a7","integration_release_id":"de917766-2908-45e4-ad61-19ce27f637cc","component_id":"36076511-3ced-4faf-addf-101fce0405ff","readme":"Type: `azure-chroot`\nArtifact BuilderId: `azure.chroot`\n\nThe `azure-chroot` builder is able to build Azure managed disk (MD) images. For\nmore information on managed disks, see [Azure Managed Disks Overview](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/managed-disks-overview).\n\nThe difference between this builder and the `azure-arm` builder is that this\nbuilder is able to build a managed disk image without launching a new Azure VM\nfor every build, but instead use an already-running Azure VM. This can\ndramatically speed up image builds. It also allows for more deterministic image\ncontent and enables some capabilities that are not possible with the\n`azure-arm` builder.\n\n\u003e **This is an advanced builder** If you're just getting started with Packer,\n\u003e it is recommend to start with the [azure-arm builder](https://packer.io/docs/builder/azure-arm),\n\u003e which is much easier to use.\n\n## How Does it Work?\n\nThis builder works by creating a new MD from either an existing source or from\nscratch and attaching it to the (already existing) Azure VM where Packer is\nrunning. Once attached, a [chroot](https://en.wikipedia.org/wiki/Chroot) is set\nup and made available to the [provisioners](https://packer.io/docs/provisioners).\nAfter provisioning, the MD is detached, snapshotted and a MD image is created.\n\nUsing this process, minutes can be shaved off the image creation process\nbecause Packer does not need to launch a VM instance.\n\nThere are some restrictions however:\n\n- The host system must be a similar system (generally the same OS version,\n  kernel versions, etc.) as the image being built.\n- If the source is a managed disk, it must be made available in the same\n  region as the host system.\n- The host system SKU has to allow for all of the specified disks to be\n  attached.\n\n## Configuration Reference\n\nThere are many configuration options available for the builder. We'll start\nwith authentication parameters, then go over the Azure chroot builder specific\noptions.\n\n### Authentication options\n\nNone of the authentication options are required, but depending on which\nones are specified a different authentication method may be used. See the\n[shared Azure builders documentation](https://packer.io/docs/builder/azure) for more\ninformation.\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/common/client/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `cloud_environment_name` (string) - One of Public, China, or\n  USGovernment. Defaults to Public. Long forms such as\n  USGovernmentCloud and AzureUSGovernmentCloud are also supported.\n\n- `metadata_host` (string) - The Hostname of the Azure Metadata Service\n  (for example management.azure.com), used to obtain the Cloud Environment\n  when using a Custom Azure Environment. This can also be sourced from the\n  ARM_METADATA_HOST Environment Variable.\n  Note: CloudEnvironmentName must be set to the requested environment\n  name in the list of available environments held in the metadata_host.\n\n- `client_id` (string) - The application ID of the AAD Service Principal.\n  Requires either `client_secret`, `client_cert_path` or `client_jwt` to be set as well.\n\n- `client_secret` (string) - A password/secret registered for the AAD SP.\n\n- `client_cert_path` (string) - The path to a PKCS#12 bundle (.pfx file) to be used as the client certificate\n  that will be used to authenticate as the specified AAD SP.\n\n- `client_cert_password` (string) - The password for decrypting the client certificate bundle.\n\n- `client_jwt` (string) - A JWT bearer token for client auth (RFC 7523, Sec. 2.2) that will be used\n  to authenticate the AAD SP. Provides more control over token the expiration\n  when using certificate authentication than when using `client_cert_path`.\n\n- `object_id` (string) - The object ID for the AAD SP. Optional, will be derived from the oAuth token if left empty.\n\n- `tenant_id` (string) - The Active Directory tenant identifier with which your `client_id` and\n  `subscription_id` are associated. If not specified, `tenant_id` will be\n  looked up using `subscription_id`.\n\n- `subscription_id` (string) - The subscription to use.\n\n- `use_azure_cli_auth` (bool) - Flag to use Azure CLI authentication. Defaults to false.\n  CLI auth will use the information from an active `az login` session to connect to Azure and set the subscription id and tenant id associated to the signed in account.\n  If enabled, it will use the authentication provided by the `az` CLI.\n  Azure CLI authentication will use the credential marked as `isDefault` and can be verified using `az account show`.\n  Works with normal authentication (`az login`) and service principals (`az login --service-principal --username APP_ID --password PASSWORD --tenant TENANT_ID`).\n  Ignores all other configurations if enabled.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/common/client/config.go; --\u003e\n\n\n### Azure chroot builder specific options\n\n#### Required:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/chroot/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `source` (string) - One of the following can be used as a source for an image:\n  - a shared image version resource ID\n  - a managed disk resource ID\n  - a publisher:offer:sku:version specifier for plaform image sources.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/chroot/builder.go; --\u003e\n\n\n#### Optional:\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/chroot/builder.go; DO NOT EDIT MANUALLY --\u003e\n\n- `from_scratch` (bool) - When set to `true`, starts with an empty, unpartitioned disk. Defaults to `false`.\n\n- `command_wrapper` (string) - How to run shell commands. This may be useful to set environment variables or perhaps run\n  a command with sudo or so on. This is a configuration template where the `.Command` variable\n  is replaced with the command to be run. Defaults to `{{.Command}}`.\n\n- `pre_mount_commands` ([]string) - A series of commands to execute after attaching the root volume and before mounting the chroot.\n  This is not required unless using `from_scratch`. If so, this should include any partitioning\n  and filesystem creation commands. The path to the device is provided by `{{.Device}}`.\n\n- `mount_options` ([]string) - Options to supply the `mount` command when mounting devices. Each option will be prefixed with\n  `-o` and supplied to the `mount` command ran by Packer. Because this command is ran in a shell,\n  user discretion is advised. See this manual page for the `mount` command for valid file system specific options.\n\n- `mount_partition` (string) - The partition number containing the / partition. By default this is the first partition of the volume.\n\n- `mount_path` (string) - The path where the volume will be mounted. This is where the chroot environment will be. This defaults\n  to `/mnt/packer-amazon-chroot-volumes/{{.Device}}`. This is a configuration template where the `.Device`\n  variable is replaced with the name of the device where the volume is attached.\n\n- `post_mount_commands` ([]string) - As `pre_mount_commands`, but the commands are executed after mounting the root device and before the\n  extra mount and copy steps. The device and mount path are provided by `{{.Device}}` and `{{.MountPath}}`.\n\n- `chroot_mounts` ([][]string) - This is a list of devices to mount into the chroot environment. This configuration parameter requires\n  some additional documentation which is in the \"Chroot Mounts\" section below. Please read that section\n  for more information on how to use this.\n\n- `copy_files` ([]string) - Paths to files on the running Azure instance that will be copied into the chroot environment prior to\n  provisioning. Defaults to `/etc/resolv.conf` so that DNS lookups work. Pass an empty list to skip copying\n  `/etc/resolv.conf`. You may need to do this if you're building an image that uses systemd.\n\n- `os_disk_size_gb` (int64) - Try to resize the OS disk to this size on the first copy. Disks can only be englarged. If not specified,\n  the disk will keep its original size. Required when using `from_scratch`\n\n- `os_disk_storage_account_type` (string) - The [storage SKU](https://docs.microsoft.com/en-us/rest/api/compute/disks/createorupdate#diskstorageaccounttypes)\n  to use for the OS Disk. Defaults to `Standard_LRS`.\n\n- `os_disk_cache_type` (string) - The [cache type](https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#cachingtypes)\n  specified in the resulting image and for attaching it to the Packer VM. Defaults to `ReadOnly`\n\n- `data_disk_storage_account_type` (string) - The [storage SKU](https://docs.microsoft.com/en-us/rest/api/compute/disks/createorupdate#diskstorageaccounttypes)\n  to use for datadisks. Defaults to `Standard_LRS`.\n\n- `data_disk_cache_type` (string) - The [cache type](https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#cachingtypes)\n  specified in the resulting image and for attaching it to the Packer VM. Defaults to `ReadOnly`\n\n- `image_hyperv_generation` (string) - The [Hyper-V generation type](https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#hypervgenerationtypes) for Managed Image output.\n  Defaults to `V1`.\n\n- `temporary_os_disk_id` (string) - The id of the temporary OS disk that will be created. Will be generated if not set.\n\n- `temporary_os_disk_snapshot_id` (string) - The id of the temporary OS disk snapshot that will be created. Will be generated if not set.\n\n- `temporary_data_disk_id_prefix` (string) - The prefix for the resource ids of the temporary data disks that will be created. The disks will be suffixed with a number. Will be generated if not set.\n\n- `temporary_data_disk_snapshot_id` (string) - The prefix for the resource ids of the temporary data disk snapshots that will be created. The snapshots will be suffixed with a number. Will be generated if not set.\n\n- `skip_cleanup` (bool) - If set to `true`, leaves the temporary disks and snapshots behind in the Packer VM resource group. Defaults to `false`\n\n- `image_resource_id` (string) - The managed image to create using this build.\n\n- `shared_image_destination` (SharedImageGalleryDestination) - The shared image to create using this build.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/chroot/builder.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the Config struct in builder/azure/common/config.go; DO NOT EDIT MANUALLY --\u003e\n\n- `skip_create_image` (bool) - Skip creating the image.\n  Useful for setting to `true` during a build test stage.\n  Defaults to `false`.\n\n\u003c!-- End of code generated from the comments of the Config struct in builder/azure/common/config.go; --\u003e\n\n\n#### Output options:\n\nAt least one of these options needs to be specified:\n\n- `image_resource_id` (string) - The managed image to create using this build.\n\n- `shared_image_destination` (object) - The shared image to create using this build.\n\nWhere `shared_image_destination` is an object with the following properties:\n\n\u003c!-- Code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/chroot/shared_image_gallery_destination.go; DO NOT EDIT MANUALLY --\u003e\n\n- `resource_group` (string) - Resource Group\n\n- `gallery_name` (string) - Gallery Name\n\n- `image_name` (string) - Image Name\n\n- `image_version` (string) - Image Version\n\n\u003c!-- End of code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/chroot/shared_image_gallery_destination.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/chroot/shared_image_gallery_destination.go; DO NOT EDIT MANUALLY --\u003e\n\n- `target_regions` ([]TargetRegion) - Target Regions\n\n- `exclude_from_latest` (bool) - Exclude From Latest\n\n\u003c!-- End of code generated from the comments of the SharedImageGalleryDestination struct in builder/azure/chroot/shared_image_gallery_destination.go; --\u003e\n\n\nAnd `target_regions` is an array of objects with the following properties:\n\n\u003c!-- Code generated from the comments of the TargetRegion struct in builder/azure/chroot/shared_image_gallery_destination.go; DO NOT EDIT MANUALLY --\u003e\n\n- `name` (string) - Name of the Azure region\n\n\u003c!-- End of code generated from the comments of the TargetRegion struct in builder/azure/chroot/shared_image_gallery_destination.go; --\u003e\n\n\n\u003c!-- Code generated from the comments of the TargetRegion struct in builder/azure/chroot/shared_image_gallery_destination.go; DO NOT EDIT MANUALLY --\u003e\n\n- `replicas` (int64) - Number of replicas in this region. Default: 1\n\n- `storage_account_type` (string) - Storage account type: Standard_LRS or Standard_ZRS. Default: Standard_ZRS\n\n\u003c!-- End of code generated from the comments of the TargetRegion struct in builder/azure/chroot/shared_image_gallery_destination.go; --\u003e\n\n\n## Chroot Mounts\n\nThe `chroot_mounts` configuration can be used to mount specific devices within\nthe chroot. By default, the following additional mounts are added into the\nchroot by Packer:\n\n- `/proc` (proc)\n- `/sys` (sysfs)\n- `/dev` (bind to real `/dev`)\n- `/dev/pts` (devpts)\n- `/proc/sys/fs/binfmt_misc` (binfmt_misc)\n\nThese default mounts are usually good enough for anyone and are sane defaults.\nHowever, if you want to change or add the mount points, you may using the\n`chroot_mounts` configuration. Here is an example configuration which only\nmounts `/prod` and `/dev`:\n\n```json\n{\n  \"chroot_mounts\": [\n    [\"proc\", \"proc\", \"/proc\"],\n    [\"bind\", \"/dev\", \"/dev\"]\n  ]\n}\n```\n\n`chroot_mounts` is a list of a 3-tuples of strings. The three components of the\n3-tuple, in order, are:\n\n- The filesystem type. If this is \"bind\", then Packer will properly bind the\n  filesystem to another mount point.\n\n- The source device.\n\n- The mount directory.\n\n## Additional template function\n\nBecause this builder runs on an Azure VM, there is an additional template function\navailable called `vm`, which returns the following VM metadata:\n\n- name\n- subscription_id\n- resource_group\n- location\n- resource_id\n\nThis function can be used in the configuration templates, for example, use\n\n```text\n\"{{ vm `subscription_id` }}\"\n```\n\nto fill in the subscription ID of the VM in any of the configuration options.\n\n## Build Shared Information Variables\n\nThis builder generates data that are shared with provisioner and post-processor via build function of [template engine](https://packer.io/docs/templates/legacy_json_templates/engine) for JSON and [contextual variables](https://packer.io/docs/templates/hcl_templates/contextual-variables) for HCL2.\n\nThe generated variables available for this builder are:\n\n- `SourceImageName` - The full name of the source image used in the deployment. When using\nshared images the resulting name will point to the actual source used to create the said version.\n  building the AMI.\n\nUsage example:\n\n**HCL2**\n\n```hcl\n// When accessing one of these variables from inside the builder, you need to\n// use the golang templating syntax. This is due to an architectural quirk that\n// won't be easily resolvable until legacy json templates are deprecated:\n\n{\nsource \"amazon-arm\" \"basic-example\" {\n  source = \"credativ:Debian:9:latest\"\n}\n\n// when accessing one of the variables from a provisioner or post-processor, use\n// hcl-syntax\npost-processor \"manifest\" {\n    output = \"manifest.json\"\n    strip_path = true\n    custom_data = {\n        source_image_name = \"${build.SourceImageName}\"\n    }\n}\n```\n**JSON**\n\n```json\n\"post-processors\": [\n  {\n    \"type\": \"manifest\",\n    \"output\": \"manifest.json\",\n    \"strip_path\": true,\n    \"custom_data\": {\n      \"source_image_name\": \"{{ build `SourceImageName` }}\"\n    }\n  }\n]\n```\n\n\n\n## Examples\n\nHere are some examples using this builder.\nThis builder requires privileged actions, such as mounting disks, running\n`chroot` and other admin commands. Usually it needs to be run with root\npermissions, for example:\n\n```shell-session\n$ sudo -E packer build example.pkr.json\n```\n\n### Using a VM with a Managed Identity\n\nOn a VM with a system-assigned managed identity that has the contributor role\non its own resource group, the following config can be used to create an\nupdated Debian image:\n\n\n**HCL2**\n\n```hcl\nsource \"azure-chroot\" \"example\" {\n  image_resource_id = \"/subscriptions/{{vm `subscription_id`}}/resourceGroups/{{vm `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\"\n  source            = \"credativ:Debian:9:latest\"\n}\n\nbuild {\n  sources = [\"source.azure-chroot.example\"]\n\n  provisioner \"shell\" {\n    inline         = [\"apt-get update\", \"apt-get upgrade -y\"]\n    inline_shebang = \"/bin/sh -x\"\n  }\n}\n```\n\n\n**JSON**\n\n```json\n{\n  \"builders\": [\n    {\n      \"type\": \"azure-chroot\",\n\n      \"image_resource_id\": \"/subscriptions/{{vm `subscription_id`}}/resourceGroups/{{vm `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\",\n      \"source\": \"credativ:Debian:9:latest\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"inline\": [\"apt-get update\", \"apt-get upgrade -y\"],\n      \"inline_shebang\": \"/bin/sh -x\",\n      \"type\": \"shell\"\n    }\n  ]\n}\n```\n\n\n### Using a Service Principal\n\nHere is an example that creates a Debian image with updated packages. Specify\nall environment variables (`ARM_CLIENT_ID`, `ARM_CLIENT_SECRET`,\n`ARM_SUBSCRIPTION_ID`) to use a service principal.\nThe identity you choose should have permission to create disks and images and also\nto update your VM.\nSet the `ARM_IMAGE_RESOURCEGROUP_ID` variable to an existing resource group in the\nsubscription where the resulting image will be created.\n\n**HCL2**\n\n```hcl\nvariable \"client_id\" {\n  type = string\n}\nvariable \"client_secret\" {\n  type = string\n}\nvariable \"subscription_id\" {\n  type = string\n} variable \"resource_group\" {\n  type = string\n}\n\nsource \"azure-chroot\" \"basic-example\" {\n  client_id = var.client_id\n  client_secret = var.client_secret\n  subscription_id = var.subscription_id\n\n  image_resource_id = \"/subscriptions/${var.subscription_id}/resourceGroups/${var.resource_group}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\"\n\n  source = \"credativ:Debian:9:latest\"\n}\n\nbuild {\n  sources = [\"sources.azure-chroot.basic-example\"]\n\n  provisioner \"shell\" {\n    inline = [\"apt-get update\", \"apt-get upgrade -y\"]\n    inline_shebang = \"/bin/sh -x\"\n  }\n}\n```\n\n**JSON**\n\n```json\n{\n  \"variables\": {\n    \"client_id\": \"{{env `ARM_CLIENT_ID`}}\",\n    \"client_secret\": \"{{env `ARM_CLIENT_SECRET`}}\",\n    \"subscription_id\": \"{{env `ARM_SUBSCRIPTION_ID`}}\",\n    \"resource_group\": \"{{env `ARM_IMAGE_RESOURCEGROUP_ID`}}\"\n  },\n  \"builders\": [\n    {\n      \"type\": \"azure-chroot\",\n\n      \"client_id\": \"{{user `client_id`}}\",\n      \"client_secret\": \"{{user `client_secret`}}\",\n      \"subscription_id\": \"{{user `subscription_id`}}\",\n\n      \"image_resource_id\": \"/subscriptions/{{user `subscription_id`}}/resourceGroups/{{user `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\",\n\n      \"source\": \"credativ:Debian:9:latest\"\n    }\n  ],\n  \"provisioners\": [\n    {\n      \"inline\": [\"apt-get update\", \"apt-get upgrade -y\"],\n      \"inline_shebang\": \"/bin/sh -x\",\n      \"type\": \"shell\"\n    }\n  ]\n}\n```\n","created_at":"2024-02-22T15:44:30.705Z","updated_at":"2024-02-22T15:44:30.705Z","name":"chroot","slug":"chroot","component":{"id":"36076511-3ced-4faf-addf-101fce0405ff","slug":"builder","name":"Builder","plural_name":"Builders","product_id":"4c2b00c6-7cc1-4e4c-b596-4ab57e319f21","created_at":"2022-11-09T22:56:30.937Z","updated_at":"2022-11-09T22:56:30.937Z"},"variable_groups":[]},"processedVariablesMarkdown":{},"anchorLinks":[{"id":"how-does-it-work","level":2,"title":"How Does it Work?"},{"id":"configuration-reference","level":2,"title":"Configuration Reference"},{"id":"authentication-options","level":3,"title":"Authentication options"},{"id":"azure-chroot-builder-specific-options","level":3,"title":"Azure chroot builder specific options"},{"id":"required:","level":4,"title":"Required:"},{"id":"optional:","level":4,"title":"Optional:"},{"id":"output-options:","level":4,"title":"Output options:"},{"id":"chroot-mounts","level":2,"title":"Chroot Mounts"},{"id":"additional-template-function","level":2,"title":"Additional template function"},{"id":"build-shared-information-variables","level":2,"title":"Build Shared Information Variables"},{"id":"examples","level":2,"title":"Examples"},{"id":"using-a-vm-with-a-managed-identity","level":3,"title":"Using a VM with a Managed Identity"},{"id":"using-a-service-principal","level":3,"title":"Using a Service Principal"}],"serializedREADME":{"compiledSource":"var m=Object.defineProperty,d=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;var r=(a,n,t)=\u003en in a?m(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=\u003e{for(var t in n||(n={}))o.call(n,t)\u0026\u0026r(a,t,n[t]);if(p)for(var t of p(n))i.call(n,t)\u0026\u0026r(a,t,n[t]);return a},l=(a,n)=\u003ed(a,N(n));var c=(a,n)=\u003e{var t={};for(var s in a)o.call(a,s)\u0026\u0026n.indexOf(s)\u003c0\u0026\u0026(t[s]=a[s]);if(a!=null\u0026\u0026p)for(var s of p(a))n.indexOf(s)\u003c0\u0026\u0026i.call(a,s)\u0026\u0026(t[s]=a[s]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=c(s,[\"components\"]);return mdx(MDXLayout,l(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Type: \",mdx(\"inlineCode\",{parentName:\"p\"},\"azure-chroot\"),`\nArtifact BuilderId: `,mdx(\"inlineCode\",{parentName:\"p\"},\"azure.chroot\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"azure-chroot\"),` builder is able to build Azure managed disk (MD) images. For\nmore information on managed disks, see `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.microsoft.com/en-us/azure/virtual-machines/windows/managed-disks-overview\"}),\"Azure Managed Disks Overview\"),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The difference between this builder and the \",mdx(\"inlineCode\",{parentName:\"p\"},\"azure-arm\"),` builder is that this\nbuilder is able to build a managed disk image without launching a new Azure VM\nfor every build, but instead use an already-running Azure VM. This can\ndramatically speed up image builds. It also allows for more deterministic image\ncontent and enables some capabilities that are not possible with the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"azure-arm\"),\" builder.\"),mdx(\"blockquote\",null,mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"This is an advanced builder\"),` If you're just getting started with Packer,\nit is recommend to start with the `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://packer.io/docs/builder/azure-arm\"}),\"azure-arm builder\"),`,\nwhich is much easier to use.`)),mdx(\"h2\",e({},{id:\"user-content-how-does-it-work\",\"data-text-content\":\"How Does it Work\",className:\"g-type-display-3\"}),\"How Does it Work?\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`This builder works by creating a new MD from either an existing source or from\nscratch and attaching it to the (already existing) Azure VM where Packer is\nrunning. Once attached, a `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://en.wikipedia.org/wiki/Chroot\"}),\"chroot\"),` is set\nup and made available to the `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://packer.io/docs/provisioners\"}),\"provisioners\"),`.\nAfter provisioning, the MD is detached, snapshotted and a MD image is created.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Using this process, minutes can be shaved off the image creation process\nbecause Packer does not need to launch a VM instance.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"There are some restrictions however:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},`The host system must be a similar system (generally the same OS version,\nkernel versions, etc.) as the image being built.`),mdx(\"li\",{parentName:\"ul\"},`If the source is a managed disk, it must be made available in the same\nregion as the host system.`),mdx(\"li\",{parentName:\"ul\"},`The host system SKU has to allow for all of the specified disks to be\nattached.`)),mdx(\"h2\",e({},{id:\"user-content-configuration-reference\",\"data-text-content\":\"Configuration Reference\",className:\"g-type-display-3\"}),\"Configuration Reference\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`There are many configuration options available for the builder. We'll start\nwith authentication parameters, then go over the Azure chroot builder specific\noptions.`),mdx(\"h3\",e({},{id:\"user-content-authentication-options\",\"data-text-content\":\"Authentication options\",className:\"g-type-display-4\"}),\"Authentication options\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`None of the authentication options are required, but depending on which\nones are specified a different authentication method may be used. See the\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"https://packer.io/docs/builder/azure\"}),\"shared Azure builders documentation\"),` for more\ninformation.`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"cloud_environment_name\"),` (string) - One of Public, China, or\nUSGovernment. Defaults to Public. Long forms such as\nUSGovernmentCloud and AzureUSGovernmentCloud are also supported.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"metadata_host\"),` (string) - The Hostname of the Azure Metadata Service\n(for example management.azure.com), used to obtain the Cloud Environment\nwhen using a Custom Azure Environment. This can also be sourced from the\nARM_METADATA_HOST Environment Variable.\nNote: CloudEnvironmentName must be set to the requested environment\nname in the list of available environments held in the metadata_host.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"client_id\"),` (string) - The application ID of the AAD Service Principal.\nRequires either `,mdx(\"inlineCode\",{parentName:\"p\"},\"client_secret\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"client_cert_path\"),\" or \",mdx(\"inlineCode\",{parentName:\"p\"},\"client_jwt\"),\" to be set as well.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"client_secret\"),\" (string) - A password/secret registered for the AAD SP.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"client_cert_path\"),` (string) - The path to a PKCS#12 bundle (.pfx file) to be used as the client certificate\nthat will be used to authenticate as the specified AAD SP.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"client_cert_password\"),\" (string) - The password for decrypting the client certificate bundle.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"client_jwt\"),` (string) - A JWT bearer token for client auth (RFC 7523, Sec. 2.2) that will be used\nto authenticate the AAD SP. Provides more control over token the expiration\nwhen using certificate authentication than when using `,mdx(\"inlineCode\",{parentName:\"p\"},\"client_cert_path\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"object_id\"),\" (string) - The object ID for the AAD SP. Optional, will be derived from the oAuth token if left empty.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"tenant_id\"),\" (string) - The Active Directory tenant identifier with which your \",mdx(\"inlineCode\",{parentName:\"p\"},\"client_id\"),` and\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"subscription_id\"),\" are associated. If not specified, \",mdx(\"inlineCode\",{parentName:\"p\"},\"tenant_id\"),` will be\nlooked up using `,mdx(\"inlineCode\",{parentName:\"p\"},\"subscription_id\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"subscription_id\"),\" (string) - The subscription to use.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"use_azure_cli_auth\"),` (bool) - Flag to use Azure CLI authentication. Defaults to false.\nCLI auth will use the information from an active `,mdx(\"inlineCode\",{parentName:\"p\"},\"az login\"),` session to connect to Azure and set the subscription id and tenant id associated to the signed in account.\nIf enabled, it will use the authentication provided by the `,mdx(\"inlineCode\",{parentName:\"p\"},\"az\"),` CLI.\nAzure CLI authentication will use the credential marked as `,mdx(\"inlineCode\",{parentName:\"p\"},\"isDefault\"),\" and can be verified using \",mdx(\"inlineCode\",{parentName:\"p\"},\"az account show\"),`.\nWorks with normal authentication (`,mdx(\"inlineCode\",{parentName:\"p\"},\"az login\"),\") and service principals (\",mdx(\"inlineCode\",{parentName:\"p\"},\"az login --service-principal --username APP_ID --password PASSWORD --tenant TENANT_ID\"),`).\nIgnores all other configurations if enabled.`))),mdx(\"h3\",e({},{id:\"user-content-azure-chroot-builder-specific-options\",\"data-text-content\":\"Azure chroot builder specific options\",className:\"g-type-display-4\"}),\"Azure chroot builder specific options\"),mdx(\"h4\",e({},{id:\"user-content-required:\",\"data-text-content\":\"Required\",className:\"g-type-display-5\"}),\"Required:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"source\"),\" (string) - One of the following can be used as a source for an image:\",mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},\"a shared image version resource ID\"),mdx(\"li\",{parentName:\"ul\"},\"a managed disk resource ID\"),mdx(\"li\",{parentName:\"ul\"},\"a publisher:offer:sku:version specifier for plaform image sources.\")))),mdx(\"h4\",e({},{id:\"user-content-optional:\",\"data-text-content\":\"Optional\",className:\"g-type-display-5\"}),\"Optional:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"from_scratch\"),\" (bool) - When set to \",mdx(\"inlineCode\",{parentName:\"p\"},\"true\"),\", starts with an empty, unpartitioned disk. Defaults to \",mdx(\"inlineCode\",{parentName:\"p\"},\"false\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"command_wrapper\"),` (string) - How to run shell commands. This may be useful to set environment variables or perhaps run\na command with sudo or so on. This is a configuration template where the `,mdx(\"inlineCode\",{parentName:\"p\"},\".Command\"),` variable\nis replaced with the command to be run. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},\"{{.Command}}\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"pre_mount_commands\"),` ([]string) - A series of commands to execute after attaching the root volume and before mounting the chroot.\nThis is not required unless using `,mdx(\"inlineCode\",{parentName:\"p\"},\"from_scratch\"),`. If so, this should include any partitioning\nand filesystem creation commands. The path to the device is provided by `,mdx(\"inlineCode\",{parentName:\"p\"},\"{{.Device}}\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"mount_options\"),\" ([]string) - Options to supply the \",mdx(\"inlineCode\",{parentName:\"p\"},\"mount\"),` command when mounting devices. Each option will be prefixed with\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"-o\"),\" and supplied to the \",mdx(\"inlineCode\",{parentName:\"p\"},\"mount\"),` command ran by Packer. Because this command is ran in a shell,\nuser discretion is advised. See this manual page for the `,mdx(\"inlineCode\",{parentName:\"p\"},\"mount\"),\" command for valid file system specific options.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"mount_partition\"),\" (string) - The partition number containing the / partition. By default this is the first partition of the volume.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"mount_path\"),` (string) - The path where the volume will be mounted. This is where the chroot environment will be. This defaults\nto `,mdx(\"inlineCode\",{parentName:\"p\"},\"/mnt/packer-amazon-chroot-volumes/{{.Device}}\"),\". This is a configuration template where the \",mdx(\"inlineCode\",{parentName:\"p\"},\".Device\"),`\nvariable is replaced with the name of the device where the volume is attached.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"post_mount_commands\"),\" ([]string) - As \",mdx(\"inlineCode\",{parentName:\"p\"},\"pre_mount_commands\"),`, but the commands are executed after mounting the root device and before the\nextra mount and copy steps. The device and mount path are provided by `,mdx(\"inlineCode\",{parentName:\"p\"},\"{{.Device}}\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"{{.MountPath}}\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"chroot_mounts\"),\" (\",\"[][]\",`string) - This is a list of devices to mount into the chroot environment. This configuration parameter requires\nsome additional documentation which is in the \"Chroot Mounts\" section below. Please read that section\nfor more information on how to use this.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"copy_files\"),` ([]string) - Paths to files on the running Azure instance that will be copied into the chroot environment prior to\nprovisioning. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},\"/etc/resolv.conf\"),` so that DNS lookups work. Pass an empty list to skip copying\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"/etc/resolv.conf\"),\". You may need to do this if you're building an image that uses systemd.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"os_disk_size_gb\"),` (int64) - Try to resize the OS disk to this size on the first copy. Disks can only be englarged. If not specified,\nthe disk will keep its original size. Required when using `,mdx(\"inlineCode\",{parentName:\"p\"},\"from_scratch\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"os_disk_storage_account_type\"),\" (string) - The \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.microsoft.com/en-us/rest/api/compute/disks/createorupdate#diskstorageaccounttypes\"}),\"storage SKU\"),`\nto use for the OS Disk. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},\"Standard_LRS\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"os_disk_cache_type\"),\" (string) - The \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#cachingtypes\"}),\"cache type\"),`\nspecified in the resulting image and for attaching it to the Packer VM. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},\"ReadOnly\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"data_disk_storage_account_type\"),\" (string) - The \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.microsoft.com/en-us/rest/api/compute/disks/createorupdate#diskstorageaccounttypes\"}),\"storage SKU\"),`\nto use for datadisks. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},\"Standard_LRS\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"data_disk_cache_type\"),\" (string) - The \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#cachingtypes\"}),\"cache type\"),`\nspecified in the resulting image and for attaching it to the Packer VM. Defaults to `,mdx(\"inlineCode\",{parentName:\"p\"},\"ReadOnly\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"image_hyperv_generation\"),\" (string) - The \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.microsoft.com/en-us/rest/api/compute/images/createorupdate#hypervgenerationtypes\"}),\"Hyper-V generation type\"),` for Managed Image output.\nDefaults to `,mdx(\"inlineCode\",{parentName:\"p\"},\"V1\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"temporary_os_disk_id\"),\" (string) - The id of the temporary OS disk that will be created. Will be generated if not set.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"temporary_os_disk_snapshot_id\"),\" (string) - The id of the temporary OS disk snapshot that will be created. Will be generated if not set.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"temporary_data_disk_id_prefix\"),\" (string) - The prefix for the resource ids of the temporary data disks that will be created. The disks will be suffixed with a number. Will be generated if not set.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"temporary_data_disk_snapshot_id\"),\" (string) - The prefix for the resource ids of the temporary data disk snapshots that will be created. The snapshots will be suffixed with a number. Will be generated if not set.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"skip_cleanup\"),\" (bool) - If set to \",mdx(\"inlineCode\",{parentName:\"p\"},\"true\"),\", leaves the temporary disks and snapshots behind in the Packer VM resource group. Defaults to \",mdx(\"inlineCode\",{parentName:\"p\"},\"false\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"image_resource_id\"),\" (string) - The managed image to create using this build.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"shared_image_destination\"),\" (SharedImageGalleryDestination) - The shared image to create using this build.\"))),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"skip_create_image\"),` (bool) - Skip creating the image.\nUseful for setting to `,mdx(\"inlineCode\",{parentName:\"li\"},\"true\"),` during a build test stage.\nDefaults to `,mdx(\"inlineCode\",{parentName:\"li\"},\"false\"),\".\")),mdx(\"h4\",e({},{id:\"user-content-output-options:\",\"data-text-content\":\"Output options\",className:\"g-type-display-5\"}),\"Output options:\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"At least one of these options needs to be specified:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"image_resource_id\"),\" (string) - The managed image to create using this build.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"shared_image_destination\"),\" (object) - The shared image to create using this build.\"))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Where \",mdx(\"inlineCode\",{parentName:\"p\"},\"shared_image_destination\"),\" is an object with the following properties:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"resource_group\"),\" (string) - Resource Group\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"gallery_name\"),\" (string) - Gallery Name\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"image_name\"),\" (string) - Image Name\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"image_version\"),\" (string) - Image Version\"))),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"target_regions\"),\" ([]TargetRegion) - Target Regions\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"exclude_from_latest\"),\" (bool) - Exclude From Latest\"))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"And \",mdx(\"inlineCode\",{parentName:\"p\"},\"target_regions\"),\" is an array of objects with the following properties:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"name\"),\" (string) - Name of the Azure region\")),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"replicas\"),\" (int64) - Number of replicas in this region. Default: 1\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"storage_account_type\"),\" (string) - Storage account type: Standard_LRS or Standard_ZRS. Default: Standard_ZRS\"))),mdx(\"h2\",e({},{id:\"user-content-chroot-mounts\",\"data-text-content\":\"Chroot Mounts\",className:\"g-type-display-3\"}),\"Chroot Mounts\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"chroot_mounts\"),` configuration can be used to mount specific devices within\nthe chroot. By default, the following additional mounts are added into the\nchroot by Packer:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"/proc\"),\" (proc)\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"/sys\"),\" (sysfs)\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"/dev\"),\" (bind to real \",mdx(\"inlineCode\",{parentName:\"li\"},\"/dev\"),\")\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"/dev/pts\"),\" (devpts)\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"/proc/sys/fs/binfmt_misc\"),\" (binfmt_misc)\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`These default mounts are usually good enough for anyone and are sane defaults.\nHowever, if you want to change or add the mount points, you may using the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"chroot_mounts\"),` configuration. Here is an example configuration which only\nmounts `,mdx(\"inlineCode\",{parentName:\"p\"},\"/prod\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"/dev\"),\":\"),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"chroot_mounts\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"proc\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"proc\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/proc\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"bind\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/dev\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/dev\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"inlineCode\",{parentName:\"p\"},\"chroot_mounts\"),` is a list of a 3-tuples of strings. The three components of the\n3-tuple, in order, are:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`The filesystem type. If this is \"bind\", then Packer will properly bind the\nfilesystem to another mount point.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"The source device.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"The mount directory.\"))),mdx(\"h2\",e({},{id:\"user-content-additional-template-function\",\"data-text-content\":\"Additional template function\",className:\"g-type-display-3\"}),\"Additional template function\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Because this builder runs on an Azure VM, there is an additional template function\navailable called `,mdx(\"inlineCode\",{parentName:\"p\"},\"vm\"),\", which returns the following VM metadata:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"name\"),mdx(\"li\",{parentName:\"ul\"},\"subscription_id\"),mdx(\"li\",{parentName:\"ul\"},\"resource_group\"),mdx(\"li\",{parentName:\"ul\"},\"location\"),mdx(\"li\",{parentName:\"ul\"},\"resource_id\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"This function can be used in the configuration templates, for example, use\"),mdx(\"pre\",e({},{className:\"language-text\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-text\"}),'\"{{ vm `subscription_id` }}\"',`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"to fill in the subscription ID of the VM in any of the configuration options.\"),mdx(\"h2\",e({},{id:\"user-content-build-shared-information-variables\",\"data-text-content\":\"Build Shared Information Variables\",className:\"g-type-display-3\"}),\"Build Shared Information Variables\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"This builder generates data that are shared with provisioner and post-processor via build function of \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://packer.io/docs/templates/legacy_json_templates/engine\"}),\"template engine\"),\" for JSON and \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://packer.io/docs/templates/hcl_templates/contextual-variables\"}),\"contextual variables\"),\" for HCL2.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The generated variables available for this builder are:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"SourceImageName\"),` - The full name of the source image used in the deployment. When using\nshared images the resulting name will point to the actual source used to create the said version.\nbuilding the AMI.`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Usage example:\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"HCL2\")),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// When accessing one of these variables from inside the builder, you need to\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// use the golang templating syntax. This is due to an architectural quirk that\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// won't be easily resolvable until legacy json templates are deprecated:\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"source \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"amazon-arm\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"basic-example\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"credativ:Debian:9:latest\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// when accessing one of the variables from a provisioner or post-processor, use\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// hcl-syntax\"),`\n`,\"post-processor \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"manifest\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"output\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"manifest.json\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"strip_path\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"true\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"custom_data\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source_image_name\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\"build\",mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"SourceImageName\",mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"JSON\")),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"post-processors\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"manifest\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"output\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"manifest.json\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"strip_path\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"true\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"custom_data\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"source_image_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"{{ build `SourceImageName` }}\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`)),mdx(\"h2\",e({},{id:\"user-content-examples\",\"data-text-content\":\"Examples\",className:\"g-type-display-3\"}),\"Examples\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Here are some examples using this builder.\nThis builder requires privileged actions, such as mounting disks, running\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"chroot\"),` and other admin commands. Usually it needs to be run with root\npermissions, for example:`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"sudo\"),\" -E packer build example.pkr.json\")),`\n`)),mdx(\"h3\",e({},{id:\"user-content-using-a-vm-with-a-managed-identity\",\"data-text-content\":\"Using a VM with a Managed Identity\",className:\"g-type-display-4\"}),\"Using a VM with a Managed Identity\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`On a VM with a system-assigned managed identity that has the contributor role\non its own resource group, the following config can be used to create an\nupdated Debian image:`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"HCL2\")),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),\"source \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"azure-chroot\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"example\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"image_resource_id\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/subscriptions/{{vm `subscription_id`}}/resourceGroups/{{vm `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\"            \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"credativ:Debian:9:latest\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"build\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"sources\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"source.azure-chroot.example\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provisioner\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"shell\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"inline\"),\"         \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"apt-get update\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"apt-get upgrade -y\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"inline_shebang\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/bin/sh -x\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"JSON\")),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"builders\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"azure-chroot\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"image_resource_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/subscriptions/{{vm `subscription_id`}}/resourceGroups/{{vm `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"source\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"credativ:Debian:9:latest\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"provisioners\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"inline\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"apt-get update\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"apt-get upgrade -y\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"inline_shebang\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/bin/sh -x\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"shell\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h3\",e({},{id:\"user-content-using-a-service-principal\",\"data-text-content\":\"Using a Service Principal\",className:\"g-type-display-4\"}),\"Using a Service Principal\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Here is an example that creates a Debian image with updated packages. Specify\nall environment variables (`,mdx(\"inlineCode\",{parentName:\"p\"},\"ARM_CLIENT_ID\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"ARM_CLIENT_SECRET\"),`,\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"ARM_SUBSCRIPTION_ID\"),`) to use a service principal.\nThe identity you choose should have permission to create disks and images and also\nto update your VM.\nSet the `,mdx(\"inlineCode\",{parentName:\"p\"},\"ARM_IMAGE_RESOURCEGROUP_ID\"),` variable to an existing resource group in the\nsubscription where the resulting image will be created.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"HCL2\")),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"client_id\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"client_secret\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"subscription_id\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"resource_group\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"source \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"azure-chroot\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"basic-example\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"client_id\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.client_id\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"client_secret\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.client_secret\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"subscription_id\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.subscription_id\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"image_resource_id\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/subscriptions/',mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"subscription_id\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),\"/resourceGroups/\",mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"resource_group\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\"'),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"credativ:Debian:9:latest\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"build\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"sources\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"sources.azure-chroot.basic-example\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provisioner\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"shell\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"inline\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"apt-get update\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"apt-get upgrade -y\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"inline_shebang\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/bin/sh -x\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"JSON\")),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"variables\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"client_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"{{env `ARM_CLIENT_ID`}}\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"client_secret\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"{{env `ARM_CLIENT_SECRET`}}\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"subscription_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"{{env `ARM_SUBSCRIPTION_ID`}}\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"resource_group\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"{{env `ARM_IMAGE_RESOURCEGROUP_ID`}}\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"builders\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"azure-chroot\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"client_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"{{user `client_id`}}\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"client_secret\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"{{user `client_secret`}}\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"subscription_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"{{user `subscription_id`}}\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"image_resource_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/subscriptions/{{user `subscription_id`}}/resourceGroups/{{user `resource_group`}}/providers/Microsoft.Compute/images/MyDebianOSImage-{{timestamp}}\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"source\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"credativ:Debian:9:latest\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"provisioners\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"inline\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"apt-get update\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"apt-get upgrade -y\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"inline_shebang\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"/bin/sh -x\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"type\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"shell\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)))}MDXContent.isMDXComponent=!0;\n","scope":{}},"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Packer","url":"/packer"},{"title":"Integrations","url":"/packer/integrations"},{"title":"Azure","url":"/packer/integrations/hashicorp/azure","isCurrentPage":false},{"title":"v2.0.4","url":"/packer/integrations/hashicorp/azure/v2.0.4","isCurrentPage":false},{"title":"Components"},{"title":"Builder"},{"title":"chroot","url":"/packer/integrations/hashicorp/azure/latest/components/builder/chroot","isCurrentPage":true}]},"__N_SSG":true},"page":"/[productSlug]/integrations/[organizationSlug]/[integrationSlug]/[integrationVersion]/components/[componentType]/[componentSlug]","query":{"productSlug":"packer","organizationSlug":"hashicorp","integrationSlug":"azure","integrationVersion":"latest","componentType":"builder","componentSlug":"chroot"},"buildId":"1sdYLlFQ1437_Ko0L9N2-","assetPrefix":"/hashicorp-packer","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-warning.js"><\x2fscript>');</script></body></html>